<!doctype html><html><head><title>AoC 2021 Day 21: Dicinator â€“ jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_5823201688106629450.min.8c7d803d89ebdecf2416d468f4ecb981a3acf645154a7a336f2e5d0190ea8163.js integrity="sha256-jH2APYnr3s8kFtRo9Oy5gaOs9kUVSnozby5dAZDqgWM=" defer></script>
<script src=/jquery.fancybox_6181813213021922412.min.921ca906a32e718ab61ac0b4da24e0eaa6bdd41912654a33b44bd3fc2f0c2a4d.js integrity="sha256-khypBqMucYq2GsC02iTg6qa91BkSZUoztEvT/C8MKk0=" defer></script>
<script src=/katex_12008035502722260518.min.1c3dce03daaf56a7d2fe0d0ec49bf35256837226f835adaf52c09502ef9bc5d1.js integrity="sha256-HD3OA9qvVqfS/g0OxJvzUlaDcib4Na2vUsCVAu+bxdE=" defer></script>
<script src=/bigfoot_8444447145154709333.min.5e80bd85ebaeb95607834d6777bfe7013d1d161f0f02a31b845e4bd765898316.js integrity="sha256-XoC9heuuuVYHg01nd7/nAT0dFh8PAqMbhF5L12WJgxY=" defer></script>
<script src=/mermaid_12365941879912544862.min.973b5415b3fa1835d620c0e58236f859d5f80891f447e240cbbb9eb825251ff0.js integrity="sha256-lztUFbP6GDXWIMDlgjb4WdX4CJH0R+JAy7ueuCUlH/A=" defer></script>
<script src=/main.min.982c2d7bb434b4cf8b19c2cf38ef7e7f7162ddbed610e5bdddbb937001e26574.js integrity="sha256-mCwte7Q0tM+LGcLPOO9+f3Fi3b7WEOW93buTcAHiZXQ=" defer></script>
<link rel=stylesheet href=/katex_14163593549783030822.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_16482899066638414220.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_16222217791602823071.min.e28b5d7d9d89efacb5f708ac30cbd76b1b9a0f816dfd9da96631d1d09cbbdd76.css integrity="sha256-4otdfZ2J76y19wisMMvXaxuaD4Ft/Z2pZjHR0Jy73XY="><link rel=stylesheet href=/css_4780214198035419921.min.246b6f8e7620eeb717bca5e7b121037906e5dfaa05805f427fcc5a09b6c99f5c.css integrity="sha256-JGtvjnYg7rcXvKXnsSEDeQbl36oFgF9Cf8xaCbbJn1w="><link rel=stylesheet href=/main.min.e0e68b86dea32185ab89b0b9cc01649107cc6b0be3290c8c7b13c716bc0dabfa.css integrity="sha256-4OaLht6jIYWribC5zAFkkQfMawvjKQyMexPHFrwNq/o="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>AoC 2021 Day 21: Dicinator</h1><div class=entry-meta><span class=entry-date>2021-12-21</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2021/12/20/aoc-2021-day-20-enhancinator/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/python>Python</a><a href=https://blog.jverkamp.com/2021/12/22/aoc-2021-day-22-cubinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2021/12/20/aoc-2021-day-20-enhancinator/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/advent-of-code>Advent of Code</a><a href=https://blog.jverkamp.com/2021/12/22/aoc-2021-day-22-cubinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2021/12/15/aoc-2021-day-15-low-ceiling-simulator/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/algorithms>Algorithms</a><a href=https://blog.jverkamp.com/2021/12/22/aoc-2021-day-22-cubinator/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2021/08/05/raco-pkg-install-noise/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/games>Games</a><a href=https://blog.jverkamp.com/2022/12/17/aoc-2022-day-17-tetrisinator/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2021/12/15/aoc-2021-day-15-low-ceiling-simulator/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/optimization>Optimization</a><a href=https://blog.jverkamp.com/2021/12/22/aoc-2021-day-22-cubinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/series/>Series</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2021/12/20/aoc-2021-day-20-enhancinator/ class=previous-link></a><a class=taxonomy-value href=/series/advent-of-code-2021>Advent of Code 2021</a><a href=https://blog.jverkamp.com/2021/12/22/aoc-2021-day-22-cubinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2021/12/20/aoc-2021-day-20-enhancinator/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2021/12/22/aoc-2021-day-22-cubinator/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2021/12/21/the-greatest-showman/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2021/12/22/hawkeye/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><h3 id=source-dirac-dicehttpsadventofcodecom2021day21>Source: <a href=https://adventofcode.com/2021/day/21 target=_blank rel=noopener>Dirac Dice</a></h3><h4 id=part-1-play-a-simple-game-describe-below-with-a-loaded-d100-that-always-rolls-1-2-3--99-100-1--return-the-score-of-the-losing-player-times-the-number-of-times-the-die-was-rolled><strong>Part 1:</strong> Play a simple game (describe below) with a loaded D100 (that always rolls 1, 2, 3, &mldr; 99, 100, 1, &mldr;). Return the score of the losing player times the number of times the die was rolled.</h4><ul><li>The board has a circle of 10 squares, numbered 1-10</li><li>The player pieces start on given squares</li><li>Each turn, roll 3 dice, advance the sum of the three many spaces (wrapping around)</li><li>Score points equal to the square you land on</li><li>The first player to score >= 1000 wins</li></ul><p>This is not a hard problem, so I&rsquo;m going to <em>dramatically</em> overengineer it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>Die <span style=color:#f92672>=</span> Generator[int, <span style=color:#66d9ef>None</span>, <span style=color:#66d9ef>None</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>LoadedDie</span>(sides: int) <span style=color:#f92672>-&gt;</span> Die:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(sides):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>yield</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@dataclass</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Game</span>:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Reprents a weird/simple game.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    die: Die
</span></span><span style=display:flex><span>    size: int
</span></span><span style=display:flex><span>    target: int
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    current: int
</span></span><span style=display:flex><span>    players: List[int]
</span></span><span style=display:flex><span>    scores: List[int]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    roll_count: int
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(
</span></span><span style=display:flex><span>            self,
</span></span><span style=display:flex><span>            die: Die,
</span></span><span style=display:flex><span>            size: Optional[int] <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>            target: Optional[int] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000</span>,
</span></span><span style=display:flex><span>            number_of_players: Optional[int] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>            initial_spots: Optional[List[int]] <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>    ):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;Create a game with various defaults.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> number_of_players <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            number_of_players <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>die <span style=color:#f92672>=</span> die
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>size <span style=color:#f92672>=</span> size <span style=color:#f92672>or</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>target <span style=color:#f92672>=</span> target <span style=color:#f92672>or</span> <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>current <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>players <span style=color:#f92672>=</span> initial_spots <span style=color:#f92672>or</span> [<span style=color:#ae81ff>0</span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(number_of_players)]
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>scores <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(number_of_players)]
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>roll_count <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> number_of_players <span style=color:#f92672>==</span> len(self<span style=color:#f92672>.</span>players):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#39;If both number of players and initial spots are provided, they must match&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>winner</span>(self) <span style=color:#f92672>-&gt;</span> Optional[int]:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;Return the current winner (or None if no winner)&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i, score <span style=color:#f92672>in</span> enumerate(self<span style=color:#f92672>.</span>scores):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> score <span style=color:#f92672>&gt;=</span> self<span style=color:#f92672>.</span>target:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>update</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;Plays one round.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>winner():
</span></span><span style=display:flex><span>            logging<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#39;Cannot update, game is already over&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>roll_count <span style=color:#f92672>+=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>        rolls <span style=color:#f92672>=</span> [next(self<span style=color:#f92672>.</span>die), next(self<span style=color:#f92672>.</span>die), next(self<span style=color:#f92672>.</span>die)]
</span></span><span style=display:flex><span>        new_space <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>players[self<span style=color:#f92672>.</span>current] <span style=color:#f92672>+</span> sum(rolls)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> new_space <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>size:
</span></span><span style=display:flex><span>            new_space <span style=color:#f92672>-=</span> self<span style=color:#f92672>.</span>size
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>players[self<span style=color:#f92672>.</span>current] <span style=color:#f92672>=</span> new_space
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>scores[self<span style=color:#f92672>.</span>current] <span style=color:#f92672>+=</span> new_space
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;&#39;&#39;</span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span><span style=color:#e6db74>Player </span><span style=color:#e6db74>{</span>self<span style=color:#f92672>.</span>current<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74> rolls </span><span style=color:#e6db74>{</span>rolls<span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span><span style=color:#e6db74>and moves to space </span><span style=color:#e6db74>{</span>self<span style=color:#f92672>.</span>players[self<span style=color:#f92672>.</span>current]<span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span><span style=color:#e6db74>for a total score of </span><span style=color:#e6db74>{</span>self<span style=color:#f92672>.</span>scores[self<span style=color:#f92672>.</span>current]<span style=color:#e6db74>}</span><span style=color:#e6db74>.</span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span><span style=color:#e6db74>&#39;&#39;&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>current <span style=color:#f92672>=</span> (self<span style=color:#f92672>.</span>current <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> len(self<span style=color:#f92672>.</span>players)
</span></span></code></pre></div><p>Now with any user supplied die, any size board, any number of players, and any target score! I think the most interesting thing was the <code>LoadedDie</code> generator. Any generator will work though.</p><p>Wrap that in the problem statement:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>part1</span>(file: typer<span style=color:#f92672>.</span>FileText):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    p1 <span style=color:#f92672>=</span> int(file<span style=color:#f92672>.</span>readline()<span style=color:#f92672>.</span>split()[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>    p2 <span style=color:#f92672>=</span> int(file<span style=color:#f92672>.</span>readline()<span style=color:#f92672>.</span>split()[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    game <span style=color:#f92672>=</span> Game(die<span style=color:#f92672>=</span>LoadedDie(<span style=color:#ae81ff>100</span>), initial_spots<span style=color:#f92672>=</span>[p1, p2])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#f92672>not</span> game<span style=color:#f92672>.</span>winner():
</span></span><span style=display:flex><span>        game<span style=color:#f92672>.</span>update()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    winning_player <span style=color:#f92672>=</span> game<span style=color:#f92672>.</span>winner()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(
</span></span><span style=display:flex><span>        winning_player, <span style=color:#e6db74>&#39;wins,&#39;</span>,
</span></span><span style=display:flex><span>        game<span style=color:#f92672>.</span>scores[<span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> winning_player <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>else</span> <span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> game<span style=color:#f92672>.</span>roll_count
</span></span><span style=display:flex><span>    )
</span></span></code></pre></div><p>And we&rsquo;re golden:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python3 dicinator.py part1 input.txt
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> wins, <span style=color:#ae81ff>752247</span>
</span></span><span style=display:flex><span><span style=color:#75715e># time 45107958ns / 0.05s</span>
</span></span></code></pre></div><h4 id=part-2-instead-of-the-loaded-die-you-have-a-3-sided-quantum-dirac-die-every-time-it-rolls-split-into-3-universes-rolling-a-1-2-or-3-changing-the-target-score-to-only-21-calculate-the-number-of-universes-in-which-the-player-who-wins-more-matches-wins><strong>Part 2:</strong> Instead of the loaded die, you have a 3-sided quantum Dirac Die. Every time it rolls, split into 3 universes (rolling a 1, 2, or 3). Changing the target score to only 21, calculate the number of universes in which the player who wins more matches wins.</h4><p>Yeah&mldr; all of the code I wrote for the first time? Throw it out.</p><p>Instead, I&rsquo;m going to maintain a current state map with the (player number, location of 1, score of 1, location of 2, score of 2) mapped to the number of games that got to this state. That way, each time we advance a turn, we can regenerate that map and multiply the number of ways we got to that state times the number of ways (out of 27) we can advance. Make sense?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>part2</span>(file: typer<span style=color:#f92672>.</span>FileText):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    location1 <span style=color:#f92672>=</span> int(file<span style=color:#f92672>.</span>readline()<span style=color:#f92672>.</span>split()[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>    location2 <span style=color:#f92672>=</span> int(file<span style=color:#f92672>.</span>readline()<span style=color:#f92672>.</span>split()[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># State is a mapping of (current player, p1 location, p1 score, p2 location, p2 score): count</span>
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        (<span style=color:#ae81ff>1</span>, location1, <span style=color:#ae81ff>0</span>, location2, <span style=color:#ae81ff>0</span>): <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Rolls are the number (out of 27) of each possible roll we could see</span>
</span></span><span style=display:flex><span>    rolls: MutableMapping[int, int] <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>                sum <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> j <span style=color:#f92672>+</span> k
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> sum <span style=color:#f92672>in</span> rolls:
</span></span><span style=display:flex><span>                    rolls[sum] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    rolls[sum] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Wins is the number of times each player has won</span>
</span></span><span style=display:flex><span>    wins <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Advance the state of all possible simulations until every one is finished</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Since we&#39;ll always advance at least 3, this will take a maximum of 7 plays for each player (14 total rounds)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> state:
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>state<span style=color:#e6db74>=}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>{</span>wins<span style=color:#e6db74>=}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>        next_state <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Unpack all of the current states</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (player, location1, score1, location2, score2), current_count <span style=color:#f92672>in</span> state<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>            <span style=color:#75715e># Try every possible combination of rolls of the dice</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> roll, new_count <span style=color:#f92672>in</span> rolls<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>                <span style=color:#75715e># Make sure we&#39;re working on the correct player</span>
</span></span><span style=display:flex><span>                (location, score) <span style=color:#f92672>=</span> (location1, score1) <span style=color:#66d9ef>if</span> player <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>else</span> (location2, score2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># Update that player&#39;s location and score</span>
</span></span><span style=display:flex><span>                new_location <span style=color:#f92672>=</span> location <span style=color:#f92672>+</span> roll
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>while</span> new_location <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10</span>:
</span></span><span style=display:flex><span>                    new_location <span style=color:#f92672>-=</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                score <span style=color:#f92672>+=</span> new_location
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># If the score is &gt;= 21, don&#39;t add those possibilities back into the state space</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># Instead, increment number of wins by the ways we got here (current_count) times the ways to advance (new_count)</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> score <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>21</span>:
</span></span><span style=display:flex><span>                    wins[player] <span style=color:#f92672>+=</span> current_count <span style=color:#f92672>*</span> new_count
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># If we didn&#39;t win, calculate the new index into the state variable</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># This basically means swapping the player and updating either location1,score1 or location2,score2</span>
</span></span><span style=display:flex><span>                new_index <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> player <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>else</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    new_location <span style=color:#66d9ef>if</span> player <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>else</span> location1,
</span></span><span style=display:flex><span>                    score <span style=color:#66d9ef>if</span> player <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>else</span> score1,
</span></span><span style=display:flex><span>                    new_location <span style=color:#66d9ef>if</span> player <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>else</span> location2,
</span></span><span style=display:flex><span>                    score <span style=color:#66d9ef>if</span> player <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>else</span> score2
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># Update the counts in the next state by the ways we got here (current_count) times the ways to advance (new_count)</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> new_index <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> next_state:
</span></span><span style=display:flex><span>                    next_state[new_index] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                next_state[new_index] <span style=color:#f92672>+=</span> current_count <span style=color:#f92672>*</span> new_count
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        state <span style=color:#f92672>=</span> next_state
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    logging<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Final </span><span style=color:#e6db74>{</span>state<span style=color:#e6db74>=}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>{</span>wins<span style=color:#e6db74>=}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    print(max(wins))
</span></span></code></pre></div><p>It&rsquo;s&mldr; pretty crazy, but I think it makes sense to me at least. And it works!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python3 dicinator.py part2 input.txt
</span></span><span style=display:flex><span><span style=color:#ae81ff>221109915584112</span>
</span></span><span style=display:flex><span><span style=color:#75715e># time 181642208ns / 0.18s</span>
</span></span></code></pre></div><p>They won 221 TRILLION times. Go them!</p></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>