<!DOCTYPE html>
<html onclick >
<head>
    <title>A Generic Brute Force Backtracking Solver â€“ jverkamp.com</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8"><link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css" integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" />

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper"><header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a> *
            <a href="/resume">Resume</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>
    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation"><li><a href="https://blog.jverkamp.com/photography/">Photography</a></li><li><a href="https://blog.jverkamp.com/programming/">Programming</a></li><li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li><li><a href="https://blog.jverkamp.com/maker/">Maker</a></li><li><a href="https://blog.jverkamp.com/writing/">Writing</a></li><li><a href="https://blog.jverkamp.com/research/">Research</a></li><li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>
<div id="page-content-wrapper">
            <div id="page-content"><article>
	<header>
		<h1 class="entry-title">A Generic Brute Force Backtracking Solver</h1>

        <div class="entry-meta"><span class="entry-date">2021-06-25</span>
            </div>

        <div class="entry-taxonomies"><div class="entry-tags"><ul class="taxonomy-keys"><li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2021/01/25/gmail-oldest-first/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/javascript">JavaScript</a><a href="https://blog.jverkamp.com/2021/08/17/immutable.js-solvers/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/sources/">Sources</a>
            <ul class="taxonomy-values"><li><a class="taxonomy-value" href="/programming/sources/algorithms">Algorithms</a><a href="https://blog.jverkamp.com/2021/08/17/immutable.js-solvers/" class="next-link"></a></li><li><a class="taxonomy-value" href="/programming/sources/backtracking">Backtracking</a><a href="https://blog.jverkamp.com/2021/08/17/immutable.js-solvers/" class="next-link"></a></li><li><a class="taxonomy-value" href="/programming/sources/generators">Generators</a><a href="https://blog.jverkamp.com/2021/08/17/immutable.js-solvers/" class="next-link"></a></li><li><a class="taxonomy-value" href="/programming/sources/puzzles">Puzzles</a><a href="https://blog.jverkamp.com/2021/08/17/immutable.js-solvers/" class="next-link"></a></li><li><a class="taxonomy-value" href="/programming/sources/sudoku">Sudoku</a><a href="https://blog.jverkamp.com/2021/08/17/immutable.js-solvers/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/topics/">Topics</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2021/06/24/categorizing-r/fantasy-book-bingo-books/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/small-scripts">Small Scripts</a><a href="https://blog.jverkamp.com/2021/06/28/ordering-board-game-geek-geeklists-by-rank/" class="next-link"></a></li></ul>
        </li><li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2021/06/24/categorizing-r/fantasy-book-bingo-books/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2021/06/26/generating-a-book-bingo-chart-in-hugo/" class="next-link">Next</a></ul>
        </li><li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2021/06/24/categorizing-r/fantasy-book-bingo-books/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2021/06/26/generating-a-book-bingo-chart-in-hugo/" class="next-link">Next</a></ul>
        </li></ul>
</div>
</div>
    </header>

	<div class="entry-content"><p>One of the projects I&rsquo;ve had vaguely in the back of my head is a sort of generic puzzle solver. I really love puzzles, but of the pencil and paper and video game varieties. So I think it would be awesome to write out a definition of a puzzle (say how to play Sudoku), give it input, and have it give me an answer back.</p>
<p>Well, I finally got around to trying it!</p>
<p>And it turns out for what I&rsquo;m working on, it&rsquo;s actually not at all complicated code:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">makeSimpleSolver</span>({
        <span style="color:#a6e22e">generateNextStates</span>,
        <span style="color:#a6e22e">isValid</span>,
        <span style="color:#a6e22e">isSolved</span>,
    }) {
    <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">state</span>) =&gt; {
        <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">visited</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

        <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">recur</span> <span style="color:#f92672">=</span> () =&gt; {
            <span style="color:#a6e22e">visited</span><span style="color:#f92672">++</span>

            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">isValid</span>(<span style="color:#a6e22e">state</span>)) {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
            }

            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">isSolved</span>(<span style="color:#a6e22e">state</span>)) {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
            }

            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> {<span style="color:#a6e22e">step</span>, <span style="color:#a6e22e">unstep</span>} <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">generateNextStates</span>(<span style="color:#a6e22e">state</span>)) {
                <span style="color:#a6e22e">step</span>(<span style="color:#a6e22e">state</span>)

                <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">recur</span>()) {
                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
                } <span style="color:#66d9ef">else</span> {
                    <span style="color:#a6e22e">unstep</span>(<span style="color:#a6e22e">state</span>)
                }
            }

            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
        }
        <span style="color:#a6e22e">recur</span>()

        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">state</span>
    }
}
</code></pre></div><p>Essentially for any puzzle you want to solve, I want you to define three functions:</p>
<ul>
<li><code>generateNextStates</code>: takes in the current &lsquo;state&rsquo; (whatever that is) and returns an interable objects containing two functions {<code>step</code>, <code>unstep</code>}:
<ul>
<li><code>step</code>: Take the current state and make one move (move a piece in chess, fill in a number in a Sudoku puzzle)</li>
<li><code>unstep</code>: Should be the exact inverse of the previous function</li>
</ul>
</li>
<li><code>isValid</code>: Take a state and tell us if it&rsquo;s a valid state (this may be useless if the generator functions only return valid states, but I needed it for sudoku)</li>
<li><code>isSolved</code>: Return <code>true</code> if we have solved the problem</li>
</ul>
<p>I&rsquo;ll admit the <code>generateNextStates</code> was particularly weird. If I was working with purely functional languages / immutable data structures, I would probably just keep the state that way. But working on a mutable state (with an undo function) lets us only keep one copy of the actual state data rather than copying it.</p>
<p>It&rsquo;s like keeping only the current state of a chess board in memory and keeping a list of moves rather than keeping a copy of each possible chess board along the way. It should be somewhat more memory efficient.</p>
<p>And that&rsquo;s all we need. Other than that, it&rsquo;s a standard recursive backtracker:</p>
<ul>
<li>Take the current state:
<ul>
<li>If it&rsquo;s an invalid state, ignore it</li>
<li>If it&rsquo;s a solved state, return it all the way back up the call stack</li>
<li>Otherwise, generate a list of moves, for each in turn:
<ul>
<li>Try to make that move and recursively solve from that point</li>
<li>If any branch of that state is a solution, keep returning</li>
<li>If no state was, backtrack (undoing this step) and try another branch</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Now, let&rsquo;s go back to my working example, a Sudoku solver.</p>
<p>First, what are we using as the <code>state</code> of this problem. In this case, a 2D array where each value is 0-9. 1-9 are numbers and 0 is a blank space.</p>
<p>Next, my &lsquo;moves&rsquo; are going to be: find the first empty spaces and try every value in it. I&rsquo;m not at all making sure that a particular number can be used in a space, that&rsquo;s what <code>isValid</code> is used for.</p>
<p>After that, <code>isValid</code> and <code>isSolved</code> each basically require the same set of helper functions. One each to get all of the values in a specific row (<code>getRow</code>), column, or cell/block (the 3x3 subsections of the puzzle). The first two are straight forward, just access that <code>row</code> or <code>column</code> in the <code>state</code>, but the third is&hellip; weird. I mostly had to work it out, but it&rsquo;s a lot of modular math that gets the blocks from top left, across, and then down.</p>
<p>After that, a quick functional way of determining if a list has any non-zero duplicates:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">hasDup</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">vs</span>) =&gt; <span style="color:#a6e22e">vs</span>.<span style="color:#a6e22e">some</span>(<span style="color:#a6e22e">v1</span> =&gt; <span style="color:#a6e22e">v1</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">vs</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">v2</span> =&gt; <span style="color:#a6e22e">v1</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">v2</span>).<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>)
</code></pre></div><p>I&rsquo;m actually quite happy with that function. It takes a list of values <code>vs</code> and asks if there is <code>some</code> value <code>v1</code> such that if you filter the list for only values <code>v2</code> that are the same as <code>v1</code> there&rsquo;s more than one of them (a duplicate!). I still really like functional programming, but the absolutely crazy number of libraries for JavaScript available is something to appreciate. Plus, I can run it directly in the browser!</p>
<p>So, putting this all together:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">makeSimpleSolver</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./solver.js&#39;</span>

<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">indexes</span> <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>]

<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">getRow</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">state</span>, <span style="color:#a6e22e">row</span>) =&gt; <span style="color:#a6e22e">indexes</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">i</span> =&gt; <span style="color:#a6e22e">state</span>[<span style="color:#a6e22e">row</span>][<span style="color:#a6e22e">i</span>])
<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">getCol</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">state</span>, <span style="color:#a6e22e">col</span>) =&gt; <span style="color:#a6e22e">indexes</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">i</span> =&gt; <span style="color:#a6e22e">state</span>[<span style="color:#a6e22e">i</span>][<span style="color:#a6e22e">col</span>])
<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">getCel</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">state</span>, <span style="color:#a6e22e">cel</span>) =&gt; <span style="color:#a6e22e">indexes</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">i</span> =&gt; <span style="color:#a6e22e">state</span>[<span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> Math.<span style="color:#a6e22e">floor</span>(<span style="color:#a6e22e">cel</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">floor</span>(<span style="color:#a6e22e">i</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">3</span>)][<span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> (<span style="color:#a6e22e">cel</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span>)])

<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">hasDup</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">vs</span>) =&gt; <span style="color:#a6e22e">vs</span>.<span style="color:#a6e22e">some</span>(<span style="color:#a6e22e">v1</span> =&gt; <span style="color:#a6e22e">v1</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">vs</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">v2</span> =&gt; <span style="color:#a6e22e">v1</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">v2</span>).<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>)

<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">solveSudoku</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">makeSimpleSolver</span>({
    <span style="color:#a6e22e">returnMeta</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
    <span style="color:#a6e22e">generateNextStates</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span><span style="color:#f92672">*</span>(<span style="color:#a6e22e">state</span>) {
        <span style="color:#75715e">// Find the first empty cell
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">9</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">j</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">9</span>; <span style="color:#a6e22e">j</span><span style="color:#f92672">++</span>) {
                <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">state</span>[<span style="color:#a6e22e">i</span>][<span style="color:#a6e22e">j</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
                    <span style="color:#75715e">// Try each value in it
</span><span style="color:#75715e"></span>                    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">v</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">v</span> <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>; <span style="color:#a6e22e">v</span><span style="color:#f92672">++</span>) {
                        <span style="color:#66d9ef">yield</span> {
                            <span style="color:#a6e22e">step</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">state</span>) { <span style="color:#a6e22e">state</span>[<span style="color:#a6e22e">i</span>][<span style="color:#a6e22e">j</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">v</span> },
                            <span style="color:#a6e22e">unstep</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">state</span>) { <span style="color:#a6e22e">state</span>[<span style="color:#a6e22e">i</span>][<span style="color:#a6e22e">j</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> }
                        }
                    }
                    <span style="color:#66d9ef">return</span>
                }
            }
        }
    },
    <span style="color:#a6e22e">isValid</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">state</span>) {
        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">p</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">p</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">9</span>; <span style="color:#a6e22e">p</span><span style="color:#f92672">++</span>) {
            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">hasDup</span>(<span style="color:#a6e22e">getRow</span>(<span style="color:#a6e22e">state</span>, <span style="color:#a6e22e">p</span>)) 
                    <span style="color:#f92672">||</span> <span style="color:#a6e22e">hasDup</span>(<span style="color:#a6e22e">getCol</span>(<span style="color:#a6e22e">state</span>, <span style="color:#a6e22e">p</span>))
                    <span style="color:#f92672">||</span> <span style="color:#a6e22e">hasDup</span>(<span style="color:#a6e22e">getCel</span>(<span style="color:#a6e22e">state</span>, <span style="color:#a6e22e">p</span>)))
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
        }
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
    },
    <span style="color:#a6e22e">isSolved</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">state</span>) {
        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">9</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">j</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">9</span>; <span style="color:#a6e22e">j</span><span style="color:#f92672">++</span>) {
                <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">state</span>[<span style="color:#a6e22e">i</span>][<span style="color:#a6e22e">j</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
            }
        }

        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">p</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">p</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">9</span>; <span style="color:#a6e22e">p</span><span style="color:#f92672">++</span>) {
            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">hasDup</span>(<span style="color:#a6e22e">getRow</span>(<span style="color:#a6e22e">state</span>, <span style="color:#a6e22e">p</span>)) 
                    <span style="color:#f92672">||</span> <span style="color:#a6e22e">hasDup</span>(<span style="color:#a6e22e">getCol</span>(<span style="color:#a6e22e">state</span>, <span style="color:#a6e22e">p</span>))
                    <span style="color:#f92672">||</span> <span style="color:#a6e22e">hasDup</span>(<span style="color:#a6e22e">getCel</span>(<span style="color:#a6e22e">state</span>, <span style="color:#a6e22e">p</span>)))
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
        }

        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
    }
})
</code></pre></div><p>One interesting thing I didn&rsquo;t actually know you could do with JavaScript until this project: generators! I&rsquo;ve always liked them in Python and they&rsquo;re not that much more difficult to use in JavaScript. Just use <code>function*</code> instead of <code>function</code> and then <code>yield</code> each answer to return. Free (more or less) iterable!</p>
<p>One caveat to watch for, the <code>step</code> and <code>unstep</code> functions have to use the <code>function</code> form, they cannot use arrow syntax, since the latter does not make a closure. The result of that is that the current <code>i</code>/<code>j</code>/<code>v</code> values aren&rsquo;t captured, instead only one value (the last) is used. Which doesn&rsquo;t work so well. That was an interesting but to track down.</p>
<p>And that&rsquo;s it! Let&rsquo;s run a few tests with some vague timing:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">sudokuToString</span>, <span style="color:#a6e22e">solveSudoku</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./sudoku.js&#39;</span>

<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">tests</span> <span style="color:#f92672">=</span> {
    <span style="color:#e6db74">&#39;easy&#39;</span><span style="color:#f92672">:</span> [
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">9</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">4</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">8</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">0</span>]
    ],
    <span style="color:#e6db74">&#39;hard&#39;</span><span style="color:#f92672">:</span> [
        [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">8</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2</span>],
        [<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">7</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]
    ],
    <span style="color:#e6db74">&#39;hardest&#39;</span><span style="color:#f92672">:</span> [
        [<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">8</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>],
        [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]
    ]
}

<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">test</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">tests</span>) {
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">input</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tests</span>[<span style="color:#a6e22e">test</span>]

    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`===== </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">test</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> =====`</span>)
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`input:`</span>)
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">sudokuToString</span>(<span style="color:#a6e22e">input</span>))

    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">time</span>(<span style="color:#a6e22e">test</span>)
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">output</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">solveSudoku</span>(<span style="color:#a6e22e">input</span>)
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">timeEnd</span>(<span style="color:#a6e22e">test</span>)
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>()

    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`output:`</span>)
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">sudokuToString</span>(<span style="color:#a6e22e">input</span>))
}
</code></pre></div><p>Run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">=====</span> easy <span style="color:#f92672">=====</span>
input:
<span style="color:#ae81ff">040000179</span>
<span style="color:#ae81ff">002008054</span>
<span style="color:#ae81ff">006005008</span>
<span style="color:#ae81ff">080070910</span>
<span style="color:#ae81ff">050090030</span>
<span style="color:#ae81ff">019060040</span>
<span style="color:#ae81ff">300400700</span>
<span style="color:#ae81ff">570100200</span>
<span style="color:#ae81ff">928000060</span>

easy: 46.848ms

output:
<span style="color:#ae81ff">845632179</span>
<span style="color:#ae81ff">732918654</span>
<span style="color:#ae81ff">196745328</span>
<span style="color:#ae81ff">683574912</span>
<span style="color:#ae81ff">457291836</span>
<span style="color:#ae81ff">219863547</span>
<span style="color:#ae81ff">361429785</span>
<span style="color:#ae81ff">574186293</span>
928357461

<span style="color:#f92672">=====</span> hard <span style="color:#f92672">=====</span>
input:
<span style="color:#ae81ff">100007090</span>
<span style="color:#ae81ff">030020008</span>
<span style="color:#ae81ff">009600500</span>
<span style="color:#ae81ff">005300900</span>
<span style="color:#ae81ff">010080002</span>
<span style="color:#ae81ff">600004000</span>
<span style="color:#ae81ff">300000010</span>
<span style="color:#ae81ff">040000007</span>
<span style="color:#ae81ff">007000300</span>

hard: 444.153ms

output:
<span style="color:#ae81ff">162857493</span>
<span style="color:#ae81ff">534129678</span>
<span style="color:#ae81ff">789643521</span>
<span style="color:#ae81ff">475312986</span>
<span style="color:#ae81ff">913586742</span>
<span style="color:#ae81ff">628794135</span>
<span style="color:#ae81ff">356478219</span>
<span style="color:#ae81ff">241935867</span>
897261354

<span style="color:#f92672">=====</span> hardest <span style="color:#f92672">=====</span>
input:
<span style="color:#ae81ff">800000000</span>
<span style="color:#ae81ff">003600000</span>
<span style="color:#ae81ff">070090200</span>
<span style="color:#ae81ff">050007000</span>
<span style="color:#ae81ff">000045700</span>
<span style="color:#ae81ff">000100030</span>
<span style="color:#ae81ff">001000068</span>
<span style="color:#ae81ff">008500010</span>
<span style="color:#ae81ff">090000400</span>

hardest: 2.034s

output:
<span style="color:#ae81ff">812753649</span>
<span style="color:#ae81ff">943682175</span>
<span style="color:#ae81ff">675491283</span>
<span style="color:#ae81ff">154237896</span>
<span style="color:#ae81ff">369845721</span>
<span style="color:#ae81ff">287169534</span>
<span style="color:#ae81ff">521974368</span>
<span style="color:#ae81ff">438526917</span>
<span style="color:#ae81ff">796318452</span>
</code></pre></div><p>Fun! And quick too. At least quick enough for what I&rsquo;m looking for.</p>
<p>Next up, I want to implement duplicate detection so that our solver doesn&rsquo;t get into infinite loops. This doesn&rsquo;t happen in Sudoku (since we&rsquo;re always adding elements, never removing them; other than backtacking). But in Chess for example, we could get in a state where we move the King back and forth indefiniately, which I want to avoid.</p>
<p>And then&hellip; actual puzzle solvers!</p>
<p>Onward!</p></div>
</article></div>
        </div><footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li><li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li></ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>
</div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js" integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js" integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin="anonymous"></script>

<script src="/custom.js"></script>
</body>
</html>
