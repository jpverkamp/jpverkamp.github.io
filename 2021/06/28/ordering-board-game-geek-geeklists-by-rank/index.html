<!DOCTYPE html>
<html onclick >
<head>
    <title>Ordering Board Game Geek GeekLists by Rank â€“ jverkamp.com</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8"><link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css" integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" />

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper"><header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a> *
            <a href="/resume">Resume</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>
    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation"><li><a href="https://blog.jverkamp.com/programming/">Programming</a></li><li><a href="https://blog.jverkamp.com/photography/">Photography</a></li><li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li><li><a href="https://blog.jverkamp.com/maker/">Maker</a></li><li><a href="https://blog.jverkamp.com/writing/">Writing</a></li><li><a href="https://blog.jverkamp.com/research/">Research</a></li><li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>
<div id="page-content-wrapper">
            <div id="page-content"><article>
	<header>
		<h1 class="entry-title">Ordering Board Game Geek GeekLists by Rank</h1>

        <div class="entry-meta"><span class="entry-date">2021-06-28</span>
            </div>

        <div class="entry-taxonomies"><div class="entry-tags"><ul class="taxonomy-keys"><li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2021/06/24/categorizing-r/fantasy-book-bingo-books/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/python">Python</a><a href="https://blog.jverkamp.com/2021/08/10/splitting-images/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/sources/">Sources</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2021/06/26/generating-a-book-bingo-chart-in-hugo/" class="previous-link"></a><a class="taxonomy-value" href="/programming/sources/apis">APIs</a></li><li><a class="taxonomy-value" href="/programming/sources/board-game-arena">Board Game Arena</a></li><li><a class="taxonomy-value" href="/programming/sources/board-game-geek">Board Game Geek</a></li><li><a class="taxonomy-value" href="/programming/sources/board-games">Board Games</a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/topics/">Topics</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2021/06/25/a-generic-brute-force-backtracking-solver/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/small-scripts">Small Scripts</a><a href="https://blog.jverkamp.com/2021/08/17/immutable.js-solvers/" class="next-link"></a></li></ul>
        </li><li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2021/06/26/generating-a-book-bingo-chart-in-hugo/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2021/07/15/crosslinks-by-title-in-hugo/" class="next-link">Next</a></ul>
        </li><li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2021/06/27/the-sopranos-season-2/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2021/06/28/still-life/" class="next-link">Next</a></ul>
        </li></ul>
</div>
</div>
    </header>

	<div class="entry-content"><p>A quick script.</p>
<p>I play a lot of board games. With the whole COVID-19 mess, I&rsquo;ve been playing a lot on <a href="https://boardgamearena.com/">Board Game Arena</a>, which is a wonderful site. But one thing that&rsquo;s a bit lacking is having ratings / metadata about games to great games I&rsquo;ve just not heard about before. Where can you get lots of that data? <a href="https://boardgamegeek.com/">Board Game Geek</a>!</p>
<p>The problem though, is merging the two. So, how do we do it? Well, this time around, I&rsquo;m going to start with <a href="https://boardgamegeek.com/geeklist/252354/list-games-board-game-arena">this GeekList</a> that someone else maintains of BGA games on BGG. Which has the games, but no ranks. And apparently there are no ways to rank those by BGG (for some reason). But that&rsquo;s easy when you know a bit of scripting!</p>
<p>Relevant BGG APIs (yes, I know there&rsquo;s a version 2):</p>
<ul>
<li><a href="https://boardgamegeek.com/wiki/page/BGG_XML_API&amp;redirectedfrom=XML_API#toc7">/xmlapi/geeklist/:id</a> - retrieve information about a GeekList</li>
<li><a href="https://boardgamegeek.com/wiki/page/BGG_XML_API&amp;redirectedfrom=XML_API#toc4">/xmlapi/boardgame/:id?stats=1</a> - without <code>stats=1</code>, you get lots of game information, but not the rankings</li>
</ul>
<p>From there, I&rsquo;m going to use some Python (it&rsquo;s what I know best), with <a href="https://docs.python-requests.org/en/master/">requests</a> for fetching from the API and <a href="https://docs.python.org/3/library/xml.etree.elementtree.html">xml.etree</a> for XML parsing. I swear there should be a more elegant way for the latter, but again, it works.</p>
<p>Plug everything together and:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> sys

<span style="color:#f92672">from</span> xml.etree <span style="color:#f92672">import</span> ElementTree <span style="color:#66d9ef">as</span> et

rankings <span style="color:#f92672">=</span> {}

<span style="color:#66d9ef">for</span> list <span style="color:#f92672">in</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>:]:
    response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(f<span style="color:#e6db74">&#39;https://www.boardgamegeek.com/xmlapi/geeklist/{list}&#39;</span>)
    xml <span style="color:#f92672">=</span> et<span style="color:#f92672">.</span>fromstring(response<span style="color:#f92672">.</span>text)
    <span style="color:#66d9ef">for</span> item_el <span style="color:#f92672">in</span> xml<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">&#39;item&#39;</span>):
        game_id <span style="color:#f92672">=</span> item_el<span style="color:#f92672">.</span>attrib[<span style="color:#e6db74">&#39;objectid&#39;</span>]
        game_name <span style="color:#f92672">=</span> item_el<span style="color:#f92672">.</span>attrib[<span style="color:#e6db74">&#39;objectname&#39;</span>]
        sys<span style="color:#f92672">.</span>stderr<span style="color:#f92672">.</span>write(f<span style="color:#e6db74">&#39;Loading {game_name} ({game_id})</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)

        game_response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(f<span style="color:#e6db74">&#39;https://www.boardgamegeek.com/xmlapi/boardgame/{game_id}?stats=1&#39;</span>)
        game_xml <span style="color:#f92672">=</span> et<span style="color:#f92672">.</span>fromstring(game_response<span style="color:#f92672">.</span>text)

        <span style="color:#66d9ef">for</span> rank_el <span style="color:#f92672">in</span> game_xml<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">&#39;.//rank&#39;</span>):
            <span style="color:#66d9ef">try</span>:
                rank_name <span style="color:#f92672">=</span> rank_el<span style="color:#f92672">.</span>attrib[<span style="color:#e6db74">&#39;friendlyname&#39;</span>]
                rank_value <span style="color:#f92672">=</span> int(rank_el<span style="color:#f92672">.</span>attrib[<span style="color:#e6db74">&#39;value&#39;</span>])
            <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ValueError</span>:
                <span style="color:#66d9ef">continue</span>

            <span style="color:#66d9ef">if</span> rank_name <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> rankings:
                rankings[rank_name] <span style="color:#f92672">=</span> []

            rankings[rank_name]<span style="color:#f92672">.</span>append((rank_value, game_name))

<span style="color:#66d9ef">for</span> ranking, games <span style="color:#f92672">in</span> rankings<span style="color:#f92672">.</span>items():
    <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;===== {ranking} =====&#39;</span>)
    <span style="color:#66d9ef">for</span> i, (score, game) <span style="color:#f92672">in</span> enumerate(sorted(games), <span style="color:#ae81ff">1</span>):
        <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;{i: &lt;5} {score: &lt;5} {game}&#39;</span>)
    <span style="color:#66d9ef">print</span>()
</code></pre></div><p>In summary:</p>
<ul>
<li>Fetch the geek list</li>
<li>Iterate through <code>item</code> elements (these contain the items in the list)
<ul>
<li>For each, get the <code>objectid</code> (which is a game)</li>
<li>Fetch that game, including <code>stats=1</code></li>
<li>For each list the game is on (overall, best strategy etc), store the ranking information</li>
</ul>
</li>
<li>Sort and print the information we collected</li>
</ul>
<p>The first column is just numbering, the second is BGG rank overall within that category (so Through The Ages: A New Story of Civilization is the 8th highest ranked game on BGG as of now), and the last is the name.</p>
<p>It&rsquo;s pretty nice:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">===== Board Game Rank =====
1     8     Through the Ages: A New Story of Civilization
2     16    Terra Mystica
3     17    7 Wonders Duel
4     28    Puerto Rico
5     39    The Crew: The Quest for Planet Nine
6     41    Tzolk&#39;in: The Mayan Calendar
7     49    Clans of Caledonia
8     54    Through the Ages: A Story of Civilization
9     63    The Voyages of Marco Polo
10    65    Race for the Galaxy
...

===== Family Game Rank =====
1     3     The Crew: The Quest for Planet Nine
2     4     Lost Ruins of Arnak
3     9     7 Wonders
4     16    Stone Age
5     17    Welcome To...
6     22    Jaipur
7     29    Santorini
8     35    Carcassonne
9     39    Kingdomino
10    43    Nidavellir
...

===== Strategy Game Rank =====
1     8     Through the Ages: A New Story of Civilization
2     15    Terra Mystica
3     18    7 Wonders Duel
4     27    Puerto Rico
5     39    The Crew: The Quest for Planet Nine
6     41    Clans of Caledonia
7     42    Tzolk&#39;in: The Mayan Calendar
8     47    Through the Ages: A Story of Civilization
9     50    Lost Ruins of Arnak
10    52    Teotihuacan: City of Gods
...

===== Abstract Game Rank =====
1     11    Santorini
2     13    Go
3     16    Hive
4     25    Taluva
5     29    Dragon Castle
6     35    Medina (Second Edition)
7     39    Tash-Kalar: Arena of Legends
8     46    Chess
9     51    Cribbage
10    52    Xiangqi
...

===== Party Game Rank =====
1     25    Skull
2     45    Coup
3     52    Perudo
4     56    Concept
5     75    Oriflamme
6     93    The Werewolves of Miller&#39;s Hollow
7     117   Saboteur
8     478   Scum: The Food Chain Game
9     572   Fluxx

===== Customizable Rank =====
1     73    Krosmaster: Arena

===== Thematic Rank =====
1     63    Dungeon Petz
2     173   K2
3     227   Rallyman: GT
4     303   Room 25
5     531   NOIR: Deductive Mystery Game
6     576   Penny Press

===== War Game Rank =====
1     25    Unconditional Surrender! World War 2 in Europe
2     65    Polis: Fight for the Hegemony

===== Children&#39;s Game Rank =====
1     132   Monster Factory
2     811   Connect Four
3     831   Battleship
</code></pre></div><p>I&rsquo;ve played quite a few of these (and most of them were great!) but there are all sorts of ones I didn&rsquo;t even know were on BGA. All the games!</p>
<p>Next, I want to write something to scrape BGA (they don&rsquo;t have an official API, but that&rsquo;s workaroundable) and combine both data sets into something even better. The joys of scripting things.</p></div>
</article></div>
        </div><footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li><li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li></ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>
</div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js" integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js" integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin="anonymous"></script>

<script src="/custom.js"></script>
</body>
</html>
