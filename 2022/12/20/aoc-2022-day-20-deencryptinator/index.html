<!doctype html><html><head><title>AoC 2022 Day 20: Deencryptinator â€“ jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_17422284542669262002.min.834c1e2313951f0c25b90152fe8b62250eab4a2e8cbd2560fa1a1cdc91c71733.js integrity="sha256-g0weIxOVHwwluQFS/otiJQ6rSi6MvSVg+hoc3JHHFzM=" defer></script><script src=/jquery.fancybox_16245765822111608191.min.a8e11addf4349ee2ca5045f7f3cbf1febbf2c3a2840be2143ea69539c10f8c7f.js integrity="sha256-qOEa3fQ0nuLKUEX388vx/rvyw6KEC+IUPqaVOcEPjH8=" defer></script><script src=/katex_17296078054267651618.min.4a06464d8d6f8358d8896de62b53b5a89205d335dfd8c5b6b27edd7c039ae9d8.js integrity="sha256-SgZGTY1vg1jYiW3mK1O1qJIF0zXf2MW2sn7dfAOa6dg=" defer></script><script src=/auto-render_14944144240389301023.min.e694d9d5eae2917984179683ead27b998784a81398e8836c369373d2c67fc32a.js integrity="sha256-5pTZ1erikXmEF5aD6tJ7mYeEqBOY6INsNpNz0sZ/wyo=" defer></script><script src=/bigfoot_28293813221957978.min.af671f08986f0a2267c5a0cb2748b005489e47fa25f55479b200e2a563d23022.js integrity="sha256-r2cfCJhvCiJnxaDLJ0iwBUieR/ol9VR5sgDipWPSMCI=" defer></script><script src=/mermaid_9520146763733687737.min.a17078917a4403310cd19178939257b706fb5e1da76167c9f4a6d2123c9d59c4.js integrity="sha256-oXB4kXpEAzEM0ZF4k5JXtwb7Xh2nYWfJ9KbSEjydWcQ=" defer></script><script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script><link rel=stylesheet href=/katex_13658330645258633971.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_8781527669040159104.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_5330465509389191777.min.7420a1602c62a85d4b50881c1d8ce42f72c049dc2b097d440696425d6e54bb1e.css integrity="sha256-dCChYCxiqF1LUIgcHYzkL3LASdwrCX1EBpZCXW5Uux4="><link rel=stylesheet href=/css_1846377409604050217.min.fffe842bc000dd1fe8661ac6427a392a08faa95e8edab1ea7fb98c5f8dac6a6f.css integrity="sha256-//6EK8AA3R/oZhrGQno5Kgj6qV6O2rHqf7mMX42sam8="><link rel=stylesheet href=/main.min.5ff4b87c40715a96119d8b5f34d971604fc65ab18f4870fd8da6ede9fd1e6188.css integrity="sha256-X/S4fEBxWpYRnYtfNNlxYE/GWrGPSHD9jabt6f0eYYg="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/home-automation/>Automation</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>AoC 2022 Day 20: Deencryptinator</h1><div class=entry-meta><span class=entry-date>2022-12-20</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2022/12/19/aoc-2022-day-19-blueprintinator/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/rust>Rust</a><a href=https://blog.jverkamp.com/2022/12/21/aoc-2022-day-21-yellinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2022/12/19/aoc-2022-day-19-blueprintinator/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/advent-of-code>Advent of Code</a><a href=https://blog.jverkamp.com/2022/12/21/aoc-2022-day-21-yellinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a class=taxonomy-value href=/programming/topics/ciphers>Ciphers</a></li><li><a href=https://blog.jverkamp.com/2020/04/09/command-line-aes-with-openssl-and-tar/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/encryption>Encryption</a></li><li><a href=https://blog.jverkamp.com/2022/12/17/aoc-2022-day-17-tetrisinator/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/modular-arithmetic>Modular Arithmetic</a></li></ul></li><li><a class=taxonomy-key href=/series/>Series</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2022/12/19/aoc-2022-day-19-blueprintinator/ class=previous-link></a><a class=taxonomy-value href=/series/advent-of-code-2022>Advent of Code 2022</a><a href=https://blog.jverkamp.com/2022/12/21/aoc-2022-day-21-yellinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2022/12/19/aoc-2022-day-19-blueprintinator/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2022/12/21/aoc-2022-day-21-yellinator/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2022/12/20/alices-adventures-in-wonderland/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2022/12/21/aoc-2022-day-21-yellinator/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><h2 id=source-grove-positioning-system>Source: <a href=https://adventofcode.com/2022/day/20 target=_blank rel=noopener>Grove Positioning System</a></h2><h2 id=part-1>Part 1</h2><blockquote><p>Given a list of numbers <code>mix</code> them by moving each number forward/backward in the list based on it&rsquo;s value. For example, in <code>4, -2, 5, 6, 7, 8, 9</code> moving the <code>-2</code> will result in <code>4, 5, 6, 7, 8, -2, 9</code>. Each number should be moved exactly once in the <em>original order</em> they appeared in the list.</p></blockquote><p>That&rsquo;s a very strange description. Originally, I was planning to essentially create two level linked list (I have no idea if there&rsquo;s an &lsquo;official&rsquo; name for this). Each node would hold a number, the first linked list would iterate through the numbers in the original order (and never change) and the second level would iterate through the numbers in their current order (and change with each <code>mix</code>).</p><p>I still think that this would be the most &rsquo;elegant&rsquo; way to go about this from an algorithmic case, &mldr; but I just couldn&rsquo;t get the data structure to work out right in Rust. I may have to come back to this one yet.</p><p>So instead we have:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>INumber</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>i128</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#[derive(Clone, Debug)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Message</span> {
</span></span><span style=display:flex><span>    data: Vec<span style=color:#f92672>&lt;</span>(<span style=color:#66d9ef>usize</span>, INumber)<span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>impl</span><span style=color:#f92672>&lt;</span>I<span style=color:#f92672>&gt;</span> From<span style=color:#f92672>&lt;&amp;</span><span style=color:#66d9ef>mut</span> I<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>for</span> Message
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span>
</span></span><span style=display:flex><span>    I: Iterator<span style=color:#f92672>&lt;</span>Item <span style=color:#f92672>=</span> String<span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>from</span>(iter: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>mut</span> I) -&gt; <span style=color:#a6e22e>Self</span> {
</span></span><span style=display:flex><span>        Message {
</span></span><span style=display:flex><span>            data: <span style=color:#a6e22e>iter</span>
</span></span><span style=display:flex><span>                .map(<span style=color:#f92672>|</span>line<span style=color:#f92672>|</span> line.parse::<span style=color:#f92672>&lt;</span>INumber<span style=color:#f92672>&gt;</span>().expect(<span style=color:#e6db74>&#34;must be a number&#34;</span>))
</span></span><span style=display:flex><span>                .enumerate()
</span></span><span style=display:flex><span>                .collect::<span style=color:#f92672>&lt;</span>Vec<span style=color:#f92672>&lt;</span>_<span style=color:#f92672>&gt;&gt;</span>(),
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>I&rsquo;ll come back to why I made <code>INumber</code>. Hint: really really big numbers.</p><p>In a nutshell, the data is stored as tuples of <code>(original index, value)</code>. That way when the order is scrambled, I can still come through and figure out where the number with the next <code>original_index</code> is now.</p><p>After that, we have the mixing function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>impl</span> Message {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>mix</span>(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> self, index_to_move: <span style=color:#66d9ef>usize</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> (index_current, (_, value)) <span style=color:#f92672>=</span> self
</span></span><span style=display:flex><span>            .data
</span></span><span style=display:flex><span>            .iter()
</span></span><span style=display:flex><span>            .enumerate()
</span></span><span style=display:flex><span>            .find(<span style=color:#f92672>|</span>(_, (index_original, _))<span style=color:#f92672>|</span> index_to_move <span style=color:#f92672>==</span> <span style=color:#f92672>*</span>index_original)
</span></span><span style=display:flex><span>            .unwrap();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> index_target <span style=color:#f92672>=</span> index_current <span style=color:#66d9ef>as</span> INumber <span style=color:#f92672>+</span> value;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> ilen <span style=color:#f92672>=</span> self.data.len() <span style=color:#66d9ef>as</span> INumber;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// If the index is negative, increase it into range
</span></span></span><span style=display:flex><span>        <span style=color:#75715e>// We can&#39;t jump directly there because we&#39;ll overflow even i128, so jump in decreasing steps
</span></span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> index_target <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>            index_target <span style=color:#f92672>+=</span> ilen <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> index_target <span style=color:#f92672>&gt;=</span> ilen {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> loops <span style=color:#f92672>=</span> index_target <span style=color:#f92672>/</span> ilen;
</span></span><span style=display:flex><span>            index_target <span style=color:#f92672>=</span> index_target <span style=color:#f92672>-</span> loops <span style=color:#f92672>*</span> ilen <span style=color:#f92672>+</span> loops;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// If we were jumping downwards and ended up at 0, we actually want it at the end
</span></span></span><span style=display:flex><span>        <span style=color:#75715e>// Most to match the given test case, this doesn&#39;t matter for the real answers
</span></span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> index_target <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>*</span>value <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>            index_target <span style=color:#f92672>=</span> ilen <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> index_target <span style=color:#f92672>=</span> index_target <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>usize</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> removed <span style=color:#f92672>=</span> self.data.remove(index_current);
</span></span><span style=display:flex><span>        self.data.insert(index_target, removed);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>len</span>(<span style=color:#f92672>&amp;</span>self) -&gt; <span style=color:#66d9ef>usize</span> {
</span></span><span style=display:flex><span>        self.data.len()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[allow(dead_code)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>data</span>(<span style=color:#f92672>&amp;</span>self) -&gt; Vec<span style=color:#f92672>&lt;</span>INumber<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>        self.data.iter().map(<span style=color:#f92672>|</span>(_, v)<span style=color:#f92672>|</span> <span style=color:#f92672>*</span>v).collect::<span style=color:#f92672>&lt;</span>Vec<span style=color:#f92672>&lt;</span>_<span style=color:#f92672>&gt;&gt;</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>One thing that I really wanted to do was to use <a href=https://en.wikipedia.org/wiki/modular%20arithmetic>modular arithmetic</a>, but alas. The behavior on negative numbers (returning a negative number) is not what I actually want. I could have just added one more size (which is something I just thought of now), but this works as well enough.</p><p>As I did mention, the finding the <code>index_current</code> (which is the currently shuffled index) that matches the <code>index_to_move</code> is the first trick. After that, we don&rsquo;t care about the index.</p><p>The other gotcha is that while the number is moving, the list is one element shorter. That one bit me a bit.</p><p>With that, we decrypt my moving each number in turn:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>impl</span> Message {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>decrypt</span>(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> self) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> index_to_move <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>self.len() {
</span></span><span style=display:flex><span>            self.mix(index_to_move);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And then finally to get the input we actually want, we need the 1000th, 2000th, and 3000th elements <em>after the current position of the element with value 0</em>. (Took me a bit to notice that bit of the instructions):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>part1</span>(filename: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>Path</span>) -&gt; String {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> Message::from(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> iter_lines(filename));
</span></span><span style=display:flex><span>    message.decrypt();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> index_zero <span style=color:#f92672>=</span> message
</span></span><span style=display:flex><span>        .data
</span></span><span style=display:flex><span>        .iter()
</span></span><span style=display:flex><span>        .enumerate()
</span></span><span style=display:flex><span>        .find(<span style=color:#f92672>|</span>(_, (_, v))<span style=color:#f92672>|</span> <span style=color:#f92672>*</span>v <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>        .unwrap()
</span></span><span style=display:flex><span>        .<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (message.data[(index_zero <span style=color:#f92672>+</span> <span style=color:#ae81ff>1000</span>) <span style=color:#f92672>%</span> message.len()].<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>+</span> message.data[(index_zero <span style=color:#f92672>+</span> <span style=color:#ae81ff>2000</span>) <span style=color:#f92672>%</span> message.len()].<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>+</span> message.data[(index_zero <span style=color:#f92672>+</span> <span style=color:#ae81ff>3000</span>) <span style=color:#f92672>%</span> message.len()].<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        .to_string()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Sweet.</p><h2 id=part-2>Part 2</h2><blockquote><p>Multiply every value by 811589153 and then mix the list 10 times (still using the original order).</p></blockquote><p>Theoretically, the original code would have worked great for this, but not using modular arithmetic is biting me now. It&rsquo;s much slower to loop. And then once I solved that, I ran into another big issue: <code>integer overflow</code>. The <code>i128</code> solved the latter, but for the former I ended up doing something&mldr; a bit strange:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>impl</span> Message {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>mix</span>(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> self, index_to_move: <span style=color:#66d9ef>usize</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> (index_current, (_, value)) <span style=color:#f92672>=</span> self
</span></span><span style=display:flex><span>            .data
</span></span><span style=display:flex><span>            .iter()
</span></span><span style=display:flex><span>            .enumerate()
</span></span><span style=display:flex><span>            .find(<span style=color:#f92672>|</span>(_, (index_original, _))<span style=color:#f92672>|</span> index_to_move <span style=color:#f92672>==</span> <span style=color:#f92672>*</span>index_original)
</span></span><span style=display:flex><span>            .unwrap();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> index_target <span style=color:#f92672>=</span> index_current <span style=color:#66d9ef>as</span> INumber <span style=color:#f92672>+</span> value;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> ilen <span style=color:#f92672>=</span> self.data.len() <span style=color:#66d9ef>as</span> INumber;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// If the index is negative, increase it into range
</span></span></span><span style=display:flex><span>        <span style=color:#75715e>// We can&#39;t jump directly there because we&#39;ll overflow even i128, so jump in decreasing steps
</span></span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> steps <span style=color:#f92672>=</span> <span style=color:#ae81ff>100000000</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> steps <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> index_target <span style=color:#f92672>&lt;</span> <span style=color:#f92672>-</span>steps <span style=color:#f92672>*</span> ilen {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> loops <span style=color:#f92672>=</span> (<span style=color:#f92672>-</span>index_target <span style=color:#f92672>/</span> ilen).min(steps);
</span></span><span style=display:flex><span>                index_target <span style=color:#f92672>+=</span> loops <span style=color:#f92672>*</span> ilen <span style=color:#f92672>-</span> loops;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            steps <span style=color:#f92672>/=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> index_target <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>            index_target <span style=color:#f92672>+=</span> ilen <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Do the same if the index is too big, resetting steps
</span></span></span><span style=display:flex><span>        steps <span style=color:#f92672>=</span> <span style=color:#ae81ff>10000000</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> steps <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> index_target <span style=color:#f92672>&gt;=</span> steps <span style=color:#f92672>*</span> ilen {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> loops <span style=color:#f92672>=</span> (index_target <span style=color:#f92672>/</span> ilen).min(steps);
</span></span><span style=display:flex><span>                index_target <span style=color:#f92672>=</span> index_target <span style=color:#f92672>-</span> loops <span style=color:#f92672>*</span> ilen <span style=color:#f92672>+</span> loops;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            steps <span style=color:#f92672>/=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> index_target <span style=color:#f92672>&gt;=</span> ilen {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> loops <span style=color:#f92672>=</span> index_target <span style=color:#f92672>/</span> ilen;
</span></span><span style=display:flex><span>            index_target <span style=color:#f92672>=</span> index_target <span style=color:#f92672>-</span> loops <span style=color:#f92672>*</span> ilen <span style=color:#f92672>+</span> loops;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// If we were jumping downwards and ended up at 0, we actually want it at the end
</span></span></span><span style=display:flex><span>        <span style=color:#75715e>// Most to match the given test case, this doesn&#39;t matter for the real answers
</span></span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> index_target <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>*</span>value <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>            index_target <span style=color:#f92672>=</span> ilen <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> index_target <span style=color:#f92672>=</span> index_target <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>usize</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>cfg!</span>(debug_assertions) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>println!</span>(
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74> [moving, orig: </span><span style=color:#e6db74>{:2}</span><span style=color:#e6db74>, value: </span><span style=color:#e6db74>{:2}</span><span style=color:#e6db74>, curr: </span><span style=color:#e6db74>{:2}</span><span style=color:#e6db74>, next: </span><span style=color:#e6db74>{:2}</span><span style=color:#e6db74>]&#34;</span>,
</span></span><span style=display:flex><span>                self, index_to_move, value, index_current, index_target,
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> removed <span style=color:#f92672>=</span> self.data.remove(index_current);
</span></span><span style=display:flex><span>        self.data.insert(index_target, removed);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>len</span>(<span style=color:#f92672>&amp;</span>self) -&gt; <span style=color:#66d9ef>usize</span> {
</span></span><span style=display:flex><span>        self.data.len()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[allow(dead_code)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>data</span>(<span style=color:#f92672>&amp;</span>self) -&gt; Vec<span style=color:#f92672>&lt;</span>INumber<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>        self.data.iter().map(<span style=color:#f92672>|</span>(_, v)<span style=color:#f92672>|</span> <span style=color:#f92672>*</span>v).collect::<span style=color:#f92672>&lt;</span>Vec<span style=color:#f92672>&lt;</span>_<span style=color:#f92672>&gt;&gt;</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Essentially, I start by jumping <code>10,000,000</code> times the length of the list towards the proper value. Then <code>1,000,000</code> and stepping down as I pass each value. This is weird&mldr; but it works? And it works pretty fast.</p><p>The new wrapper becomes:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>part2</span>(filename: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>Path</span>) -&gt; String {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> Message::from(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> iter_lines(filename));
</span></span><span style=display:flex><span>    message.data.iter_mut().for_each(<span style=color:#f92672>|</span>p<span style=color:#f92672>|</span> p.<span style=color:#ae81ff>1</span> <span style=color:#f92672>*=</span> <span style=color:#ae81ff>811589153</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> _round <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>..</span><span style=color:#ae81ff>10</span> {
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> index_zero <span style=color:#f92672>=</span> message
</span></span><span style=display:flex><span>        .data
</span></span><span style=display:flex><span>        .iter()
</span></span><span style=display:flex><span>        .enumerate()
</span></span><span style=display:flex><span>        .find(<span style=color:#f92672>|</span>(_, (_, v))<span style=color:#f92672>|</span> <span style=color:#f92672>*</span>v <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>        .unwrap()
</span></span><span style=display:flex><span>        .<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (message.data[(index_zero <span style=color:#f92672>+</span> <span style=color:#ae81ff>1000</span>) <span style=color:#f92672>%</span> message.len()].<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>+</span> message.data[(index_zero <span style=color:#f92672>+</span> <span style=color:#ae81ff>2000</span>) <span style=color:#f92672>%</span> message.len()].<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>+</span> message.data[(index_zero <span style=color:#f92672>+</span> <span style=color:#ae81ff>3000</span>) <span style=color:#f92672>%</span> message.len()].<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        .to_string()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>I like that we can just <code>iter_mut</code> over the data and then loop the <code>decrypt</code> function. Pretty shiny.</p><h2 id=unit-testing>Unit testing</h2><p>Something I really should have been doing throughout these problems that came to a head during this problem: <a href=https://en.wikipedia.org/wiki/unit%20testing>unit testing</a>. I have always been testing my two answers (to make sure it stays stable), but for this one, the <code>mix</code> function just has so many edge cases&mldr; So to make sure that each fix kept working for later cases:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>#[cfg(test)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>mod</span> tests {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>use</span> <span style=color:#66d9ef>crate</span>::{part1, part2, Message};
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>use</span> aoc::aoc_test;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>make_test</span>() -&gt; <span style=color:#a6e22e>Message</span> {
</span></span><span style=display:flex><span>        Message {
</span></span><span style=display:flex><span>            data: <span style=color:#a6e22e>vec</span><span style=color:#f92672>!</span>[(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>), (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>), (<span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>), (<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>), (<span style=color:#ae81ff>4</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>), (<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>), (<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>4</span>)],
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>make_zeroes</span>(size: <span style=color:#66d9ef>usize</span>) -&gt; <span style=color:#a6e22e>Message</span> {
</span></span><span style=display:flex><span>        Message {
</span></span><span style=display:flex><span>            data: (<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>size).map(<span style=color:#f92672>|</span>v<span style=color:#f92672>|</span> (v, <span style=color:#ae81ff>0</span>)).collect::<span style=color:#f92672>&lt;</span>Vec<span style=color:#f92672>&lt;</span>_<span style=color:#f92672>&gt;&gt;</span>(),
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>make_singleton</span>(size: <span style=color:#66d9ef>usize</span>, index: <span style=color:#66d9ef>usize</span>, value: <span style=color:#a6e22e>crate</span>::INumber) -&gt; <span style=color:#a6e22e>Message</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_zeroes(size);
</span></span><span style=display:flex><span>        message.data[index].<span style=color:#ae81ff>1</span> <span style=color:#f92672>=</span> value;
</span></span><span style=display:flex><span>        message
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_mix</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_test();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        message.mix(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        message.mix(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        message.mix(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        message.mix(<span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        message.mix(<span style=color:#ae81ff>4</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        message.mix(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        message.mix(<span style=color:#ae81ff>6</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_decrypt</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_test();
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_zeros</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_zeroes(<span style=color:#ae81ff>9</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_singleton</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_small_forward</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_looped_forward</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_double_looped_forward</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>14</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>14</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_small_backward</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_exact_loop_backward</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_looped_backward</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>4</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>4</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>8</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test_double_looped_backward</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> message <span style=color:#f92672>=</span> make_singleton(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>14</span>);
</span></span><span style=display:flex><span>        message.decrypt();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assert_eq!</span>(message.data(), <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>14</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test1</span>() {
</span></span><span style=display:flex><span>        aoc_test(<span style=color:#e6db74>&#34;20&#34;</span>, part1, <span style=color:#e6db74>&#34;19070&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[test]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>test2</span>() {
</span></span><span style=display:flex><span>        aoc_test(<span style=color:#e6db74>&#34;20&#34;</span>, part2, <span style=color:#e6db74>&#34;14773357352059&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>I test not mixing, mixing forward and backwards, and each of those looping once or more than once. Each case does slightly different things. I also had a few edge cases (literally) where a number could be either the first or last element in the list, which didn&rsquo;t matter for the actual problem statement (since it&rsquo;s a looped list) but for the purposes of my tests, i wanted to match the examples given.</p><p>It&rsquo;s a decent enough way to write the tests and easy to run!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cargo test --release --bin 20-deencryptinator
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Compiling aoc2022 v0.1.0 <span style=color:#f92672>(</span>/Users/jp/Projects/advent-of-code/2022<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    Finished release <span style=color:#f92672>[</span>optimized<span style=color:#f92672>]</span> target<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> in 0.45s
</span></span><span style=display:flex><span>     Running unittests src/bin/20-deencryptinator.rs <span style=color:#f92672>(</span>target/release/deps/20_deencryptinator-008079e4e2c7fe78<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>running <span style=color:#ae81ff>13</span> tests
</span></span><span style=display:flex><span>test tests::test_double_looped_backward ... ok
</span></span><span style=display:flex><span>test tests::test_decrypt ... ok
</span></span><span style=display:flex><span>test tests::test_exact_loop_backward ... ok
</span></span><span style=display:flex><span>test tests::test_double_looped_forward ... ok
</span></span><span style=display:flex><span>test tests::test_looped_backward ... ok
</span></span><span style=display:flex><span>test tests::test_looped_forward ... ok
</span></span><span style=display:flex><span>test tests::test_mix ... ok
</span></span><span style=display:flex><span>test tests::test_singleton ... ok
</span></span><span style=display:flex><span>test tests::test_small_backward ... ok
</span></span><span style=display:flex><span>test tests::test_small_forward ... ok
</span></span><span style=display:flex><span>test tests::test_zeros ... ok
</span></span><span style=display:flex><span>test tests::test1 ... ok
</span></span><span style=display:flex><span>test tests::test2 ... ok
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>test result: ok. <span style=color:#ae81ff>13</span> passed; <span style=color:#ae81ff>0</span> failed; <span style=color:#ae81ff>0</span> ignored; <span style=color:#ae81ff>0</span> measured; <span style=color:#ae81ff>0</span> filtered out; finished in 0.21s
</span></span></code></pre></div><p>I did run it in <code>--release</code> mode, mostly because the final test cases are much faster that way &#x1f604;</p><h2 id=performance>Performance</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./target/release/20-deencryptinator <span style=color:#ae81ff>1</span> data/20.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>19070</span>
</span></span><span style=display:flex><span>took 32.35ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ ./target/release/20-deencryptinator <span style=color:#ae81ff>2</span> data/20.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>14773357352059</span>
</span></span><span style=display:flex><span>took 203.954833ms
</span></span></code></pre></div><p>Acceptable. Especially after yesterday&mldr;</p></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>