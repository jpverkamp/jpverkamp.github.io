<!doctype html><html><head><title>Wombat IDE - Assorted bug fixes (Î»â€Ž mode fixed) â€“ jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_5823201688106629450.min.8c7d803d89ebdecf2416d468f4ecb981a3acf645154a7a336f2e5d0190ea8163.js integrity="sha256-jH2APYnr3s8kFtRo9Oy5gaOs9kUVSnozby5dAZDqgWM=" defer></script>
<script src=/jquery.fancybox_6181813213021922412.min.921ca906a32e718ab61ac0b4da24e0eaa6bdd41912654a33b44bd3fc2f0c2a4d.js integrity="sha256-khypBqMucYq2GsC02iTg6qa91BkSZUoztEvT/C8MKk0=" defer></script>
<script src=/katex_12008035502722260518.min.1c3dce03daaf56a7d2fe0d0ec49bf35256837226f835adaf52c09502ef9bc5d1.js integrity="sha256-HD3OA9qvVqfS/g0OxJvzUlaDcib4Na2vUsCVAu+bxdE=" defer></script>
<script src=/auto-render_2152414756166376840.min.45ae2f6b03d0c7b867df0a6cb7d43215ec78369998685a5748c5b12f502321f2.js integrity="sha256-Ra4vawPQx7hn3wpst9QyFex4NpmYaFpXSMWxL1AjIfI=" defer></script>
<script src=/bigfoot_8444447145154709333.min.5e80bd85ebaeb95607834d6777bfe7013d1d161f0f02a31b845e4bd765898316.js integrity="sha256-XoC9heuuuVYHg01nd7/nAT0dFh8PAqMbhF5L12WJgxY=" defer></script>
<script src=/mermaid_12365941879912544862.min.973b5415b3fa1835d620c0e58236f859d5f80891f447e240cbbb9eb825251ff0.js integrity="sha256-lztUFbP6GDXWIMDlgjb4WdX4CJH0R+JAy7ueuCUlH/A=" defer></script>
<script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script>
<link rel=stylesheet href=/katex_14163593549783030822.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_16482899066638414220.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_16222217791602823071.min.e28b5d7d9d89efacb5f708ac30cbd76b1b9a0f816dfd9da96631d1d09cbbdd76.css integrity="sha256-4otdfZ2J76y19wisMMvXaxuaD4Ft/Z2pZjHR0Jy73XY="><link rel=stylesheet href=/css_4780214198035419921.min.246b6f8e7620eeb717bca5e7b121037906e5dfaa05805f427fcc5a09b6c99f5c.css integrity="sha256-JGtvjnYg7rcXvKXnsSEDeQbl36oFgF9Cf8xaCbbJn1w="><link rel=stylesheet href=/main.min.d99288811f82c16d031e4f6c01e50e18aeccbb9968db7c625a21660aef059ef5.css integrity="sha256-2ZKIgR+CwW0DHk9sAeUOGK7Mu5lo23xiWiFmCu8FnvU="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>Wombat IDE - Assorted bug fixes (Î»â€Ž mode fixed)</h1><div class=entry-meta><span class=entry-date>2012-03-09</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2012/02/29/wombat-ide-updated-draw-image/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/java>Java</a><a href=https://blog.jverkamp.com/2012/03/22/wombat-ide-a-helping-hand-and-image-library-updates/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2012/02/29/wombat-ide-updated-draw-image/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/scheme>Scheme</a><a href=https://blog.jverkamp.com/2012/03/22/wombat-ide-a-helping-hand-and-image-library-updates/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/series/>Series</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2012/02/29/wombat-ide-updated-draw-image/ class=previous-link></a><a class=taxonomy-value href=/series/wombat-ide>Wombat IDE</a><a href=https://blog.jverkamp.com/2012/03/22/wombat-ide-a-helping-hand-and-image-library-updates/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2012/02/29/wombat-ide-updated-draw-image/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2012/03/22/wombat-ide-a-helping-hand-and-image-library-updates/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2012/03/07/light-painting/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2012/03/12/john-carter/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>A few minor bug fixes first:</p><ul><li>Fixed the cursor jumping to the end of the document on saves. This was being caused by the code that automatically trimmed whitespace, which will still change the file on disk but won&rsquo;t change the actual open document.</li><li>Apparently, there were some lingering issues with the undo/redo stack sometimes erasing the document. If this happens, you can always undo once more to get passed it, but I think I&rsquo;ve tracked down why it was happening. If it happens again, please let me know.</li><li>Fixed an error where closing documents through the InfoNode close event wouldn&rsquo;t actually remove them from memory.</li></ul><p>Also, theÂ Î» mode that I&rsquo;d talked about <a href=https://blog.jverkamp.com/2012/02/24/wombat-ide-%CE%BB-mode/>before</a> has been fixed. Previously, it would work just fine if you stayed in either mode, but apparently changing from one to another with more than oneÂ Î»/<code>lambda</code> in the document would break things.</p><p>Essentially, the code was calculating the position of all of the lambdas first and then replacing them. However, after the first, the shorterÂ Î» characters would through off the offset to the longer <code>lambda</code>, thus breaking the document.</p><p>Unfortunately, I don&rsquo;t actually write eitherÂ <code>lambda</code>s often myself, much preferring the shorter forms of <code>define</code> and named <code>let</code>s, only using <code>lambda</code> in anonymous functions passed to <code>map</code> or <code>filter</code>. So I didn&rsquo;t catch this as soon as I should have. So it goes. It&rsquo;s a good reason that I should probably work in some more automated testing to make sure that fixes don&rsquo;t break things. ðŸ˜„</p><p>An example, before changing to Î»Â mode:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>(<span style=color:#66d9ef>define </span>fact
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>lambda </span>(<span style=color:#a6e22e>n</span>)
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>if </span>(zero? n)
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        (* n (<span style=color:#a6e22e>fact</span> (- n <span style=color:#ae81ff>1</span>))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>tail-fact
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>lambda </span>(<span style=color:#a6e22e>n</span>)
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>define </span>^
</span></span><span style=display:flex><span>      (<span style=color:#66d9ef>lambda </span>(<span style=color:#a6e22e>n</span> a)
</span></span><span style=display:flex><span>        (<span style=color:#66d9ef>if </span>(zero? n)
</span></span><span style=display:flex><span>            a
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>^</span> (- n <span style=color:#ae81ff>1</span>) (* n <span style=color:#ae81ff>1</span>)))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>^</span> n <span style=color:#ae81ff>1</span>)))
</span></span></code></pre></div><p>After switching to <code>lambda</code> mode:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>(<span style=color:#66d9ef>define </span>fact
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>Î»</span> (<span style=color:#a6e22e>n</span>)
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>if </span>(zero? n)
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        (* n (<span style=color:#a6e22e>fact</span> (- n <span style=color:#ae81ff>1</span>))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>tail-fact
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>lambdÎ»</span>    (<span style=color:#66d9ef>define </span>^
</span></span><span style=display:flex><span>      (<span style=color:#66d9ef>lambda </span>(<span style=color:#a6e22e>n</span> a)
</span></span><span style=display:flex><span>        (<span style=color:#66d9ef>if </span>(zero? n)
</span></span><span style=display:flex><span>            a
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>^</span> (- n <span style=color:#ae81ff>1</span>) (* n <span style=color:#ae81ff>1</span>)))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>^</span> n <span style=color:#ae81ff>1</span>)))
</span></span></code></pre></div><p>Luckily, the fix was just a matter of slightly slower code that wouldn&rsquo;t find all the locations first but rather replaced each one in turn.</p><p>If you&rsquo;re curious why I didn&rsquo;t just do a find and replace on the text string, the issue is that&rsquo;s exactly what was causing the problems with the disappearing code that I mentioned in the second bullet above. Essentially, the undo/redo stack was seeing the document be cleared then the new code inserted on a <code>setText</code> call and this got saved to the undo/redo stack as two distinct elements. Unfortunate, but it really does make sense.</p><p>In any case, it&rsquo;s fixed now. Ah the joys of software development.</p></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>