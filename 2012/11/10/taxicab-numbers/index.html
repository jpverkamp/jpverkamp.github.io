<!doctype html><html><head><title>Taxicab numbers – jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_5823201688106629450.min.8c7d803d89ebdecf2416d468f4ecb981a3acf645154a7a336f2e5d0190ea8163.js integrity="sha256-jH2APYnr3s8kFtRo9Oy5gaOs9kUVSnozby5dAZDqgWM=" defer></script>
<script src=/jquery.fancybox_6181813213021922412.min.921ca906a32e718ab61ac0b4da24e0eaa6bdd41912654a33b44bd3fc2f0c2a4d.js integrity="sha256-khypBqMucYq2GsC02iTg6qa91BkSZUoztEvT/C8MKk0=" defer></script>
<script src=/katex_12008035502722260518.min.1c3dce03daaf56a7d2fe0d0ec49bf35256837226f835adaf52c09502ef9bc5d1.js integrity="sha256-HD3OA9qvVqfS/g0OxJvzUlaDcib4Na2vUsCVAu+bxdE=" defer></script>
<script src=/auto-render_2152414756166376840.min.45ae2f6b03d0c7b867df0a6cb7d43215ec78369998685a5748c5b12f502321f2.js integrity="sha256-Ra4vawPQx7hn3wpst9QyFex4NpmYaFpXSMWxL1AjIfI=" defer></script>
<script src=/bigfoot_8444447145154709333.min.5e80bd85ebaeb95607834d6777bfe7013d1d161f0f02a31b845e4bd765898316.js integrity="sha256-XoC9heuuuVYHg01nd7/nAT0dFh8PAqMbhF5L12WJgxY=" defer></script>
<script src=/mermaid_12365941879912544862.min.973b5415b3fa1835d620c0e58236f859d5f80891f447e240cbbb9eb825251ff0.js integrity="sha256-lztUFbP6GDXWIMDlgjb4WdX4CJH0R+JAy7ueuCUlH/A=" defer></script>
<script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script>
<link rel=stylesheet href=/katex_14163593549783030822.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_16482899066638414220.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_16222217791602823071.min.e28b5d7d9d89efacb5f708ac30cbd76b1b9a0f816dfd9da96631d1d09cbbdd76.css integrity="sha256-4otdfZ2J76y19wisMMvXaxuaD4Ft/Z2pZjHR0Jy73XY="><link rel=stylesheet href=/css_4780214198035419921.min.246b6f8e7620eeb717bca5e7b121037906e5dfaa05805f427fcc5a09b6c99f5c.css integrity="sha256-JGtvjnYg7rcXvKXnsSEDeQbl36oFgF9Cf8xaCbbJn1w="><link rel=stylesheet href=/main.min.d99288811f82c16d031e4f6c01e50e18aeccbb9968db7c625a21660aef059ef5.css integrity="sha256-2ZKIgR+CwW0DHk9sAeUOGK7Mu5lo23xiWiFmCu8FnvU="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>Taxicab numbers</h1><div class=entry-meta><span class=entry-date>2012-11-10</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2012/11/08/project-euler-5/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/racket>Racket</a><a href=https://blog.jverkamp.com/2012/11/11/project-euler-6/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2012/11/08/project-euler-5/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/scheme>Scheme</a><a href=https://blog.jverkamp.com/2012/11/11/project-euler-6/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2012/11/01/the-sum-of-the-first-billion-primes/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/programming-praxis>Programming Praxis</a><a href=https://blog.jverkamp.com/2012/11/21/list-algorithms-and-efficiency/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2012/11/08/project-euler-5/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2012/11/11/project-euler-6/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2012/11/10/confession-day-9/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2012/11/11/skyfall/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>Yesterday had another <a title="Taxicab Numbers" href=http://programmingpraxis.com/2012/11/09/taxicab-numbers/>programming puzzle</a> by Programming Praxis. This time, we are looking for a very special sort of number, a <a href=https://en.wikipedia.org/wiki/Taxicab%20number>Taxicab number</a>.  According to Wikipedia:</p><blockquote><p>In mathematics, the nth taxicab number, typically denoted Ta(n) or Taxicab(n), is defined as the smallest number that can be expressed as a sum of two positive algebraic cubes in n distinct ways.
&ndash; <cite><a href=https://en.wikipedia.org/wiki/Taxicab%20number>Wikipedia: Taxicab Number</a></cite></p></blockquote><p>In this particularly problem, we&rsquo;re looking to verify that Ta(2) = 1729, that is that 1729 is the smallest number that can be written as the sum of two pairs of cubes. Given in the original question, we already know that 1729 can at least be written as the sum of two pairs of cubes as the cubes are given (1<sup>3</sup> + 12<sup>3</sup> and 9<sup>3</sup> + 10<sup>3</sup>). But can we prove that it&rsquo;s the smallest such number?</p><p>First, let&rsquo;s start with a helper function that can be used to find all of the cube pairs of a number. Basically, we can brute force the problem by trying all possible values for the first number, subtracting and taking the cube root for the second. If it&rsquo;s an integer, return it.</p><p>Here&rsquo;s my first attempt:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; list all pairs a, b such that a^3 + b^3 = n</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>cube-pairs</span> n)  
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>for/list</span> ([i (<span style=color:#a6e22e>in-range</span> <span style=color:#ae81ff>1</span> n)]
</span></span><span style=display:flex><span>             <span style=color:#f92672>#</span>:when (integer? (expt (- n (expt i <span style=color:#ae81ff>3</span>)) <span style=color:#ae81ff>1</span>/3)))
</span></span><span style=display:flex><span>    (list i (expt (- n (expt i <span style=color:#ae81ff>3</span>)) <span style=color:#ae81ff>1</span>/3))))
</span></span></code></pre></div><p>And running it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (<span style=color:#a6e22e>cube-pairs</span> <span style=color:#ae81ff>1729</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&#39;</span>((<span style=color:#ae81ff>12</span> <span style=color:#ae81ff>1</span>))
</span></span></code></pre></div><p>Well, that&rsquo;s one pair. We were also expecting (9 10). So what happened? Well, let&rsquo;s look at the pieces of the <code>#:when</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (expt <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span><span style=color:#ae81ff>729</span>
</span></span><span style=display:flex><span>&gt; (- <span style=color:#ae81ff>1729</span> (expt <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>3</span>))
</span></span><span style=display:flex><span><span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>&gt; (expt (- <span style=color:#ae81ff>1729</span> (expt <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>3</span>)) <span style=color:#ae81ff>1</span>/3)
</span></span><span style=display:flex><span><span style=color:#ae81ff>9.999999999999998</span>
</span></span></code></pre></div><p>All good until we get to the last line. There, we&rsquo;re having a bit of a problem. It seems that the floating point calculations mean that the cube root isn&rsquo;t actually an integer any more, even though it should be. So how do we fix that?</p><p>Well, my first idea is to calculate that same number as before and then round it to the nearest integer. We can then multiple the expression back out to test if it&rsquo;s actually a valid cube pair. Something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; list all pairs a, b such that a^3 + b^3 = n</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>cube-pairs-2</span> n)  
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>j</span> i) (inexact-&gt;exact (round (expt (- n (expt i <span style=color:#ae81ff>3</span>)) <span style=color:#ae81ff>1</span>/3))))
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>for/list</span> ([i (<span style=color:#a6e22e>in-range</span> <span style=color:#ae81ff>1</span> (expt n <span style=color:#ae81ff>1</span>/3))]
</span></span><span style=display:flex><span>             <span style=color:#f92672>#</span>:when (<span style=color:#66d9ef>let </span>([j (<span style=color:#a6e22e>j</span> i)])
</span></span><span style=display:flex><span>                      (<span style=color:#66d9ef>and </span>(&lt; i j)
</span></span><span style=display:flex><span>                           (= (+ (* i i i) (* j j j)) n))))
</span></span><span style=display:flex><span>    (list i (<span style=color:#a6e22e>j</span> i))))
</span></span></code></pre></div><p>And testing it again:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (<span style=color:#a6e22e>cube-pairs2</span> <span style=color:#ae81ff>1729</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&#39;</span>((<span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span>) (<span style=color:#ae81ff>9</span> <span style=color:#ae81ff>10</span>))
</span></span></code></pre></div><p>Good to go. Granted, it&rsquo;s not exactly the best code, as we&rsquo;re recalculating the value of <code>(j i)</code>. I think that&rsquo;s a completely reasonable price to pay though, as we&rsquo;re only going to be doing the second calculation when we have a candidate answer. And that number is going to be dwarfed by the first comparison. So now something we have to worry about.</p><p>Moving on from there, the next step is to verify that Ta(2) = 1729 is actually true. For that to be the case, there cannot be a smaller number that has two cube pairs. So let&rsquo;s try that. Given n, find the first number that has n cube pairs:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; find the taxicab number for n</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; this is the number such that their exists a1...an and b1...bn such that</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; a1^3 + b1^3 = ... = an^3 + bn^3 = some number</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; for example, Ta(2) = 1729 = 1^3 + 12^3 = 9^3 + 10^3</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>taxicab</span> n)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>let </span>loop ([i <span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>if </span>(= n (length (<span style=color:#a6e22e>cube-pairs-3</span> i)))
</span></span><span style=display:flex><span>        (list i (<span style=color:#a6e22e>cube-pairs-3</span> i))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>loop</span> (+ i <span style=color:#ae81ff>1</span>)))))
</span></span></code></pre></div><p>Simple, straightforward, and to the point. I love code like that. Let&rsquo;s just make sure it works all quicklike:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (<span style=color:#a6e22e>taxicab</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>1729</span> ((<span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span>) (<span style=color:#ae81ff>9</span> <span style=color:#ae81ff>10</span>)))
</span></span></code></pre></div><p>And just for fun, let&rsquo;s check the next value:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (<span style=color:#a6e22e>taxicab</span> <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>87539319</span> ((<span style=color:#ae81ff>167</span> <span style=color:#ae81ff>436</span>) (<span style=color:#ae81ff>228</span> <span style=color:#ae81ff>423</span>) (<span style=color:#ae81ff>255</span> <span style=color:#ae81ff>414</span>)))
</span></span></code></pre></div><p>According to the answer on the <a href=https://en.wikipedia.org/wiki/Taxicab%20number>Wikipedia page</a>, we&rsquo;re good to go. That took a while to run, so I don&rsquo;t think that I&rsquo;ll try any higher (apparently only the first six values are even known, with Ta(6) = 24,153,319,581,254,312,065,344 (26 sextillion). So who knows how large Ta(7) is&mldr;</p><p>If you&rsquo;d like to download today&rsquo;s code, you can do so here: <a href=https://github.com/jpverkamp/small-projects/blob/master/blog/taxicab-numbers.rkt title="GitHub: jpverkamp: Taxicab numbers">taxicab numbers source</a></p></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>