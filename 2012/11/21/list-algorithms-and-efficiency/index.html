<!DOCTYPE html>
<html>
<head>
    <title>
    List algorithms and efficiency â€“ jverkamp.com
</title>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/css/themes/light/nanogallery_light.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css">

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />


    
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper">
        <header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://twitter.com/jpverkamp">Twitter</a> *
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>

    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
        
            
        
            
            <li><a href="https://blog.jverkamp.com/photography/">Photography</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/programming/">Programming</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/research/">Research</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/writing/">Writing</a></li>
            
        
            <li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>


        <div id="page-content-wrapper">
            <div id="page-content">
            
<article>
	<header>
		<h1 class="entry-title">List algorithms and efficiency</h1>

        <div class="entry-meta">
            
            <span class="entry-date">2012-11-21</span>
            
            
        </div>

        <div class="entry-tags">
    
    

    <ul class="taxonomy-keys">
    
        
        

        
        

        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2012/10/25/determining-country-by-latitude/longitude/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/languages/python">Python</a>
                        <a href="https://blog.jverkamp.com/2012/12/10/numbers-of-wirth/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2012/11/15/project-euler-9/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/languages/racket">Racket</a>
                        <a href="https://blog.jverkamp.com/2012/11/29/one-billion-primes---segmented-sieve/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2012/11/15/project-euler-9/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/languages/scheme">Scheme</a>
                        <a href="https://blog.jverkamp.com/2012/11/29/one-billion-primes---segmented-sieve/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/sources/">Sources</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2012/11/10/taxicab-numbers/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/sources/programming-praxis">Programming Praxis</a>
                        <a href="https://blog.jverkamp.com/2012/11/29/one-billion-primes---segmented-sieve/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    

    
        
        <li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li>
                
                <a href="https://blog.jverkamp.com/2012/11/15/project-euler-9/" class="previous-link">Prev</a>
                

                
                <a href="https://blog.jverkamp.com/2012/11/29/one-billion-primes---segmented-sieve/" class="next-link">Next</a>
                
            </ul>
        </li>
        

        
        <li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li>
                
                <a href="https://blog.jverkamp.com/2012/11/21/confession---day-20/" class="previous-link">Prev</a>
                

                
                <a href="https://blog.jverkamp.com/2012/11/22/confession---day-21/" class="next-link">Next</a>
                
            </ul>
        </li>
        
    
    </ul>
</div>

    </header>

	<div class="entry-content">
		<p>Programming Praxis&rsquo; new challenge(s) are to write three different list algorithms three times, each with a different runtime complexity. From their <a title="Programming Praxis: List Intersection and Union" href="http://programmingpraxis.com/2012/11/16/list-intersection-and-union/">first post</a> last week we have list intersection and union and from a <a title="Programming Praxis: List Difference" href="http://programmingpraxis.com/2012/11/20/list-difference/">newer post</a> yesterday we have the difference of two lists. For each of those, we want to be able to write an algorithm that runs in O(n<sup>2</sup>) time, one that runs in O(n log n), and finally one that runs in O(n). It turns out that it&rsquo;s more of an exercise in data structures than anything (although they&rsquo;re all still technically &lsquo;list&rsquo; algorithms), but it&rsquo;s still interesting to see how you can achieve the same goal in different ways that may be far more efficient.</p>

<p></p>

<p>Since all three of the basic algorithms (intersection, union, and difference) are actually rather similar, I&rsquo;m going to start with the three different runtimes first. Like my recent <a href="https://blog.jverkamp.com/2012/11/15/project-euler-9/">Project Euler</a> posts, I&rsquo;ll be writing the code in both Racket and Python to help those that read one language but not the other (although I would highly recommend that you learn both actually, they each have definite strengths). If you&rsquo;d like to see the full code for each algorithm, you can see it here: <a href="https://github.com/jpverkamp/small-projects/blob/master/blog/list-algorithms.py" title="List algorithms source (Python)">python</a>, <a href="https://github.com/jpverkamp/small-projects/blob/master/blog/list-algorithms.rkt" title="List algorithms source (Racket)">racket</a></p>

<p>First, let&rsquo;s start with the slowest but most likely easiest to understand algorithm. Since we&rsquo;re doing list intersection, we want to only return the elements in both lists. To do that, we want to start by looping over one list. For each element in that last, scan through the second list. If the element is in both, return it, otherwise, skip it. This ends up being O(n<sup>2</sup>) because for each element in one list (O(n)), you have to loop over the other list (also O(n)). Since the loops are nested, you multiply the runtimes, resulting in O(n<sup>2</sup>).</p>

<p>Starting with the Python version (note that Python&rsquo;s <code>in</code> operator on lists loops over the list to check for inclusion):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">intersection_loops</span>(ls1, ls2):
	<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;&#39;&#39;Calculate the intersection of two lists using nested loops.&#39;&#39;&#39;</span>

	result <span style="color:#f92672">=</span> []

	<span style="color:#66d9ef">for</span> e <span style="color:#f92672">in</span> ls1:
		<span style="color:#66d9ef">if</span> e <span style="color:#f92672">in</span> ls2:
			result<span style="color:#f92672">.</span>append(e)

	<span style="color:#66d9ef">return</span> result</code></pre></div>
<p>(Yes, this could be written in a single line using Python&rsquo;s list comprehension as <code>return [e for e in ls1 if e in ls2]</code>. In this case, I&rsquo;m going for clean code over the shortest version.)</p>

<p>Next, we have the Racket version (in much the same way, <code>member</code> is linear):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Calculate the intersection of two lists using nested loops.</span>
(<span style="color:#66d9ef">define </span>(intersection-loops ls1 ls2)
  (<span style="color:#66d9ef">let </span>loop ([ls1 ls1])
    (cond
      [(null? ls1) <span style="color:#f92672">&#39;</span>()]
      [(member (car ls1) ls2) 
       (cons (car ls1) (loop (cdr ls1)))]
      [else
       (loop (cdr ls1))])))</code></pre></div>
<p>This could be shortened significantly using Racket&rsquo;s <code>for/list</code> macro:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#66d9ef">define </span>(intersection-loops ls1 ls2)
  (for/list ([e (in-list ls1)]
             <span style="color:#f92672">#</span>:when (member e ls2))
    e))</code></pre></div>
<p>This will work here and on the third case, but we&rsquo;ll need to write the loops explicitly in the next (pre-sorted) case.</p>

<p>When you run it on some randomly generated lists, the result is quite obviously quadratic (the blue line is the runtime, the red line is a quadratic fit):</p>


<figure >
    
        <img src="/embeds/2012/intersection-loops.png" />
    
    
</figure>


<p>Next, we want to improve the time to O(n log n). Any time that you see a runtime like that, you should immediately think &lsquo;sort&rsquo; (or trees, but not in this case) as the best sorting algorithms all have that runtime. In this case, we have to change the algorithm somewhat, but the basic idea is to first sort the lists. Then, you only have to compare the first elements against each other, basically zipping them together.</p>

<p>That basic idea in Python:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">intersection_sort</span>(ls1, ls2):
	<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;&#39;&#39;Calculate the intersection of two lists by sorting them first.&#39;&#39;&#39;</span>

	ls1 <span style="color:#f92672">=</span> sorted(ls1)
	ls2 <span style="color:#f92672">=</span> sorted(ls2)
	result <span style="color:#f92672">=</span> []

	i, j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
	<span style="color:#66d9ef">while</span> True:
		<span style="color:#66d9ef">if</span> i <span style="color:#f92672">&gt;=</span> len(ls1):
			<span style="color:#66d9ef">break</span>
		<span style="color:#66d9ef">elif</span> j <span style="color:#f92672">&gt;=</span> len(ls2):
			<span style="color:#66d9ef">break</span>
		<span style="color:#66d9ef">elif</span> ls1[i] <span style="color:#f92672">&lt;</span> ls2[j]:
			i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
		<span style="color:#66d9ef">elif</span> ls1[i] <span style="color:#f92672">&gt;</span> ls2[j]:
			j <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
		<span style="color:#66d9ef">else</span>: <span style="color:#75715e"># ==</span>
			result<span style="color:#f92672">.</span>append(ls1[i])
			i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
			j <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>

	<span style="color:#66d9ef">return</span> result</code></pre></div>
<p>For intersection, if either list runs out, we&rsquo;re done. There will be no more matched elements. If either first element is smaller than the other, skip past that one. As soon as they&rsquo;re both equal, we have a match. Return it and keep going. The other two (union and difference) are much the same, see the full code (<a href="https://github.com/jpverkamp/small-projects/blob/master/blog/list-algorithms.py" title="List algorithms source (Python)">python</a>, <a href="https://github.com/jpverkamp/small-projects/blob/master/blog/list-algorithms.rkt" title="List algorithms source (Racket)">racket</a>) for more details.</p>

<p>And here&rsquo;s the Racket version:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#66d9ef">define </span>(intersection-sort ls1 ls2)
  (<span style="color:#66d9ef">let </span>loop ([ls1 (sort ls1 &lt;)]
             [ls2 (sort ls2 &lt;)])
    (cond
      [(null? ls1) <span style="color:#f92672">&#39;</span>()]
      [(null? ls2) <span style="color:#f92672">&#39;</span>()]
      [(&lt; (car ls1) (car ls2))
       (loop (cdr ls1) ls2)]
      [(&gt; (car ls1) (car ls2))
       (loop ls1 (cdr ls2))]
      [else
       (cons (car ls1) (loop (cdr ls1) (cdr ls2)))])))</code></pre></div>
<p>If we graph this one against O(n log n), we find that the graph isn&rsquo;t nearly as nice. Mostly, that&rsquo;s due to the relatively small times we&rsquo;re using. I also tried using larger lists, but garbage collection became a significant problem. Again, the blue is runtime and the red is the expected value.</p>


<figure >
    
        <img src="/embeds/2012/insertion-sort.png" />
    
    
</figure>


<p>Finally, the fastest version. The goal here is O(n). Since we have to loop over the lists at least once, that&rsquo;s going to be the fastest we can get. Since we don&rsquo;t have any more room to breathe as it were, we need an O(1) sort of algorithm. The first thing that comes to mind then is a hash. Hashes will gives us both O(1) insertion and selection, so it sounds like exactly what we need. Actually, the change from the first set (with nested loops) is only a line or two of code in each. In the Python version, we&rsquo;ll still be using <code>in</code>, but we want to build a <code>set</code> first (which is stored using hashing):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">intersection_hash</span>(ls1, ls2):
	<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;&#39;&#39;Calculate the intersection of two lists using a hash.&#39;&#39;&#39;</span>

	ls2_set <span style="color:#f92672">=</span> set(ls2)
	result <span style="color:#f92672">=</span> []

	<span style="color:#66d9ef">for</span> e <span style="color:#f92672">in</span> ls1:
		<span style="color:#66d9ef">if</span> e <span style="color:#f92672">in</span> ls2_set:
			result<span style="color:#f92672">.</span>append(e)

	<span style="color:#66d9ef">return</span> result</code></pre></div>
<p>And similarly for Racket, we will be using a hash built using <code>for/list</code>. For that, we want to return two <code>value</code>s, the key and the value. We don&rsquo;t care what the values are, so we&rsquo;ll just insert <code>#t</code>. Then we can use <code>hash-has-key?</code> to do the lookup:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Calculate the intersection of two lists using a hash.</span>
(<span style="color:#66d9ef">define </span>(intersection-hash ls1 ls2)
  (<span style="color:#66d9ef">define </span>ls2-hash (for/hash ([e2 (in-list ls2)]) (values e2 <span style="color:#66d9ef">#t</span>)))
  (<span style="color:#66d9ef">let </span>loop ([ls1 ls1])
    (cond
      [(null? ls1) <span style="color:#f92672">&#39;</span>()]
      [(hash-has-key? ls2-hash (car ls1)) 
       (cons (car ls1) (loop (cdr ls1)))]
      [else
       (loop (cdr ls1))])))</code></pre></div>
<p>Similiarly to the sorted case, the timing (blue line) isn&rsquo;t perfect, but it&rsquo;s quite clearly linear (the red line):</p>


<figure >
    
        <img src="/embeds/2012/insertion-hash.png" />
    
    
</figure>


<p>ANd that&rsquo;s it. I&rsquo;m not actually going to include the code for union or difference as it&rsquo;s basically the same with a few minor tweaks. You can see it in its fully comment entirety here: <a href="https://github.com/jpverkamp/small-projects/blob/master/blog/list-algorithms.py" title="List algorithms source (Python)">python</a>, <a href="https://github.com/jpverkamp/small-projects/blob/master/blog/list-algorithms.rkt" title="List algorithms source (Racket)">racket</a></p>
	</div>

    
<div class="entry-comments">
    <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = "jverkamp";
            var disqus_title = "List algorithms and efficiency";
            var disqus_url = "https:\/\/blog.jverkamp.com\/2012\/11\/21\/list-algorithms-and-efficiency\/";

             
            (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>


</article>

            </div>
        </div>

        <footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup>

<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li>

            
            <li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup>

<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li>
            
        </ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>

    </div>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/jquery.nanogallery.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js"></script>

<script type="text/javascript" src="/custom.js" defer></script>

</body>
</html>
