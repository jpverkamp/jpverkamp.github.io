<!DOCTYPE html>
<html>
<head>
    <title>
    Evaluating prefix/infix/postfix expressions â€“ jverkamp.com
</title>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/css/themes/light/nanogallery_light.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css">

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />


    
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper">
        <header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://twitter.com/jpverkamp">Twitter</a> *
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>

    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
        
            
        
            
            <li><a href="https://blog.jverkamp.com/photography/">Photography</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/programming/">Programming</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/research/">Research</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/writing/">Writing</a></li>
            
        
            <li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>


        <div id="page-content-wrapper">
            <div id="page-content">
            
<article>
	<header>
		<h1 class="entry-title">Evaluating prefix/infix/postfix expressions</h1>

        <div class="entry-meta">
            
            <span class="entry-date">2012-10-08</span>
            
            
        </div>

        <div class="entry-tags">
    
    

    <ul class="taxonomy-keys">
    
        
        

        
        

        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2012/10/03/elementary-cellular-automaton/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/languages/javascript">JavaScript</a>
                        <a href="https://blog.jverkamp.com/2013/03/06/partitioning-the-dutch-national-flag/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/topics/">Topics</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2012/10/07/three-ways-to-write-expressions/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/topics/data-structures">Data Structures</a>
                        <a href="https://blog.jverkamp.com/2012/10/11/dictionary-tries-in-racket/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    

    
        
        <li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li>
                
                <a href="https://blog.jverkamp.com/2012/10/07/three-ways-to-write-expressions/" class="previous-link">Prev</a>
                

                
                <a href="https://blog.jverkamp.com/2012/10/10/two-word-games/" class="next-link">Next</a>
                
            </ul>
        </li>
        

        
        <li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li>
                
                <a href="https://blog.jverkamp.com/2012/10/07/three-ways-to-write-expressions/" class="previous-link">Prev</a>
                

                
                <a href="https://blog.jverkamp.com/2012/10/09/a-sea-of-stars---ch.-13---missing/" class="next-link">Next</a>
                
            </ul>
        </li>
        
    
    </ul>
</div>

    </header>

	<div class="entry-content">
		

<p>In <a href="https://blog.jverkamp.com/2012/10/07/three-ways-to-write-expressions/">yesterday&rsquo;s post</a>, I talked about three different ways to write expressions: prefix, infix, and postfix expressions. I also promised to write up a web-based example that would show the guts of each algorithm in action. Well, here it is!</p>

<p>Use the three buttons at the top to switch between the different machines. Enter an expression in the box and click run to evaluate it. The only things that are supported at the moment are numbers (integers or floating point) and the operators +, -, *, and /, although the code is extensible enough that adding more shouldn&rsquo;t be an issue.</p>

<p>Have fun!</p>

<ul>
<li><a href="#prefix">prefix</a></li>
<li><a href="#infix">infix</a></li>
<li><a href="#postfix">postfix</a></li>
</ul>

<h1 id="prefix-scheme-a-name-prefix-a">Prefix / Scheme <a name="prefix"></a></h1>

<p><input type="text" id="prefixInput" value="+ * 5 8 + 5 - 1 4"> <button id="prefixRun">Run</button></p>

<h2 id="results">Results</h2>

<table class="table table-striped">
    <thead><tr><td>Tick</td><td>Input</td><td>Output</td><td>Rest</td><td>Error</td></tr></thead>
    <tbody id="prefixResult"></tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// known operators
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">operators</span> <span style="color:#f92672">=</span> {
	<span style="color:#e6db74">&#39;+&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">b</span>; },
	<span style="color:#e6db74">&#39;-&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">b</span>; },
	<span style="color:#e6db74">&#39;*&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">b</span>; },
	<span style="color:#e6db74">&#39;/&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#960050;background-color:#1e0010">/ b; },</span>
};

<span style="color:#75715e">// process at this level
</span><span style="color:#75715e">// return the result of this level and what we didn&#39;t use
</span><span style="color:#75715e">// return a null value if we fail at any point
</span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">step</span>(<span style="color:#a6e22e">current</span>) {
	<span style="color:#75715e">// directly return numbers
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>isNaN(parseFloat(<span style="color:#a6e22e">current</span>[<span style="color:#ae81ff">0</span>]))) {
		<span style="color:#66d9ef">return</span> {
			<span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> parseFloat(<span style="color:#a6e22e">current</span>[<span style="color:#ae81ff">0</span>]),
			<span style="color:#a6e22e">rest</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">current</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">1</span>)
		};
	}

	<span style="color:#75715e">// otherwise, we&#39;re going to have to recur
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">else</span> {
		<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">operators</span>[<span style="color:#a6e22e">current</span>[<span style="color:#ae81ff">0</span>]];

		<span style="color:#75715e">// recur for left, use that rest for right
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">left</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">step</span>(<span style="color:#a6e22e">current</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">1</span>));
		<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">left</span>.<span style="color:#a6e22e">value</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">return</span> {<span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">rest</span><span style="color:#f92672">:</span> []};
		<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">right</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">step</span>(<span style="color:#a6e22e">left</span>.<span style="color:#a6e22e">rest</span>);
		<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">right</span>.<span style="color:#a6e22e">value</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">return</span> {<span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">rest</span><span style="color:#f92672">:</span> []};

		<span style="color:#75715e">// return at my level
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">return</span> {
			<span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">left</span>.<span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">right</span>.<span style="color:#a6e22e">value</span>),
			<span style="color:#a6e22e">rest</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">right</span>.<span style="color:#a6e22e">rest</span>
		};
	}
}
<span style="color:#a6e22e">step</span>(<span style="color:#a6e22e">input</span>);</code></pre></div>
<hr />

<h1 id="infix-a-name-infix-a">Infix <a name="infix"></a></h1>

<p><input type="text" id="infixInput" value="4 + 2 * 7 - 1 * 5 + 6 * 5 - 1"> <button id="infixRun">Run</button></p>

<h2 id="results-1">Results</h2>

<table class="table table-striped">
    <thead><tr><td>Tick</td><td>Command</td><td>Reducing</td><td>Error</td></tr></thead>
    <tbody id="infixResult"></tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// known operators
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">operators</span> <span style="color:#f92672">=</span> {
	<span style="color:#e6db74">&#39;+&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">b</span>; },
	<span style="color:#e6db74">&#39;-&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">b</span>; },
	<span style="color:#e6db74">&#39;*&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">b</span>; },
	<span style="color:#e6db74">&#39;/&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#960050;background-color:#1e0010">/ b; },</span>
};
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">precedence</span> <span style="color:#f92672">=</span> [
	[<span style="color:#e6db74">&#39;*&#39;</span>, <span style="color:#e6db74">&#39;/&#39;</span>],
	[<span style="color:#e6db74">&#39;+&#39;</span>, <span style="color:#e6db74">&#39;-&#39;</span>]
]

<span style="color:#75715e">// process until we are done
</span><span style="color:#75715e"></span><span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>) {
	<span style="color:#75715e">// find the first operator at the lowest level
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">reduceAt</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">found</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">precedence</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">j</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">j</span><span style="color:#f92672">++</span>) {
			<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">$</span>.<span style="color:#a6e22e">inArray</span>(<span style="color:#a6e22e">input</span>[<span style="color:#a6e22e">j</span>], <span style="color:#a6e22e">precedence</span>[<span style="color:#a6e22e">i</span>]) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>) {
				<span style="color:#a6e22e">reduceAt</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">j</span>;
				<span style="color:#a6e22e">found</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
				<span style="color:#66d9ef">break</span>;
			}
		}
		<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">found</span>) <span style="color:#66d9ef">break</span>;
	}

	<span style="color:#75715e">// if we didn&#39;t find one, bail
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">found</span>) <span style="color:#66d9ef">return</span>;

	<span style="color:#75715e">// otherwise, reduce that operator
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">newInput</span> <span style="color:#f92672">=</span> [];
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">operators</span>[<span style="color:#a6e22e">input</span>[<span style="color:#a6e22e">reduceAt</span>]];

	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">reduceAt</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>)
		<span style="color:#a6e22e">newInput</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">input</span>[<span style="color:#a6e22e">i</span>]);

	<span style="color:#a6e22e">newInput</span>.<span style="color:#a6e22e">push</span>(<span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">f</span>(
		parseFloat(<span style="color:#a6e22e">input</span>[<span style="color:#a6e22e">reduceAt</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]),
		parseFloat(<span style="color:#a6e22e">input</span>[<span style="color:#a6e22e">reduceAt</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>])
	));

	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">reduceAt</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>)
		<span style="color:#a6e22e">newInput</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">input</span>[<span style="color:#a6e22e">i</span>]);

	<span style="color:#a6e22e">input</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">newInput</span>;
}</code></pre></div>
<hr />

<h1 id="postfix-rpn-a-name-postfix-a">Postfix / RPN <a name="postfix"></a></h1>

<p><input type="text" id="postfixInput" value="4 2 7 * + 1 6 - 5 * - 1 -"> <button id="postfixRun">Run</button></p>

<h2 id="results-2">Results</h2>

<table class="table table-striped">
    <thead><tr><td>Tick</td><td>Command</td><td>Stack</td><td>Error</td></tr></thead>
    <tbody id="postfixResult"></tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// known operators
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">operators</span> <span style="color:#f92672">=</span> {
	<span style="color:#e6db74">&#39;+&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">b</span>; },
	<span style="color:#e6db74">&#39;-&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">b</span>; },
	<span style="color:#e6db74">&#39;*&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">b</span>; },
	<span style="color:#e6db74">&#39;/&#39;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span> <span style="color:#960050;background-color:#1e0010">/ b; },</span>
};

<span style="color:#75715e">// run through all commands in the input
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">stack</span> <span style="color:#f92672">=</span> [];
<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cmd</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">input</span>[<span style="color:#a6e22e">i</span>];

	<span style="color:#75715e">// known operator
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">cmd</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">operators</span>) {
		<span style="color:#75715e">// get the function
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">operators</span>[<span style="color:#a6e22e">cmd</span>];

		<span style="color:#75715e">// sanity check
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">stack</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">length</span>) {
			<span style="color:#a6e22e">error</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;not enough arguments&#39;</span>;
			<span style="color:#66d9ef">break</span>;
		}

		<span style="color:#75715e">// get the correct number of arguments
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">args</span> <span style="color:#f92672">=</span> [];
		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">j</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">j</span><span style="color:#f92672">++</span>)
			<span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">unshift</span>(<span style="color:#a6e22e">stack</span>.<span style="color:#a6e22e">shift</span>());

		<span style="color:#75715e">// apply and push back onto the stack
</span><span style="color:#75715e"></span>		<span style="color:#75715e">// note: the first argument to apply is &#39;this&#39;
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">stack</span>.<span style="color:#a6e22e">unshift</span>(<span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">apply</span>(<span style="color:#66d9ef">undefined</span>, <span style="color:#a6e22e">args</span>));
	}

	<span style="color:#75715e">// anything else, push onto the stack as either a number or string
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">else</span> {
		<span style="color:#a6e22e">stack</span>.<span style="color:#a6e22e">unshift</span>(isNaN(parseFloat(<span style="color:#a6e22e">cmd</span>)) <span style="color:#f92672">?</span> <span style="color:#a6e22e">cmd</span> <span style="color:#f92672">:</span> parseFloat(<span style="color:#a6e22e">cmd</span>));
	}
}</code></pre></div>
<hr />

<p>Hopefully this helps give some insight into what I was talking about in <a href="https://blog.jverkamp.com/2012/10/07/three-ways-to-write-expressions/">yesterday&rsquo;s post</a>. I have to admit, I&rsquo;m actually starting to like Javascript. It&rsquo;s a bit strange at times, but it does have a nice functional flavor which is always fun.</p>

<p>If you&rsquo;d like to download the entire source code, you can do so here: <a href="https://github.com/jpverkamp/small-projects/blob/master/blog/evaluating-prefix-infix-postfix.js" title="Evaluating prefix/infix/postfix source code">source code</a></p>

<style>
.warning { color: red; }
</style>

<script>
jQuery(function($) {

// only show one of the three at a time
//$("#prefix").hide();
$("#infix").hide();
$("#postfix").hide();

$("#prefixShow").click(function() {    
    $("#prefix").show();
    $("#infix").hide();
    $("#postfix").hide();
});

$("#infixShow").click(function() {    
    $("#prefix").hide();
    $("#infix").show();
    $("#postfix").hide();
});

$("#postfixShow").click(function() {    
    $("#prefix").hide();
    $("#infix").hide();
    $("#postfix").show();
});

// show/hide source, start with it hidden
$(".source").hide();
$("#showHidePrefixSource").click(function() { $("#prefixSource").toggle(); });
$("#showHideInfixSource").click(function() { $("#infixSource").toggle(); });
$("#showHidePostfixSource").click(function() { $("#postfixSource").toggle(); });

// known operators
var operators = {
    '+': function(a, b) { return a + b; },
    '-': function(a, b) { return a - b; },
    '*': function(a, b) { return a * b; },
    '/': function(a, b) { return a / b; },
};
var precedence = [
    ['*', '/'],
    ['+', '-']
]

// evaluate an prefix expression
function prefixRun() {
    $("#prefixResult").empty();

    var tick = 0;

    var input = $('#prefixInput').val().split(" ");
    var error = null;

    // process at this level
    // return an array of the result of this level and what we didn't use
    function step(current) {
        tick += 1;

        // if we don't have anything else, this is an error
        if (current.length == 0) {
            $('#prefixResult').append('<tr><td>' + tick + '</td><td>' + current.join(' ') + '</td><td></td><td></td><td class="warning">unable to continue, no input</td></tr>\n');
            return {value: null, rest: []};;
        }

        // report what we started with
        $('#prefixResult').append('<tr><td>' + tick + '</td><td>' + current.join(' ') + '</td><td></td><td></td><td class="warning"></td></tr>\n');

        // directly return numbers
        if (!isNaN(parseFloat(current[0]))) {
            var output = parseFloat(current[0]);
            var rest = current.slice(1);

            $('#prefixResult').append('<tr><td>' + tick + '</td><td></td><td>' + output + '</td><td>' + rest.join(' ') + '</td><td class="warning"></td></tr>\n');

            return {value: output, rest: rest};
        }

        // otherwise, we're going to have to recur
        else {
            var f = operators[current[0]];

            // recur for left, use that rest for right
            var left = step(current.slice(1));
            if (left.value == null) return {value: null, rest: []};
            var right = step(left.rest);
            if (right.value == null) return {value: null, rest: []};

            // apply the function to the two values
            var output = f(left.value, right.value);
            var rest = right.rest;

            $('#prefixResult').append('<tr><td>' + tick + '</td><td></td><td>' + left.value + ' ' + current[0] + ' ' + right.value + ' = ' + output + '</td><td>' + rest.join(' ') + '</td><td class="warning"></td></tr>\n');

            return {value: output, rest: rest};
        }
    }
    var result = step(input);
    if (result.value == null) {
    } else if (result.rest.length == 0) {
        $('#prefixResult').append('<tr><td>result</td><td></td><td><b>' + result.value + '</b></td><td></td><td class="warning"></td></tr>\n');
    } else {
        $('#prefixResult').append('<tr><td>result</td><td></td><td></td><td>' + result.rest.join(' ') + '</td><td class="warning">malformed expression</td></tr>\n');
    }
}
$("#prefixRun").click(prefixRun);

// evaluate an infix expression
function infixRun() {
    $("#infixResult").empty();

    var tick = 0;

    var input = $('#infixInput').val().split(" ");
    var error = null;

    // process until we are done
    while (input.length > 1) {
        tick += 1;

        // find the first operator at the lowest level
        var reduceAt = 0;
        var reduceWhich = undefined;
        var found = false;
        for (var i = 0; i < precedence.length; i++) {
            for (var j = 1; j < input.length - 1; j++) {
                if ($.inArray(input[j], precedence[i]) >= 0) {
                    reduceAt = j;
                    reduceWhich = precedence[i].join(' ')
                    found = true;
                    break;
                }
            }
            if (found) break;
        }

        // if we didn't find one, error
        if (!found) {
            $('#infixResult').append('<tr><td>' + tick + '</td><td>' + input.join(' ') + '</td><td></td><td class="warning">unable to find an operator to reduce</td></tr>\n');
            $('.warning').css('color', 'red');     
            return;
        }

        // report what we're about to do
        $('#infixResult').append('<tr><td>' + tick + '</td><td>' + input.join(' ') + '</td><td>' + reduceWhich + '</td><td class="warning"></td></tr>\n');

        // otherwise, reduce that operator
        var newInput = [];
        var f = operators[input[reduceAt]];

        for (var i = 0; i < reduceAt - 1; i++)
            newInput.push(input[i]);

        newInput.push("" + f(
            parseFloat(input[reduceAt - 1]),
            parseFloat(input[reduceAt + 1])
        ));

        for (var i = reduceAt + 2; i < input.length; i++)
            newInput.push(input[i]);

        input = newInput;
    }

    // report the final result
    $('#infixResult').append('<tr><td>result</td><td><b>' + input.join(' ') + '</b></td><td></td><td class="warning"></td></tr>\n');
}
$("#infixRun").click(infixRun);

// evaluate a postfix expression
function postfixRun() {
    $("#postfixResult").empty();

    var tick = 0;
    var stack = [];

    var input = $('#postfixInput').val().split(" ");
    var error = null;

    // run through all commands in the input
    for (var i = 0; i < input.length; i++) {
        var cmd = input[i];
        tick += 1;

        // known operator
        if (cmd in operators) {
            // get the function
            var f = operators[cmd];

            // sanity check
            if (stack.length < f.length) {
            error = 'not enough arguments';
            break;
            }

            // get the correct number of arguments
            var args = [];
            for (var j = 0; j < f.length; j++)
            args.unshift(stack.shift());

            // apply and push back onto the stack
            // note: the first argument to apply is 'this'
            stack.unshift(f.apply(undefined, args));
        }

        // anything else, push onto the stack as either a number or string
        else {
            stack.unshift(isNaN(parseFloat(cmd)) ? cmd : parseFloat(cmd));
        }

        // report on current stack
        $('#postfixResult').append('<tr><td>' + tick + '</td><td>' + cmd + '</td><td>' + stack + '</td><td></td></tr>\n');
    }

    // check final stack
    if (stack.length > 1)
        error = 'malformed expression, multiple results on final stack';

    // report final result or error
    if (error == null) {
        $('#postfixResult').append('<tr><td>result</td><td></td><td><b>' + stack + '</b></td><td></td></tr>\n');
    } else {
        $('#postfixResult').append('<tr><td>result</td><td>' + cmd + '</td><td>' + stack + '</td><td class="warning">' + error + '</td></tr>\n');
        error = null;
    }  
}
$("#postfixRun").click(postfixRun);
});
</script>

	</div>

    
<div class="entry-comments">
    <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = "jverkamp";
            var disqus_title = "Evaluating prefix\/infix\/postfix expressions";
            var disqus_url = "https:\/\/blog.jverkamp.com\/2012\/10\/08\/evaluating-prefix\/infix\/postfix-expressions\/";

             
            (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>


</article>

            </div>
        </div>

        <footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup>

<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li>

            
            <li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup>

<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li>
            
        </ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>

    </div>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/jquery.nanogallery.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js"></script>

<script type="text/javascript" src="/custom.js" defer></script>

</body>
</html>
