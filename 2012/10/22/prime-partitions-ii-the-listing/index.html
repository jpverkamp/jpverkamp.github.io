<!DOCTYPE html>
<html onclick >
<head>
    <title>Prime Partitions II: The Listing â€“ jverkamp.com</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8"><link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css" integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" />

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper"><header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a> *
            <a href="/resume">Resume</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>
    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation"><li><a href="https://blog.jverkamp.com/photography/">Photography</a></li><li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li><li><a href="https://blog.jverkamp.com/maker/">Maker</a></li><li><a href="https://blog.jverkamp.com/programming/">Programming</a></li><li><a href="https://blog.jverkamp.com/writing/">Writing</a></li><li><a href="https://blog.jverkamp.com/research/">Research</a></li><li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>
<div id="page-content-wrapper">
            <div id="page-content"><article>
	<header>
		<h1 class="entry-title">Prime Partitions II: The Listing</h1>

        <div class="entry-meta"><span class="entry-date">2012-10-22</span>
            </div>

        <div class="entry-taxonomies"><div class="entry-tags"><ul class="taxonomy-keys"><li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2012/10/20/prime-partitions/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/racket">Racket</a><a href="https://blog.jverkamp.com/2012/10/27/pythagorean-triples/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2012/10/20/prime-partitions/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/scheme">Scheme</a><a href="https://blog.jverkamp.com/2012/10/27/pythagorean-triples/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/sources/">Sources</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2012/10/20/prime-partitions/" class="previous-link"></a><a class="taxonomy-value" href="/programming/sources/programming-praxis">Programming Praxis</a><a href="https://blog.jverkamp.com/2012/10/27/pythagorean-triples/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/topics/">Topics</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2012/10/20/prime-partitions/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/mathematics">Mathematics</a><a href="https://blog.jverkamp.com/2012/10/27/pythagorean-triples/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2012/10/20/prime-partitions/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/prime-numbers">Prime Numbers</a><a href="https://blog.jverkamp.com/2012/11/01/the-sum-of-the-first-billion-primes/" class="next-link"></a></li></ul>
        </li><li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2012/10/20/prime-partitions/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2012/10/24/determining-country-by-ip/" class="next-link">Next</a></ul>
        </li><li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2012/10/21/popocatepetl-rising/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2012/10/22/isc/caida-workshop/" class="next-link">Next</a></ul>
        </li></ul>
</div>
</div>
    </header>

	<div class="entry-content"><p>As the continuation of <a href="https://blog.jverkamp.com/2012/10/22/prime-partitions-ii-the-listing/">Saturday&rsquo;s post</a> on counting the number of prime partitions of a number without actually determining what those partitions are, today we&rsquo;re going to work out the actual list of partitions.</p>
<p>To start with, we&rsquo;re going to need some way of generating a list of primes. Using a <code>generator</code>, the code is rather straight forward. Start with 2 and 3. After that, loop through the odd numbers, checking if each in turn is prime. For the ones that are, <code>yield</code> them. Something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#a6e22e">require</span> racket/generator)

<span style="color:#75715e">; create a generator of primes between min and max (inclusive)</span>
<span style="color:#75715e">; if max is #f, return an infinite generator</span>
(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">primes</span> [min <span style="color:#ae81ff">2</span>] [max <span style="color:#66d9ef">#f</span>])
  (<span style="color:#a6e22e">generator</span> ()
    (<span style="color:#a6e22e">when</span> (&gt;= <span style="color:#ae81ff">2</span> min)
      (<span style="color:#a6e22e">yield</span> <span style="color:#ae81ff">2</span>))
    (<span style="color:#66d9ef">let </span>loop ([i <span style="color:#ae81ff">3</span>])
      (<span style="color:#a6e22e">when</span> (<span style="color:#66d9ef">or </span>(not max) (&lt;= i max))
        (<span style="color:#a6e22e">when</span> (<span style="color:#66d9ef">and </span>(&gt;= i min) (<span style="color:#a6e22e">prime?</span> i))
          (<span style="color:#a6e22e">yield</span> i))
        (<span style="color:#a6e22e">loop</span> (+ i <span style="color:#ae81ff">2</span>))))
    (<span style="color:#a6e22e">yield</span> <span style="color:#66d9ef">#f</span>)))
</code></pre></div><p>There&rsquo;s one additional part to this code&ndash;the optional parameters <code>min</code> and <code>max</code> that control just which primes you want. Basically, return a <code>generator</code> that will generate all of the primes between <code>min</code> and <code>max</code> inclusive. So we have:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (<span style="color:#a6e22e">for/list</span> ([i (<span style="color:#a6e22e">in-producer</span> (<span style="color:#a6e22e">primes</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">40</span>) <span style="color:#66d9ef">#f</span>)]) i)
<span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">23</span> <span style="color:#ae81ff">29</span> <span style="color:#ae81ff">31</span> <span style="color:#ae81ff">37</span>)
</code></pre></div><p>The <code>in-producer</code> will take any function (like the one created by <code>primes</code>) and call it over and over again until a given value&ndash;<code>#f</code> in this case&ndash;is returned.</p>
<p>To make this work though, you need a way to determine if a number is prime, so that&rsquo;s the second part of today&rsquo;s post. To determine if a number is prime, we basically use the exact same code as the <a href="https://blog.jverkamp.com/2012/10/22/prime-partitions-ii-the-listing/">previous post</a>, except we return <code>#t</code> or <code>#f</code> instead of the factors:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; is n prime?</span>
(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">prime?</span> n)
  (<span style="color:#66d9ef">define </span>rootn (sqrt n))
  (<span style="color:#a6e22e">cond</span>
    [(= n <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">#f</span>]
    [(<span style="color:#a6e22e">divides?</span> n <span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">#f</span>]
    [else
     (<span style="color:#66d9ef">let </span>loop ([i <span style="color:#ae81ff">3</span>])
       (<span style="color:#a6e22e">cond</span>
          [(&gt; i rootn) <span style="color:#66d9ef">#t</span>]
          [(<span style="color:#a6e22e">divides?</span> n i) <span style="color:#66d9ef">#f</span>]
          [else
           (<span style="color:#a6e22e">loop</span> (+ i <span style="color:#ae81ff">2</span>))]))]))
</code></pre></div><p>Now with these two pieces in place, all we have to do is write a function to generate the actual partitions. The idea is straightforward. Go through all primes lower than the given number. For each, recur on the original number minus the prime, noting that we only want further primes to be greater or equal. That way the lists will be naturally sorted. If we ever get exactly 0, there&rsquo;s one way to add numbers to get it&ndash;add none of them. If we go below 0, there&rsquo;s no hope any more. So how does that all translate into code?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; calculate the prime partitions of n</span>
<span style="color:#75715e">; min is the smallest prime to consider for the recursion</span>
(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">prime-partitions</span> n [min <span style="color:#ae81ff">2</span>])
  (<span style="color:#a6e22e">cond</span>
    [(&lt; n <span style="color:#ae81ff">0</span>) <span style="color:#f92672">&#39;</span>()]
    [(= n <span style="color:#ae81ff">0</span>) <span style="color:#f92672">&#39;</span>(())]
    [else
     (<span style="color:#a6e22e">for*/list</span> ([i (<span style="color:#a6e22e">in-producer</span> (<span style="color:#a6e22e">primes</span> min n) <span style="color:#66d9ef">#f</span>)]
                 [r (<span style="color:#a6e22e">prime-partitions</span> (- n i) i)])
       (cons i r))]))
</code></pre></div><p>The nice thing about this is that it will nest the loops over primes <code>i</code> and recursive results <code>r</code> using that prime. With this, any branches that don&rsquo;t actually produce a result just don&rsquo;t appear. I have a feeling that some of my older code could better be written in this same style.</p>
<p>A few examples:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (<span style="color:#a6e22e">prime-partitions</span> <span style="color:#ae81ff">5</span>)
<span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>) (<span style="color:#ae81ff">5</span>))
&gt; (<span style="color:#a6e22e">prime-partitions</span> <span style="color:#ae81ff">11</span>)
<span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>) (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span>) (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">7</span>) (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span>) (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">5</span>) (<span style="color:#ae81ff">11</span>))
&gt; (<span style="color:#a6e22e">prime-partitions</span> <span style="color:#ae81ff">15</span>)
<span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>)
  (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span>)
  (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">7</span>)
  (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span>)
  (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">5</span>)
  (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">11</span>)
  (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span>)
  (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">5</span>)
  (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">13</span>)
  (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span>)
  (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">7</span>)
  (<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">5</span>))
</code></pre></div><p>And that&rsquo;s all there is to it. I think perhaps I won&rsquo;t be calling <code>(prime-partitions 1000)</code> though. ðŸ˜„</p>
<p>If you&rsquo;d like to download the source for this post, you can do so here: <a href="https://github.com/jpverkamp/small-projects/blob/master/blog/get-prime-partitions.rkt" title="get-prime-partitions source">get-prime-partitions source</a></p></div>
</article></div>
        </div><footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li><li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li></ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>
</div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js" integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js" integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin="anonymous"></script>

<script src="/custom.js"></script>
</body>
</html>
