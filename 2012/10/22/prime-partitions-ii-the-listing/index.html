<!doctype html><html><head><title>Prime Partitions II: The Listing â€“ jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_17422284542669262002.min.834c1e2313951f0c25b90152fe8b62250eab4a2e8cbd2560fa1a1cdc91c71733.js integrity="sha256-g0weIxOVHwwluQFS/otiJQ6rSi6MvSVg+hoc3JHHFzM=" defer></script><script src=/jquery.fancybox_16245765822111608191.min.ef050764ff69f3287c89ff655825479dd8304dcd9bc653d1ddd4772a701ad445.js integrity="sha256-7wUHZP9p8yh8if9lWCVHndgwTc2bxlPR3dR3KnAa1EU=" defer></script><script src=/katex_17296078054267651618.min.deed0e78a77391517d530a00324ce7b760ac204134992ef22d36f583615ae498.js integrity="sha256-3u0OeKdzkVF9UwoAMkznt2CsIEE0mS7yLTb1g2Fa5Jg=" defer></script><script src=/auto-render_14944144240389301023.min.e694d9d5eae2917984179683ead27b998784a81398e8836c369373d2c67fc32a.js integrity="sha256-5pTZ1erikXmEF5aD6tJ7mYeEqBOY6INsNpNz0sZ/wyo=" defer></script><script src=/bigfoot_28293813221957978.min.af671f08986f0a2267c5a0cb2748b005489e47fa25f55479b200e2a563d23022.js integrity="sha256-r2cfCJhvCiJnxaDLJ0iwBUieR/ol9VR5sgDipWPSMCI=" defer></script><script src=/mermaid_9520146763733687737.min.bfe50b47c0387e3c3bf97ec5f338bba94f7ccb02f962a4aec8cf0b4d68c8434d.js integrity="sha256-v+ULR8A4fjw7+X7F8zi7qU98ywL5YqSuyM8LTWjIQ00=" defer></script><script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script><link rel=stylesheet href=/katex_13658330645258633971.min.64e42891d651aee0b8cd02ec9227ff271d37bcf06dae985d1acf0eba1623e850.css integrity="sha256-ZOQokdZRruC4zQLskif/Jx03vPBtrphdGs8OuhYj6FA="><link rel=stylesheet href=/bigfoot-default_8781527669040159104.min.0d2b289fa3451447692959fcee5676b846532fe7ab50ddc4660824c42d4adcd7.css integrity="sha256-DSson6NFFEdpKVn87lZ2uEZTL+erUN3EZggkxC1K3Nc="><link rel=stylesheet href=/jquery.fancybox_5330465509389191777.min.67505d77381ebd82623ab9296c1989c44ec828d867c00296e80e52ef860cac37.css integrity="sha256-Z1BddzgevYJiOrkpbBmJxE7IKNhnwAKW6A5S74YMrDc="><link rel=stylesheet href=/css_1846377409604050217.min.fffe842bc000dd1fe8661ac6427a392a08faa95e8edab1ea7fb98c5f8dac6a6f.css integrity="sha256-//6EK8AA3R/oZhrGQno5Kgj6qV6O2rHqf7mMX42sam8="><link rel=stylesheet href=/main.min.34a34d86b8aae11b989d80a1626629c053029d012419a1993cfb6c12ea175737.css integrity="sha256-NKNNhriq4RuYnYChYmYpwFMCnQEkGaGZPPtsEuoXVzc="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/home-automation/>Home Automation</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>Prime Partitions II: The Listing</h1><div class=entry-meta><span class=entry-date>2012-10-22</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2012/10/20/prime-partitions/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/racket>Racket</a><a href=https://blog.jverkamp.com/2012/10/27/pythagorean-triples/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2012/10/20/prime-partitions/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/scheme>Scheme</a><a href=https://blog.jverkamp.com/2012/10/27/pythagorean-triples/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2012/10/20/prime-partitions/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/programming-praxis>Programming Praxis</a><a href=https://blog.jverkamp.com/2012/10/27/pythagorean-triples/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2012/10/20/prime-partitions/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/mathematics>Mathematics</a><a href=https://blog.jverkamp.com/2012/10/27/pythagorean-triples/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2012/10/20/prime-partitions/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/prime-numbers>Prime Numbers</a><a href=https://blog.jverkamp.com/2012/11/01/the-sum-of-the-first-billion-primes/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2012/10/20/prime-partitions/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2012/10/24/determining-country-by-ip/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2012/10/21/popocatepetl-rising/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2012/10/22/isc/caida-workshop/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>As the continuation of <a href=https://blog.jverkamp.com/2012/10/22/prime-partitions-ii-the-listing/>Saturday&rsquo;s post</a> on counting the number of prime partitions of a number without actually determining what those partitions are, today we&rsquo;re going to work out the actual list of partitions.</p><p>To start with, we&rsquo;re going to need some way of generating a list of primes. Using a <code>generator</code>, the code is rather straight forward. Start with 2 and 3. After that, loop through the odd numbers, checking if each in turn is prime. For the ones that are, <code>yield</code> them. Something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>(<span style=color:#a6e22e>require</span> racket/generator)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; create a generator of primes between min and max (inclusive)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; if max is #f, return an infinite generator</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>primes</span> [min <span style=color:#ae81ff>2</span>] [max <span style=color:#66d9ef>#f</span>])
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>generator</span> ()
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>when</span> (&gt;= <span style=color:#ae81ff>2</span> min)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>yield</span> <span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>let </span>loop ([i <span style=color:#ae81ff>3</span>])
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>when</span> (<span style=color:#66d9ef>or </span>(not max) (&lt;= i max))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>when</span> (<span style=color:#66d9ef>and </span>(&gt;= i min) (<span style=color:#a6e22e>prime?</span> i))
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>yield</span> i))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>loop</span> (+ i <span style=color:#ae81ff>2</span>))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>yield</span> <span style=color:#66d9ef>#f</span>)))
</span></span></code></pre></div><p>There&rsquo;s one additional part to this code&ndash;the optional parameters <code>min</code> and <code>max</code> that control just which primes you want. Basically, return a <code>generator</code> that will generate all of the primes between <code>min</code> and <code>max</code> inclusive. So we have:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (<span style=color:#a6e22e>for/list</span> ([i (<span style=color:#a6e22e>in-producer</span> (<span style=color:#a6e22e>primes</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>40</span>) <span style=color:#66d9ef>#f</span>)]) i)
</span></span><span style=display:flex><span><span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>23</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>31</span> <span style=color:#ae81ff>37</span>)
</span></span></code></pre></div><p>The <code>in-producer</code> will take any function (like the one created by <code>primes</code>) and call it over and over again until a given value&ndash;<code>#f</code> in this case&ndash;is returned.</p><p>To make this work though, you need a way to determine if a number is prime, so that&rsquo;s the second part of today&rsquo;s post. To determine if a number is prime, we basically use the exact same code as the <a href=https://blog.jverkamp.com/2012/10/22/prime-partitions-ii-the-listing/>previous post</a>, except we return <code>#t</code> or <code>#f</code> instead of the factors:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; is n prime?</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>prime?</span> n)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>rootn (sqrt n))
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>    [(= n <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>#f</span>]
</span></span><span style=display:flex><span>    [(<span style=color:#a6e22e>divides?</span> n <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>#f</span>]
</span></span><span style=display:flex><span>    [else
</span></span><span style=display:flex><span>     (<span style=color:#66d9ef>let </span>loop ([i <span style=color:#ae81ff>3</span>])
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>          [(&gt; i rootn) <span style=color:#66d9ef>#t</span>]
</span></span><span style=display:flex><span>          [(<span style=color:#a6e22e>divides?</span> n i) <span style=color:#66d9ef>#f</span>]
</span></span><span style=display:flex><span>          [else
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>loop</span> (+ i <span style=color:#ae81ff>2</span>))]))]))
</span></span></code></pre></div><p>Now with these two pieces in place, all we have to do is write a function to generate the actual partitions. The idea is straightforward. Go through all primes lower than the given number. For each, recur on the original number minus the prime, noting that we only want further primes to be greater or equal. That way the lists will be naturally sorted. If we ever get exactly 0, there&rsquo;s one way to add numbers to get it&ndash;add none of them. If we go below 0, there&rsquo;s no hope any more. So how does that all translate into code?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; calculate the prime partitions of n</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; min is the smallest prime to consider for the recursion</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>prime-partitions</span> n [min <span style=color:#ae81ff>2</span>])
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>    [(&lt; n <span style=color:#ae81ff>0</span>) <span style=color:#f92672>&#39;</span>()]
</span></span><span style=display:flex><span>    [(= n <span style=color:#ae81ff>0</span>) <span style=color:#f92672>&#39;</span>(())]
</span></span><span style=display:flex><span>    [else
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>for*/list</span> ([i (<span style=color:#a6e22e>in-producer</span> (<span style=color:#a6e22e>primes</span> min n) <span style=color:#66d9ef>#f</span>)]
</span></span><span style=display:flex><span>                 [r (<span style=color:#a6e22e>prime-partitions</span> (- n i) i)])
</span></span><span style=display:flex><span>       (cons i r))]))
</span></span></code></pre></div><p>The nice thing about this is that it will nest the loops over primes <code>i</code> and recursive results <code>r</code> using that prime. With this, any branches that don&rsquo;t actually produce a result just don&rsquo;t appear. I have a feeling that some of my older code could better be written in this same style.</p><p>A few examples:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (<span style=color:#a6e22e>prime-partitions</span> <span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&#39;</span>((<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>3</span>) (<span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>&gt; (<span style=color:#a6e22e>prime-partitions</span> <span style=color:#ae81ff>11</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&#39;</span>((<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>3</span>) (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span>) (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>7</span>) (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span>) (<span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>5</span>) (<span style=color:#ae81ff>11</span>))
</span></span><span style=display:flex><span>&gt; (<span style=color:#a6e22e>prime-partitions</span> <span style=color:#ae81ff>15</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&#39;</span>((<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>7</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>11</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>7</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>2</span> <span style=color:#ae81ff>13</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>3</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>7</span>)
</span></span><span style=display:flex><span>  (<span style=color:#ae81ff>5</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>5</span>))
</span></span></code></pre></div><p>And that&rsquo;s all there is to it. I think perhaps I won&rsquo;t be calling <code>(prime-partitions 1000)</code> though. &#x1f604;</p><p>If you&rsquo;d like to download the source for this post, you can do so here: <a href=https://github.com/jpverkamp/small-projects/blob/master/blog/get-prime-partitions.rkt title="get-prime-partitions source">get-prime-partitions source</a></p></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>