<!doctype html><html><head><title>Parallel BF â€“ jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_5823201688106629450.min.30448892aa1f91e9c4cb5494e5c5e5abc13b7778de7786e5256cdc7d2424813a.js defer></script>
<script src=/jquery.fancybox_6181813213021922412.min.6ba037466db9f8843b66c38c32fe5a353344e7fd68ecda97efb63a84c881f828.js defer></script>
<script src=/katex_12008035502722260518.min.3cc3a080c0368785179e37b0cd0a71c6cf60c4fc5a8dce503f5a542ec0a25043.js defer></script>
<script src=/bigfoot_8444447145154709333.min.5e80bd85ebaeb95607834d6777bfe7013d1d161f0f02a31b845e4bd765898316.js defer></script>
<script src=/mermaid_12365941879912544862.min.e8f19283a632077085b9ad74aecad54abe84429c69789fd29ffa3a254d86abdd.js defer></script>
<script src=/custom.min.9bb1a6d1e0b58ced38df246e4479317e4561461cfabab31b36fbc36035186214.js defer></script>
<link rel=stylesheet href=/katex_14163593549783030822.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css><link rel=stylesheet href=/bigfoot-default_16482899066638414220.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css><link rel=stylesheet href=/jquery.fancybox_16222217791602823071.min.e28b5d7d9d89efacb5f708ac30cbd76b1b9a0f816dfd9da96631d1d09cbbdd76.css><link rel=stylesheet href=/css_4780214198035419921.min.7cfac95bdd962d85ceec560e50fe7b04c44b58a76e5202006ef36ca8c0a7d836.css><link rel=stylesheet href=/custom.min.3bcba67844fc4a76aa7c1947a1fcf14cddaf8e9e0f1e734fde0fa219416f058d.css></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=//www.google.com/search method=get onsubmit='(function(e){e.q.value="site:blog.jverkamp.com "+e.qfront.value})(this)' class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=hidden>
<input name=qfront type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article><header><h1 class=entry-title>Parallel BF</h1><div class=entry-meta><span class=entry-date>2012-12-31</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2012/12/30/a-brainfk-interpreter/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/brainfk>Brainf**k</a></li><li><a href=https://blog.jverkamp.com/2012/12/30/a-brainfk-interpreter/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/racket>Racket</a><a href=https://blog.jverkamp.com/2013/01/02/happy-new-year/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2012/12/22/nested-primes/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/scheme>Scheme</a><a href=https://blog.jverkamp.com/2013/01/02/happy-new-year/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2012/12/30/a-brainfk-interpreter/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/plt-games>PLT Games</a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2012/12/30/a-brainfk-interpreter/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/esolangs>Esolangs</a><a href=https://blog.jverkamp.com/2014/06/10/what-the-befunge/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2012/12/30/a-brainfk-interpreter/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2013/01/02/happy-new-year/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2012/12/31/confession-day-60/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2013/01/02/confession-day-61/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>Getting a bit close to the deadline, but I think I have something that&rsquo;s pretty interesting. Basically, it&rsquo;s the same BF interpreter that I wrote about <a href=https://blog.jverkamp.com/2012/12/30/a-brainfk-interpreter/>yesterday</a> with four additional commands:</p><table><thead><tr><th>&</th><th>Spawn a new thread; set the current cell to 0 in the parent and 1 in the child</th></tr></thead><tbody><tr><td>~</td><td>Kill the current thread</td></tr><tr><td>!</td><td>Send a ping on the channel specified by the current cell</td></tr><tr><td>?</td><td>Wait for a ping on the channel specified by the current cell</td></tr></tbody></table><p>Originally, the idea was the keep the threads in sync, running only a single step on each in turn, but in the end I decided just to directly go with Racket&rsquo;s <code>thread</code>s both for ease of implementation and because it more closely matches what I&rsquo;m actually trying to do.</p><p>If you&rsquo;d like to see full source code, you can do so <a href=https://github.com/jpverkamp/pbf/blob/master/pbf.rkt title="GitHub: pbf">on GitHub</a>. Otherwise, here are the new sections:</p><p>First, we have the new instruction <code>&amp;amp;</code> that is designed to spawn a new thread:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; spawn a new thread, set current cell to 0 in the parent and non-0 in the child</span>
</span></span><span style=display:flex><span>[(<span style=color:#e6db74>#\&amp;</span>)
</span></span><span style=display:flex><span> <span style=color:#75715e>; spawn the child process</span>
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>thread</span>
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>lambda </span>() (<span style=color:#a6e22e>step</span> (+ pc <span style=color:#ae81ff>1</span>) tape-left <span style=color:#ae81ff>1</span> tape-right)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>; step the parent process</span>
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>step</span> (+ pc <span style=color:#ae81ff>1</span>) tape-left <span style=color:#ae81ff>0</span> tape-right)]
</span></span></code></pre></div><p>That&rsquo;s one thing that I like about the provided <code>thread</code>s, all you have to do is pass it a thunk and it does the rest. So we&rsquo;ll spawn one process in a separate thread with 1 in the current cell and take a step while at the same time taking a step in the original thread. And that&rsquo;s it! The built in functionality will handle everything else for us.</p><p>Next, how do we kill off threads? That&rsquo;s even easier. Since we have the large <code>case</code> statement that&rsquo;s dealing with processing the input, all we have to do is break out of it (by returning <code>void</code> in this case):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; kill the current thread</span>
</span></span><span style=display:flex><span>[(<span style=color:#e6db74>#\~</span>)
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>void</span>)]
</span></span></code></pre></div><p>Now for the communication between threads. Optimally, I&rsquo;d like to have something that could actually send messages, but I couldn&rsquo;t figure out a good way to do that while only having a single variable at a time. Perhaps I could just send/receive the current cell? We&rsquo;ll see.</p><p>In any case, the model that I settled on is useful for synchronizing the threads. Basically, you can send a ping with <code>!</code> or wait for one with <code>?</code>.</p><p>But how does that work? First we need the channels of communication. I used a shared mutable hash:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; control communication on channels</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>channels (<span style=color:#a6e22e>make-hash</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; send a ping on a given channel</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>ping</span> i)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>hash-set!</span> channels i <span style=color:#66d9ef>#t</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; wait for a ping on a given channel</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; current a spinlock :(</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>pong</span> i)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>let </span>loop ()
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>if </span>(<span style=color:#a6e22e>hash-ref</span> channels i <span style=color:#66d9ef>#f</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>hash-remove!</span> channels i) 
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>loop</span>))))
</span></span></code></pre></div><p>This way <code>pong</code> will block until it receives a message from another thread. there are some potential issues in that <code>pong</code> isn&rsquo;t actually atomic so you could have two threads receive the same ping or not, non-deterministically. But that&rsquo;s half the fun of a Turing Tarpit isn&rsquo;t it? ðŸ˜„</p><p>With that, the code for <code>!</code> and <code>?</code> is straight forward:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; send a ping on a given channel</span>
</span></span><span style=display:flex><span>[(<span style=color:#e6db74>#\!</span>)
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>ping</span> tape-cell)
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>step</span> (+ pc <span style=color:#ae81ff>1</span>) tape-left tape-cell tape-right)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; receive a ping on a given channel</span>
</span></span><span style=display:flex><span>[(<span style=color:#e6db74>#\?</span>)
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>pong</span> tape-cell)
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>step</span> (+ pc <span style=color:#ae81ff>1</span>) tape-left tape-cell tape-right)]
</span></span></code></pre></div><p>And that&rsquo;s all there is to it. Now you can BF in parallel!</p><p>But what&rsquo;s it actually useful for?</p><p>Well, consider this example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>&amp;[</span>     spawn thread <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>echo <span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>+</span>     set cell <span style=color:#ae81ff>0</span> to <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>to ID the thread<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;&gt;+</span>   set cell <span style=color:#ae81ff>2</span> to <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;,</span>    read into cell <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>     <span style=color:#66d9ef>while</span> not EOF<span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>+.</span>    add <span style=color:#ae81ff>1</span> and echo
</span></span><span style=display:flex><span>  <span style=color:#f92672>&gt;+!</span>   set cell <span style=color:#ae81ff>2</span> to <span style=color:#ae81ff>2</span> and send a ping on <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>-?</span>    set cell <span style=color:#ae81ff>2</span> to <span style=color:#ae81ff>1</span> and wait <span style=color:#66d9ef>for</span> a ping on <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;,</span>    read into cell <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>~</span>     kill <span style=color:#66d9ef>this</span> thread
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&amp;[</span>     spawn thread <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>++</span>    set cell <span style=color:#ae81ff>0</span> to <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>to ID the thread<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;&gt;++?</span> set cell <span style=color:#ae81ff>2</span> to <span style=color:#ae81ff>2</span> and wait <span style=color:#66d9ef>for</span> a ping on <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;,</span>    read into cell <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>     <span style=color:#66d9ef>while</span> not EOF<span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>-.</span>    sub <span style=color:#ae81ff>1</span> and echo
</span></span><span style=display:flex><span>  <span style=color:#f92672>&gt;-!</span>   set cell <span style=color:#ae81ff>2</span> to <span style=color:#ae81ff>1</span> and send a ping on <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>+?</span>    set cell <span style=color:#ae81ff>2</span> to <span style=color:#ae81ff>2</span> and wait <span style=color:#66d9ef>for</span> a ping on <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;,</span>    read into cell <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>~</span>     kill <span style=color:#66d9ef>this</span> thread
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span></code></pre></div><p>What this will actually do is act as a close cousin to the cat program from yesterday. Instead of a single thread though, here we spawn two. The first will read input and add one to it before echoing. The second will subtract one. Using <code>!</code> and <code>?</code>, we&rsquo;ll make sure to alternate between the two. Yes, this could easily have been written without threads, but it was a good test to make sure I had everything working.</p><p>Here&rsquo;s an example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (<span style=color:#a6e22e>current-i/o-mode</span> <span style=color:#e6db74>&#39;numeric</span>)
</span></span><span style=display:flex><span>&gt; (<span style=color:#a6e22e>pbf</span> (<span style=color:#a6e22e>file-&gt;string</span> <span style=color:#e6db74>&#34;split-cat.pbf&#34;</span>))
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>11</span>
</span></span></code></pre></div><p>Even more fun, how about Hello World done in parallel? Essentially, we can have one thread for upper case letters, one for lower case, and one for the rest. That way we can move around and get everything read all at the same time:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>the goal<span style=color:#f92672>:</span>
</span></span><span style=display:flex><span> thread <span style=color:#ae81ff>0</span> outputs <span style=color:#e6db74>&#39;H&#39;</span> and sends <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> on <span style=color:#ae81ff>1</span> thread <span style=color:#ae81ff>1</span> outputs <span style=color:#960050;background-color:#1e0010>&#39;</span>ello<span style=color:#960050;background-color:#1e0010>&#39;</span> and sends <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span> on <span style=color:#ae81ff>2</span> thread <span style=color:#ae81ff>2</span> outputs <span style=color:#e6db74>&#39; &#39;</span> and sends <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span> on <span style=color:#ae81ff>3</span> thread <span style=color:#ae81ff>0</span> outputs <span style=color:#e6db74>&#39;W&#39;</span> and sends <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span> on <span style=color:#ae81ff>4</span> thread <span style=color:#ae81ff>1</span> outputs <span style=color:#960050;background-color:#1e0010>&#39;</span>orld<span style=color:#960050;background-color:#1e0010>&#39;</span> and sends <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span> on <span style=color:#ae81ff>5</span> thread <span style=color:#ae81ff>2</span> outputs bang
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&amp;[-</span>         spawn thread <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>for</span> H and W<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;</span>          go to cell <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>+++++++++</span>  set cell <span style=color:#ae81ff>1</span> to <span style=color:#ae81ff>9</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>          loop <span style=color:#66d9ef>while</span> cell <span style=color:#ae81ff>1</span> is not <span style=color:#ae81ff>0</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;++++++++</span>  add <span style=color:#ae81ff>8</span> to cell <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&gt;-</span>         subtract <span style=color:#ae81ff>1</span> from cell <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;.</span>         output cell <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>9</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>72</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;H&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;+!</span>        send a ping on <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>++</span>         set cell <span style=color:#ae81ff>2</span> to <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>          loop <span style=color:#66d9ef>while</span> cell <span style=color:#ae81ff>1</span> is not <span style=color:#ae81ff>0</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;+++++</span>     add <span style=color:#ae81ff>5</span> to cell <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&gt;-</span>         subtract <span style=color:#ae81ff>1</span> from cell <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>+++?</span>      wait <span style=color:#66d9ef>for</span> a ping on <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;.</span>        output cell <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>72</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>87</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;W&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;+!</span>        send a ping on <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>~</span>          kill <span style=color:#66d9ef>this</span> thread
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&amp;[-</span>         spawn thread <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>for</span> <span style=color:#960050;background-color:#1e0010>&#39;</span>ello<span style=color:#960050;background-color:#1e0010>&#39;</span> and <span style=color:#960050;background-color:#1e0010>&#39;</span>orld<span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;+++++</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>+++++</span>     add <span style=color:#ae81ff>10</span> to cell <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>          <span style=color:#66d9ef>while</span> cell <span style=color:#ae81ff>1</span> is not <span style=color:#ae81ff>0</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;+++++</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>+++++</span>    add <span style=color:#ae81ff>10</span> to cell <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&gt;-</span>        subtract <span style=color:#ae81ff>1</span> from cell <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;+</span>         add <span style=color:#ae81ff>1</span> to cell <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;+?</span>        wait <span style=color:#66d9ef>for</span> a ping on <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;.</span>         output cell <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>10</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>101</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;e&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>++++++..</span>   add <span style=color:#ae81ff>7</span> to cell <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>for</span> <span style=color:#ae81ff>108</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;l&#39;</span><span style=color:#f92672>)</span> and output twice
</span></span><span style=display:flex><span> <span style=color:#f92672>+++.</span>       add <span style=color:#ae81ff>3</span> to cell <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>for</span> <span style=color:#ae81ff>111</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;o&#39;</span><span style=color:#f92672>)</span> and output
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;+!</span>        send a ping on <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>++?</span>        wait <span style=color:#66d9ef>for</span> a ping on <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;.</span>         output cell <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span><span style=color:#e6db74>&#39;o&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>+++.</span>       add <span style=color:#ae81ff>3</span> and <span style=color:#a6e22e>output</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>114</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;r&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>------.</span>    subtract <span style=color:#ae81ff>6</span> and <span style=color:#a6e22e>output</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>108</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;l&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>--------.</span>  subtract <span style=color:#ae81ff>8</span> and <span style=color:#a6e22e>output</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>100</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;d&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;+!</span>        send a ping on <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>~</span>          kill <span style=color:#66d9ef>this</span> thread
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&amp;[-</span>         spawn thread <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#39; &#39;</span> and bang<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;++++</span>      set cell <span style=color:#ae81ff>1</span> to <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>          <span style=color:#66d9ef>while</span> cell <span style=color:#ae81ff>1</span> is not <span style=color:#ae81ff>0</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;++++++++</span>  add <span style=color:#ae81ff>8</span> to cell <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&gt;-</span>         subtract <span style=color:#ae81ff>1</span> from cell <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>++?</span>        wait <span style=color:#66d9ef>for</span> a ping on <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;.</span>         output cell <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;+!</span>        send a ping on <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;+</span>         add <span style=color:#ae81ff>1</span> to cell <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&gt;++?</span>       wait <span style=color:#66d9ef>for</span> a ping on <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;.</span>         output cell <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>32</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>33</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;!&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>~</span>          kill <span style=color:#66d9ef>this</span> thread
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Check it out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt;(<span style=color:#a6e22e>current-i/o-mode</span> <span style=color:#e6db74>&#39;unicode</span>)
</span></span><span style=display:flex><span>&gt; (<span style=color:#a6e22e>pbf</span> (<span style=color:#a6e22e>file-&gt;string</span> <span style=color:#e6db74>&#34;hello.pbf&#34;</span>))
</span></span><span style=display:flex><span>Hello World!
</span></span></code></pre></div><p>And that&rsquo;s that. You can see the entire project on GitHub <a href=https://github.com/jpverkamp/pbf title="GitHub: jpverkamp/pbf">here</a> or the competition from <a href=http://www.pltgames.com/competition/2012/12 title="PLT Games Competition December 2012">PLT Games here</a>.</p><p>This was actually pretty fun. I think I&rsquo;m going to have to try a few other variants in the future.</p></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>