<!doctype html><html><head><title>AoC 2018 Day 9: Marble Madness – jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_5823201688106629450.min.a38b80d356cf8bf4156ba2df63ffa25593fab82156591d1626626c75bc83394a.js integrity="sha256-o4uA01bPi/QVa6LfY/+iVZP6uCFWWR0WJmJsdbyDOUo=" defer></script>
<script src=/jquery.fancybox_6181813213021922412.min.769b3113e29a7df642b9426e9dace3b3499e1626944a7f98db68da3c1633cd23.js integrity="sha256-dpsxE+KaffZCuUJunazjs0meFiaUSn+Y22jaPBYzzSM=" defer></script>
<script src=/katex_12008035502722260518.min.1c3dce03daaf56a7d2fe0d0ec49bf35256837226f835adaf52c09502ef9bc5d1.js integrity="sha256-HD3OA9qvVqfS/g0OxJvzUlaDcib4Na2vUsCVAu+bxdE=" defer></script>
<script src=/bigfoot_8444447145154709333.min.5e80bd85ebaeb95607834d6777bfe7013d1d161f0f02a31b845e4bd765898316.js integrity="sha256-XoC9heuuuVYHg01nd7/nAT0dFh8PAqMbhF5L12WJgxY=" defer></script>
<script src=/mermaid_12365941879912544862.min.2b035670bce6e6394692a10248ec2f5abcfd2e5fafb0149895b6c901673bca7f.js integrity="sha256-KwNWcLzm5jlGkqECSOwvWrz9Ll+vsBSYlbbJAWc7yn8=" defer></script>
<script src=/main.min.982c2d7bb434b4cf8b19c2cf38ef7e7f7162ddbed610e5bdddbb937001e26574.js integrity="sha256-mCwte7Q0tM+LGcLPOO9+f3Fi3b7WEOW93buTcAHiZXQ=" defer></script>
<link rel=stylesheet href=/katex_14163593549783030822.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_16482899066638414220.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_16222217791602823071.min.e28b5d7d9d89efacb5f708ac30cbd76b1b9a0f816dfd9da96631d1d09cbbdd76.css integrity="sha256-4otdfZ2J76y19wisMMvXaxuaD4Ft/Z2pZjHR0Jy73XY="><link rel=stylesheet href=/css_4780214198035419921.min.246b6f8e7620eeb717bca5e7b121037906e5dfaa05805f427fcc5a09b6c99f5c.css integrity="sha256-JGtvjnYg7rcXvKXnsSEDeQbl36oFgF9Cf8xaCbbJn1w="><link rel=stylesheet href=/main.min.1a5fbab1ecff843d4ee6e936243fb06066197cd8c9357883d791333ce6001f3b.css integrity="sha256-Gl+6sez/hD1O5uk2JD+wYGYZfNjJNXiD15EzPOYAHzs="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=//www.google.com/search method=get onsubmit='(function(e){e.q.value="site:blog.jverkamp.com "+e.qfront.value})(this)' class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=hidden>
<input name=qfront type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article><header><h1 class=entry-title>AoC 2018 Day 9: Marble Madness</h1><div class=entry-meta><span class=entry-date>2018-12-09</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2018/12/08/aoc-2018-day-8-checksum-treeification/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/racket>Racket</a><a href=https://blog.jverkamp.com/2018/12/10/aoc-2018-day-10-its-full-of-stars/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2018/12/08/aoc-2018-day-8-checksum-treeification/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/advent-of-code>Advent of Code</a><a href=https://blog.jverkamp.com/2018/12/10/aoc-2018-day-10-its-full-of-stars/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/series/>Series</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2018/12/08/aoc-2018-day-8-checksum-treeification/ class=previous-link></a><a class=taxonomy-value href=/series/advent-of-code-2018>Advent of Code 2018</a><a href=https://blog.jverkamp.com/2018/12/10/aoc-2018-day-10-its-full-of-stars/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2018/12/08/aoc-2018-day-8-checksum-treeification/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2018/12/10/aoc-2018-day-10-its-full-of-stars/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2018/12/09/predators-gold/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2018/12/10/aoc-2018-day-10-its-full-of-stars/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><h3 id=source-marble-maniahttpsadventofcodecom2018day9>Source: <a href=https://adventofcode.com/2018/day/9>Marble Mania</a></h3><blockquote><p><strong>Part 1:</strong> Place marbles in a circle such that each marble is placed by skipping one place <em>except</em> for marbles divisible by 23. For those, don&rsquo;t place them, skip back 7 places, and remove that marble as well. Add these two marbles to your current score.</p></blockquote><blockquote><p>Given a specific player count and last marble, what&rsquo;s the highest score?</p></blockquote><p>Well. That&rsquo;s a thing. What this problem really comes down to is a custom data structure problem. What we want is a <a href=https://en.wikipedia.org/wiki/circular%20list>circular list</a>, where you can spin the list forward or backwards and efficiently add/remove the item at the first element of the list.</p><p>Since Racket doesn&rsquo;t seem to have a data structure exactly like this, what I&rsquo;m going to do is create my own by combining two lists. Essentially, we&rsquo;ll have a list of items before (<code>prev</code>) to the current <code>head</code> of the list (stored in reverse order) and another for items after (<code>next</code>) the current <code>head</code>. As we move forward, we move items from <code>next</code> to <code>prev</code> and backwards is the reverse. If either list runs out, you can refresh it by applying a <code>reverse</code> to its partner list. <code>reverse</code> is expensive, but you only rarely need to do it (depending on performance) leading to a decent <a href=https://en.wikipedia.org/wiki/amortized%20analysis>amortized runtime</a>. Fun times.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span><span style=color:#f92672>#lang </span>racket
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>provide</span> (<span style=color:#66d9ef>all-defined-out</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>struct</span> circular-list (prev next)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>#:transparent</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>#:methods</span> <span style=color:#66d9ef>gen:custom-write</span>
</span></span><span style=display:flex><span>  [(<span style=color:#66d9ef>define</span> write-proc
</span></span><span style=display:flex><span>     (<span style=color:#66d9ef>λ</span> (cls out depth)
</span></span><span style=display:flex><span>       (fprintf out <span style=color:#e6db74>&#34;#&lt;circular-list ~a&gt;&#34;</span> (circular-list-&gt;list cls))))])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Create an empty circular list</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define</span> (make-circular-list)
</span></span><span style=display:flex><span>  (circular-list <span style=color:#f92672>&#39;</span>() <span style=color:#f92672>&#39;</span>()))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Turn a list into a circular list</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define</span> (list-&gt;circular-list ls)
</span></span><span style=display:flex><span>  (circular-list <span style=color:#f92672>&#39;</span>() ls))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Turn a circular list back into a regular one at the current point</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define</span> (circular-list-&gt;list cls)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>match-define</span> (circular-list prev next) cls)
</span></span><span style=display:flex><span>  (append next (reverse prev)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Test if a circular list contains no elements</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define</span> (circular-list-empty? cls)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>match-define</span> (circular-list prev next) cls)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>and</span> (null? prev) (null? next)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Get size of a circular-list</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define</span> (circular-list-length cls)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>match-define</span> (circular-list prev next) cls)
</span></span><span style=display:flex><span>  (+ (length prev) (length next)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Look at the current first item of a circular list</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define</span> (circular-list-peek cls)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>match-define</span> (circular-list prev next) cls)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>cond</span>
</span></span><span style=display:flex><span>    [(null? next) (last prev)]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>else</span> (first next)]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Add a new item to the head of a circular list</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define</span> (circular-list-push cls value)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>match-define</span> (circular-list prev next) cls)
</span></span><span style=display:flex><span>  (circular-list (list* value prev) next))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Remove the current head of a circular list</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define</span> (circular-list-pop cls)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>match-define</span> (circular-list prev next) cls)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>cond</span>
</span></span><span style=display:flex><span>    [(null? next)
</span></span><span style=display:flex><span>     (<span style=color:#66d9ef>define</span> next (reverse prev))
</span></span><span style=display:flex><span>     (circular-list <span style=color:#f92672>&#39;</span>() (rest next))]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>     (circular-list prev (rest next))]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Rotate a circular list n positions</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Positive numbers rotate &#39;forward&#39;, negative &#39;backwards&#39;</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define</span> (circular-list-rotate cls [steps <span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>match-define</span> (circular-list prev next) cls)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>let</span> loop ([prev (circular-list-prev cls)]
</span></span><span style=display:flex><span>             [next (circular-list-next cls)]
</span></span><span style=display:flex><span>             [steps steps])
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>cond</span>
</span></span><span style=display:flex><span>      [(zero? steps) (circular-list prev next)]
</span></span><span style=display:flex><span>      [(negative? steps)
</span></span><span style=display:flex><span>       (<span style=color:#66d9ef>cond</span>
</span></span><span style=display:flex><span>         [(null? prev)
</span></span><span style=display:flex><span>          (<span style=color:#66d9ef>define</span> prev (reverse next))
</span></span><span style=display:flex><span>          (loop (rest prev) (list (first prev)) (add1 steps))]
</span></span><span style=display:flex><span>         [<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>          (loop (rest prev) (list* (first prev) next) (add1 steps))])]
</span></span><span style=display:flex><span>      [<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>       (<span style=color:#66d9ef>cond</span>
</span></span><span style=display:flex><span>         [(null? next)
</span></span><span style=display:flex><span>          (<span style=color:#66d9ef>define</span> next (reverse prev))
</span></span><span style=display:flex><span>          (loop (list (first next)) (rest next) (sub1 steps))]
</span></span><span style=display:flex><span>         [<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>          (loop (list* (first next) prev) (rest next) (sub1 steps))])])))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Rotate a circular list until the head matches the given prediate</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define</span> (circular-list-rotate-until cls pred?)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>let</span> loop ([length (circular-list-length cls)]
</span></span><span style=display:flex><span>             [cls cls])
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>cond</span>
</span></span><span style=display:flex><span>      [(<span style=color:#66d9ef>or</span> (zero? length)
</span></span><span style=display:flex><span>           (pred? (circular-list-peek cls)))
</span></span><span style=display:flex><span>       cls]
</span></span><span style=display:flex><span>      [<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>       (loop (sub1 length)
</span></span><span style=display:flex><span>             (circular-list-rotate cls <span style=color:#ae81ff>-1</span>))])))
</span></span></code></pre></div><p>That&rsquo;s a bit of code. <code>circular-list-rotate</code> is by far the most interesting code (since it has to handle reversing the lists), but hopefully still worth it.</p><p>Ironically, the code I had a bug in for the longest time? <code>circular-list-peek</code>. When all of the data was in <code>prev</code>, I was taking the <code>first</code> instead of <code>last</code> element&mldr; Oops. Works much better when you do it correctly.</p><p>With all that code, the solution is hopefully not nearly as complicated:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span>(<span style=color:#66d9ef>let</span> loop ([players (list-&gt;circular-list (range <span style=color:#ae81ff>1</span> (add1 (players))))]
</span></span><span style=display:flex><span>           [scores (hash)]
</span></span><span style=display:flex><span>           [table (list-&gt;circular-list <span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>0</span>))]
</span></span><span style=display:flex><span>           [marble <span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>cond</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Used up the last marble, output scores</span>
</span></span><span style=display:flex><span>    [(= marble (add1 (last-marble)))
</span></span><span style=display:flex><span>     (apply max (hash-values scores))]
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Marbles divisible by 23 scores 23 + removes the marble 7 ago</span>
</span></span><span style=display:flex><span>    [(= <span style=color:#ae81ff>0</span> (remainder marble <span style=color:#ae81ff>23</span>))
</span></span><span style=display:flex><span>     (<span style=color:#66d9ef>let*</span> ([table (circular-list-rotate table <span style=color:#ae81ff>-8</span>)]
</span></span><span style=display:flex><span>            [score (+ (circular-list-peek table) marble)]
</span></span><span style=display:flex><span>            [table (circular-list-pop table)]
</span></span><span style=display:flex><span>            [table (circular-list-rotate table <span style=color:#ae81ff>1</span>)])
</span></span><span style=display:flex><span>       (loop (circular-list-rotate players)
</span></span><span style=display:flex><span>             (hash-update scores (circular-list-peek players) (curry + score) <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>             table
</span></span><span style=display:flex><span>             (add1 marble)))]
</span></span><span style=display:flex><span>    <span style=color:#75715e>; All other marbles skip 1 and insert the marble</span>
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>     (loop (circular-list-rotate players)
</span></span><span style=display:flex><span>           scores
</span></span><span style=display:flex><span>           (circular-list-push (circular-list-rotate table) marble)
</span></span><span style=display:flex><span>           (add1 marble))]))
</span></span></code></pre></div><p>Well look at that.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ racket marble-madness.rkt --players <span style=color:#ae81ff>477</span> --stop-at <span style=color:#ae81ff>70851</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>374690</span>
</span></span></code></pre></div><p>I did create a print function that prints more or less the same thing in the problem statement to help debug:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span>(<span style=color:#66d9ef>let</span> loop ([players (list-&gt;circular-list (range <span style=color:#ae81ff>1</span> (add1 (players))))]
</span></span><span style=display:flex><span>           [scores (hash)]
</span></span><span style=display:flex><span>           [table (list-&gt;circular-list <span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>0</span>))]
</span></span><span style=display:flex><span>           [marble <span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>when</span> (debug)
</span></span><span style=display:flex><span>    (printf <span style=color:#e6db74>&#34;[~a] [head:~a] ~a</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>            (circular-list-peek players)
</span></span><span style=display:flex><span>            (circular-list-peek (circular-list-rotate table))
</span></span><span style=display:flex><span>            (circular-list-rotate-until table zero?)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>...</span>)
</span></span></code></pre></div><p>Pretty handy:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span>$ racket marble-madness.rkt --players <span style=color:#ae81ff>9</span> --stop-at <span style=color:#ae81ff>26</span> --debug
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>1</span>] [head:0] #&lt;circular-list (<span style=color:#ae81ff>0</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2</span>] [head:1] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>1</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>3</span>] [head:0] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>1</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>4</span>] [head:2] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>3</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>5</span>] [head:1] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>3</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>6</span>] [head:3] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>3</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>7</span>] [head:0] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>3</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>8</span>] [head:4] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>7</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>9</span>] [head:2] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>7</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>1</span>] [head:5] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>7</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2</span>] [head:1] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>7</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>3</span>] [head:6] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>7</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>4</span>] [head:3] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>7</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>5</span>] [head:7] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>7</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>6</span>] [head:0] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>7</span>] [head:8] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>8</span>] [head:4] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>9</span>] [head:9] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>1</span>] [head:2] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>18</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2</span>] [head:10] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>18</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>3</span>] [head:5] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>18</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>4</span>] [head:11] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>18</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>21</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>5</span>] [head:1] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>18</span> <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>21</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>22</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>6</span>] [head:20] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>18</span> <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>21</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>22</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>7</span>] [head:10] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>18</span> <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>24</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>21</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>22</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>8</span>] [head:21] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>18</span> <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>24</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>25</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>21</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>22</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>9</span>] [head:5] #&lt;circular-list (<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>18</span> <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>24</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>25</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>26</span> <span style=color:#ae81ff>21</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>22</span> <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>15</span>)&gt;
</span></span><span style=display:flex><span><span style=color:#ae81ff>32</span>
</span></span></code></pre></div><p>Being able to visualize a problem helps a lot&mldr;</p><blockquote><p><strong>Part 2:</strong> Try again with 100x as many marbles.</p></blockquote><p>If part 1 was solved efficiently (which is why I spent a while on <code>circular-list</code> in the first place&mldr;), this is just a matter of running it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ racket marble-madness.rkt --players <span style=color:#ae81ff>477</span> --stop-at <span style=color:#ae81ff>7085100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3009951158</span>
</span></span></code></pre></div></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>