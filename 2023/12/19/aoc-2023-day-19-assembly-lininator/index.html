<!doctype html><html><head><title>AoC 2023 Day 19: Assembly Lininator â€“ jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_17422284542669262002.min.834c1e2313951f0c25b90152fe8b62250eab4a2e8cbd2560fa1a1cdc91c71733.js integrity="sha256-g0weIxOVHwwluQFS/otiJQ6rSi6MvSVg+hoc3JHHFzM=" defer></script><script src=/jquery.fancybox_16245765822111608191.min.ef050764ff69f3287c89ff655825479dd8304dcd9bc653d1ddd4772a701ad445.js integrity="sha256-7wUHZP9p8yh8if9lWCVHndgwTc2bxlPR3dR3KnAa1EU=" defer></script><script src=/katex_17296078054267651618.min.deed0e78a77391517d530a00324ce7b760ac204134992ef22d36f583615ae498.js integrity="sha256-3u0OeKdzkVF9UwoAMkznt2CsIEE0mS7yLTb1g2Fa5Jg=" defer></script><script src=/auto-render_14944144240389301023.min.e694d9d5eae2917984179683ead27b998784a81398e8836c369373d2c67fc32a.js integrity="sha256-5pTZ1erikXmEF5aD6tJ7mYeEqBOY6INsNpNz0sZ/wyo=" defer></script><script src=/bigfoot_28293813221957978.min.af671f08986f0a2267c5a0cb2748b005489e47fa25f55479b200e2a563d23022.js integrity="sha256-r2cfCJhvCiJnxaDLJ0iwBUieR/ol9VR5sgDipWPSMCI=" defer></script><script src=/mermaid_9520146763733687737.min.bfe50b47c0387e3c3bf97ec5f338bba94f7ccb02f962a4aec8cf0b4d68c8434d.js integrity="sha256-v+ULR8A4fjw7+X7F8zi7qU98ywL5YqSuyM8LTWjIQ00=" defer></script><script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script><link rel=stylesheet href=/katex_13658330645258633971.min.64e42891d651aee0b8cd02ec9227ff271d37bcf06dae985d1acf0eba1623e850.css integrity="sha256-ZOQokdZRruC4zQLskif/Jx03vPBtrphdGs8OuhYj6FA="><link rel=stylesheet href=/bigfoot-default_8781527669040159104.min.0d2b289fa3451447692959fcee5676b846532fe7ab50ddc4660824c42d4adcd7.css integrity="sha256-DSson6NFFEdpKVn87lZ2uEZTL+erUN3EZggkxC1K3Nc="><link rel=stylesheet href=/jquery.fancybox_5330465509389191777.min.67505d77381ebd82623ab9296c1989c44ec828d867c00296e80e52ef860cac37.css integrity="sha256-Z1BddzgevYJiOrkpbBmJxE7IKNhnwAKW6A5S74YMrDc="><link rel=stylesheet href=/css_1846377409604050217.min.fffe842bc000dd1fe8661ac6427a392a08faa95e8edab1ea7fb98c5f8dac6a6f.css integrity="sha256-//6EK8AA3R/oZhrGQno5Kgj6qV6O2rHqf7mMX42sam8="><link rel=stylesheet href=/main.min.34a34d86b8aae11b989d80a1626629c053029d012419a1993cfb6c12ea175737.css integrity="sha256-NKNNhriq4RuYnYChYmYpwFMCnQEkGaGZPPtsEuoXVzc="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/home-automation/>Home Automation</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>AoC 2023 Day 19: Assembly Lininator</h1><div class=entry-meta><span class=entry-date>2023-12-19</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2023/12/18/aoc-2023-day-18-flood-fillinator/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/rust>Rust</a><a href=https://blog.jverkamp.com/2023/12/20/aoc-2023-day-20-flip-flopinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2023/12/18/aoc-2023-day-18-flood-fillinator/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/advent-of-code>Advent of Code</a><a href=https://blog.jverkamp.com/2023/12/20/aoc-2023-day-20-flip-flopinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/series/>Series</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2023/12/18/aoc-2023-day-18-flood-fillinator/ class=previous-link></a><a class=taxonomy-value href=/series/advent-of-code-2023>Advent of Code 2023</a><a href=https://blog.jverkamp.com/2023/12/20/aoc-2023-day-20-flip-flopinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2023/12/18/aoc-2023-day-18-flood-fillinator/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2023/12/20/aoc-2023-day-20-flip-flopinator/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2023/12/19/broken-soul/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2023/12/20/heidi/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><h2 id=source-day-19-aplenty>Source: <a href=https://adventofcode.com/2023/day/19 target=_blank rel=noopener>Day 19: Aplenty</a></h2><p><a href=https://github.com/jpverkamp/advent-of-code/tree/master/2023/solutions/day19 target=_blank rel=noopener>Full solution</a> for today (spoilers!)</p><nav id=TableOfContents><ul><li><a href=#source-day-19-aplenty>Source: <a href=https://adventofcode.com/2023/day/19>Day 19: Aplenty</a></a></li><li><a href=#part-1>Part 1</a><ul><li><a href=#types-and-parsing>Types and Parsing</a></li><li><a href=#simulation>Simulation</a></li></ul></li><li><a href=#part-2>Part 2</a><ul><li><a href=#brute-force>Brute Force</a></li><li><a href=#ranges>Ranges</a></li></ul></li><li><a href=#performance>Performance</a></li></ul></nav><h2 id=part-1>Part 1</h2><blockquote><p>You are given a series of parts with 4 ratings as such:</p><p><code>{x=787,m=2655,a=1222,s=2876}</code></p><p>In addition, you are given a series of rules describing a graph as such:</p><p><code>px{a&lt;2006:qkq,m>2090:A,rfg}</code></p><p>In this example, if you are at the node <code>px</code>, if <code>a &lt; 2006</code>, move to <code>qkq</code>. Otherwise, if <code>m > 2090</code> move to <code>A</code>. If no other case matches, the last defaults to <code>rfg</code>.</p><p><code>A</code> and <code>R</code> are special cases for accept and reject.</p><p>Calculate the sum of sum of all four ratings for all nodes that end at <code>Accept</code>.</p></blockquote><h3 id=types-and-parsing>Types and Parsing</h3><p>That&rsquo;s a really long problem description. Reminds me of <a href=https://blog.jverkamp.com/2023/12/05/aoc-2023-day-5-growinator/>day 5</a> Let&rsquo;s write up an equally long set of types and parsers!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#[derive(Debug, Copy, Clone, Eq, PartialEq, Hash)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>Label</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>&#39;a</span><span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    Input,
</span></span><span style=display:flex><span>    Accept,
</span></span><span style=display:flex><span>    Reject,
</span></span><span style=display:flex><span>    Node(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>&#39;a</span> <span style=color:#66d9ef>str</span>),
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#[derive(Debug, Copy, Clone)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>RatingCategory</span> {
</span></span><span style=display:flex><span>    X,
</span></span><span style=display:flex><span>    M,
</span></span><span style=display:flex><span>    A,
</span></span><span style=display:flex><span>    S,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#[derive(Debug, Copy, Clone)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Part</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> x: <span style=color:#66d9ef>u64</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> m: <span style=color:#66d9ef>u64</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> a: <span style=color:#66d9ef>u64</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> s: <span style=color:#66d9ef>u64</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#[derive(Debug, Copy, Clone)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>Comparator</span> {
</span></span><span style=display:flex><span>    LessThan,
</span></span><span style=display:flex><span>    GreaterThan,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#[derive(Debug, Copy, Clone)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Comparison</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>&#39;a</span><span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> category: <span style=color:#a6e22e>RatingCategory</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> comparator: <span style=color:#a6e22e>Comparator</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> value: <span style=color:#66d9ef>u64</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> label: <span style=color:#a6e22e>Label</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>&#39;a</span><span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#[derive(Debug)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Rule</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>&#39;a</span><span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> label: <span style=color:#a6e22e>Label</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>&#39;a</span><span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> comparisons: Vec<span style=color:#f92672>&lt;</span>Comparison<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>&#39;a</span><span style=color:#f92672>&gt;&gt;</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> default: <span style=color:#a6e22e>Label</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>&#39;a</span><span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>nom</code> it up:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// A category for part ratings, always a literal char from &#39;xmas&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>rating_category</span>(input: <span style=color:#66d9ef>&amp;</span><span style=color:#66d9ef>str</span>) -&gt; <span style=color:#a6e22e>IResult</span><span style=color:#f92672>&lt;&amp;</span><span style=color:#66d9ef>str</span>, RatingCategory<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    alt((
</span></span><span style=display:flex><span>        map(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;x&#39;</span>), <span style=color:#f92672>|</span>_<span style=color:#f92672>|</span> RatingCategory::X),
</span></span><span style=display:flex><span>        map(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;m&#39;</span>), <span style=color:#f92672>|</span>_<span style=color:#f92672>|</span> RatingCategory::M),
</span></span><span style=display:flex><span>        map(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;a&#39;</span>), <span style=color:#f92672>|</span>_<span style=color:#f92672>|</span> RatingCategory::A),
</span></span><span style=display:flex><span>        map(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;s&#39;</span>), <span style=color:#f92672>|</span>_<span style=color:#f92672>|</span> RatingCategory::S),
</span></span><span style=display:flex><span>    ))(input)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// A label for a rule or part, an alphabetic string or the literals A and R
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>label</span>(input: <span style=color:#66d9ef>&amp;</span><span style=color:#66d9ef>str</span>) -&gt; <span style=color:#a6e22e>IResult</span><span style=color:#f92672>&lt;&amp;</span><span style=color:#66d9ef>str</span>, Label<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    alt((
</span></span><span style=display:flex><span>        map(tag(<span style=color:#e6db74>&#34;in&#34;</span>), <span style=color:#f92672>|</span>_<span style=color:#f92672>|</span> Label::Input),
</span></span><span style=display:flex><span>        map(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;A&#39;</span>), <span style=color:#f92672>|</span>_<span style=color:#f92672>|</span> Label::Accept),
</span></span><span style=display:flex><span>        map(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;R&#39;</span>), <span style=color:#f92672>|</span>_<span style=color:#f92672>|</span> Label::Reject),
</span></span><span style=display:flex><span>        map(alpha1, Label::Node),
</span></span><span style=display:flex><span>    ))(input)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Comparison operators
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>comparator</span>(input: <span style=color:#66d9ef>&amp;</span><span style=color:#66d9ef>str</span>) -&gt; <span style=color:#a6e22e>IResult</span><span style=color:#f92672>&lt;&amp;</span><span style=color:#66d9ef>str</span>, Comparator<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    alt((
</span></span><span style=display:flex><span>        map(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;&lt;&#39;</span>), <span style=color:#f92672>|</span>_<span style=color:#f92672>|</span> Comparator::LessThan),
</span></span><span style=display:flex><span>        map(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;&gt;&#39;</span>), <span style=color:#f92672>|</span>_<span style=color:#f92672>|</span> Comparator::GreaterThan),
</span></span><span style=display:flex><span>    ))(input)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// A comparison takes a rating category, comparator, and a value
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>comparison</span>(input: <span style=color:#66d9ef>&amp;</span><span style=color:#66d9ef>str</span>) -&gt; <span style=color:#a6e22e>IResult</span><span style=color:#f92672>&lt;&amp;</span><span style=color:#66d9ef>str</span>, Comparison<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> (input, (category, comparator, value, label)) <span style=color:#f92672>=</span> tuple((
</span></span><span style=display:flex><span>        rating_category,
</span></span><span style=display:flex><span>        comparator,
</span></span><span style=display:flex><span>        complete::<span style=color:#66d9ef>u64</span>,
</span></span><span style=display:flex><span>        preceded(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;:&#39;</span>), label),
</span></span><span style=display:flex><span>    ))(input)<span style=color:#f92672>?</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Ok((
</span></span><span style=display:flex><span>        input,
</span></span><span style=display:flex><span>        Comparison {
</span></span><span style=display:flex><span>            category,
</span></span><span style=display:flex><span>            comparator,
</span></span><span style=display:flex><span>            value,
</span></span><span style=display:flex><span>            label,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    ))
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// A rule has a label, a list of comparisons, and a default if no comparison matches
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>rule</span>(input: <span style=color:#66d9ef>&amp;</span><span style=color:#66d9ef>str</span>) -&gt; <span style=color:#a6e22e>IResult</span><span style=color:#f92672>&lt;&amp;</span><span style=color:#66d9ef>str</span>, Rule<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> (input, (label, comparisons, default)) <span style=color:#f92672>=</span> tuple((
</span></span><span style=display:flex><span>        label,
</span></span><span style=display:flex><span>        preceded(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;{&#39;</span>), separated_list1(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;,&#39;</span>), comparison)),
</span></span><span style=display:flex><span>        delimited(<span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;,&#39;</span>), label, <span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;}&#39;</span>)),
</span></span><span style=display:flex><span>    ))(input)<span style=color:#f92672>?</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Ok((
</span></span><span style=display:flex><span>        input,
</span></span><span style=display:flex><span>        Rule {
</span></span><span style=display:flex><span>            label,
</span></span><span style=display:flex><span>            comparisons,
</span></span><span style=display:flex><span>            default,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    ))
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// A part has a score for each of the four rating categories
</span></span></span><span style=display:flex><span><span style=color:#75715e>// For now, assume they are ordered
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>part</span>(input: <span style=color:#66d9ef>&amp;</span><span style=color:#66d9ef>str</span>) -&gt; <span style=color:#a6e22e>IResult</span><span style=color:#f92672>&lt;&amp;</span><span style=color:#66d9ef>str</span>, Part<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> (input, (x, m, a, s)) <span style=color:#f92672>=</span> delimited(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;{&#39;</span>),
</span></span><span style=display:flex><span>        tuple((
</span></span><span style=display:flex><span>            preceded(tag(<span style=color:#e6db74>&#34;x=&#34;</span>), complete::<span style=color:#66d9ef>u64</span>),
</span></span><span style=display:flex><span>            preceded(tag(<span style=color:#e6db74>&#34;,m=&#34;</span>), complete::<span style=color:#66d9ef>u64</span>),
</span></span><span style=display:flex><span>            preceded(tag(<span style=color:#e6db74>&#34;,a=&#34;</span>), complete::<span style=color:#66d9ef>u64</span>),
</span></span><span style=display:flex><span>            preceded(tag(<span style=color:#e6db74>&#34;,s=&#34;</span>), complete::<span style=color:#66d9ef>u64</span>),
</span></span><span style=display:flex><span>        )),
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;}&#39;</span>),
</span></span><span style=display:flex><span>    )(input)<span style=color:#f92672>?</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Ok((input, Part { x, m, a, s }))
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// A simulation contains a list of rules and a list of parts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>simulation</span>(input: <span style=color:#66d9ef>&amp;</span><span style=color:#66d9ef>str</span>) -&gt; <span style=color:#a6e22e>IResult</span><span style=color:#f92672>&lt;&amp;</span><span style=color:#66d9ef>str</span>, (FxHashMap<span style=color:#f92672>&lt;</span>Label, Rule<span style=color:#f92672>&gt;</span>, Vec<span style=color:#f92672>&lt;</span>Part<span style=color:#f92672>&gt;</span>)<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> (input, (rules, parts)) <span style=color:#f92672>=</span> separated_pair(
</span></span><span style=display:flex><span>        separated_list1(line_ending, rule),
</span></span><span style=display:flex><span>        many1(line_ending),
</span></span><span style=display:flex><span>        separated_list1(line_ending, part),
</span></span><span style=display:flex><span>    )(input)<span style=color:#f92672>?</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> rules <span style=color:#f92672>=</span> rules
</span></span><span style=display:flex><span>        .into_iter()
</span></span><span style=display:flex><span>        .map(<span style=color:#f92672>|</span>r<span style=color:#f92672>|</span> (r.label, r))
</span></span><span style=display:flex><span>        .collect::<span style=color:#f92672>&lt;</span>FxHashMap<span style=color:#f92672>&lt;</span>_, _<span style=color:#f92672>&gt;&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Ok((input, (rules, parts)))
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>There&rsquo;s a lot there, but hopefully by breaking it down into lots of little pieces it&rsquo;s fairly straight forward?</p><h3 id=simulation>Simulation</h3><p>Okay, we have our types, how do we actually run the simulation?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() -&gt; Result<span style=color:#f92672>&lt;</span>()<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> stdin <span style=color:#f92672>=</span> io::stdin();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> input <span style=color:#f92672>=</span> io::read_to_string(stdin.lock())<span style=color:#f92672>?</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> (s, (rules, parts)) <span style=color:#f92672>=</span> parse::simulation(<span style=color:#f92672>&amp;</span>input).unwrap();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>assert_eq!</span>(s.trim(), <span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> result <span style=color:#f92672>=</span> parts
</span></span><span style=display:flex><span>        .iter()
</span></span><span style=display:flex><span>        .filter_map(<span style=color:#f92672>|</span>part<span style=color:#f92672>|</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> label <span style=color:#f92672>=</span> Label::Input;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>loop</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> rule <span style=color:#f92672>=</span> rules.get(<span style=color:#f92672>&amp;</span>label).unwrap();
</span></span><span style=display:flex><span>                label <span style=color:#f92672>=</span> rule.default;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> comparison <span style=color:#66d9ef>in</span> rule.comparisons.iter() {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>let</span> value <span style=color:#f92672>=</span> <span style=color:#66d9ef>match</span> comparison.category {
</span></span><span style=display:flex><span>                        RatingCategory::X <span style=color:#f92672>=&gt;</span> part.x,
</span></span><span style=display:flex><span>                        RatingCategory::M <span style=color:#f92672>=&gt;</span> part.m,
</span></span><span style=display:flex><span>                        RatingCategory::A <span style=color:#f92672>=&gt;</span> part.a,
</span></span><span style=display:flex><span>                        RatingCategory::S <span style=color:#f92672>=&gt;</span> part.s,
</span></span><span style=display:flex><span>                    };
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>match</span> comparison.comparator {
</span></span><span style=display:flex><span>                        Comparator::LessThan <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>if</span> value <span style=color:#f92672>&lt;</span> comparison.value {
</span></span><span style=display:flex><span>                                label <span style=color:#f92672>=</span> comparison.label;
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                        Comparator::GreaterThan <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>if</span> value <span style=color:#f92672>&gt;</span> comparison.value {
</span></span><span style=display:flex><span>                                label <span style=color:#f92672>=</span> comparison.label;
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> label <span style=color:#f92672>==</span> Label::Accept {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> Some(part);
</span></span><span style=display:flex><span>                } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> label <span style=color:#f92672>==</span> Label::Reject {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> None;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        .map(<span style=color:#f92672>|</span>part<span style=color:#f92672>|</span> part.x <span style=color:#f92672>+</span> part.m <span style=color:#f92672>+</span> part.a <span style=color:#f92672>+</span> part.s)
</span></span><span style=display:flex><span>        .sum::<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u64</span><span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>println!</span>(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{result}</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    Ok(())
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>I like this. Most of the work is done in a <code>loop</code> inside of the <code>filter_map</code>. The goal is to <code>None</code> for <code>Reject</code>, so it will be removed and we&rsquo;ll only have <code>Accept</code> left. Just hope there aren&rsquo;t any infinite loops &#x1f604;.</p><p>It&rsquo;s interesting how verbose unpacking the categories and comparators ended up being. That certainly does walk the line between being more specific and being more concise. I&rsquo;m not entirely sure which way it falls for me.</p><p>But in the end, it works and it&rsquo;s quick! Onward.</p><h2 id=part-2>Part 2</h2><blockquote><p>Allow each of the ratings (<code>xmas</code>) to vary from <code>1..=4000</code>. How many of these 256 trillion possibilities end in accept?</p></blockquote><h3 id=brute-force>Brute Force</h3><p>Well&mldr; you could brute force it!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>let</span> result <span style=color:#f92672>=</span> values
</span></span><span style=display:flex><span>    .clone()
</span></span><span style=display:flex><span>    .cartesian_product(values.clone())
</span></span><span style=display:flex><span>    .inspect(<span style=color:#f92672>|</span>v<span style=color:#f92672>|</span> <span style=color:#a6e22e>println!</span>(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{v:?}</span><span style=color:#e6db74> in </span><span style=color:#e6db74>{sec:?}</span><span style=color:#e6db74>&#34;</span>, sec <span style=color:#f92672>=</span> start.elapsed()))
</span></span><span style=display:flex><span>    .cartesian_product(values.clone())
</span></span><span style=display:flex><span>    .cartesian_product(values.clone())
</span></span><span style=display:flex><span>    .flat_map(<span style=color:#f92672>|</span>(((x, m), a), s)<span style=color:#f92672>|</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> part <span style=color:#f92672>=</span> Part { x, m, a, s };
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> label <span style=color:#f92672>=</span> Label::Input;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    })
</span></span><span style=display:flex><span>    .count();
</span></span></code></pre></div><p>I stuck that <code>inspect</code> in to show me just how slow this is going&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>334</span>ns
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>555.949417</span>ms
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>) <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>1.071667792</span>s
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>) <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>1.592958542</span>s
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>) <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>2.119584709</span>s
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>) <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>2.644092709</span>s
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>7</span>) <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>3.170371959</span>s
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>8</span>) <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>3.694674</span>s
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>9</span>) <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>4.219525959</span>s
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>10</span>) <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>4.744019417</span>s
</span></span></code></pre></div><p>Each of those is ~16 million, so we&rsquo;re running at about 33 MHz. That&rsquo;s&mldr; 87 days. Let&rsquo;s not.</p><h3 id=ranges>Ranges</h3><p>Yup. The <a href=https://blog.jverkamp.com/2023/12/05/aoc-2023-day-5-growinator/>day 5</a> is <em>strong</em> in this one. What we really want to do is apply each rule to <em>ranges</em>, possibly splitting each range in half.</p><p>Something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>===== =====
</span></span><span style=display:flex><span>State { label: Input, part: RangedPart { x: 1..=4000, m: 1..=4000, a: 1..=4000, s: 1..=4000 } }
</span></span><span style=display:flex><span>  - comparison: Comparison { category: S, comparator: LessThan, value: 1351, label: Node(&#34;px&#34;) }
</span></span><span style=display:flex><span>   - remaining: [State { label: Input, part: RangedPart { x: 1..=4000, m: 1..=4000, a: 1..=4000, s: 1..=4000 } }]
</span></span><span style=display:flex><span>    - value is in range, splitting
</span></span><span style=display:flex><span>     - lo (RangedPart { x: 1..=4000, m: 1..=4000, a: 1..=4000, s: 1..=1350 }) is pushing to queue with label=Node(&#34;px&#34;)
</span></span><span style=display:flex><span>     - hi (RangedPart { x: 1..=4000, m: 1..=4000, a: 1..=4000, s: 1351..=4000 }) is is remaining
</span></span><span style=display:flex><span>  - defaulting: State { label: Node(&#34;qqz&#34;), part: RangedPart { x: 1..=4000, m: 1..=4000, a: 1..=4000, s: 1351..=4000 } }
</span></span><span style=display:flex><span>===== =====
</span></span><span style=display:flex><span>State { label: Node(&#34;qqz&#34;), part: RangedPart { x: 1..=4000, m: 1..=4000, a: 1..=4000, s: 1351..=4000 } }
</span></span><span style=display:flex><span>  - comparison: Comparison { category: S, comparator: GreaterThan, value: 2770, label: Node(&#34;qs&#34;) }
</span></span><span style=display:flex><span>   - remaining: [State { label: Node(&#34;qqz&#34;), part: RangedPart { x: 1..=4000, m: 1..=4000, a: 1..=4000, s: 1351..=4000 } }]
</span></span><span style=display:flex><span>    - value is in range, splitting
</span></span><span style=display:flex><span>     - lo (RangedPart { x: 1..=4000, m: 1..=4000, a: 1..=4000, s: 1351..=2770 }) is is remaining
</span></span><span style=display:flex><span>     - hi (RangedPart { x: 1..=4000, m: 1..=4000, a: 1..=4000, s: 2771..=4000 }) is pushing to queue with label=Node(&#34;qs&#34;)
</span></span><span style=display:flex><span>  - comparison: Comparison { category: M, comparator: LessThan, value: 1801, label: Node(&#34;hdj&#34;) }
</span></span><span style=display:flex><span>   - remaining: [State { label: Node(&#34;qqz&#34;), part: RangedPart { x: 1..=4000, m: 1..=4000, a: 1..=4000, s: 1351..=2770 } }]
</span></span><span style=display:flex><span>    - value is in range, splitting
</span></span><span style=display:flex><span>     - lo (RangedPart { x: 1..=4000, m: 1..=1800, a: 1..=4000, s: 1351..=2770 }) is pushing to queue with label=Node(&#34;hdj&#34;)
</span></span><span style=display:flex><span>     - hi (RangedPart { x: 1..=4000, m: 1801..=4000, a: 1..=4000, s: 1351..=2770 }) is is remaining
</span></span><span style=display:flex><span>  - defaulting: State { label: Reject, part: RangedPart { x: 1..=4000, m: 1801..=4000, a: 1..=4000, s: 1351..=2770 } }
</span></span></code></pre></div><p>Yeah, that&rsquo;s a lot to read. Let&rsquo;s just do some code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>#[derive(Debug, Clone)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>RangedPart</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> x: <span style=color:#a6e22e>RangeInclusive</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u64</span><span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> m: <span style=color:#a6e22e>RangeInclusive</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u64</span><span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> a: <span style=color:#a6e22e>RangeInclusive</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u64</span><span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> s: <span style=color:#a6e22e>RangeInclusive</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u64</span><span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() -&gt; Result<span style=color:#f92672>&lt;</span>()<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    env_logger::init();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> stdin <span style=color:#f92672>=</span> io::stdin();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> input <span style=color:#f92672>=</span> io::read_to_string(stdin.lock())<span style=color:#f92672>?</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> (s, (rules, _)) <span style=color:#f92672>=</span> parse::simulation(<span style=color:#f92672>&amp;</span>input).unwrap();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>assert_eq!</span>(s.trim(), <span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[derive(Debug, Clone)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>State</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>&#39;a</span><span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>        label: <span style=color:#a6e22e>Label</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>&#39;a</span><span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>        part: <span style=color:#a6e22e>RangedPart</span>,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> queue <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec!</span>[State {
</span></span><span style=display:flex><span>        label: <span style=color:#a6e22e>Label</span>::Input,
</span></span><span style=display:flex><span>        part: <span style=color:#a6e22e>RangedPart</span> {
</span></span><span style=display:flex><span>            x: <span style=color:#ae81ff>1</span><span style=color:#f92672>..=</span><span style=color:#ae81ff>4000</span>,
</span></span><span style=display:flex><span>            m: <span style=color:#ae81ff>1</span><span style=color:#f92672>..=</span><span style=color:#ae81ff>4000</span>,
</span></span><span style=display:flex><span>            a: <span style=color:#ae81ff>1</span><span style=color:#f92672>..=</span><span style=color:#ae81ff>4000</span>,
</span></span><span style=display:flex><span>            s: <span style=color:#ae81ff>1</span><span style=color:#f92672>..=</span><span style=color:#ae81ff>4000</span>,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    }];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> accepted <span style=color:#f92672>=</span> Vec::new();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>let</span> Some(state) <span style=color:#f92672>=</span> queue.pop() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;===== =====&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;{:?}&#34;</span>, state);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// If we&#39;re in accept/reject, process specifically
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> state.label <span style=color:#f92672>==</span> Label::Accept {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;- accepting&#34;</span>);
</span></span><span style=display:flex><span>            accepted.push(state.part);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> state.label <span style=color:#f92672>==</span> Label::Reject {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;- rejecting&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> rule <span style=color:#f92672>=</span> rules.get(<span style=color:#f92672>&amp;</span>state.label).unwrap();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// &#39;Remaining&#39; is ranges that haven&#39;t had any comparison applied to them
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// Anything that makes it all the way through will be defaulted
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> remaining <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec!</span>[state];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Apply comparisons to all remaining ranges
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> comparison <span style=color:#66d9ef>in</span> rule.comparisons.iter() {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;  - comparison: {:?}&#34;</span>, comparison);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;   - remaining: {:?}&#34;</span>, remaining);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Update remaining
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#75715e>// Any parts that are moved to queue will filter_map to None (and be removed)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#75715e>// Anything else will Some and be kept for the next comparison
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            remaining <span style=color:#f92672>=</span> remaining
</span></span><span style=display:flex><span>                .into_iter()
</span></span><span style=display:flex><span>                .filter_map(<span style=color:#f92672>|</span>state<span style=color:#f92672>|</span> {
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Get the relevant range
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>let</span> value_range <span style=color:#f92672>=</span> <span style=color:#66d9ef>match</span> comparison.category {
</span></span><span style=display:flex><span>                        RatingCategory::X <span style=color:#f92672>=&gt;</span> state.part.x.clone(),
</span></span><span style=display:flex><span>                        RatingCategory::M <span style=color:#f92672>=&gt;</span> state.part.m.clone(),
</span></span><span style=display:flex><span>                        RatingCategory::A <span style=color:#f92672>=&gt;</span> state.part.a.clone(),
</span></span><span style=display:flex><span>                        RatingCategory::S <span style=color:#f92672>=&gt;</span> state.part.s.clone(),
</span></span><span style=display:flex><span>                    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Apply the comparison to the range, possibly splitting
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#75715e>// There are three cases: less than, during, and greater than the range
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>if</span> comparison.value <span style=color:#f92672>&lt;</span> <span style=color:#f92672>*</span>value_range.start() {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;    - all values are greater than value&#34;</span>);
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>match</span> comparison.comparator {
</span></span><span style=display:flex><span>                            Comparator::GreaterThan <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;    - pushing to queue with label={:?}&#34;</span>, comparison.label);
</span></span><span style=display:flex><span>                                queue.push(State {
</span></span><span style=display:flex><span>                                    label: <span style=color:#a6e22e>comparison</span>.label,
</span></span><span style=display:flex><span>                                    part: <span style=color:#a6e22e>state</span>.part,
</span></span><span style=display:flex><span>                                });
</span></span><span style=display:flex><span>                                None
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                            Comparator::LessThan <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;    - remaining&#34;</span>);
</span></span><span style=display:flex><span>                                Some(state)
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> comparison.value <span style=color:#f92672>&gt;</span> <span style=color:#f92672>*</span>value_range.end() {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;    - all values are less than value&#34;</span>);
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>match</span> comparison.comparator {
</span></span><span style=display:flex><span>                            Comparator::GreaterThan <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;    - remaining&#34;</span>);
</span></span><span style=display:flex><span>                                Some(state)
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                            Comparator::LessThan <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;    - pushing to queue with label={:?}&#34;</span>, comparison.label);
</span></span><span style=display:flex><span>                                queue.push(State {
</span></span><span style=display:flex><span>                                    label: <span style=color:#a6e22e>comparison</span>.label,
</span></span><span style=display:flex><span>                                    part: <span style=color:#a6e22e>state</span>.part,
</span></span><span style=display:flex><span>                                });
</span></span><span style=display:flex><span>                                None
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;    - value is in range, splitting&#34;</span>);
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>match</span> comparison.comparator {
</span></span><span style=display:flex><span>                            Comparator::GreaterThan <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                                <span style=color:#75715e>// Comparison is less than, so the value goes with the upper half
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                <span style=color:#75715e>// Lower half goes to queue, upper half stays in remaining
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                <span style=color:#66d9ef>let</span> lo_range <span style=color:#f92672>=</span> (<span style=color:#f92672>*</span>value_range.start()<span style=color:#f92672>..=</span>comparison.value).clone();
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>let</span> hi_range <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>                                    ((comparison.value <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)<span style=color:#f92672>..=*</span>value_range.end()).clone();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> lo <span style=color:#f92672>=</span> state.clone().part;
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>match</span> comparison.category {
</span></span><span style=display:flex><span>                                    RatingCategory::X <span style=color:#f92672>=&gt;</span> lo.x <span style=color:#f92672>=</span> lo_range,
</span></span><span style=display:flex><span>                                    RatingCategory::M <span style=color:#f92672>=&gt;</span> lo.m <span style=color:#f92672>=</span> lo_range,
</span></span><span style=display:flex><span>                                    RatingCategory::A <span style=color:#f92672>=&gt;</span> lo.a <span style=color:#f92672>=</span> lo_range,
</span></span><span style=display:flex><span>                                    RatingCategory::S <span style=color:#f92672>=&gt;</span> lo.s <span style=color:#f92672>=</span> lo_range,
</span></span><span style=display:flex><span>                                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> hi <span style=color:#f92672>=</span> state.clone().part.clone();
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>match</span> comparison.category {
</span></span><span style=display:flex><span>                                    RatingCategory::X <span style=color:#f92672>=&gt;</span> hi.x <span style=color:#f92672>=</span> hi_range,
</span></span><span style=display:flex><span>                                    RatingCategory::M <span style=color:#f92672>=&gt;</span> hi.m <span style=color:#f92672>=</span> hi_range,
</span></span><span style=display:flex><span>                                    RatingCategory::A <span style=color:#f92672>=&gt;</span> hi.a <span style=color:#f92672>=</span> hi_range,
</span></span><span style=display:flex><span>                                    RatingCategory::S <span style=color:#f92672>=&gt;</span> hi.s <span style=color:#f92672>=</span> hi_range,
</span></span><span style=display:flex><span>                                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;     - lo ({:?}) is is remaining&#34;</span>, lo);
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>info!</span>(
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;     - hi ({:?}) is pushing to queue with label={:?}&#34;</span>,
</span></span><span style=display:flex><span>                                    hi, comparison.label
</span></span><span style=display:flex><span>                                );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                queue.push(State {
</span></span><span style=display:flex><span>                                    label: <span style=color:#a6e22e>comparison</span>.label,
</span></span><span style=display:flex><span>                                    part: <span style=color:#a6e22e>hi</span>,
</span></span><span style=display:flex><span>                                });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                Some(State {
</span></span><span style=display:flex><span>                                    label: <span style=color:#a6e22e>state</span>.label,
</span></span><span style=display:flex><span>                                    part: <span style=color:#a6e22e>lo</span>,
</span></span><span style=display:flex><span>                                })
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                            Comparator::LessThan <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                                <span style=color:#75715e>// Comparison is greater than, so value goes with the lower half
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                <span style=color:#75715e>// Lower half stays in remaining, upper half goes to queue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                <span style=color:#66d9ef>let</span> lo_range <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>                                    (<span style=color:#f92672>*</span>value_range.start()<span style=color:#f92672>..=</span>(comparison.value <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)).clone();
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>let</span> hi_range <span style=color:#f92672>=</span> (comparison.value<span style=color:#f92672>..=*</span>value_range.end()).clone();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> lo <span style=color:#f92672>=</span> state.part.clone();
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>match</span> comparison.category {
</span></span><span style=display:flex><span>                                    RatingCategory::X <span style=color:#f92672>=&gt;</span> lo.x <span style=color:#f92672>=</span> lo_range,
</span></span><span style=display:flex><span>                                    RatingCategory::M <span style=color:#f92672>=&gt;</span> lo.m <span style=color:#f92672>=</span> lo_range,
</span></span><span style=display:flex><span>                                    RatingCategory::A <span style=color:#f92672>=&gt;</span> lo.a <span style=color:#f92672>=</span> lo_range,
</span></span><span style=display:flex><span>                                    RatingCategory::S <span style=color:#f92672>=&gt;</span> lo.s <span style=color:#f92672>=</span> lo_range,
</span></span><span style=display:flex><span>                                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> hi <span style=color:#f92672>=</span> state.part.clone();
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>match</span> comparison.category {
</span></span><span style=display:flex><span>                                    RatingCategory::X <span style=color:#f92672>=&gt;</span> hi.x <span style=color:#f92672>=</span> hi_range,
</span></span><span style=display:flex><span>                                    RatingCategory::M <span style=color:#f92672>=&gt;</span> hi.m <span style=color:#f92672>=</span> hi_range,
</span></span><span style=display:flex><span>                                    RatingCategory::A <span style=color:#f92672>=&gt;</span> hi.a <span style=color:#f92672>=</span> hi_range,
</span></span><span style=display:flex><span>                                    RatingCategory::S <span style=color:#f92672>=&gt;</span> hi.s <span style=color:#f92672>=</span> hi_range,
</span></span><span style=display:flex><span>                                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>info!</span>(
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;     - lo ({:?}) is pushing to queue with label={:?}&#34;</span>,
</span></span><span style=display:flex><span>                                    lo, comparison.label
</span></span><span style=display:flex><span>                                );
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;     - hi ({:?}) is is remaining&#34;</span>, hi);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                queue.push(State {
</span></span><span style=display:flex><span>                                    label: <span style=color:#a6e22e>comparison</span>.label,
</span></span><span style=display:flex><span>                                    part: <span style=color:#a6e22e>lo</span>,
</span></span><span style=display:flex><span>                                });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                Some(State {
</span></span><span style=display:flex><span>                                    label: <span style=color:#a6e22e>state</span>.label,
</span></span><span style=display:flex><span>                                    part: <span style=color:#a6e22e>hi</span>,
</span></span><span style=display:flex><span>                                })
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>                .collect();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Anything still remaining gets the default label
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        remaining.iter_mut().for_each(<span style=color:#f92672>|</span>state<span style=color:#f92672>|</span> {
</span></span><span style=display:flex><span>            state.label <span style=color:#f92672>=</span> rule.default;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>info!</span>(<span style=color:#e6db74>&#34;  - defaulting: {:?}&#34;</span>, state);
</span></span><span style=display:flex><span>            queue.push(state.clone());
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> result <span style=color:#f92672>=</span> accepted
</span></span><span style=display:flex><span>        .iter()
</span></span><span style=display:flex><span>        .map(<span style=color:#f92672>|</span>part<span style=color:#f92672>|</span> {
</span></span><span style=display:flex><span>            (part.x.end() <span style=color:#f92672>-</span> part.x.start() <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>u128</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>*</span> (part.m.end() <span style=color:#f92672>-</span> part.m.start() <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>u128</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>*</span> (part.a.end() <span style=color:#f92672>-</span> part.a.start() <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>u128</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>*</span> (part.s.end() <span style=color:#f92672>-</span> part.s.start() <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>u128</span>
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        .sum::<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u128</span><span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>println!</span>(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{result}</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    Ok(())
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>It&rsquo;s &mldr; a lot longer. Not going to lie. And it has a lot more <code>info!</code> logging than I often leave in. But making sure all of the cases work well for that? Well, that&rsquo;s when logging comes in handy (yes, I should have written more (any) test cases).</p><p>The basic idea is:</p><ul><li>Keep a queue of states to process, starting with <code>{x: 1..=4000, m: : 1..=4000, a: 1..=4000, s: 1..=4000}</code>.</li><li>For each state in the queue:<ul><li>Remove <code>Accept</code> and <code>Reject</code> states (and count or not)</li><li>Load the rule based on that state&rsquo;s label</li><li>Initialize a second list of <code>remaining</code> states; this will be any subset of the original ranges that hasn&rsquo;t already had a condition applied to it</li><li>Apply each condition to the rule in turn<ul><li>Split the range:<ul><li>If the condition&rsquo;s value is entirely above or below the current range, you will have one output range</li><li>If the condition&rsquo;s value is in the range, you will split (although which range the <code>condition.value</code> is in goes to depends on the conditional)</li></ul></li><li>For that one or two ranges:<ul><li>If the condition applied, move the range back to the <code>queue</code> (no more <code>conditions</code> will apply to this range)</li><li>If it did not, keep it in <code>remaining</code></li></ul></li></ul></li><li>Any values left in <code>remaining</code> change to the <code>default</code> label for that state</li></ul></li></ul><p>It&rsquo;s arguable if that&rsquo;s any easier to read than the code and I&rsquo;ll admit, there were a number of off by one errors and flipping what &rsquo;less than&rsquo; means (condition &lt; range or range &lt; condition).</p><p>But in the end, I think that it&rsquo;s actually a fairly elegant way to look at the program!</p><h2 id=performance>Performance</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>$</span> just time <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>hyperfine <span style=color:#f92672>--</span>warmup <span style=color:#ae81ff>3</span> <span style=color:#a6e22e>&#39;just</span> run <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>1</span><span style=color:#a6e22e>&#39;</span>
</span></span><span style=display:flex><span>Benchmark <span style=color:#ae81ff>1</span>: <span style=color:#a6e22e>just</span> run <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  Time (mean <span style=color:#960050;background-color:#1e0010>Â±</span> <span style=color:#960050;background-color:#1e0010>Ïƒ</span>):      <span style=color:#ae81ff>94.0</span> ms <span style=color:#960050;background-color:#1e0010>Â±</span>   <span style=color:#ae81ff>3.1</span> ms    [User: <span style=color:#ae81ff>38.3</span> ms, System: <span style=color:#ae81ff>15.5</span> ms]
</span></span><span style=display:flex><span>  Range (min <span style=color:#960050;background-color:#1e0010>â€¦</span> max):    <span style=color:#ae81ff>89.4</span> ms <span style=color:#960050;background-color:#1e0010>â€¦</span> <span style=color:#ae81ff>103.4</span> ms    <span style=color:#ae81ff>30</span> runs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>$</span> just time <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>hyperfine <span style=color:#f92672>--</span>warmup <span style=color:#ae81ff>3</span> <span style=color:#a6e22e>&#39;just</span> run <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span><span style=color:#a6e22e>&#39;</span>
</span></span><span style=display:flex><span>Benchmark <span style=color:#ae81ff>1</span>: <span style=color:#a6e22e>just</span> run <span style=color:#ae81ff>19</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  Time (mean <span style=color:#960050;background-color:#1e0010>Â±</span> <span style=color:#960050;background-color:#1e0010>Ïƒ</span>):     <span style=color:#ae81ff>103.7</span> ms <span style=color:#960050;background-color:#1e0010>Â±</span>   <span style=color:#ae81ff>2.9</span> ms    [User: <span style=color:#ae81ff>38.5</span> ms, System: <span style=color:#ae81ff>16.0</span> ms]
</span></span><span style=display:flex><span>  Range (min <span style=color:#960050;background-color:#1e0010>â€¦</span> max):   <span style=color:#ae81ff>100.6</span> ms <span style=color:#960050;background-color:#1e0010>â€¦</span> <span style=color:#ae81ff>114.4</span> ms    <span style=color:#ae81ff>27</span> runs
</span></span></code></pre></div><p>Sometimes it&rsquo;s amazing how much more work you can do in the same amount of time. Processing 2000 inputs or trillions? Doesn&rsquo;t matter when you handle them as ranges!</p></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>