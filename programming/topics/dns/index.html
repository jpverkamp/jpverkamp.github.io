<!DOCTYPE html>
<html onclick >
<head>
    <title>jverkamp.com</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8"><link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css" integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" />

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper"><header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a> *
            <a href="/resume">Resume</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>
    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation"><li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li><li><a href="https://blog.jverkamp.com/programming/">Programming</a></li><li><a href="https://blog.jverkamp.com/maker/">Maker</a></li><li><a href="https://blog.jverkamp.com/photography/">Photography</a></li><li><a href="https://blog.jverkamp.com/writing/">Writing</a></li><li><a href="https://blog.jverkamp.com/research/">Research</a></li><li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>
<div id="page-content-wrapper">
            <div id="page-content">
    <div class="entry-content"></div>

    <article class="li">
    	<header>
    		<h1 class="entry-title">
                <a href="https://blog.jverkamp.com/2020/07/16/an-spf-dns-server/" class="clearfix">An SPF DNS Server</a>
            </h1>

    		<div class="entry-meta"><span class="entry-date">2020-07-16</span>
                </div>
    	</header>
    	<div class="entry-content"><p>The <a href="https://en.wikipedia.org/wiki/Sender%20Policy%20Framework">Sender Policy Framework</a> is one of those things that&rsquo;s really powerful and useful to help prevent phishing and email spam, but can be a royal pain to work with. Specifically, SPF is a series of DNS TXT records<sup class="footnote-ref" id="fnref:history"><a href="#fn:history">1</a></sup> with a specific format that can be looked up by any email service to verify that an email was sent by a server that should be authorized to send email on your behalf. For example</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#e6db74">&#34;v=spf1 ip4:192.0.2.0/24 ip4:198.51.100.123 a -all&#34;</span></code></pre></div>
<ul>
<li><code>v=spf1</code> - tells the client this is an SPF record and should always start the record</li>
<li><code>{key}[:{value}]?</code> - one of many different key/value pairs that can define the record

<ul>
<li>in the case above a <code>ip4</code> key species an <a href="https://en.wikipedia.org/wiki/IPv4">IPv4</a> address range that can send emails on your behalf (the value can be optional)</li>
<li>the <code>a</code> above is another special case where if the sender domain (<code>jp@example.com</code> would be <code>example.com</code>) resolves via a <code>DNS A</code> record to the server that sent the email, it&rsquo;s allows</li>
</ul></li>
<li><code>-all</code> is a fallthrough case meaning &lsquo;fail all that didn&rsquo;t match a previous case</li>
</ul>

<p>There are a number of other cases, but we&rsquo;ll get to the other interesting ones in a bit.</p><p><a href="/2020/07/16/an-spf-dns-server/">read more...</a></p></div>

        <hr /></article><article class="li">
    	<header>
    		<h1 class="entry-title">
                <a href="https://blog.jverkamp.com/2020/06/30/ssrf-protection-in-rails/" class="clearfix">SSRF Protection in Rails</a>
            </h1>

    		<div class="entry-meta"><span class="entry-date">2020-06-30</span>
                </div>
    	</header>
    	<div class="entry-content"><p>One of the more subtle bugs that a lot of companies miss is Server Side Request Forgery (SSRF). Like it&rsquo;s cousin CSRF (cross-site request forgery), SSRF involves carefully crafting a request that runs in a way that the original developers didn&rsquo;t expect to do things that shouldn&rsquo;t be done. In the case of CSRF, one site is making a request on behalf of another in a user&rsquo;s browser (cross-site), but in SSRF, a request is being made by a server on behalf of a client, but you can trick it into making a request that wasn&rsquo;t intended.</p>

<p>For a perhaps more obvious example, consider a website with a service that will render webpages as preview images&ndash;consider sharing links on a social network. A user makes a request such as <code>/render?url=https://www.google.com</code>. This goes to the server, which will then fetch <a href="https://www.google.com">https://www.google.com</a>, render the page to a screenshot, and then return that as a thumbnail.</p>

<p>This seems like rather useful functionality, but what if instead, the user gives the url: <code>/render?url=https://secret-internal-site.company.com</code>. Normally, <code>company.com</code> would be an internal only domain that cannot be viewed by users, but in this case&ndash;the server is within the corporate network. Off the server goes, helpfully taking and returning a screenshot. Another option&ndash;if you&rsquo;re hosted on AWS&ndash;is the AWS <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html">metadata endpoint</a>: <code>http://169.254.169.254/latest/meta-data/</code>. All sorts of interesting private things there. Or even more insidious, <code>/render?url=file:///etc/password</code>. That shouldn&rsquo;t work in most cases, since most libraries know better than to rener <code>file://</code> protocol URLs, but&hellip; not always!</p><p><a href="/2020/06/30/ssrf-protection-in-rails/">read more...</a></p></div>

        <hr /></article><article class="li">
    	<header>
    		<h1 class="entry-title">
                <a href="https://blog.jverkamp.com/2018/07/09/creating-a-temporary-smtp-server-to-catch-domain-validation-emails/" class="clearfix">Creating a temporary SMTP server to &#39;catch&#39; domain validation emails</a>
            </h1>

    		<div class="entry-meta"><span class="entry-date">2018-07-09</span>
                </div>
    	</header>
    	<div class="entry-content"><p>One problem that has come up a time or two is dealing with email-based domain validation (specifically in this case for the issuance of TLS certificates) on domains that aren&rsquo;t actually configured to receive email. Yes, in a perfect world, it would be easier to switch to DNS-based validation (since we have to have control of the DNS for the domain, we need it later), but let&rsquo;s just assume that&rsquo;s not an option. So, how do we &lsquo;catch&rsquo; the activation email so we can prove we can receive email on that domain?</p><p><a href="/2018/07/09/creating-a-temporary-smtp-server-to-catch-domain-validation-emails/">read more...</a></p></div>

        <hr /></article><article class="li">
    	<header>
    		<h1 class="entry-title">
                <a href="https://blog.jverkamp.com/2018/03/12/generating-zone-files-from-route53/" class="clearfix">Generating zone files from Route53</a>
            </h1>

    		<div class="entry-meta"><span class="entry-date">2018-03-12</span>
                </div>
    	</header>
    	<div class="entry-content"><p>Recently I found myself wanting to do some analysis on all of our DNS entires stored in AWS&rsquo;s Route53 for security reasons (specifically to prevent subdomain takeover attacks, I&rsquo;ll probably write that up soon). In doing so, I realized that while Route53 has the ability to import a <a href="https://en.wikipedia.org/wiki/zone%20file">zone file</a>, it&rsquo;s not possible to export one.</p>

<p>To some extent, this makes sense. Since Route53 supports ALIAS records (which can automatically determine their values based on other AWS products, such as an ELB changing its public IP) and those aren&rsquo;t actually &lsquo;real&rsquo; DNS entries, things will get confused. But I don&rsquo;t currently intend to re-import these zone files, just use them. So let&rsquo;s see what we can do.</p><p><a href="/2018/03/12/generating-zone-files-from-route53/">read more...</a></p></div>

        <hr /></article><article class="li">
    	<header>
    		<h1 class="entry-title">
                <a href="https://blog.jverkamp.com/2013/09/27/large-scale-asynchronous-dns-scans/" class="clearfix">Large scale asynchronous DNS scans</a>
            </h1>

    		<div class="entry-meta"><span class="entry-date">2013-09-27</span>
                </div>
    	</header>
    	<div class="entry-content"><p>On Monday we <a href="https://blog.jverkamp.com/2013/09/23/extending-racket-structs-to-bitfields/">laid out a framework</a> for converting structures into bytes. On Wednesday, we used that to <a href="https://blog.jverkamp.com/2013/09/25/extending-rackets-dns-capabilities/">enhance Racket&rsquo;s UDP and DNS capabilities</a>. Today, we&rsquo;re going to take that all one step further and scan large portions of the Internet. The end goal will be to look for <a href="https://blog.jverkamp.com/2013/02/09/isma-2013-aims-5-dns-based-censorship/">DNS-based</a> on a worldwide scale.</p><p><a href="/2013/09/27/large-scale-asynchronous-dns-scans/">read more...</a></p></div>

        <hr /></article><article class="li">
    	<header>
    		<h1 class="entry-title">
                <a href="https://blog.jverkamp.com/2013/09/25/extending-rackets-dns-capabilities/" class="clearfix">Extending Racket&#39;s DNS capabilities</a>
            </h1>

    		<div class="entry-meta"><span class="entry-date">2013-09-25</span>
                </div>
    	</header>
    	<div class="entry-content"><p>As I <a href="https://blog.jverkamp.com/2013/09/23/extending-racket-structs-to-bitfields/">mentioned</a> on Monday, I wrote my <a href="https://blog.jverkamp.com/2013/02/09/isma-2013-aims-5-dns-based-censorship/">DNS-based censorship</a> around the world&ndash;and to do that, I need a fair bit of control over the DNS packets that I&rsquo;m sending back and over parsing the ones that I get back.</p><p><a href="/2013/09/25/extending-rackets-dns-capabilities/">read more...</a></p></div>

        <hr /></article><article class="li">
    	<header>
    		<h1 class="entry-title">
                <a href="https://blog.jverkamp.com/2013/02/09/isma-2013-aims-5-dns-based-censorship/" class="clearfix">ISMA 2013 AIMS-5 - DNS Based Censorship</a>
            </h1>

    		<div class="entry-meta"><span class="entry-date">2013-02-09</span>
                </div>
    	</header>
    	<div class="entry-content">I gave a presentation about research that I&rsquo;m just starting out studying DNS-based censorship in specific around the world. In particularly, preliminary findings in China have confirmed that the Great Firewall is responding via packet injection to many queries for either Facebook or Twitter (among others). Interestingly, the pool of IPs that they return is consistent yet none of the IPs seem to resolve to anything interesting. In addition, there is fallout in South Korea where some percentage of packets go through China and thus have the same behaviors.<p><a href="/2013/02/09/isma-2013-aims-5-dns-based-censorship/">read more...</a></p></div>

        <hr /></article><article class="li">
    	<header>
    		<h1 class="entry-title">
                <a href="https://blog.jverkamp.com/2013/02/09/aims-5-day-3/" class="clearfix">AIMS-5 - Day 3</a>
            </h1>

    		<div class="entry-meta"><span class="entry-date">2013-02-09</span>
                </div>
    	</header>
    	<div class="entry-content"><p>Yesterday was the third and final day of AIMS-5. With the main topic being <em>Detection of Censorship, Filtering, and Outages</em>, many of these talks were much more in line with what I know and what I&rsquo;m working on. I gave my presentation as well, you can see it (along with a link to my slides) down below.</p><p><a href="/2013/02/09/aims-5-day-3/">read more...</a></p></div>

        <hr /></article><article class="li">
    	<header>
    		<h1 class="entry-title">
                <a href="https://blog.jverkamp.com/2013/02/08/aims-5-day-2/" class="clearfix">AIMS-5 - Day 2</a>
            </h1>

    		<div class="entry-meta"><span class="entry-date">2013-02-08</span>
                </div>
    	</header>
    	<div class="entry-content"><p>Today&rsquo;s agenda had discussions on Mobile Measurements and IPv6 Annotations, none of which are areas that I find myself particularly interested in. Still, I did learn a few things.</p><p><a href="/2013/02/08/aims-5-day-2/">read more...</a></p></div>

        <hr /></article><article class="li">
    	<header>
    		<h1 class="entry-title">
                <a href="https://blog.jverkamp.com/2013/02/07/aims-5-workshop-on-active-internet-measurements/" class="clearfix">AIMS-5 - Workshop on Active Internet Measurements</a>
            </h1>

    		<div class="entry-meta"><span class="entry-date">2013-02-07</span>
                </div>
    	</header>
    	<div class="entry-content"><p>Yesterday was the first of three days for the fifth annual <a href="https://blog.jverkamp.com/2012/10/22/isc/caida-workshop/">ISC/CAIDA Workshop</a> I went to in Baltimore back in October at least, but even the ones that weren&rsquo;t have still been interesting.</p>

<p>I&rsquo;ll be presenting on Friday and I&rsquo;ll share my slides when I get that far (they aren&rsquo;t actually finished yet). I&rsquo;ll be talking about new work that I&rsquo;m just getting off the ground focusing specifically on DNS-based censorship. There is a lot of interesting ground to cover there and this should be only the first in a series of updates about that work (I hope).</p><p><a href="/2013/02/07/aims-5-workshop-on-active-internet-measurements/">read more...</a></p></div>

        <hr /></article><nav id="pagination-navigation" role="navigation">

<ul class="pagination">
    
    <li class="page-item">
        <a href="/programming/topics/dns/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item disabled">
    <a href="" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/programming/topics/dns/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/programming/topics/dns/page/2/">2</a></li>
    
    
    <li class="page-item">
    <a href="/programming/topics/dns/page/2/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/programming/topics/dns/page/2/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>
</nav></div>
        </div><footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li><li>
                <a href="/programming/topics/atom.xml">
                    RSS: programming/topics<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li></ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>
</div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js" integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js" integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin="anonymous"></script>

<script src="/custom.js"></script>
</body>
</html>
