<!doctype html><html><head><title>Programming, Topic:
DNS - jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_17422284542669262002.min.834c1e2313951f0c25b90152fe8b62250eab4a2e8cbd2560fa1a1cdc91c71733.js integrity="sha256-g0weIxOVHwwluQFS/otiJQ6rSi6MvSVg+hoc3JHHFzM=" defer></script><script src=/jquery.fancybox_16245765822111608191.min.a8e11addf4349ee2ca5045f7f3cbf1febbf2c3a2840be2143ea69539c10f8c7f.js integrity="sha256-qOEa3fQ0nuLKUEX388vx/rvyw6KEC+IUPqaVOcEPjH8=" defer></script><script src=/katex_17296078054267651618.min.4a06464d8d6f8358d8896de62b53b5a89205d335dfd8c5b6b27edd7c039ae9d8.js integrity="sha256-SgZGTY1vg1jYiW3mK1O1qJIF0zXf2MW2sn7dfAOa6dg=" defer></script><script src=/auto-render_14944144240389301023.min.e694d9d5eae2917984179683ead27b998784a81398e8836c369373d2c67fc32a.js integrity="sha256-5pTZ1erikXmEF5aD6tJ7mYeEqBOY6INsNpNz0sZ/wyo=" defer></script><script src=/bigfoot_28293813221957978.min.af671f08986f0a2267c5a0cb2748b005489e47fa25f55479b200e2a563d23022.js integrity="sha256-r2cfCJhvCiJnxaDLJ0iwBUieR/ol9VR5sgDipWPSMCI=" defer></script><script src=/mermaid_9520146763733687737.min.a17078917a4403310cd19178939257b706fb5e1da76167c9f4a6d2123c9d59c4.js integrity="sha256-oXB4kXpEAzEM0ZF4k5JXtwb7Xh2nYWfJ9KbSEjydWcQ=" defer></script><script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script><link rel=stylesheet href=/katex_13658330645258633971.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_8781527669040159104.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_5330465509389191777.min.7420a1602c62a85d4b50881c1d8ce42f72c049dc2b097d440696425d6e54bb1e.css integrity="sha256-dCChYCxiqF1LUIgcHYzkL3LASdwrCX1EBpZCXW5Uux4="><link rel=stylesheet href=/css_1846377409604050217.min.fffe842bc000dd1fe8661ac6427a392a08faa95e8edab1ea7fb98c5f8dac6a6f.css integrity="sha256-//6EK8AA3R/oZhrGQno5Kgj6qV6O2rHqf7mMX42sam8="><link rel=stylesheet href=/main.min.5ff4b87c40715a96119d8b5f34d971604fc65ab18f4870fd8da6ede9fd1e6188.css integrity="sha256-X/S4fEBxWpYRnYtfNNlxYE/GWrGPSHD9jabt6f0eYYg="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/home-automation/>Automation</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><h1 class=entry-title data-pagefind-meta=title>Programming, Topic:
DNS</h1><div class=entry-content></div><h2>Recent posts (Page 1 of 2)</h2><div class=post-list><article class=post-card><div class=post-card-image><a href=https://blog.jverkamp.com/2025/12/28/dns/wireguard-tunnel-weirdness-on-ios/><img src=/2025/12/28/dns/wireguard-tunnel-weirdness-on-ios/home.png alt="DNS/Wireguard Tunnel Weirdness on iOS" loading=lazy></a></div><div class=post-card-content><header><h1 class=entry-title><a href=https://blog.jverkamp.com/2025/12/28/dns/wireguard-tunnel-weirdness-on-ios/ class=clearfix>DNS/Wireguard Tunnel Weirdness on iOS</a></h1><div class=entry-meta><span class=entry-date>2025-12-28</span><span class=entry-category> in <a href=/other/>Other</a></span></div></header><div class=entry-content><p>A note so that if anyone ever haves this same bit of weirdness, hopefully they might stumble across this. I had a heck of a time searching for this&mldr;</p><p>So, I have Wireguard set up on my home server along with various services that are designed to only be accessible locally.</p><p>If I want to use my home connection/Wireguard from my phone (iOS), this is easy enough to deal with:</p><p><img src=home.png alt="My wireguard setup"></p><p>Everything works just fine.</p><p>However, I found that this connection was sometimes not working, especially if I was on a cellular connection or switching connections. The connection would just hang until I either switched to the full tunnel or turned it off entirely (and made it home).</p><p>I tried all manner of switching around the <code>Allowed IPs</code>, adding 10. ranges (for the Wireguard IPs), other private ranges, leaving off specific IPs, all of it.</p><p>But what did it take in the end?</p><p><img src=home-minimal.png alt="My on-demand wireguard setup"></p><p>Note the difference?</p><p>I had to tunnel the DNS.</p><p>I believe that this is an iOS specific security behavior&ndash;I have public DNS addresses that <em>resolve to a private IP range</em>. It works fine for me and won&rsquo;t work for anyone else&ndash;they&rsquo;ll go to whatever their local private network is. But iOS (rightfully) thinks that might be a security hole and wouldn&rsquo;t let the DNS resolve for me&ndash;unless I also tunnelled the DNS server (for now I&rsquo;m using 1.1.1.1 for that; I&rsquo;m hoping to self host that as well some day).</p><p>So if you have: an on-demand wireguard tunnel on iOS with a limited Allowed IPs range <em>and</em> a custom DNS set up, you may just need to tunnel the DNS.</p><p>Oy that was a fun one.</p><p>But it&rsquo;s been working absolutely fine for a month now, so all is well. Onward!</p></div></div></article><article class=post-card><div class=post-card-content><header><h1 class=entry-title><a href=https://blog.jverkamp.com/2020/07/16/an-spf-dns-server/ class=clearfix>An SPF DNS Server</a></h1><div class=entry-meta><span class=entry-date>2020-07-16</span><span class=entry-category> in <a href=/programming/>Programming</a></span></div></header><div class=entry-content><p>The <a href=https://en.wikipedia.org/wiki/Sender%20Policy%20Framework>Sender Policy Framework</a> is one of those things that&rsquo;s really powerful and useful to help prevent phishing and email spam, but can be a royal pain to work with. Specifically, SPF is a series of DNS TXT records<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> with a specific format that can be looked up by any email service to verify that an email was sent by a server that should be authorized to send email on your behalf. For example</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e6db74>&#34;v=spf1 ip4:192.0.2.0/24 ip4:198.51.100.123 a -all&#34;</span>
</span></span></code></pre></div><ul><li><code>v=spf1</code> - tells the client this is an SPF record and should always start the record</li><li><code>{key}[:{value}]?</code> - one of many different key/value pairs that can define the record<ul><li>in the case above a <code>ip4</code> key species an <a href=https://en.wikipedia.org/wiki/IPv4>IPv4</a> address range that can send emails on your behalf (the value can be optional)</li><li>the <code>a</code> above is another special case where if the sender domain (<code>jp@example.com</code> would be <code>example.com</code>) resolves via a <code>DNS A</code> record to the server that sent the email, it&rsquo;s allows</li></ul></li><li><code>-all</code> is a fallthrough case meaning &lsquo;fail all that didn&rsquo;t match a previous case</li></ul><p>There are a number of other cases, but we&rsquo;ll get to the other interesting ones in a bit.</p><p><a href=/2020/07/16/an-spf-dns-server/>read more...</a></p></div></div></article><article class=post-card><div class=post-card-content><header><h1 class=entry-title><a href=https://blog.jverkamp.com/2020/06/30/ssrf-protection-in-rails/ class=clearfix>SSRF Protection in Rails</a></h1><div class=entry-meta><span class=entry-date>2020-06-30</span><span class=entry-category> in <a href=/programming/>Programming</a></span></div></header><div class=entry-content><p>One of the more subtle bugs that a lot of companies miss is Server Side Request Forgery (SSRF). Like it&rsquo;s cousin CSRF (cross-site request forgery), SSRF involves carefully crafting a request that runs in a way that the original developers didn&rsquo;t expect to do things that shouldn&rsquo;t be done. In the case of CSRF, one site is making a request on behalf of another in a user&rsquo;s browser (cross-site), but in SSRF, a request is being made by a server on behalf of a client, but you can trick it into making a request that wasn&rsquo;t intended.</p><p>For a perhaps more obvious example, consider a website with a service that will render webpages as preview images&ndash;consider sharing links on a social network. A user makes a request such as <code>/render?url=https://www.google.com</code>. This goes to the server, which will then fetch <a href=https://www.google.com target=_blank rel=noopener>https://www.google.com</a>, render the page to a screenshot, and then return that as a thumbnail.</p><p>This seems like rather useful functionality, but what if instead, the user gives the url: <code>/render?url=https://secret-internal-site.company.com</code>. Normally, <code>company.com</code> would be an internal only domain that cannot be viewed by users, but in this case&ndash;the server is within the corporate network. Off the server goes, helpfully taking and returning a screenshot. Another option&ndash;if you&rsquo;re hosted on AWS&ndash;is the AWS <a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html target=_blank rel=noopener>metadata endpoint</a>: <code>http://169.254.169.254/latest/meta-data/</code>. All sorts of interesting private things there. Or even more insidious, <code>/render?url=file:///etc/password</code>. That shouldn&rsquo;t work in most cases, since most libraries know better than to rener <code>file://</code> protocol URLs, but&mldr; not always!</p><p><a href=/2020/06/30/ssrf-protection-in-rails/>read more...</a></p></div></div></article><article class=post-card><div class=post-card-content><header><h1 class=entry-title><a href=https://blog.jverkamp.com/2018/07/09/creating-a-temporary-smtp-server-to-catch-domain-validation-emails/ class=clearfix>Creating a temporary SMTP server to 'catch' domain validation emails</a></h1><div class=entry-meta><span class=entry-date>2018-07-09</span><span class=entry-category> in <a href=/programming/>Programming</a></span></div></header><div class=entry-content><p>One problem that has come up a time or two is dealing with email-based domain validation (specifically in this case for the issuance of TLS certificates) on domains that aren&rsquo;t actually configured to receive email. Yes, in a perfect world, it would be easier to switch to DNS-based validation (since we have to have control of the DNS for the domain, we need it later), but let&rsquo;s just assume that&rsquo;s not an option. So, how do we &lsquo;catch&rsquo; the activation email so we can prove we can receive email on that domain?</p><p><a href=/2018/07/09/creating-a-temporary-smtp-server-to-catch-domain-validation-emails/>read more...</a></p></div></div></article><article class=post-card><div class=post-card-content><header><h1 class=entry-title><a href=https://blog.jverkamp.com/2018/03/12/generating-zone-files-from-route53/ class=clearfix>Generating zone files from Route53</a></h1><div class=entry-meta><span class=entry-date>2018-03-12</span><span class=entry-category> in <a href=/programming/>Programming</a></span></div></header><div class=entry-content><p>Recently I found myself wanting to do some analysis on all of our DNS entires stored in AWS&rsquo;s Route53 for security reasons (specifically to prevent subdomain takeover attacks, I&rsquo;ll probably write that up soon). In doing so, I realized that while Route53 has the ability to import a <a href=https://en.wikipedia.org/wiki/zone%20file>zone file</a>, it&rsquo;s not possible to export one.</p><p>To some extent, this makes sense. Since Route53 supports ALIAS records (which can automatically determine their values based on other AWS products, such as an ELB changing its public IP) and those aren&rsquo;t actually &lsquo;real&rsquo; DNS entries, things will get confused. But I don&rsquo;t currently intend to re-import these zone files, just use them. So let&rsquo;s see what we can do.</p><p><a href=/2018/03/12/generating-zone-files-from-route53/>read more...</a></p></div></div></article><article class=post-card><div class=post-card-content><header><h1 class=entry-title><a href=https://blog.jverkamp.com/2013/09/27/large-scale-asynchronous-dns-scans/ class=clearfix>Large scale asynchronous DNS scans</a></h1><div class=entry-meta><span class=entry-date>2013-09-27</span><span class=entry-category> in <a href=/programming/>Programming</a></span></div></header><div class=entry-content><p>On Monday we <a href=https://blog.jverkamp.com/2013/09/23/extending-racket-structs-to-bitfields/>laid out a framework</a> for converting structures into bytes. On Wednesday, we used that to <a href=https://blog.jverkamp.com/2013/09/25/extending-rackets-dns-capabilities/>enhance Racket&rsquo;s UDP and DNS capabilities</a>. Today, we&rsquo;re going to take that all one step further and scan large portions of the Internet. The end goal will be to look for <a href=https://blog.jverkamp.com/2013/02/09/isma-2013-aims-5-dns-based-censorship/>DNS-based</a> on a worldwide scale.</p><p><a href=/2013/09/27/large-scale-asynchronous-dns-scans/>read more...</a></p></div></div></article><article class=post-card><div class=post-card-content><header><h1 class=entry-title><a href=https://blog.jverkamp.com/2013/09/25/extending-rackets-dns-capabilities/ class=clearfix>Extending Racket's DNS capabilities</a></h1><div class=entry-meta><span class=entry-date>2013-09-25</span><span class=entry-category> in <a href=/programming/>Programming</a></span></div></header><div class=entry-content><p>As I <a href=https://blog.jverkamp.com/2013/09/23/extending-racket-structs-to-bitfields/>mentioned</a> on Monday, I wrote my <a href=https://blog.jverkamp.com/2013/02/09/isma-2013-aims-5-dns-based-censorship/>DNS-based censorship</a> around the world&ndash;and to do that, I need a fair bit of control over the DNS packets that I&rsquo;m sending back and over parsing the ones that I get back.</p><p><a href=/2013/09/25/extending-rackets-dns-capabilities/>read more...</a></p></div></div></article><article class=post-card><div class=post-card-image><a href=https://blog.jverkamp.com/2013/02/09/isma-2013-aims-5-dns-based-censorship/><img src=/embeds/2013/slides alt="ISMA 2013 AIMS-5 - DNS Based Censorship" loading=lazy></a></div><div class=post-card-content><header><h1 class=entry-title><a href=https://blog.jverkamp.com/2013/02/09/isma-2013-aims-5-dns-based-censorship/ class=clearfix>ISMA 2013 AIMS-5 - DNS Based Censorship</a></h1><div class=entry-meta><span class=entry-date>2013-02-09</span><span class=entry-category> in <a href=/research/>Research</a></span></div></header><div class=entry-content><p>I gave a presentation about research that I&rsquo;m just starting out studying DNS-based censorship in specific around the world. In particularly, preliminary findings in China have confirmed that the <a href=https://en.wikipedia.org/wiki/Great%20Firewall>Great Firewall</a> is responding via packet injection to many queries for either Facebook or Twitter (among others). Interestingly, the pool of IPs that they return is consistent yet none of the IPs seem to resolve to anything interesting. In addition, there is fallout in South Korea where some percentage of packets go through China and thus have the same behaviors.</p><p><a href=/2013/02/09/isma-2013-aims-5-dns-based-censorship/>read more...</a></p></div></div></article><article class=post-card><div class=post-card-content><header><h1 class=entry-title><a href=https://blog.jverkamp.com/2013/02/09/aims-5-day-3/ class=clearfix>AIMS-5 - Day 3</a></h1><div class=entry-meta><span class=entry-date>2013-02-09</span><span class=entry-category> in <a href=/research/>Research</a></span></div></header><div class=entry-content><p>Yesterday was the third and final day of AIMS-5. With the main topic being <em>Detection of Censorship, Filtering, and Outages</em>, many of these talks were much more in line with what I know and what I&rsquo;m working on. I gave my presentation as well, you can see it (along with a link to my slides) down below.</p><p><a href=/2013/02/09/aims-5-day-3/>read more...</a></p></div></div></article><article class=post-card><div class=post-card-content><header><h1 class=entry-title><a href=https://blog.jverkamp.com/2013/02/08/aims-5-day-2/ class=clearfix>AIMS-5 - Day 2</a></h1><div class=entry-meta><span class=entry-date>2013-02-08</span><span class=entry-category> in <a href=/research/>Research</a></span></div></header><div class=entry-content><p>Today&rsquo;s agenda had discussions on Mobile Measurements and IPv6 Annotations, none of which are areas that I find myself particularly interested in. Still, I did learn a few things.</p><p><a href=/2013/02/08/aims-5-day-2/>read more...</a></p></div></div></article></div><nav id=pagination-navigation role=navigation><ul class="pagination pagination-default"><li class="page-item disabled"><a aria-disabled=true aria-label=First class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;&#171;</span></a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Previous class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;</span></a></li><li class="page-item active"><a aria-current=page aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/programming/topics/dns/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/programming/topics/dns/page/2/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/programming/topics/dns/page/2/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul></nav><hr><h2>All posts</h2><ul><li><span class=entry-date>2025-12-28</span>:
<a href=https://blog.jverkamp.com/2025/12/28/dns/wireguard-tunnel-weirdness-on-ios/>DNS/Wireguard Tunnel Weirdness on iOS</a></li><li><span class=entry-date>2020-07-16</span>:
<a href=https://blog.jverkamp.com/2020/07/16/an-spf-dns-server/>An SPF DNS Server</a></li><li><span class=entry-date>2020-06-30</span>:
<a href=https://blog.jverkamp.com/2020/06/30/ssrf-protection-in-rails/>SSRF Protection in Rails</a></li><li><span class=entry-date>2018-07-09</span>:
<a href=https://blog.jverkamp.com/2018/07/09/creating-a-temporary-smtp-server-to-catch-domain-validation-emails/>Creating a temporary SMTP server to 'catch' domain validation emails</a></li><li><span class=entry-date>2018-03-12</span>:
<a href=https://blog.jverkamp.com/2018/03/12/generating-zone-files-from-route53/>Generating zone files from Route53</a></li><li><span class=entry-date>2013-09-27</span>:
<a href=https://blog.jverkamp.com/2013/09/27/large-scale-asynchronous-dns-scans/>Large scale asynchronous DNS scans</a></li><li><span class=entry-date>2013-09-25</span>:
<a href=https://blog.jverkamp.com/2013/09/25/extending-rackets-dns-capabilities/>Extending Racket's DNS capabilities</a></li><li><span class=entry-date>2013-02-09</span>:
<a href=https://blog.jverkamp.com/2013/02/09/isma-2013-aims-5-dns-based-censorship/>ISMA 2013 AIMS-5 - DNS Based Censorship</a></li><li><span class=entry-date>2013-02-09</span>:
<a href=https://blog.jverkamp.com/2013/02/09/aims-5-day-3/>AIMS-5 - Day 3</a></li><li><span class=entry-date>2013-02-08</span>:
<a href=https://blog.jverkamp.com/2013/02/08/aims-5-day-2/>AIMS-5 - Day 2</a></li><li><span class=entry-date>2013-02-07</span>:
<a href=https://blog.jverkamp.com/2013/02/07/aims-5-workshop-on-active-internet-measurements/>AIMS-5 - Workshop on Active Internet Measurements</a></li><li><span class=entry-date>2013-01-31</span>:
<a href=https://blog.jverkamp.com/2013/01/31/scanning-for-dns-resolvers/>Scanning for DNS resolvers</a></li><li><span class=entry-date>2012-10-22</span>:
<a href=https://blog.jverkamp.com/2012/10/22/isc/caida-workshop/>ISC/CAIDA Workshop</a></li></ul></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>