<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cryptography on jverkamp.com</title><link>https://blog.jverkamp.com/programming/topics/cryptography/</link><description>Recent content in Cryptography on jverkamp.com</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Thu, 29 May 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.jverkamp.com/programming/topics/cryptography/atom.xml" rel="self" type="application/rss+xml"/><item><title>Parsing PEM Certificates &amp; ASN.1 in Javascript</title><link>https://blog.jverkamp.com/2025/05/29/parsing-pem-certificates-asn.1-in-javascript/</link><pubDate>Thu, 29 May 2025 00:00:00 +0000</pubDate><guid>https://blog.jverkamp.com/2025/05/29/parsing-pem-certificates-asn.1-in-javascript/</guid><description>&lt;p&gt;I recently had a conversation about parsing HTTPS/TLS/etc certificates client side (so that various values could be compared). There are, of course, &lt;a href="https://asn1js.org/" target="_blank" rel="noopener"&gt;libraries&lt;/a&gt; for that, but where&amp;rsquo;s the fun in that? Let&amp;rsquo;s dig in ourselves!&lt;/p&gt;
&lt;p&gt;I thought of course it would be a well specified format and it wouldn&amp;rsquo;t take more than a few minutes to parse&amp;hellip; right?&lt;/p&gt;
&lt;p&gt;Right?&lt;/p&gt;
&lt;nav id="TableOfContents"&gt;
 &lt;ul&gt;
 &lt;li&gt;&lt;a href="#parsing"&gt;Parsing&lt;/a&gt;&lt;/li&gt;
 &lt;li&gt;&lt;a href="#decoding-some-datatypes"&gt;Decoding some datatypes&lt;/a&gt;
 &lt;ul&gt;
 &lt;li&gt;&lt;a href="#object-identifiers--oids"&gt;Object Identifiers &amp;ndash; OIDs&lt;/a&gt;&lt;/li&gt;
 &lt;li&gt;&lt;a href="#numbers"&gt;Numbers&lt;/a&gt;&lt;/li&gt;
 &lt;li&gt;&lt;a href="#dates"&gt;Dates&lt;/a&gt;&lt;/li&gt;
 &lt;/ul&gt;
 &lt;/li&gt;
 &lt;li&gt;&lt;a href="#printing-results"&gt;Printing results&lt;/a&gt;&lt;/li&gt;
 &lt;li&gt;&lt;a href="#an-example"&gt;An example&lt;/a&gt;&lt;/li&gt;
 &lt;li&gt;&lt;a href="#constants"&gt;Constants&lt;/a&gt;&lt;/li&gt;
 &lt;/ul&gt;
&lt;/nav&gt;</description></item><item><title>WebCrypto SHA-256 HMAC</title><link>https://blog.jverkamp.com/2025/02/05/webcrypto-sha-256-hmac/</link><pubDate>Wed, 05 Feb 2025 00:00:00 +0000</pubDate><guid>https://blog.jverkamp.com/2025/02/05/webcrypto-sha-256-hmac/</guid><description>&lt;p&gt;A quick random thing I learned that I found helpful (and you might too!):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;async&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;function&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;hmac&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;text&lt;/span&gt;, &lt;span style="color:#a6e22e"&gt;secret&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;let&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;enc&lt;/span&gt; &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;new&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;TextEncoder&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;utf-8&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;let&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;algorithm&lt;/span&gt; &lt;span style="color:#f92672"&gt;=&lt;/span&gt; { &lt;span style="color:#a6e22e"&gt;name&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;HMAC&amp;#34;&lt;/span&gt;, &lt;span style="color:#a6e22e"&gt;hash&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;SHA-256&amp;#34;&lt;/span&gt; };
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;let&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;key&lt;/span&gt; &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;await&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;crypto&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;subtle&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;importKey&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;raw&amp;#34;&lt;/span&gt;, &lt;span style="color:#a6e22e"&gt;enc&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;encode&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;secret&lt;/span&gt;), &lt;span style="color:#a6e22e"&gt;algorithm&lt;/span&gt;, &lt;span style="color:#66d9ef"&gt;false&lt;/span&gt;, [&lt;span style="color:#e6db74"&gt;&amp;#34;sign&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;verify&amp;#34;&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;let&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;signature&lt;/span&gt; &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;await&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;crypto&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;subtle&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;sign&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;algorithm&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;name&lt;/span&gt;, &lt;span style="color:#a6e22e"&gt;key&lt;/span&gt;, &lt;span style="color:#a6e22e"&gt;enc&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;encode&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;text&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;let&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;digest&lt;/span&gt; &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;btoa&lt;/span&gt;(String.&lt;span style="color:#a6e22e"&gt;fromCharCode&lt;/span&gt;(...&lt;span style="color:#66d9ef"&gt;new&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;Uint8Array&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;signature&lt;/span&gt;)));
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;digest&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This is a function that uses the &lt;a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API" target="_blank" rel="noopener"&gt;Web Crypto API&lt;/a&gt; to calculate a &lt;a href="https://en.wikipedia.org/wiki/SHA-256"&gt;SHA-256&lt;/a&gt; &lt;a href="https://en.wikipedia.org/wiki/HMAC"&gt;HMAC&lt;/a&gt; of a string given a secret value.&lt;/p&gt;
&lt;p&gt;I mostly worked this out so that I could figure out how &lt;em&gt;exactly&lt;/em&gt; &lt;code&gt;TextEncoder&lt;/code&gt; worked, along with &lt;code&gt;importKey&lt;/code&gt; (to turn a secret into proper key material) and also how to convert that back into a hex digest.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;await&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;hmac&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;lorem ipsum&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;super secret&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;qArFX93Zi83ccIayhYnuFDpd4pk3eB4rZYDvNteobSU=&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;await&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;hmac&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;lorem ipsum doler sit amet&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;super secret&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;klTAioH5nNkguNhU2YcJshaZZtJW9DEb+MTqz4NWq8E=&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;await&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;hmac&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;lorem ipsum&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;even more super secret!&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;RoQLg2uz5KWLMJM72VExH5gZOls5bdZZyzHi678eDWs=&amp;#34;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;await&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;hmac&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;lorem ipsum&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;super secret&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;qArFX93Zi83ccIayhYnuFDpd4pk3eB4rZYDvNteobSU=&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Disclaimer: This totally counts as rolling your own crypto. Don&amp;rsquo;t do this unless you know what you&amp;rsquo;re doing. &amp;#x1f604;&lt;/p&gt;
&lt;p&gt;Disclaimer disclaimer: I only rarely know what I&amp;rsquo;m doing. &amp;#x1f604; &amp;#x1f604;&lt;/p&gt;
&lt;p&gt;Also, for what it&amp;rsquo;s worth, this is equivalent to the Python standard libraries&amp;rsquo; &lt;code&gt;&lt;a href="https://docs.python.org/3/search.html?q=hmac"&gt;hmac&lt;/a&gt;&lt;/code&gt;
 + &lt;code&gt;&lt;a href="https://docs.python.org/3/search.html?q=base64"&gt;base64&lt;/a&gt;&lt;/code&gt;
:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; base64&lt;span style="color:#f92672"&gt;.&lt;/span&gt;b64encode(hmac&lt;span style="color:#f92672"&gt;.&lt;/span&gt;digest(&lt;span style="color:#e6db74"&gt;b&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;super secret&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;b&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;lorem ipsum&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;SHA256&amp;#39;&lt;/span&gt;))&lt;span style="color:#f92672"&gt;.&lt;/span&gt;decode()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;qArFX93Zi83ccIayhYnuFDpd4pk3eB4rZYDvNteobSU=&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>Setting up Postfix and OpenDKIM</title><link>https://blog.jverkamp.com/2015/08/10/setting-up-postfix-and-opendkim/</link><pubDate>Mon, 10 Aug 2015 00:00:00 +0000</pubDate><guid>https://blog.jverkamp.com/2015/08/10/setting-up-postfix-and-opendkim/</guid><description>&lt;p&gt;Last week, I was presented with a fairly interesting challenge: add DKIM (via &lt;a href="http://www.opendkim.org/"&gt;OpenDKIM&lt;/a&gt;) support to our mail servers (running &lt;a href="http://www.postfix.org/"&gt;Postfix&lt;/a&gt;). Given that I&amp;rsquo;ve never actually worked on a mail server before, it sounded fun. &amp;#x1f604;&lt;/p&gt;</description></item><item><title>Caesar cipher</title><link>https://blog.jverkamp.com/2014/03/12/caesar-cipher/</link><pubDate>Wed, 12 Mar 2014 14:00:10 +0000</pubDate><guid>https://blog.jverkamp.com/2014/03/12/caesar-cipher/</guid><description>&lt;p&gt;&lt;a href="http://programmingpraxis.com/2014/03/11/caesar-cipher/"&gt;Here&amp;rsquo;s&lt;/a&gt; a 5 minute&lt;sup id="fnref:1"&gt;&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt; coding challenge from Programming Praxis:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A &lt;a href="https://en.wikipedia.org/wiki/Caesar%20cipher"&gt;caeser cipher&lt;/a&gt;, named after Julius Caesar, who either invented the cipher or was an early user of it, is a simple substitution cipher in which letters are substituted at a fixed distance along the alphabet, which cycles; childrenâ€™s magic decoder rings implement a caesar cipher. Non-alphabetic characters are passed unchanged. For instance, the plaintext PROGRAMMINGPRAXIS is rendered as the ciphertext SURJUDPPLQJSUDALV with a shift of 3 positions.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;figure&gt;&lt;img src="https://blog.jverkamp.com/embeds/2014/caesar-shift.png"&gt;
&lt;/figure&gt;

&amp;ndash; Source: &lt;a href="https://en.wikipedia.org/wiki/File:Caesar%20cipher%20left%20shift%20of%203.svg"&gt;Wikipedia&lt;/a&gt;, public domain&lt;/p&gt;</description></item><item><title>An optimal alphabetizing cipher</title><link>https://blog.jverkamp.com/2013/01/25/an-optimal-alphabetizing-cipher/</link><pubDate>Fri, 25 Jan 2013 19:45:37 +0000</pubDate><guid>https://blog.jverkamp.com/2013/01/25/an-optimal-alphabetizing-cipher/</guid><description>&lt;p&gt;Here is &lt;a href="http://www.reddit.com/r/dailyprogrammer/comments/178vsz/012513_challenge_118_hard_alphabetizing_cipher/" title="Challenge #118 [Hard] Alphabetizing cipher"&gt;today&amp;rsquo;s /r/dailyprogramming challenge&lt;/a&gt;: Generate a simple substitution cipher such that the maximum number of words in a given dictionary of six letter words (there are 7,260 of them) are encoded as strings in alphabetical order.&lt;/p&gt;</description></item></channel></rss>