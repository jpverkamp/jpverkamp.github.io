<!doctype html><html><head><title>Genuary 2026.11: Quine â€“ jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_17422284542669262002.min.834c1e2313951f0c25b90152fe8b62250eab4a2e8cbd2560fa1a1cdc91c71733.js integrity="sha256-g0weIxOVHwwluQFS/otiJQ6rSi6MvSVg+hoc3JHHFzM=" defer></script><script src=/jquery.fancybox_16245765822111608191.min.a8e11addf4349ee2ca5045f7f3cbf1febbf2c3a2840be2143ea69539c10f8c7f.js integrity="sha256-qOEa3fQ0nuLKUEX388vx/rvyw6KEC+IUPqaVOcEPjH8=" defer></script><script src=/katex_17296078054267651618.min.4a06464d8d6f8358d8896de62b53b5a89205d335dfd8c5b6b27edd7c039ae9d8.js integrity="sha256-SgZGTY1vg1jYiW3mK1O1qJIF0zXf2MW2sn7dfAOa6dg=" defer></script><script src=/auto-render_14944144240389301023.min.e694d9d5eae2917984179683ead27b998784a81398e8836c369373d2c67fc32a.js integrity="sha256-5pTZ1erikXmEF5aD6tJ7mYeEqBOY6INsNpNz0sZ/wyo=" defer></script><script src=/bigfoot_28293813221957978.min.af671f08986f0a2267c5a0cb2748b005489e47fa25f55479b200e2a563d23022.js integrity="sha256-r2cfCJhvCiJnxaDLJ0iwBUieR/ol9VR5sgDipWPSMCI=" defer></script><script src=/mermaid_9520146763733687737.min.a17078917a4403310cd19178939257b706fb5e1da76167c9f4a6d2123c9d59c4.js integrity="sha256-oXB4kXpEAzEM0ZF4k5JXtwb7Xh2nYWfJ9KbSEjydWcQ=" defer></script><script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script><link rel=stylesheet href=/katex_13658330645258633971.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_8781527669040159104.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_5330465509389191777.min.7420a1602c62a85d4b50881c1d8ce42f72c049dc2b097d440696425d6e54bb1e.css integrity="sha256-dCChYCxiqF1LUIgcHYzkL3LASdwrCX1EBpZCXW5Uux4="><link rel=stylesheet href=/css_1846377409604050217.min.fffe842bc000dd1fe8661ac6427a392a08faa95e8edab1ea7fb98c5f8dac6a6f.css integrity="sha256-//6EK8AA3R/oZhrGQno5Kgj6qV6O2rHqf7mMX42sam8="><link rel=stylesheet href=/main.min.61064b3964637440ee1c28e577377fcf238ddc5939020ef8b3c3cae543898111.css integrity="sha256-YQZLOWRjdEDuHCjldzd/zyON3Fk5Ag74s8PK5UOJgRE="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/home-automation/>Home Automation</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>Genuary 2026.11: Quine</h1><div class=entry-meta><span class=entry-date>2026-01-11</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2026/01/10/genuary-2026.10-polar-coordinates/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/javascript>JavaScript</a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2026/01/10/genuary-2026.10-polar-coordinates/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/generative-art>Generative Art</a></li><li><a href=https://blog.jverkamp.com/2026/01/10/genuary-2026.10-polar-coordinates/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/procedural-content>Procedural Content</a></li></ul></li><li><a class=taxonomy-key href=/series/>Series</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2026/01/10/genuary-2026.10-polar-coordinates/ class=previous-link></a><a class=taxonomy-value href=/series/genuary-2026>Genuary 2026</a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2026/01/10/genuary-2026.10-polar-coordinates/ class=previous-link>Prev</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2026/01/10/genuary-2026.10-polar-coordinates/ class=previous-link>Prev</a></ul></li></ul></div></div></header><div class=entry-content><figure class=cover-image><img src=gen26.11.png></figure><h2 id=9-quine>9) Quine</h2><p>Making a genart <a href=https://en.wikipedia.org/wiki/quine>quine</a>? That&rsquo;s&mldr; certainly a thing!</p><p>So basically I made a very simple stack based virtual machine. You can check the source code below for what commands it can actually run. It will then run until it outputs enough code to match the input length (or times out). If it happens to output a quine? Woot!</p><p>If not, it will randomly mutate and try again.</p><ul><li><code>ticksPerFrame</code> - How fast the simulation will run</li><li><code>breakAfter</code> - If this many ops run without output, break</li><li><code>maxStack</code> - Limit the size of the stack</li><li><code>pauseAfter</code> - Pause to see what happened after output is done or a break</li><li><code>pauseTime</code> - How long</li><li><code>randomizePercent</code> - How much of the input to randomly change for the next iteration</li><li><code>runOutput</code> - Run the output as the next program (otherwise, randomize the input)</li><li><code>fromString</code> - If you want to provide your own program (this is base64 of a compressed version of the bytes that make up the code; good luck?)</li></ul><p>If you manage to find a quine, I&rsquo;d <em>love</em> to hear what it was. I haven&rsquo;t found one yet. The string (that you can put it <code>fromString</code>) in your developer tools / JavaScript console.</p><div class=tab><button id=iframedemo class="tablinks default" data-tabset=4dd2 onclick='changeTab(event,"4dd2","iframedemo")'>Demo</button>
<button id=defaultscript class=tablinks data-tabset=4dd2 onclick='changeTab(event,"4dd2","defaultscript")'>Script</button></div><div class=tabcontent data-tabset=4dd2 id=iframedemo><iframe marginwidth=0 width=660 height=462.00000000000006 frameborder=0 srcdoc='
            
<html>
<head>
<script src="https://blog.jverkamp.com/p5.min_4477306625390811307.min.185c03ded0da66d81473a2407c6b9ee357529acc941a9182c61f6e924e26c9f3.js"></script><script src="https://blog.jverkamp.com/quicksettings_5902975354937418934.min.dbab3b4814bc1161ccdfe3780ee5adc04c40a6ecbb9c4f081c437d4cca0fe56a.js"></script><script src="https://blog.jverkamp.com/p5.gui_266292142240667823.min.5aca091ab81f7b1e9d8c792eeff5e79f6d36cdbe86e6b7d7256271bfebbce865.js"></script>

    <style>canvas { border: 1px solid black; border-radius: 1em; }</style>
</head>
<body>

            <script>

            
                
let gui;
let params = {
  cellSize: 10, cellSizeMin: 2, cellSizeMax: 40,
  ticksPerFrame: 100, ticksPerFrameMin: 0, ticksPerFrameMax: 1000,
  breakAfter: 1000, breakAfterMin: 1, breakAfterMax: 10000,
  maxStack: 256, maxStackMin: 4, maxStackMax: 1024,
  pauseAfter: true,
  pauseTime: 0.5, pauseTimeMin: 0, pauseTimeMax: 10.0, pauseTimeStep: 0.001,
  randomizePercent: 0.1, randomizePercentMin: 0.01, randomizePercentMax: 1.0, randomizePercentStep: 0.01,
  runOutput: true,
  fromString: "",
};

const OPS = [
  {name: &#39;nop&#39;, f: (m) => {}},
  {name: &#39;push&#39;, f: (m) => m.push(m.next())},
  {name: &#39;pop&#39;, f: (m) => m.pop()},
  {name: &#39;dup&#39;, f: (m) => { 
    let v = m.pop();
    m.push(v);
    m.push(v); 
  }},
  {name: &#39;roll&#39;, f: (m) => {
    let d = m.pop();
    let c = m.pop();
    
    let temp = [];
    for (let i = 0; i < d; i++) {
      if (m.stack.length > 0) {
        temp.push(m.pop());
      }
    }
    
    for (let i = 0; i < c; i++) {
      temp.push(temp.shift());
    }
    
    for (let v in temp) {
      m.push(v);
    }
  }},
  
  {name: &#39;out&#39;, f: (m) => m.out(m.pop())},
  
  {name: &#39;add&#39;, f: (m) => m.push(m.pop() + m.pop())},
  {name: &#39;sub&#39;, f: (m) => m.push(m.pop() - m.pop())},
  {name: &#39;mul&#39;, f: (m) => m.push(m.pop() * m.pop())},
  {name: &#39;div&#39;, f: (m) => m.push(m.pop() / (m.pop() || 1))},
  
  {name: &#39;not&#39;, f: (m) => m.push(m.pop() == 1 ? 0 : 1)},  
  {name: &#39;greater&#39;, f: (m) => m.push(m.pop() > m.pop() ? 1 : 0)},
  
  {name: &#39;jump&#39;, f: (m) => m.pc += m.pop()},
  {name: &#39;back&#39;, f: (m) => m.pc -= m.pop()},
];

class VM {
  constructor(w, h) {
    this.w = w;
    this.h = h;
    this.reset();
  }
  
  reset() {
    this.message = "";
    this.code = [];
    this.output = [];
    this.stack = [];
    this.pc = 0;
    this.ticksSinceOutput = 0;
  }
  
  push(v) {
    v = floor(v);
    while (v < 0) v += 256;
    this.stack.push(v % 256);
  }
  
  pop() {
    if (this.stack.length == 0) {
      return 0;
    } else {
      return this.stack.pop();
    }
  }
  
  next() {
    let v = this.code[this.pc % this.code.length];
    this.pc += 1;
    return v;
  }
  
  out(v) {
    this.ticksSinceOutput = 0;
    this.output.push(v % OPS.length);
  }
  
  randomize() {
    let previousCode = this.code || [];
    
    this.reset();
    
    for (let i = 0; i < this.w * this.h; i++) {
      if (i < previousCode.length && random() > params.randomizePercent) {
        this.code.push(previousCode[i]);
      } else {
        this.code.push(floor(random() * 256));
      }      
    }
  }
  
  step() {
    this.ticksSinceOutput += 1;
    
    let v = this.next();
    let op = OPS[v % OPS.length];
    op.f(this);
    
    while (this.pc < 0) this.pc += this.code.length;
    this.pc = this.pc % this.code.length;
    
    while (this.stack.lenght > params.maxStack) {
      this.stack.shift();
    }
  }
  
  draw() {
    background("white");
    
    // My program
    let draw = (data, xOffset) => {
      for (let cellX = 0; cellX < this.w; cellX++) {
        for (let cellY = 0; cellY < this.h; cellY++) {
          let i = cellX + cellY * this.w
          if (i >= data.length) {
            break;
          }
          
          let v = data[i];
          let hue = 360 * (v % OPS.length) / OPS.length;

          noStroke();
          fill(hue, 50, 100);
          
          rect(
            xOffset + cellX * params.cellSize,
            cellY * params.cellSize,
            params.cellSize,
            params.cellSize,
          );
        }
      }
    }
    
    draw(this.code, 0);
    draw(this.output, this.w * params.cellSize);
    
    // PC
    stroke("black");
    noFill();
    rect(
      this.pc % this.w * params.cellSize,
      floor(this.pc / this.w) * params.cellSize,
      params.cellSize,
      params.cellSize,
    );

    // Debug
    fill("black");
    if (this.message) {
      text(this.message, 8, this.h * params.cellSize + 16);
    } else {
      text(this.stack, 8, this.h * params.cellSize + 16);
    }
    
    // Borders
    stroke("black");
    strokeWeight(1);
    noFill();
    rect(
      0,
      0,
      this.w * params.cellSize,
      this.h * params.cellSize
    );
    
    rect(
      this.w * params.cellSize,
      0,
      this.w * params.cellSize,
      this.h * params.cellSize
    );
  }
}

function oldSetup() {
  createCanvas(400, 400);
  noStroke();
  colorMode(HSB, 360, 100, 100, 100);

  gui = createGuiPanel("params");
  gui.addObject(params);
  gui.setPosition(420, 0);
}

let loadedFromString = false;
let lastCellSize;
let currentVM; 

function draw() {
  if (currentVM == undefined || lastCellSize != params.cellSize) {
    lastCellSize = params.cellSize;
    currentVM = new VM(
      width / params.cellSize / 2,
      height / params.cellSize - 2,
    );
    
    currentVM.code = [];
    for (let i = 0; i < currentVM.w * currentVM.h; i++) {
      currentVM.code.push(0);
    }
  }
  
  if (params.fromString && !loadedFromString) {
    loadedFromString = true;
    noLoop();

    base64AndDecompress(params.fromString).then(bytes => {
      currentVM.reset();
      currentVM.code = Array.from(bytes).slice(0, currentVM.w * currentVM.h);

      while (currentVM.code.length < currentVM.w * currentVM.h) {
        currentVM.code.push(0);
      }

      loop();
    });
    return;
  }
  
  for (let i = 0; i < params.ticksPerFrame; i++) {
    currentVM.step();
    
    if (currentVM.output.length >= currentVM.code.length) {
      let previousCode = currentVM.code;
      let newCode = currentVM.output.slice(0, currentVM.code.length);
      if (newCode == previousCode) {
        currentVM.message = "QUINE FOUND! (see JS console)";
        compressAndBase64(newCode).then(console.log);
        
        currentVM.draw();
        
        noLoop();
        return;
      }
      
      currentVM.message = "output complete";
      currentVM.draw();
      
      currentVM.reset();
      if (params.runOutput) {
        currentVM.code = newCode;
      } else {
        currentVM.code = previousCode;
        currentVM.randomize();
      }
      
      if (params.pauseAfter) {
        noLoop();
        setTimeout(loop, params.pauseTime * 1000);  
      }
      
      return;
    }
    
    if (currentVM.ticksSinceOutput >= params.breakAfter) {
      currentVM.message = "timed out";
      currentVM.draw();
      
      currentVM.randomize();
      
      if (params.pauseAfter) {
        noLoop();
        setTimeout(loop, params.pauseTime * 1000);  
      }
      
      return;
    }    
  }
  
  currentVM.draw();
}

async function compressAndBase64(newCode) {
  const bytes = new Uint8Array(newCode);

  const cs = new CompressionStream("gzip");
  const writer = cs.writable.getWriter();
  writer.write(bytes);
  writer.close();

  const compressed = new Uint8Array(
    await new Response(cs.readable).arrayBuffer()
  );

  return btoa(String.fromCharCode(...compressed));
}

async function base64AndDecompress(b64) {
  const binary = atob(b64);
  const bytes = Uint8Array.from(binary, c => c.charCodeAt(0));

  const ds = new DecompressionStream("gzip");
  const writer = ds.writable.getWriter();
  writer.write(bytes);
  writer.close();

  return new Uint8Array(
    await new Response(ds.readable).arrayBuffer()
  );
}

            

            const START_PAUSED = false;

            
function setup() {
    // Store a copy of the original params
    const defaultParams = typeof params !== "undefined" ? { ...params } : {};

    // Load saved settings from the browser hash fragment
    if (parent.location.hash && typeof params !== "undefined") {
        try {
            var settings = JSON.parse(atob(parent.location.hash.substring(1)));
            Object.keys(params).forEach((key) => params[key] = key in settings ? settings[key] : params[key]);
        } catch(ex) {
        }
    }

    oldSetup();
    if (START_PAUSED) {
        noLoop();
    }

    createButton("play/pause").mousePressed(() => {
        if (isLooping()) {
            noLoop();
        } else {
            loop();
        }
    });

    createButton("save").mousePressed(() => {
        saveCanvas(&#39;photo&#39;, &#39;png&#39;)
    });

    createButton("clear").mousePressed(() => {
        if (typeof reset !== &#39;undefined&#39;) {
            reset();
        } else {
            clear();
        }
    });

    createButton("reload").mousePressed(() => {
        window.location.reload();
    });

    if (typeof params !== "undefined") {
        createButton("default").mousePressed(() => {
            for (const key in defaultParams) {
                params[key] = defaultParams[key];
            }
            parent.location.hash = btoa(JSON.stringify(params));
        });

        createButton("randomize").mousePressed(() => {
            // Grab all inputs inside the GUI container
            const guiContainer = document.querySelector(&#39;.qs_main&#39;); 
            if (!guiContainer) return;

            const inputs = guiContainer.querySelectorAll(&#39;input&#39;);
            let i = 0;

            for (const key in params) {
                const el = inputs[i++];
                if (!el) continue;

                if (el.type === "checkbox") {
                    el.checked = Math.random() < 0.5;
                    params[key] = el.checked;
                } else if (el.type === "range") {
                    const min = parseFloat(el.min);
                    const max = parseFloat(el.max);
                    const step = parseFloat(el.step) || 1;
                    const rangeSteps = Math.floor((max - min) / step);
                    const randomStep = Math.floor(Math.random() * (rangeSteps + 1));
                    const value = min + randomStep * step;
                    el.value = value;
                    params[key] = value;
                } else if (el.tagName.toLowerCase() === "select") {
                    const options = el.options;
                    const randomIndex = Math.floor(Math.random() * options.length);
                    el.selectedIndex = randomIndex;
                    params[key] = options[randomIndex].value;
                } else {
                    console.warn("Unsupported input type for randomization: " + el.type);
                }

                // Trigger input event to update the GUI and callbacks
                el.dispatchEvent(new Event(&#39;input&#39;, { bubbles: true }));
            }

            // Save the random state to hash
            parent.location.hash = btoa(JSON.stringify(params));
        });
    }

    if (typeof params !== "undefined") {
        for (var el of document.querySelectorAll(&#39;input&#39;)) {
            if (el.id && el.id.startsWith(&#39;qs_&#39;)) {
                el.addEventListener(&#39;change&#39;, () => {
                    parent.location.hash = btoa(JSON.stringify(params));
                });
            }
        }
    }
}

            </script>
            
<noscript>To display this p5.js sketch, JavaScript must be enabled.</noscript>
</body>
</html>

        '></iframe></div><div class=tabcontent data-tabset=4dd2 id=defaultscript><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>gui</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>params</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cellSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>cellSizeMin</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>cellSizeMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>40</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ticksPerFrame</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>100</span>, <span style=color:#a6e22e>ticksPerFrameMin</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>ticksPerFrameMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1000</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>breakAfter</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1000</span>, <span style=color:#a6e22e>breakAfterMin</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>breakAfterMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10000</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>maxStack</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>256</span>, <span style=color:#a6e22e>maxStackMin</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>4</span>, <span style=color:#a6e22e>maxStackMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1024</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pauseAfter</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pauseTime</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.5</span>, <span style=color:#a6e22e>pauseTimeMin</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>pauseTimeMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10.0</span>, <span style=color:#a6e22e>pauseTimeStep</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.001</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>randomizePercent</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.1</span>, <span style=color:#a6e22e>randomizePercentMin</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.01</span>, <span style=color:#a6e22e>randomizePercentMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.0</span>, <span style=color:#a6e22e>randomizePercentStep</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.01</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>runOutput</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fromString</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>OPS</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;nop&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; {}},
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;push&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>next</span>())},
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;pop&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>()},
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;dup&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; { 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>v</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>v</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>v</span>); 
</span></span><span style=display:flex><span>  }},
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;roll&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>d</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>stack</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>temp</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>());
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>c</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>temp</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>temp</span>.<span style=color:#a6e22e>shift</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>v</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>temp</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>v</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }},
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;out&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>out</span>(<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>())},
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;add&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>() <span style=color:#f92672>+</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>())},
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;sub&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>() <span style=color:#f92672>-</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>())},
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;mul&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>() <span style=color:#f92672>*</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>())},
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;div&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>() <span style=color:#f92672>/</span> (<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>() <span style=color:#f92672>||</span> <span style=color:#ae81ff>1</span>))},
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;not&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>() <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>)},  
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;greater&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>() <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>() <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>)},
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;jump&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>()},
</span></span><span style=display:flex><span>  {<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;back&#39;</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>m</span>) =&gt; <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>-=</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>pop</span>()},
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>VM</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>h</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>w</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>w</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>h</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>h</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>reset</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>reset</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>message</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>code</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>output</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>stack</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ticksSinceOutput</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>v</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>v</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>v</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>v</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#a6e22e>v</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>256</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>stack</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>v</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>stack</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>stack</span>.<span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>v</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>code</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>%</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>code</span>.<span style=color:#a6e22e>length</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>v</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>out</span>(<span style=color:#a6e22e>v</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ticksSinceOutput</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>output</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>v</span> <span style=color:#f92672>%</span> <span style=color:#a6e22e>OPS</span>.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>randomize</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>previousCode</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>code</span> <span style=color:#f92672>||</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>reset</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>h</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>previousCode</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>random</span>() <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>randomizePercent</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>code</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>previousCode</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>code</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>256</span>));
</span></span><span style=display:flex><span>      }      
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>step</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ticksSinceOutput</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>v</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>next</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>op</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>OPS</span>[<span style=color:#a6e22e>v</span> <span style=color:#f92672>%</span> <span style=color:#a6e22e>OPS</span>.<span style=color:#a6e22e>length</span>];
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>op</span>.<span style=color:#a6e22e>f</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>+=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>code</span>.<span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>%</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>code</span>.<span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>stack</span>.<span style=color:#a6e22e>lenght</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>maxStack</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>stack</span>.<span style=color:#a6e22e>shift</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>background</span>(<span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// My program
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>draw</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>xOffset</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cellX</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>cellX</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>w</span>; <span style=color:#a6e22e>cellX</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cellY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>cellY</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>h</span>; <span style=color:#a6e22e>cellY</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cellX</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>cellY</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>w</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>length</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>v</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>hue</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>360</span> <span style=color:#f92672>*</span> (<span style=color:#a6e22e>v</span> <span style=color:#f92672>%</span> <span style=color:#a6e22e>OPS</span>.<span style=color:#a6e22e>length</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>OPS</span>.<span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>hue</span>, <span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>rect</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>xOffset</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>cellX</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>cellY</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>          );
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>draw</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>code</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>draw</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>output</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// PC
</span></span></span><span style=display:flex><span>    <span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#34;black&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>noFill</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rect</span>(
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>%</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>floor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pc</span> <span style=color:#f92672>/</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>w</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Debug
</span></span></span><span style=display:flex><span>    <span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;black&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>message</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>text</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>message</span>, <span style=color:#ae81ff>8</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>16</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>text</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>stack</span>, <span style=color:#ae81ff>8</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>16</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Borders
</span></span></span><span style=display:flex><span>    <span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#34;black&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>strokeWeight</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>noFill</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rect</span>(
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rect</span>(
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>,
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>400</span>, <span style=color:#ae81ff>400</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode</span>(<span style=color:#a6e22e>HSB</span>, <span style=color:#ae81ff>360</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gui</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGuiPanel</span>(<span style=color:#e6db74>&#34;params&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gui</span>.<span style=color:#a6e22e>addObject</span>(<span style=color:#a6e22e>params</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gui</span>.<span style=color:#a6e22e>setPosition</span>(<span style=color:#ae81ff>420</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>loadedFromString</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lastCellSize</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>currentVM</span>; 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>currentVM</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>undefined</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>lastCellSize</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lastCellSize</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>currentVM</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>VM</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>code</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>h</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>code</span>.<span style=color:#a6e22e>push</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>fromString</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>loadedFromString</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>loadedFromString</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>noLoop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>base64AndDecompress</span>(<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>fromString</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>bytes</span> =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>reset</span>();
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>code</span> <span style=color:#f92672>=</span> Array.<span style=color:#a6e22e>from</span>(<span style=color:#a6e22e>bytes</span>).<span style=color:#a6e22e>slice</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>h</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>code</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>h</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>code</span>.<span style=color:#a6e22e>push</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>loop</span>();
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>ticksPerFrame</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>step</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>output</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>code</span>.<span style=color:#a6e22e>length</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>previousCode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>code</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newCode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>output</span>.<span style=color:#a6e22e>slice</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>code</span>.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>newCode</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>previousCode</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>message</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;QUINE FOUND! (see JS console)&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>compressAndBase64</span>(<span style=color:#a6e22e>newCode</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>draw</span>();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>noLoop</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>message</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;output complete&#34;</span>;
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>draw</span>();
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>reset</span>();
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>runOutput</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>code</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>newCode</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>code</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>previousCode</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>randomize</span>();
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>pauseAfter</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>noLoop</span>();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>setTimeout</span>(<span style=color:#a6e22e>loop</span>, <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>pauseTime</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000</span>);  
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>ticksSinceOutput</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>breakAfter</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>message</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;timed out&#34;</span>;
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>draw</span>();
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>randomize</span>();
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>pauseAfter</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>noLoop</span>();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>setTimeout</span>(<span style=color:#a6e22e>loop</span>, <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>pauseTime</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000</span>);  
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }    
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>currentVM</span>.<span style=color:#a6e22e>draw</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>compressAndBase64</span>(<span style=color:#a6e22e>newCode</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bytes</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Uint8Array</span>(<span style=color:#a6e22e>newCode</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>cs</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CompressionStream</span>(<span style=color:#e6db74>&#34;gzip&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>writer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cs</span>.<span style=color:#a6e22e>writable</span>.<span style=color:#a6e22e>getWriter</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>writer</span>.<span style=color:#a6e22e>write</span>(<span style=color:#a6e22e>bytes</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>writer</span>.<span style=color:#a6e22e>close</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>compressed</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Uint8Array</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Response</span>(<span style=color:#a6e22e>cs</span>.<span style=color:#a6e22e>readable</span>).<span style=color:#a6e22e>arrayBuffer</span>()
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>btoa</span>(String.<span style=color:#a6e22e>fromCharCode</span>(...<span style=color:#a6e22e>compressed</span>));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>base64AndDecompress</span>(<span style=color:#a6e22e>b64</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>binary</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>atob</span>(<span style=color:#a6e22e>b64</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bytes</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Uint8Array</span>.<span style=color:#a6e22e>from</span>(<span style=color:#a6e22e>binary</span>, <span style=color:#a6e22e>c</span> =&gt; <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>charCodeAt</span>(<span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ds</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>DecompressionStream</span>(<span style=color:#e6db74>&#34;gzip&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>writer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ds</span>.<span style=color:#a6e22e>writable</span>.<span style=color:#a6e22e>getWriter</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>writer</span>.<span style=color:#a6e22e>write</span>(<span style=color:#a6e22e>bytes</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>writer</span>.<span style=color:#a6e22e>close</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Uint8Array</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Response</span>(<span style=color:#a6e22e>ds</span>.<span style=color:#a6e22e>readable</span>).<span style=color:#a6e22e>arrayBuffer</span>()
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><div class=ranking><h3 class=title>Posts in <a href=/series/genuary-2026/>Genuary 2026</a>:</h3><div class=content><ul><li><a href=https://blog.jverkamp.com/2026/01/11/genuary-2026.11-quine/>Genuary 2026.11: Quine</a></li><li><a href=https://blog.jverkamp.com/2026/01/10/genuary-2026.10-polar-coordinates/>Genuary 2026.10: Polar coordinates</a></li><li><a href=https://blog.jverkamp.com/2026/01/09/genuary-2026.09-cellular-automata/>Genuary 2026.09: Cellular automata</a></li><li><a href=https://blog.jverkamp.com/2026/01/08/genuary-2026.08-a-city/>Genuary 2026.08: A city</a></li><li><a href=https://blog.jverkamp.com/2026/01/07/genuary-2026.07-boolean-algebra/>Genuary 2026.07: Boolean algebra</a></li><li><a href=https://blog.jverkamp.com/2026/01/06/genuary-2026.06-lights-on/off/>Genuary 2026.06: Lights on/off</a></li><li><a href=https://blog.jverkamp.com/2026/01/05/genuary-2026.05-write-genuary/>Genuary 2026.05: Write 'genuary'</a></li><li><a href=https://blog.jverkamp.com/2026/01/04/genuary-2026.04-lowres/>Genuary 2026.04: lowres</a></li><li><a href=https://blog.jverkamp.com/2026/01/03/genuary-2026.03-fibonacci-forever/>Genuary 2026.03: Fibonacci forever</a></li><li><a href=https://blog.jverkamp.com/2026/01/02/genuary-2026.02-twelve-principles-of-animation/>Genuary 2026.02: Twelve principles of animation</a></li><li><a href=https://blog.jverkamp.com/2026/01/01/genuary-2026.01-one-color-one-shape/>Genuary 2026.01: One color, one shape</a></li></ul></div></div></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>