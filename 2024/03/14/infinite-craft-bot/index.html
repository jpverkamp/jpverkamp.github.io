<!doctype html><html><head><title>Infinite Craft Bot ‚Äì jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_5823201688106629450.min.8c7d803d89ebdecf2416d468f4ecb981a3acf645154a7a336f2e5d0190ea8163.js integrity="sha256-jH2APYnr3s8kFtRo9Oy5gaOs9kUVSnozby5dAZDqgWM=" defer></script>
<script src=/jquery.fancybox_6181813213021922412.min.921ca906a32e718ab61ac0b4da24e0eaa6bdd41912654a33b44bd3fc2f0c2a4d.js integrity="sha256-khypBqMucYq2GsC02iTg6qa91BkSZUoztEvT/C8MKk0=" defer></script>
<script src=/katex_12008035502722260518.min.1c3dce03daaf56a7d2fe0d0ec49bf35256837226f835adaf52c09502ef9bc5d1.js integrity="sha256-HD3OA9qvVqfS/g0OxJvzUlaDcib4Na2vUsCVAu+bxdE=" defer></script>
<script src=/auto-render_2152414756166376840.min.45ae2f6b03d0c7b867df0a6cb7d43215ec78369998685a5748c5b12f502321f2.js integrity="sha256-Ra4vawPQx7hn3wpst9QyFex4NpmYaFpXSMWxL1AjIfI=" defer></script>
<script src=/bigfoot_8444447145154709333.min.5e80bd85ebaeb95607834d6777bfe7013d1d161f0f02a31b845e4bd765898316.js integrity="sha256-XoC9heuuuVYHg01nd7/nAT0dFh8PAqMbhF5L12WJgxY=" defer></script>
<script src=/mermaid_12365941879912544862.min.973b5415b3fa1835d620c0e58236f859d5f80891f447e240cbbb9eb825251ff0.js integrity="sha256-lztUFbP6GDXWIMDlgjb4WdX4CJH0R+JAy7ueuCUlH/A=" defer></script>
<script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script>
<link rel=stylesheet href=/katex_14163593549783030822.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_16482899066638414220.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_16222217791602823071.min.e28b5d7d9d89efacb5f708ac30cbd76b1b9a0f816dfd9da96631d1d09cbbdd76.css integrity="sha256-4otdfZ2J76y19wisMMvXaxuaD4Ft/Z2pZjHR0Jy73XY="><link rel=stylesheet href=/css_4780214198035419921.min.246b6f8e7620eeb717bca5e7b121037906e5dfaa05805f427fcc5a09b6c99f5c.css integrity="sha256-JGtvjnYg7rcXvKXnsSEDeQbl36oFgF9Cf8xaCbbJn1w="><link rel=stylesheet href=/main.min.7a29c6e86e28b6da48d6e8a526f4fa597dfba1464ca3f975ea9e0fb8c00052b7.css integrity="sha256-einG6G4ottpI1uilJvT6WX37oUZMo/l16p4PuMAAUrc="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>Infinite Craft Bot</h1><div class=entry-meta><span class=entry-date>2024-03-14</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2023/11/07/mongo-db-data-exfiltration-via-search-conditions/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/python>Python</a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2022/12/25/aoc-2022-day-25-snafuinator/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/algorithms>Algorithms</a><a href=https://blog.jverkamp.com/2024/03/28/a-good-snowman-is-hard-to-...-solve/ class=next-link></a></li><li><a class=taxonomy-value href=/programming/topics/breadth-first>Breadth First</a></li><li><a href=https://blog.jverkamp.com/2022/12/16/aoc-2022-day-16-pressurinator/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/graph-theory>Graph Theory</a><a href=https://blog.jverkamp.com/2024/12/10/aoc-2024-day-10-take-a-hikinator/ class=next-link></a></li><li><a class=taxonomy-value href=/programming/topics/search>Search</a><a href=https://blog.jverkamp.com/2024/12/07/aoc-2024-day-7-mathinator/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2023/12/28/advent-of-code-2023-testing-and-timing/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2024/03/28/a-good-snowman-is-hard-to-...-solve/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2024/03/14/star-wars-vol.-12-rebels-and-rogues/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2024/03/15/star-wars-vol.-13-rogues-and-rebels/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>You&rsquo;ve probably seen <a href=https://neil.fun target=_blank rel=noopener>Neil.fun</a>&rsquo;s <a href=https://neal.fun/infinite-craft/ target=_blank rel=noopener>Infinite Craft</a> game somewhere on the internet. If not, in a nutshell:</p><ul><li>You start with 4 blocks: <code>Earth</code>, <code>Fire</code>, <code>Water</code>, and <code>Wind</code>.</li><li>You can combine any two blocks, for example:<ul><li><code>Earth + Water = Plant</code></li><li><code>Plant + Fire = Smoke</code></li><li><code>Smoke + Smoke = Cloud</code></li></ul></li></ul><p>That&rsquo;s&mldr; pretty much it, from a gameplay perspective. There&rsquo;s not really any goal, other than what you set yourself (try to make Cthulhu!). Although if you manage to find something no one has ever made before, you get a neat little note for it!</p><p>So wait, what do I mean by &lsquo;something no one has ever seen before&rsquo;?</p><p>Well, if two elements have ever been combined by anyone before, you get a cached response. Barring resets of the game (no idea if / how often this has happened, but I assume it has), if <code>A + B = C</code> for you, <code>A + B = C</code> for everyone.</p><p>And here&rsquo;s the fun part: if you find a combination no one has ever found before: <code>Neil.fun</code> will send the combination out to an LLM to generate the new answer. The specific prompt isn&rsquo;t public (so far as I know), but essentially what that means is that you have a basically infinite crafting tree<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>!</p><p>So of course seeing something like this I want to automate it. üòÑ</p><hr><nav id=TableOfContents><ul><li><a href=#the-bot>The bot</a><ul><li><a href=#bot-detection>Bot detection</a></li><li><a href=#the-cache>The cache</a></li></ul></li><li><a href=#findings>Findings</a><ul><li><a href=#raw-data>Raw data</a></li><li><a href=#discoveries>Discoveries</a></li><li><a href=#minimal-ancestors>Minimal ancestors</a></li><li><a href=#rebuilding-a-path>Rebuilding a path</a></li><li><a href=#the-mostleast-interesting>The most/least interesting</a></li></ul></li></ul></nav><h2 id=the-bot>The bot</h2><p>In a nutshell, my algorithm is this:</p><ul><li>Store all known elements and combinations in <a href=#the-cache>a cache</a></li><li>Forever (or until the site blows up):<ul><li>Wait a moment<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></li><li>Choose two random elements we haven&rsquo;t chosen together before, submit them</li><li>Record the response in the cache</li></ul></li></ul><p>That&rsquo;s&mldr; really it. It took a bit more than that to get working (see <a href=#bot-detection>bot detection</a>), but that&rsquo;s <em>really</em> it. Here&rsquo;s the code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Initial values</span>
</span></span><span style=display:flex><span>elements <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Wind&#34;</span>, <span style=color:#e6db74>&#34;Earth&#34;</span>, <span style=color:#e6db74>&#34;Fire&#34;</span>, <span style=color:#e6db74>&#34;Water&#34;</span>]
</span></span><span style=display:flex><span>emoji <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Wind&#34;</span>: <span style=color:#e6db74>&#34;üå¨Ô∏è&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Earth&#34;</span>: <span style=color:#e6db74>&#34;üåç&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Fire&#34;</span>: <span style=color:#e6db74>&#34;üî•&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Water&#34;</span>: <span style=color:#e6db74>&#34;üíß&#34;</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>children <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>parents <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>history <span style=color:#f92672>=</span> set()
</span></span><span style=display:flex><span>discoveries <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>start <span style=color:#f92672>=</span> time<span style=color:#f92672>.</span>time()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>failures <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>max_failures <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Start guessing</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> failures <span style=color:#f92672>&lt;</span> max_failures:
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>0.1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Save periodically</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> time<span style=color:#f92672>.</span>time() <span style=color:#f92672>-</span> start <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>60</span>:
</span></span><span style=display:flex><span>        start <span style=color:#f92672>=</span> time<span style=color:#f92672>.</span>time()
</span></span><span style=display:flex><span>        save()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Pick two random elements</span>
</span></span><span style=display:flex><span>    e1 <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>choice(elements)
</span></span><span style=display:flex><span>    e2 <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>choice(elements)
</span></span><span style=display:flex><span>    e1, e2 <span style=color:#f92672>=</span> sorted([e1, e2])
</span></span><span style=display:flex><span>    pair <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>e1<span style=color:#e6db74>}</span><span style=color:#ae81ff>\0</span><span style=color:#e6db74>{</span>e2<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Skip if we&#39;ve already tried this pair</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> pair <span style=color:#f92672>in</span> history:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>    history<span style=color:#f92672>.</span>add(pair)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Make the request</span>
</span></span><span style=display:flex><span>    response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;https://neal.fun/api/infinite-craft/pair&#34;</span>,
</span></span><span style=display:flex><span>        params<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;first&#34;</span>: e1,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;second&#34;</span>: e2,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        headers<span style=color:#f92672>=...</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Parse response, print it out</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        data <span style=color:#f92672>=</span> response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> json<span style=color:#f92672>.</span>JSONDecodeError:
</span></span><span style=display:flex><span>        failures <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Failed to fetch JSON, retrying (</span><span style=color:#e6db74>{</span>failures<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>{</span>max_failures<span style=color:#e6db74>}</span><span style=color:#e6db74>)...&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> data[<span style=color:#e6db74>&#34;result&#34;</span>] <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> emoji:
</span></span><span style=display:flex><span>        print(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>emoji[e1]<span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>{</span>e1<span style=color:#e6db74>}</span><span style=color:#e6db74> + </span><span style=color:#e6db74>{</span>emoji[e2]<span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>{</span>e2<span style=color:#e6db74>}</span><span style=color:#e6db74> -&gt; </span><span style=color:#e6db74>{</span>data[<span style=color:#e6db74>&#34;emoji&#34;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>{</span>data[<span style=color:#e6db74>&#34;result&#34;</span>]<span style=color:#e6db74>}{</span><span style=color:#e6db74>&#34; (NEW)&#34;</span> <span style=color:#66d9ef>if</span> data[<span style=color:#e6db74>&#34;isNew&#34;</span>] <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Store any new discoveries</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> data[<span style=color:#e6db74>&#34;isNew&#34;</span>]:
</span></span><span style=display:flex><span>        discoveries<span style=color:#f92672>.</span>append(data[<span style=color:#e6db74>&#34;result&#34;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Store new elements</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> data[<span style=color:#e6db74>&#34;result&#34;</span>] <span style=color:#f92672>in</span> emoji:
</span></span><span style=display:flex><span>        elements<span style=color:#f92672>.</span>append(data[<span style=color:#e6db74>&#34;result&#34;</span>])
</span></span><span style=display:flex><span>        emoji[data[<span style=color:#e6db74>&#34;result&#34;</span>]] <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#34;emoji&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Store the forward relationship</span>
</span></span><span style=display:flex><span>    children[pair] <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#34;result&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Store the reverse relationship</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> data[<span style=color:#e6db74>&#34;result&#34;</span>] <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> parents:
</span></span><span style=display:flex><span>        parents[data[<span style=color:#e6db74>&#34;result&#34;</span>]] <span style=color:#f92672>=</span> set()
</span></span><span style=display:flex><span>    parents[data[<span style=color:#e6db74>&#34;result&#34;</span>]]<span style=color:#f92672>.</span>add(pair)
</span></span></code></pre></div><p>As mentioned, we have some custom types:</p><ul><li><code>Element</code> - A <code>str</code> representing the name of a single element.</li><li><code>ElementPair</code> - A <code>str</code> containing two null delimited <code>Elements</code>; so <code>Earth + Wind</code> would be encoded as <code>"Earth\u0000Wind"</code>. This handles the case that a specific element might actually have a <code>+</code> in the name, while (so far as I can tell) they will never contain a null byte.</li><li><code>Emoji</code> - A <code>str</code> containing the single (unicode) character that represents an <code>Element</code>, like <code>Wind</code> is üå¨Ô∏è and <code>Earth</code> is üåç, etc.</li></ul><p>From there, we can represent our data structures:</p><ul><li><code>elements: list[Element]</code> - Stores all elements that we know about. This has to be a <code>List</code> so that we can use <code>random.choice</code> (that should really be available on <code>Set</code>, no?)</li><li><code>emoji: dict[Element, Emoji]</code> - Maps each element to the (I assume generated) emoji that is sent with it; this also serves as an <code>O(1)</code> way to check if we&rsquo;ve seen an <code>Element</code> before (which <code>elements</code> can&rsquo;t do)</li><li><code>children: dict[ElementPair, Element]</code> - Maps all known combinations we&rsquo;ve seen</li><li><code>parents: dict[Element, set[ElementPair]]</code> - Stores every combination that can be used to create a specific <code>Element</code>; because JSON doesn&rsquo;t natively do <code>sets</code>, this is stored: list` and converted on save/load</li><li><code>history: set[ElementPair]</code> - Stores all pairs we&rsquo;ve tried; looking back on this now, this is just <code>children.keys()</code> so we didn&rsquo;t have to store this separately</li><li><code>discoveries: list[Element]</code> - Any elements that have never been created before in the (current) history of Infinite Craft, discovered by us! (or at least this bot)&mldr; Some of these are <em>weird</em>.</li></ul><h3 id=bot-detection>Bot detection</h3><p>One oddity (as hinted at with that <code>headers=...</code> line above) is that you can&rsquo;t just fire off a request and hope that it will work. I&rsquo;m honestly not sure if this is intentional (minimal) bot prevention or if it&rsquo;s a side effect of a library or cache used (there is CloudFront involved here).</p><p>But after a fair bit of experimentation, I&rsquo;ve found that you need to supply:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>headers<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;User-Agent&#34;</span>: user_agent,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Referer&#34;</span>: <span style=color:#e6db74>&#34;https://neal.fun/infinite-craft/&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Referrer-Policy&#34;</span>: <span style=color:#e6db74>&#34;strict-origin-when-cross-origin&#34;</span>,
</span></span><span style=display:flex><span>},
</span></span></code></pre></div><p>Where <code>user_agent</code> is a valid/new enough user agent. So a current version of Firefox/Chrome/etc.</p><p>It&rsquo;s interesting looking back at previous implementations others have done of this and/or some libraries people have written to do exactly this behavior. Many of them just don&rsquo;t currently work&ndash;and it&rsquo;s all because of these header checks.<sup id=fnref1:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><h3 id=the-cache>The cache</h3><p>So we don&rsquo;t want to just run this once. What if it crashes? We&rsquo;d have to lose all that progress on each run!</p><p>I&rsquo;m using <code><a href="https://docs.python.org/3/search.html?q=atexit">atexit</a></code>
to save all of these values to a JSON file any time this program exists:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>save</span>():
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Saving </span><span style=color:#e6db74>{</span>len(elements)<span style=color:#e6db74>}</span><span style=color:#e6db74> elements to cache&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;cache.json&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        json<span style=color:#f92672>.</span>dump(
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;elements&#34;</span>: elements,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;emoji&#34;</span>: emoji,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;children&#34;</span>: children,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;parents&#34;</span>: {k: list(v) <span style=color:#66d9ef>for</span> k, v <span style=color:#f92672>in</span> parents<span style=color:#f92672>.</span>items()},
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;history&#34;</span>: list(history),
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;discoveries&#34;</span>: discoveries,
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            f,
</span></span><span style=display:flex><span>            indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>atexit<span style=color:#f92672>.</span>register(save)
</span></span></code></pre></div><p>And likewise loading them on every start:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;cache.json&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Loading from cache&#34;</span>)
</span></span><span style=display:flex><span>        data <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>load(f)
</span></span><span style=display:flex><span>        elements <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#34;elements&#34;</span>]
</span></span><span style=display:flex><span>        emoji <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#34;emoji&#34;</span>]
</span></span><span style=display:flex><span>        children <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#34;children&#34;</span>]
</span></span><span style=display:flex><span>        parents <span style=color:#f92672>=</span> {k: set(v) <span style=color:#66d9ef>for</span> k, v <span style=color:#f92672>in</span> data[<span style=color:#e6db74>&#34;parents&#34;</span>]<span style=color:#f92672>.</span>items()}
</span></span><span style=display:flex><span>        history <span style=color:#f92672>=</span> set(data[<span style=color:#e6db74>&#34;history&#34;</span>])
</span></span><span style=display:flex><span>        discoveries <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#34;discoveries&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> <span style=color:#a6e22e>FileNotFoundError</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Cache not found&#34;</span>)
</span></span><span style=display:flex><span>    elements <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Wind&#34;</span>, <span style=color:#e6db74>&#34;Earth&#34;</span>, <span style=color:#e6db74>&#34;Fire&#34;</span>, <span style=color:#e6db74>&#34;Water&#34;</span>]
</span></span><span style=display:flex><span>    emoji <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Wind&#34;</span>: <span style=color:#e6db74>&#34;üå¨Ô∏è&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Earth&#34;</span>: <span style=color:#e6db74>&#34;üåç&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Fire&#34;</span>: <span style=color:#e6db74>&#34;üî•&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Water&#34;</span>: <span style=color:#e6db74>&#34;üíß&#34;</span>,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    children <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    parents <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    history <span style=color:#f92672>=</span> set()
</span></span><span style=display:flex><span>    discoveries <span style=color:#f92672>=</span> []
</span></span></code></pre></div><h2 id=findings>Findings</h2><p>And &mldr; that&rsquo;s it. Off we go! I ran it off and on over the course of a few nights (whenever I remembered it) and all together found some 4000 or so elements; over 400 of them never seen before! That&rsquo;s more than I expected.</p><p>So, what interesting things did we find/discover with this data?</p><h3 id=raw-data>Raw data</h3><p>Well, as mentioned, we have some 4000 elements:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat cache.json | jq -r <span style=color:#e6db74>&#39;.elements[]&#39;</span> | wc -l
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>4321</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat cache.json | jq -r <span style=color:#e6db74>&#39;.elements[]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Wind
</span></span><span style=display:flex><span>Earth
</span></span><span style=display:flex><span>Fire
</span></span><span style=display:flex><span>Water
</span></span><span style=display:flex><span>Dust
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>C-3po
</span></span><span style=display:flex><span>Space Fish
</span></span><span style=display:flex><span>Steampunk Poseidon
</span></span><span style=display:flex><span>Harry Potter and the Sorcerer‚Äôs Stone
</span></span><span style=display:flex><span>Apex Cider
</span></span></code></pre></div><h3 id=discoveries>Discoveries</h3><p>And of those, a good number have never been seen before!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat cache.json | jq -r <span style=color:#e6db74>&#39;.discoveries[]&#39;</span> | wc -l
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     <span style=color:#ae81ff>454</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat cache.json | jq -r <span style=color:#e6db74>&#39;.discoveries[]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Yggdrasil Fishing Pole
</span></span><span style=display:flex><span>Snow Pig Fishing Pole
</span></span><span style=display:flex><span>Treebillionaire
</span></span><span style=display:flex><span>Donut-dusa
</span></span><span style=display:flex><span>Moldy Fireman Rich
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>E-megatitan
</span></span><span style=display:flex><span>Mr. Selfie Mayhem
</span></span><span style=display:flex><span>Baconnaut Trumpwave
</span></span><span style=display:flex><span>Ginguitilla Hobopoly
</span></span><span style=display:flex><span>Apex Cider
</span></span></code></pre></div><p>I know right<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>? A lot of them are of the form &lsquo;(adjective) (noun)&rsquo;, sometimes with multiple in either category. And one reason we have so many&mldr; well look at those first two. If no one has ever seen a <code>Yggrasil Fishing Pole</code>, well it stands to reason they&rsquo;ve never combined it with <code>Snow Pig</code> to get a <code>Snow Pig Fishing Pole</code>! üòÑ</p><h3 id=minimal-ancestors>Minimal ancestors</h3><p>Next, let&rsquo;s do something a bit more interesting. Let&rsquo;s take all of those <code>parents</code> lists we&rsquo;ve generated before and find the minimal set of ancestors needed to build any specific element. More specifically:</p><ul><li>Create a <code>dict[Element, Set[Element]]</code> of minimal ancestors; populate with initial elements</li><li>Until this <code>dict</code> doesn&rsquo;t change:<ul><li>For each element <code>e</code>:<ul><li>For each pair <code>(e1) + (e2)</code> that can make <code>e</code>:<ul><li>Look up the minimal ancestors of <code>e1</code> and <code>e2</code></li><li>If either is not yet set, ignore this pair for now</li><li>If both are set, <code>union</code> their minimal ancestors and add <code>{e1, e2}</code></li><li>If this <code>union</code> is smaller than the current minimal set of <code>e</code> (or if that hans&rsquo;t been set)<ul><li>Update <code>e</code>&rsquo;s minimal set</li></ul></li></ul></li></ul></li></ul></li></ul><p>In code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;cache.json&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>load(f)
</span></span><span style=display:flex><span>    parents <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#34;parents&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>minimal_ancestors <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Wind&#34;</span>: set(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Earth&#34;</span>: set(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Fire&#34;</span>: set(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Water&#34;</span>: set(),
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>settled <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> <span style=color:#f92672>not</span> settled:
</span></span><span style=display:flex><span>    settled <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> element <span style=color:#f92672>in</span> parents:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> pair <span style=color:#f92672>in</span> parents[element]:
</span></span><span style=display:flex><span>            e1, e2 <span style=color:#f92672>=</span> pair<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\0</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> e1 <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> minimal_ancestors <span style=color:#f92672>or</span> e2 <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> minimal_ancestors:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            candidate <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>                {e1, e2}<span style=color:#f92672>.</span>union(minimal_ancestors[e1])<span style=color:#f92672>.</span>union(minimal_ancestors[e2])
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            new_best <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> element <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> minimal_ancestors:
</span></span><span style=display:flex><span>                new_best <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> len(candidate) <span style=color:#f92672>&lt;</span> len(minimal_ancestors[element]):
</span></span><span style=display:flex><span>                new_best <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> new_best:
</span></span><span style=display:flex><span>                settled <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>                minimal_ancestors[element] <span style=color:#f92672>=</span> candidate
</span></span></code></pre></div><p>This lets us find the elements that are the most &lsquo;complicated&rsquo; to build. Even if we take the easiest (known) way to build them, it will still take at least some minimal number of steps to make them.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>for</span> i, (
</span></span><span style=display:flex><span>    size,
</span></span><span style=display:flex><span>    key,
</span></span><span style=display:flex><span>) <span style=color:#f92672>in</span> enumerate(reversed(sorted((len(v), k) <span style=color:#66d9ef>for</span> k, v <span style=color:#f92672>in</span> minimal_ancestors<span style=color:#f92672>.</span>items())), <span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>] </span><span style=color:#e6db74>{</span>key<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>size<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> i <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>10</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><p>Out of my data set, we have:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> poetry run python minimal<span style=color:#f92672>-</span>ancestors<span style=color:#f92672>.</span>py
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>1</span>] The Flying Squidtopus: <span style=color:#ae81ff>313</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2</span>] Banana Sword: <span style=color:#ae81ff>291</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>3</span>] The Flying Sharktopus: <span style=color:#ae81ff>287</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>4</span>] Pigsink: <span style=color:#ae81ff>279</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>5</span>] Bananamobile: <span style=color:#ae81ff>275</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>6</span>] Cryptopopet: <span style=color:#ae81ff>268</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>7</span>] Banana Kong: <span style=color:#ae81ff>267</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>8</span>] Blueberry: <span style=color:#ae81ff>266</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>9</span>] Baconnaut Creeperzilla: <span style=color:#ae81ff>265</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>10</span>] Antbacon Sharktopus: <span style=color:#ae81ff>264</span>
</span></span></code></pre></div><p>Yup. It takes at least 287 other elements to make <code>The Flying Sharktopus</code> (the <code>The</code> is part of the <code>Element</code>!). And another 26 to make that into <code>The Flying Squidtopus</code>. The most interesting part of that (to me)?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat cache.json | jq -r <span style=color:#e6db74>&#39;.discoveries[]&#39;</span> | grep <span style=color:#e6db74>&#39;The Flying&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>The Flying Porkosaurus
</span></span><span style=display:flex><span>The Flying Organ Grinder
</span></span><span style=display:flex><span>The Flying Charizard Express
</span></span><span style=display:flex><span>The Flying Crabstick Of The Apes
</span></span><span style=display:flex><span>The Flying Apple Fritter
</span></span><span style=display:flex><span>The Flying Cryptotortoise
</span></span><span style=display:flex><span>The Flying Fisherman Express
</span></span><span style=display:flex><span>The Flying Garbage Truck
</span></span><span style=display:flex><span>The Flying Golemzilla
</span></span><span style=display:flex><span>The Flying Cactus Lobster Express
</span></span><span style=display:flex><span>The Flying Porkinator Express
</span></span><span style=display:flex><span>The Flying Dumbledore Fritter
</span></span><span style=display:flex><span>The Flying Sad Wizard
</span></span></code></pre></div><p><em>Neither of those</em> are ones we actually discovered. Someone else found both of them! It&rsquo;s entirely possible there are easier ways to get to them, but I still found that interesting.</p><h3 id=rebuilding-a-path>Rebuilding a path</h3><p>Okay, we can find the hard elements, but what about actually printing out the path to any particular element? Well, first we start with the same minimal element code, but then we need to do another loop:</p><ul><li>Generate a set of <code>minimal elements</code></li><li>Start with a set of the elements we have <code>built</code> and those <code>to_build</code> (everything but the basic starting 4)</li><li>Until the <code>to_build</code> is empty:<ul><li>For each element <code>e</code> in <code>to_build</code>; check each pair of elements <code>e1</code> and <code>e2</code> in built; if any pair makes <code>e</code>, report it and move it from <code>to_build</code> to <code>built</code></li></ul></li></ul><p>In code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>for</span> arg <span style=color:#f92672>in</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>:]:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;=== </span><span style=color:#e6db74>{</span>arg<span style=color:#e6db74>}</span><span style=color:#e6db74> ===&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> arg <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> minimal_ancestors:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Unknown element</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ancestors <span style=color:#f92672>=</span> minimal_ancestors[arg]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>seek</span>(known, target):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> e1 <span style=color:#f92672>in</span> known:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> e2 <span style=color:#f92672>in</span> known:
</span></span><span style=display:flex><span>                pair <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>e1<span style=color:#e6db74>}</span><span style=color:#ae81ff>\0</span><span style=color:#e6db74>{</span>e2<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> pair <span style=color:#f92672>in</span> parents[target]:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> (e1, e2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Could not find a way to build </span><span style=color:#e6db74>{</span>target<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    built <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;Earth&#34;</span>, <span style=color:#e6db74>&#34;Fire&#34;</span>, <span style=color:#e6db74>&#34;Water&#34;</span>, <span style=color:#e6db74>&#34;Wind&#34;</span>}
</span></span><span style=display:flex><span>    to_build <span style=color:#f92672>=</span> set(ancestors)<span style=color:#f92672>.</span>union({arg})<span style=color:#f92672>.</span>difference(built)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Need to loop until settled to handle cases where two tied ancestors only one can build</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> to_build:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> _, ancestor <span style=color:#f92672>in</span> sorted(
</span></span><span style=display:flex><span>            (len(minimal_ancestors[ancestor]), ancestor) <span style=color:#66d9ef>for</span> ancestor <span style=color:#f92672>in</span> list(to_build)
</span></span><span style=display:flex><span>        ):
</span></span><span style=display:flex><span>            newly_built <span style=color:#f92672>=</span> set()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> minimal_ancestors[ancestor]:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                    e1, e2 <span style=color:#f92672>=</span> seek(built, ancestor)
</span></span><span style=display:flex><span>                    print(ancestor, <span style=color:#e6db74>&#34;:&#34;</span>, e1, <span style=color:#e6db74>&#34;x&#34;</span>, e2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    built<span style=color:#f92672>.</span>add(ancestor)
</span></span><span style=display:flex><span>                    newly_built<span style=color:#f92672>.</span>add(ancestor)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span>:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            to_build <span style=color:#f92672>=</span> to_build<span style=color:#f92672>.</span>difference(newly_built)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print()
</span></span></code></pre></div><p>This will eventually print out the exact combination of elements needed to get to any one target (if we know how):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ poetry run python ancestors.py <span style=color:#e6db74>&#34;Gandalf&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> Gandalf <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>Dust : Earth x Wind
</span></span><span style=display:flex><span>Lava : Earth x Fire
</span></span><span style=display:flex><span>Planet : Dust x Earth
</span></span><span style=display:flex><span>Sandstorm : Dust x Wind
</span></span><span style=display:flex><span>Moon : Earth x Planet
</span></span><span style=display:flex><span>Mud : Dust x Water
</span></span><span style=display:flex><span>Storm : Planet x Wind
</span></span><span style=display:flex><span>Clay : Mud x Mud
</span></span><span style=display:flex><span>Swamp : Mud x Water
</span></span><span style=display:flex><span>Volcano : Clay x Lava
</span></span><span style=display:flex><span>Brick : Clay x Clay
</span></span><span style=display:flex><span>Dust Storm : Sandstorm x Storm
</span></span><span style=display:flex><span>Mist : Swamp x Wind
</span></span><span style=display:flex><span>Pottery : Clay x Earth
</span></span><span style=display:flex><span>Fog : Brick x Mist
</span></span><span style=display:flex><span>House : Brick x Earth
</span></span><span style=display:flex><span>Ceramic : Fire x Pottery
</span></span><span style=display:flex><span>Cloud : Fog x Wind
</span></span><span style=display:flex><span>Dustbin : Dust x House
</span></span><span style=display:flex><span>Ghost : Fog x Swamp
</span></span><span style=display:flex><span>Lunar Eclipse : Dust Storm x Moon
</span></span><span style=display:flex><span>Pig : Dustbin x Mud
</span></span><span style=display:flex><span>Pot : Ceramic x Earth
</span></span><span style=display:flex><span>Rain : Cloud x Earth
</span></span><span style=display:flex><span>Fireball : Fire x Ghost
</span></span><span style=display:flex><span>Haunted House : House x Moon
</span></span><span style=display:flex><span>Stone : Lava x Rain
</span></span><span style=display:flex><span>Piggy Bank : Ceramic x Pig
</span></span><span style=display:flex><span>Sun : Fireball x Moon
</span></span><span style=display:flex><span>Plant : Pot x Sun
</span></span><span style=display:flex><span>Desert : Sandstorm x Sun
</span></span><span style=display:flex><span>Glass : Brick x Sun
</span></span><span style=display:flex><span>Lens : Fog x Glass
</span></span><span style=display:flex><span>Telescope : Dust x Glass
</span></span><span style=display:flex><span>Wine : Glass x Water
</span></span><span style=display:flex><span>Camera : Lens x Plant
</span></span><span style=display:flex><span>Rich Ghost : Ghost x Piggy Bank
</span></span><span style=display:flex><span>Ghost Town : Desert x Haunted House
</span></span><span style=display:flex><span>Gold Rush : Dust x Ghost Town
</span></span><span style=display:flex><span>Rich Lava : Rich Ghost x Volcano
</span></span><span style=display:flex><span>Gold : Earth x Rich Lava
</span></span><span style=display:flex><span>Petra : Camera x Stone
</span></span><span style=display:flex><span>Pirate : Gold x Swamp
</span></span><span style=display:flex><span>Stonehenge : Petra x Telescope
</span></span><span style=display:flex><span>Money Tree : Gold Rush x Plant
</span></span><span style=display:flex><span>Pirate Ship : Pirate x Sun
</span></span><span style=display:flex><span>Druid : Lunar Eclipse x Stonehenge
</span></span><span style=display:flex><span>Titanic : Petra x Pirate Ship
</span></span><span style=display:flex><span>Bankrupt : Money Tree x Titanic
</span></span><span style=display:flex><span>Drunk : Bankrupt x Wine
</span></span><span style=display:flex><span>Black Hole : Dust Storm x Telescope
</span></span><span style=display:flex><span>Wizard : Black Hole x Druid
</span></span><span style=display:flex><span>Gandalf : Drunk x Wizard
</span></span></code></pre></div><p>Yup. <code>Drunk + Wizard = Gandalf</code> apparently. I would have gone for <code>High</code>, but so it goes. üòÑ</p><h3 id=the-mostleast-interesting>The most/least interesting</h3><p>And finally, we have arguably the &lsquo;most/least&rsquo; interesting elements. Either from the perspective of the <code>Emoji</code> used by the most/least known <code>Elements</code> or from the <code>Elements</code> with the most children.</p><p>For the most part, it&rsquo;s a bunch of sorting and filtering.</p><p>Here&rsquo;s what I found from my data:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ poetry run python most-least.py
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>easiest to get <span style=color:#f92672>(</span>179, <span style=color:#e6db74>&#39;Pig&#39;</span><span style=color:#f92672>)</span> : Pigpen x Tsunami, Church x Rich Bacon, Fake x Pig King Kong ...
</span></span><span style=display:flex><span>singletons <span style=color:#f92672>(</span> <span style=color:#ae81ff>2278</span> <span style=color:#f92672>)</span>:  Sad Mangrotron, Porky Poseidon, Sea Weed ...
</span></span><span style=display:flex><span>most children <span style=color:#f92672>(</span>52, <span style=color:#e6db74>&#39;Earth&#39;</span><span style=color:#f92672>)</span> : Eruption, Dust, Earth ...
</span></span><span style=display:flex><span>singleton children <span style=color:#f92672>(</span> <span style=color:#ae81ff>449</span> <span style=color:#f92672>)</span> :  The Flying Porkinator Express, Captain Narcissist, Herculean Flying Organ Grinder ...
</span></span><span style=display:flex><span>most common emoji <span style=color:#f92672>(</span>222, <span style=color:#e6db74>&#39;ü¶Ä&#39;</span><span style=color:#f92672>)</span> : Spongebob Crab Rangoon Pants, Crab Titanium, Crab Cone ...
</span></span><span style=display:flex><span>singleton emoji <span style=color:#f92672>(</span> <span style=color:#ae81ff>171</span> <span style=color:#f92672>)</span> :  üöï, ü§ï, ü¶â, ü¶°, üêû, üèá, üòµ, üëò, üáª, üèÉ ...
</span></span></code></pre></div><p>Specifically, &rsquo;easiest to get&rsquo; is the <code>Element</code> we can get 179 different ways. Take that <code>Pig</code>.</p><p><code>singletons</code> is the more than half we&rsquo;ve only found one way (so far) to get to, with <code>singleton_children</code> being those elements that only create 1 other element (but not zero) and <code>singleton emoji</code> the <code>Emoji</code> only used by a single element (necessarily a <code>singleton</code> itself).</p><p><code>most_children</code> is the most prolific element: <code>Earth</code>, which can make 52 others (makes sense, it&rsquo;s a base element), while the most common emoji&mldr; <a href=https://en.wikipedia.org/wiki/Carcinisation>Carcinisation</a> is real, yo.</p><p>And that&rsquo;s it. It&rsquo;s a fun little project based on a fun little project. Onwards!</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Technically, you could end up in a state where every single possible element has been found, since there are multiple ways to make any specific element. For example you can make <code>Gandalf</code> from <code>Bilbo + Thunderstorm</code> or <code>Blacksmith + Dumbledore</code>. Or even <code>Old Man + Rainbow Smaug</code><sup id=fnref1:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>!. But eventually, you might combine <code>Bilbo</code> with every other element. And <code>Thunderstorm</code> with every other element. Etc. But it seems that the branching factor is sufficiently high that this should never practical happen<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Okay, first up: This is not at all &lsquo;optimal&rsquo; web citizen behavior.</p><p>On one hand, there&rsquo;s nothing that suggests Infinite Craft was designed to be automated&ndash;there&rsquo;s only an API so much as the site itself exists and even that has some basic bot protection (intentional or not).</p><p>On the other hand, there&rsquo;s little <em>specifically</em> on Neil.fun that prohibits this behavior. There&rsquo;s not really a terms of service (although there is a Privacy Policy). Nor even a robots.txt (not that I went looking before implementing this).</p><p>So&mldr; I suppose your milage may vary. I did make sure to put in some manual delays in my code (so it didn&rsquo;t just run as quickly as possible). I ran it primarily at night (although when that is varies depending on where in the world you are, of course). And when the site started responding oddly, I stopped scraping (although that was half or more because it stopped giving useful data).&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>I know right? You&rsquo;d think just <code>Old Man + Smaug</code>, but you&rsquo;ll see / have seen in <a href=#the-bot>the implementation details</a> that I&rsquo;m choosing which things to combine randomly. So I never actually tried just <code>Smaug</code> for this. I do have him (<code>Fire Flower + The Hobbit</code>. Or actually <code>Fire + Gandalf</code>), I just didn&rsquo;t try that combination.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><code>Astrologer + Rainbow Smoke Train = The End of the World</code>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>