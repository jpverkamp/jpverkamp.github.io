<!doctype html><html><head><title>p5js Boids â€“ jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_17422284542669262002.min.834c1e2313951f0c25b90152fe8b62250eab4a2e8cbd2560fa1a1cdc91c71733.js integrity="sha256-g0weIxOVHwwluQFS/otiJQ6rSi6MvSVg+hoc3JHHFzM=" defer></script><script src=/jquery.fancybox_16245765822111608191.min.a8e11addf4349ee2ca5045f7f3cbf1febbf2c3a2840be2143ea69539c10f8c7f.js integrity="sha256-qOEa3fQ0nuLKUEX388vx/rvyw6KEC+IUPqaVOcEPjH8=" defer></script><script src=/katex_17296078054267651618.min.4a06464d8d6f8358d8896de62b53b5a89205d335dfd8c5b6b27edd7c039ae9d8.js integrity="sha256-SgZGTY1vg1jYiW3mK1O1qJIF0zXf2MW2sn7dfAOa6dg=" defer></script><script src=/auto-render_14944144240389301023.min.e694d9d5eae2917984179683ead27b998784a81398e8836c369373d2c67fc32a.js integrity="sha256-5pTZ1erikXmEF5aD6tJ7mYeEqBOY6INsNpNz0sZ/wyo=" defer></script><script src=/bigfoot_28293813221957978.min.af671f08986f0a2267c5a0cb2748b005489e47fa25f55479b200e2a563d23022.js integrity="sha256-r2cfCJhvCiJnxaDLJ0iwBUieR/ol9VR5sgDipWPSMCI=" defer></script><script src=/mermaid_9520146763733687737.min.a17078917a4403310cd19178939257b706fb5e1da76167c9f4a6d2123c9d59c4.js integrity="sha256-oXB4kXpEAzEM0ZF4k5JXtwb7Xh2nYWfJ9KbSEjydWcQ=" defer></script><script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script><link rel=stylesheet href=/katex_13658330645258633971.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_8781527669040159104.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_5330465509389191777.min.7420a1602c62a85d4b50881c1d8ce42f72c049dc2b097d440696425d6e54bb1e.css integrity="sha256-dCChYCxiqF1LUIgcHYzkL3LASdwrCX1EBpZCXW5Uux4="><link rel=stylesheet href=/css_1846377409604050217.min.fffe842bc000dd1fe8661ac6427a392a08faa95e8edab1ea7fb98c5f8dac6a6f.css integrity="sha256-//6EK8AA3R/oZhrGQno5Kgj6qV6O2rHqf7mMX42sam8="><link rel=stylesheet href=/main.min.5ff4b87c40715a96119d8b5f34d971604fc65ab18f4870fd8da6ede9fd1e6188.css integrity="sha256-X/S4fEBxWpYRnYtfNNlxYE/GWrGPSHD9jabt6f0eYYg="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/home-automation/>Automation</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>p5js Boids</h1><div class=entry-meta><span class=entry-date>2020-11-18</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2020/11/17/p5js-worms/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/javascript>JavaScript</a><a href=https://blog.jverkamp.com/2020/11/19/worm-coral/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2020/11/17/p5js-worms/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/cellular-automata>Cellular Automata</a><a href=https://blog.jverkamp.com/2020/11/19/worm-coral/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2020/11/17/p5js-worms/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/generative-art>Generative Art</a><a href=https://blog.jverkamp.com/2020/11/19/worm-coral/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2020/11/17/p5js-worms/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/procedural-content>Procedural Content</a><a href=https://blog.jverkamp.com/2020/11/19/worm-coral/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2020/11/17/p5js-worms/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2020/11/19/worm-coral/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2020/11/17/jack-of-fables-vol.-9-the-end/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2020/11/18/fairest-volume-4-of-men-and-mice/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>Okay, sketch 2: <a href=https://en.wikipedia.org/wiki/Boids>Boids</a>!</p><p>The basic idea is to create a bunch of particles (the Boids in this case) and apply to them each a series of simple, limited rules that rely neither on communcation between the Boids nor a global controller and see what behaviors you can generate. Specifically, can you replicate the flocking behavior found in birds, since birds can obviously fly together without hitting one another and also without some lead bird giving orders.</p><p>Something like this:</p><figure><img src=/embeds/2020/boids.png></figure><p>For this case, there are three rules:</p><ul><li><strong>seperation</strong> - Fly away from any Boids that are too close to you (to avoid collision)</li><li><strong>alignment</strong> - Align yourself to fly in the same direction as any Boids in your field of vision</li><li><strong>cohesion</strong> - Fly towards the center point of the Boids you can see</li></ul><p>Let&rsquo;s turn that into code:</p><div class=tab><button id=iframedemo class="tablinks default" data-tabset=22c4 onclick='changeTab(event,"22c4","iframedemo")'>Demo</button>
<button id=defaultscript class=tablinks data-tabset=22c4 onclick='changeTab(event,"22c4","defaultscript")'>Script</button></div><div class=tabcontent data-tabset=22c4 id=iframedemo><iframe marginwidth=0 width=660 height=462.00000000000006 frameborder=0 srcdoc='
            
<html>
<head>
<script src="https://blog.jverkamp.com/p5.min_5364076176882696478.min.03e58eac22b37cd98b545eab49e3c890d99eecac6d1cbe8a3880fade45bb09ff.js"></script><script src="https://blog.jverkamp.com/quicksettings_5902975354937418934.min.dbab3b4814bc1161ccdfe3780ee5adc04c40a6ecbb9c4f081c437d4cca0fe56a.js"></script><script src="https://blog.jverkamp.com/p5.gui_266292142240667823.min.5aca091ab81f7b1e9d8c792eeff5e79f6d36cdbe86e6b7d7256271bfebbce865.js"></script>

    <style>canvas { border: 1px solid black; border-radius: 1em; }</style>
</head>
<body>

            <script>

            
                
let gui;
let params = {
    boidCount: 10, boidCountMin: 1,
    boidVision: 50, boidVisionMin: 1, boidVisionMax: 100,
    displayVision: false,

    maximumVelocity: 2, maximumVelocityMin: 1, maximumVelocityMax: 10, maximumVelocityStep: 0.1,
    fade: 0.05, fadeMin: 0, fadeMax: 1, fadeStep: 0.01,

    seperationForce: 1, seperationForceMin: -1, seperationForceMax: 10, seperationForceStep: 0.1,
    alignmentForce: 2, alignmentForceMin: -1, alignmentForceMax: 10, alignmentForceStep: 0.1,
    cohesionForce: 2, cohesionForceMin: -1, cohesionForceMax: 10, cohesionForceStep: 0.1
};

var boids = [];

class Boid {
  constructor(p, v, c) {
    this.p = p;
    if (!p) this.p = createVector(random(width), random(height));

    this.v = v;
    if (!v) this.v = createVector(
      random(-params["maximumVelocity"], params["maximumVelocity"]),
      random(-params["maximumVelocity"], params["maximumVelocity"])
    );
    this.v = this.v.limit(params["maximumVelocity"]);

    this.c = c;
    if (!c) this.c = color(random(256), random(256), random(256));
  }

  update() {
    // Fix boid count
    while (boids.length < params["boidCount"]) boids.push(new Boid());
    while (boids.length > params["boidCount"]) boids.pop();

    // Seperation
    for (var other of boids) {
      if (this.p.dist(other.p) < params["boidVision"]) {
        this.v =
          p5.Vector.sub(this.p, other.p)
          .normalize()
          .mult(params["seperationForce"] * params["maximumVelocity"])
          .add(this.v);
      }
    }

    // Calculate the average boid of the local flock
    var flock = []
    for (other of boids) {
      if (this != other && this.p.dist(other.p) < params["boidVision"]) {
        flock.push(other);
      }
    }

    if (flock.length > 0) {
      var average = flock.reduce((average, boid) => new Boid(
        p5.Vector.add(average.p, boid.p),
        p5.Vector.add(average.v, boid.v),
      ));
      average.p.div(flock.length);
      average.v.div(flock.length);

      // Alignment
      this.v.add(p5.Vector.mult(average.v, params["alignmentForce"]));

      // Cohesion
      this.v =
        p5.Vector.sub(average.p, this.p)
        .normalize()
        .mult(params["cohesionForce"] * params["maximumVelocity"])
        .add(this.v);
    }

    // Clamp and move
    this.v.limit(params["maximumVelocity"]);
    this.p.add(this.v);

    this.p.x = (this.p.x + width) % width;
    this.p.y = (this.p.y + height) % height;
  }

  draw() {
    fill(this.c);
    noStroke();
    ellipse(this.p.x, this.p.y, 2, 2);
    
    noFill();
    stroke(this.c);
    if (params["displayVision"]) {
      ellipse(this.p.x, this.p.y, params["boidVision"], params["boidVision"]);
    }
  }
}

function oldSetup() {
  createCanvas(400, 400);
  gui = createGuiPanel(&#39;boids&#39;);
  gui.addObject(params);
  gui.setPosition(420, 0);

  for (var i = 0; i < params["boidCount"]; i++) {
    boids.push(new Boid());
  }
}

function draw() {
  fill(color(256, 256, 256, 256 * params["fade"]));
  noStroke();
  rect(0, 0, width, height);

  boids.forEach((boid) => boid.update());
  boids.forEach((boid) => boid.draw());
}

function keyTyped() {
  if (key === &#39;s&#39;) {
    saveCanvas(&#39;photo&#39;, &#39;png&#39;);
  }

  if (key == &#39;c&#39;) {
    clear();
  }
}

            

            const START_PAUSED = false;

            
function setup() {
    // Store a copy of the original params
    const defaultParams = typeof params !== "undefined" ? { ...params } : {};
    window.defaultParams = defaultParams; // Store for use in updateQueryParameters

    if (typeof params !== "undefined") {
        const urlParams = new URLSearchParams(parent.window.location.search);
        let hasQueryParams = false;
        
        for (const key in params) {
            if (urlParams.has(key)) {
                hasQueryParams = true;
                break;
            }
        }

        // Load from query parameters if present
        // Fallback to legacy hash fragment
        if (hasQueryParams) {
            for (const key in params) {
                if (urlParams.has(key)) {
                    const value = urlParams.get(key);
                    // Parse the value based on the type of the default param
                    if (typeof defaultParams[key] === &#39;boolean&#39;) {
                        params[key] = value === &#39;true&#39;;
                    } else if (typeof defaultParams[key] === &#39;number&#39;) {
                        params[key] = parseFloat(value);
                    } else {
                        params[key] = value;
                    }
                }
            }
        } else if (parent.location.hash) {
            try {
                var settings = JSON.parse(atob(parent.location.hash.substring(1)));
                Object.keys(params).forEach((key) => params[key] = key in settings ? settings[key] : params[key]);
            } catch(ex) {
            }
        }
    }

    oldSetup();
    if (START_PAUSED) {
        noLoop();
    }

    createButton("play/pause").mousePressed(() => {
        if (isLooping()) {
            noLoop();
        } else {
            loop();
        }
    });

    createButton("save").mousePressed(() => {
        saveCanvas(&#39;photo&#39;, &#39;png&#39;)
    });

    createButton("clear").mousePressed(() => {
        if (typeof reset !== &#39;undefined&#39;) {
            reset();
        } else {
            clear();
        }
    });

    createButton("reload").mousePressed(() => {
        window.location.reload();
    });

    if (typeof params !== "undefined") {
        createButton("default").mousePressed(() => {
            // Load without query parameters to re-default
            parent.window.location.href = parent.window.location.pathname;
        });

        /*
        createButton("randomize").mousePressed(() => {
            // Grab all inputs inside the GUI container
            const guiContainer = document.querySelector(&#39;.qs_main&#39;); 
            if (!guiContainer) return;

            const inputs = guiContainer.querySelectorAll(&#39;input&#39;);
            let i = 0;

            for (const key in params) {
                const el = inputs[i++];
                if (!el) continue;

                if (el.type === "checkbox") {
                    el.checked = Math.random() < 0.5;
                    params[key] = el.checked;
                } else if (el.type === "range") {
                    const min = parseFloat(el.min);
                    const max = parseFloat(el.max);
                    const step = parseFloat(el.step) || 1;
                    const rangeSteps = Math.floor((max - min) / step);
                    const randomStep = Math.floor(Math.random() * (rangeSteps + 1));
                    const value = min + randomStep * step;
                    el.value = value;
                    params[key] = value;
                } else if (el.tagName.toLowerCase() === "select") {
                    const options = el.options;
                    const randomIndex = Math.floor(Math.random() * options.length);
                    el.selectedIndex = randomIndex;
                    params[key] = options[randomIndex].value;
                } else {
                    console.warn("Unsupported input type for randomization: " + el.type);
                }

                // Trigger input event to update the GUI and callbacks
                el.dispatchEvent(new Event(&#39;input&#39;, { bubbles: true }));
            }

            // Save the random state to hash
            parent.location.hash = btoa(JSON.stringify(params));
        });
        */
    }

    if (typeof params !== "undefined") {
        for (var el of document.querySelectorAll(&#39;input&#39;)) {
            if (el.id && el.id.startsWith(&#39;qs_&#39;)) {
                el.addEventListener(&#39;change&#39;, () => {
                    updateQueryParameters();
                });
            }
        }
    }
}

function updateQueryParameters() {
    if (typeof params === "undefined") return;
    
    const defaultParams = typeof window.defaultParams !== "undefined" ? window.defaultParams : {};
    const urlParams = new URLSearchParams();
    
    // Only add parameters that differ from the default
    for (const key in params) {
        const value = params[key];
        if (JSON.stringify(value) !== JSON.stringify(defaultParams[key])) {
            urlParams.set(key, value);
        }
    }
    
    // Update URL without saving to history
    const newUrl = urlParams.toString() ? 
        parent.window.location.pathname + &#39;?&#39; + urlParams.toString() :
        parent.window.location.pathname;
    parent.window.history.replaceState({}, &#39;&#39;, newUrl);
}

            </script>
            
<noscript>To display this p5.js sketch, JavaScript must be enabled.</noscript>
</body>
</html>

        '></iframe></div><div class=tabcontent data-tabset=22c4 id=defaultscript><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>gui</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>params</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>boidCount</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>boidCountMin</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>boidVision</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>50</span>, <span style=color:#a6e22e>boidVisionMin</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>boidVisionMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>100</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>displayVision</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>maximumVelocity</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>maximumVelocityMin</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>maximumVelocityMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>maximumVelocityStep</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.1</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fade</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.05</span>, <span style=color:#a6e22e>fadeMin</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>fadeMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>fadeStep</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.01</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>seperationForce</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>seperationForceMin</span><span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>seperationForceMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>seperationForceStep</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.1</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>alignmentForce</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>alignmentForceMin</span><span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>alignmentForceMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>alignmentForceStep</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.1</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cohesionForce</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>cohesionForceMin</span><span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>cohesionForceMax</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>cohesionForceStep</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.1</span>
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>boids</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Boid</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>p</span>, <span style=color:#a6e22e>v</span>, <span style=color:#a6e22e>c</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>p</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>p</span>) <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVector</span>(<span style=color:#a6e22e>random</span>(<span style=color:#a6e22e>width</span>), <span style=color:#a6e22e>random</span>(<span style=color:#a6e22e>height</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>v</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>v</span>) <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVector</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;maximumVelocity&#34;</span>], <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;maximumVelocity&#34;</span>]),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>random</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;maximumVelocity&#34;</span>], <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;maximumVelocity&#34;</span>])
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span>.<span style=color:#a6e22e>limit</span>(<span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;maximumVelocity&#34;</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>c</span>) <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>random</span>(<span style=color:#ae81ff>256</span>), <span style=color:#a6e22e>random</span>(<span style=color:#ae81ff>256</span>), <span style=color:#a6e22e>random</span>(<span style=color:#ae81ff>256</span>));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>update</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Fix boid count
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>boids</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;boidCount&#34;</span>]) <span style=color:#a6e22e>boids</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Boid</span>());
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>boids</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;boidCount&#34;</span>]) <span style=color:#a6e22e>boids</span>.<span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Seperation
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>other</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>boids</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>dist</span>(<span style=color:#a6e22e>other</span>.<span style=color:#a6e22e>p</span>) <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;boidVision&#34;</span>]) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>p5</span>.<span style=color:#a6e22e>Vector</span>.<span style=color:#a6e22e>sub</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>, <span style=color:#a6e22e>other</span>.<span style=color:#a6e22e>p</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>normalize</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>mult</span>(<span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;seperationForce&#34;</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;maximumVelocity&#34;</span>])
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Calculate the average boid of the local flock
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>flock</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#a6e22e>other</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>boids</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>other</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>dist</span>(<span style=color:#a6e22e>other</span>.<span style=color:#a6e22e>p</span>) <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;boidVision&#34;</span>]) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>flock</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>other</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>flock</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>average</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>flock</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>average</span>, <span style=color:#a6e22e>boid</span>) =&gt; <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Boid</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>p5</span>.<span style=color:#a6e22e>Vector</span>.<span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>average</span>.<span style=color:#a6e22e>p</span>, <span style=color:#a6e22e>boid</span>.<span style=color:#a6e22e>p</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>p5</span>.<span style=color:#a6e22e>Vector</span>.<span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>average</span>.<span style=color:#a6e22e>v</span>, <span style=color:#a6e22e>boid</span>.<span style=color:#a6e22e>v</span>),
</span></span><span style=display:flex><span>      ));
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>average</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>div</span>(<span style=color:#a6e22e>flock</span>.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>average</span>.<span style=color:#a6e22e>v</span>.<span style=color:#a6e22e>div</span>(<span style=color:#a6e22e>flock</span>.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Alignment
</span></span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span>.<span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>p5</span>.<span style=color:#a6e22e>Vector</span>.<span style=color:#a6e22e>mult</span>(<span style=color:#a6e22e>average</span>.<span style=color:#a6e22e>v</span>, <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;alignmentForce&#34;</span>]));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Cohesion
</span></span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>p5</span>.<span style=color:#a6e22e>Vector</span>.<span style=color:#a6e22e>sub</span>(<span style=color:#a6e22e>average</span>.<span style=color:#a6e22e>p</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>normalize</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>mult</span>(<span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;cohesionForce&#34;</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;maximumVelocity&#34;</span>])
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Clamp and move
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span>.<span style=color:#a6e22e>limit</span>(<span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;maximumVelocity&#34;</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>v</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>width</span>) <span style=color:#f92672>%</span> <span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>height</span>) <span style=color:#f92672>%</span> <span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fill</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>c</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ellipse</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>x</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>noFill</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>stroke</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>c</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;displayVision&#34;</span>]) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>ellipse</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>x</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;boidVision&#34;</span>], <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;boidVision&#34;</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>400</span>, <span style=color:#ae81ff>400</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gui</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGuiPanel</span>(<span style=color:#e6db74>&#39;boids&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gui</span>.<span style=color:#a6e22e>addObject</span>(<span style=color:#a6e22e>params</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gui</span>.<span style=color:#a6e22e>setPosition</span>(<span style=color:#ae81ff>420</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;boidCount&#34;</span>]; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>boids</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Boid</span>());
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>256</span>, <span style=color:#ae81ff>256</span>, <span style=color:#ae81ff>256</span>, <span style=color:#ae81ff>256</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>params</span>[<span style=color:#e6db74>&#34;fade&#34;</span>]));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>boids</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>boid</span>) =&gt; <span style=color:#a6e22e>boid</span>.<span style=color:#a6e22e>update</span>());
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>boids</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>boid</span>) =&gt; <span style=color:#a6e22e>boid</span>.<span style=color:#a6e22e>draw</span>());
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keyTyped</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>key</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;s&#39;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>saveCanvas</span>(<span style=color:#e6db74>&#39;photo&#39;</span>, <span style=color:#e6db74>&#39;png&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>key</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;c&#39;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>clear</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><p>I&rsquo;ve added the <a href=https://github.com/bitcraftlab/p5.gui target=_blank rel=noopener>p5.gui.js</a> library for creating mostly automatic GUIs with the variables of the simulation, so you can add/remove Boids, change the forces around (even make them negative), and other things. Pretty fun to play with!</p><p>You can do some pretty crazy things with these. One setting I found looks awfully like a cell:</p><figure><img src=/embeds/2020/boid-cell.png></figure><p>Weird!</p></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>