<!DOCTYPE html>
<html onclick >
<head>
    <title>p5js Boids â€“ jverkamp.com</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8"><link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css" integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" />

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper"><header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a> *
            <a href="/resume">Resume</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>
    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation"><li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li><li><a href="https://blog.jverkamp.com/photography/">Photography</a></li><li><a href="https://blog.jverkamp.com/maker/">Maker</a></li><li><a href="https://blog.jverkamp.com/programming/">Programming</a></li><li><a href="https://blog.jverkamp.com/writing/">Writing</a></li><li><a href="https://blog.jverkamp.com/research/">Research</a></li><li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>
<div id="page-content-wrapper">
            <div id="page-content"><article>
	<header>
		<h1 class="entry-title">p5js Boids</h1>

        <div class="entry-meta"><span class="entry-date">2020-11-18</span>
            </div>

        <div class="entry-taxonomies"><div class="entry-tags"><ul class="taxonomy-keys"><li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2020/11/17/p5js-worms/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/javascript">JavaScript</a><a href="https://blog.jverkamp.com/2020/11/19/worm-coral/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/topics/">Topics</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2020/11/17/p5js-worms/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/cellular-automata">Cellular Automata</a><a href="https://blog.jverkamp.com/2020/11/19/worm-coral/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2020/11/17/p5js-worms/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/generative-art">Generative Art</a><a href="https://blog.jverkamp.com/2020/11/19/worm-coral/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2020/11/17/p5js-worms/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/p5js">p5js</a><a href="https://blog.jverkamp.com/2020/11/19/worm-coral/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2020/11/17/p5js-worms/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/procedural-content">Procedural Content</a><a href="https://blog.jverkamp.com/2020/11/19/worm-coral/" class="next-link"></a></li></ul>
        </li><li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2020/11/17/p5js-worms/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2020/11/19/worm-coral/" class="next-link">Next</a></ul>
        </li><li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2020/11/17/jack-of-fables-vol.-9-the-end/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2020/11/18/fairest-volume-4-of-men-and-mice/" class="next-link">Next</a></ul>
        </li></ul>
</div>
</div>
    </header>

	<div class="entry-content"><p>Okay, sketch 2: <a href="https://en.wikipedia.org/wiki/Boids">Boids</a>!</p>
<p>The basic idea is to create a bunch of particles (the Boids in this case) and apply to them each a series of simple, limited rules that rely neither on communcation between the Boids nor a global controller and see what behaviors you can generate. Specifically, can you replicate the flocking behavior found in birds, since birds can obviously fly together without hitting one another and also without some lead bird giving orders.</p>
<p>Something like this:</p>
<figure>
    <img src="/embeds/2020/boids.png"/> 
</figure>

<p>For this case, there are three rules:</p>
<ul>
<li><strong>seperation</strong> - Fly away from any Boids that are too close to you (to avoid collision)</li>
<li><strong>alignment</strong> - Align yourself to fly in the same direction as any Boids in your field of vision</li>
<li><strong>cohesion</strong> - Fly towards the center point of the Boids you can see</li>
</ul>
<p>Let&rsquo;s turn that into code:</p>








    








<div class="tab">
    <button class="tablinks default" data-tabset="22c4" onclick="changeTab(event, '22c4', 'iframedemo')">Demo</button>
    
        <button class="tablinks" data-tabset="22c4" onclick="changeTab(event, '22c4', 'defaultscript')">Script</button>
    
</div>

<div class="tabcontent" data-tabset="22c4" id="iframedemo">
    <iframe 
        width="660" height="462.00000000000006" frameBorder="0"
        srcdoc="
            
&lt;html&gt;
&lt;head&gt;
    &lt;script src=&#34;https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.1.9/p5.min.js&#34; integrity=&#34;sha512-WIklPM6qPCIp6d3fSSr90j&#43;1unQHUOoWDS4sdTiR8gxUTnyZ8S2Mr8e10sKKJ/bhJgpAa/qG068RDkg6fIlNFA==&#34; crossorigin=&#34;anonymous&#34;&gt;&lt;/script&gt;
    &lt;script src=&#34;https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.1.9/addons/p5.sound.min.js&#34; integrity=&#34;sha512-wM&#43;t5MzLiNHl2fwT5rWSXr2JMeymTtixiw2lWyVk1JK/jDM4RBSFoH4J8LjucwlDdY6Mu84Kj0gPXp7rLGaDyA==&#34; crossorigin=&#34;anonymous&#34;&gt;&lt;/script&gt;    
    
    &lt;script src=&#34;https://unpkg.com/p5.gui.variables@1.0.1/libraries/quicksettings.js&#34; integrity=&#34;sha384-XlyRxqW2TTF2gFC0VpBI8OqnCTsZOdgrhBFikxYD4hEu68QdNQ64kiej07hCAiJq&#34; crossorigin=&#34;anonymous&#34;&gt;&lt;/script&gt;
    &lt;script src=&#34;https://unpkg.com/p5.gui.variables@1.0.1/libraries/p5.gui.js&#34; integrity=&#34;sha384-/Uy&#43;8NNvYJjG164REYQP/RnqVcrnsFTtnoCJcLg/tVBKaHUaovtr&#43;ZJgKQKHGAPW&#34; crossorigin=&#34;anonymous&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;&#34;&gt;&lt;/script&gt;

    &lt;style&gt;canvas { border: 1px solid black; border-radius: 1em; }&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

            <script>

            
                
let gui;
let params = {
    boidCount: 10, boidCountMin: 1,
    boidVision: 50, boidVisionMin: 1, boidVisionMax: 100,
    displayVision: false,

    maximumVelocity: 2, maximumVelocityMin: 1, maximumVelocityMax: 10, maximumVelocityStep: 0.1,
    fade: 0.05, fadeMin: 0, fadeMax: 1, fadeStep: 0.01,

    seperationForce: 1, seperationForceMin: -1, seperationForceMax: 10, seperationForceStep: 0.1,
    alignmentForce: 2, alignmentForceMin: -1, alignmentForceMax: 10, alignmentForceStep: 0.1,
    cohesionForce: 2, cohesionForceMin: -1, cohesionForceMax: 10, cohesionForceStep: 0.1
};

var boids = [];

class Boid {
  constructor(p, v, c) {
    this.p = p;
    if (!p) this.p = createVector(random(width), random(height));

    this.v = v;
    if (!v) this.v = createVector(
      random(-params[&#34;maximumVelocity&#34;], params[&#34;maximumVelocity&#34;]),
      random(-params[&#34;maximumVelocity&#34;], params[&#34;maximumVelocity&#34;])
    );
    this.v = this.v.limit(params[&#34;maximumVelocity&#34;]);

    this.c = c;
    if (!c) this.c = color(random(256), random(256), random(256));
  }

  update() {
    // Fix boid count
    while (boids.length &lt; params[&#34;boidCount&#34;]) boids.push(new Boid());
    while (boids.length &gt; params[&#34;boidCount&#34;]) boids.pop();

    // Seperation
    for (var other of boids) {
      if (this.p.dist(other.p) &lt; params[&#34;boidVision&#34;]) {
        this.v =
          p5.Vector.sub(this.p, other.p)
          .normalize()
          .mult(params[&#34;seperationForce&#34;] * params[&#34;maximumVelocity&#34;])
          .add(this.v);
      }
    }

    // Calculate the average boid of the local flock
    var flock = []
    for (other of boids) {
      if (this != other && this.p.dist(other.p) &lt; params[&#34;boidVision&#34;]) {
        flock.push(other);
      }
    }

    if (flock.length &gt; 0) {
      var average = flock.reduce((average, boid) =&gt; new Boid(
        p5.Vector.add(average.p, boid.p),
        p5.Vector.add(average.v, boid.v),
      ));
      average.p.div(flock.length);
      average.v.div(flock.length);

      // Alignment
      this.v.add(p5.Vector.mult(average.v, params[&#34;alignmentForce&#34;]));

      // Cohesion
      this.v =
        p5.Vector.sub(average.p, this.p)
        .normalize()
        .mult(params[&#34;cohesionForce&#34;] * params[&#34;maximumVelocity&#34;])
        .add(this.v);
    }

    // Clamp and move
    this.v.limit(params[&#34;maximumVelocity&#34;]);
    this.p.add(this.v);

    this.p.x = (this.p.x &#43; width) % width;
    this.p.y = (this.p.y &#43; height) % height;
  }

  draw() {
    fill(this.c);
    noStroke();
    ellipse(this.p.x, this.p.y, 2, 2);
    
    noFill();
    stroke(this.c);
    if (params[&#34;displayVision&#34;]) {
      ellipse(this.p.x, this.p.y, params[&#34;boidVision&#34;], params[&#34;boidVision&#34;]);
    }
  }
}

function setup() {
  createCanvas(400, 400);
  gui = createGuiPanel(&#39;boids&#39;);
  gui.addObject(params);
  gui.setPosition(420, 0);

  for (var i = 0; i &lt; params[&#34;boidCount&#34;]; i&#43;&#43;) {
    boids.push(new Boid());
  }
}

function draw() {
  fill(color(256, 256, 256, 256 * params[&#34;fade&#34;]));
  noStroke();
  rect(0, 0, width, height);

  boids.forEach((boid) =&gt; boid.update());
  boids.forEach((boid) =&gt; boid.draw());
}

function keyTyped() {
  if (key === &#39;s&#39;) {
    saveCanvas(&#39;photo&#39;, &#39;png&#39;);
  }

  if (key == &#39;c&#39;) {
    clear();
  }
}

            

            
var oldSetup = setup;
setup = () =&gt; {
    // Load saved settings from the browser hash fragment
    if (parent.location.hash &amp;&amp; typeof params !== &#34;undefined&#34;) {
        try {
            var settings = JSON.parse(atob(parent.location.hash.substring(1)));
            Object.keys(params).forEach((key) =&gt; params[key] = settings[key] || params[key]);
        } catch(ex) {
        }
    }

    oldSetup();

    createButton(&#34;play/pause&#34;).mousePressed(() =&gt; {
        if (isLooping()) {
        noLoop();
        } else {
        loop();
        }
    });

    createButton(&#34;save&#34;).mousePressed(() =&gt; {
        saveCanvas(&#39;photo&#39;, &#39;png&#39;)
    });

    createButton(&#34;clear&#34;).mousePressed(() =&gt; {
        if (typeof reset !== &#39;undefined&#39;) {
            reset();
        } else {
            clear();
        }
    });

    if (typeof params !== &#34;undefined&#34;) {
        for (var el of document.querySelectorAll(&#39;input&#39;)) {
            if (el.id &amp;&amp; el.id.startsWith(&#39;qs_&#39;)) {
                el.addEventListener(&#39;change&#39;, () =&gt; {
                    parent.location.hash = btoa(JSON.stringify(params));
                });
            }
        }
    }
}

            </script>
            
&lt;noscript&gt;To display this p5.js sketch, JavaScript must be enabled.&lt;/noscript&gt;
&lt;/body&gt;
&lt;/html&gt;

        "
    ></iframe>
</div>


    <div class="tabcontent" data-tabset="22c4" id="defaultscript">
    <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">gui</span>;
<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">params</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">boidCount</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span>, <span style="color:#a6e22e">boidCountMin</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>,
    <span style="color:#a6e22e">boidVision</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">50</span>, <span style="color:#a6e22e">boidVisionMin</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">boidVisionMax</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">100</span>,
    <span style="color:#a6e22e">displayVision</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>,

    <span style="color:#a6e22e">maximumVelocity</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">maximumVelocityMin</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">maximumVelocityMax</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span>, <span style="color:#a6e22e">maximumVelocityStep</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0.1</span>,
    <span style="color:#a6e22e">fade</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0.05</span>, <span style="color:#a6e22e">fadeMin</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">fadeMax</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">fadeStep</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0.01</span>,

    <span style="color:#a6e22e">seperationForce</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">seperationForceMin</span><span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">seperationForceMax</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span>, <span style="color:#a6e22e">seperationForceStep</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0.1</span>,
    <span style="color:#a6e22e">alignmentForce</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">alignmentForceMin</span><span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">alignmentForceMax</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span>, <span style="color:#a6e22e">alignmentForceStep</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0.1</span>,
    <span style="color:#a6e22e">cohesionForce</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">cohesionForceMin</span><span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">cohesionForceMax</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span>, <span style="color:#a6e22e">cohesionForceStep</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0.1</span>
};

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">boids</span> <span style="color:#f92672">=</span> [];

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Boid</span> {
  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">p</span>, <span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">c</span>) {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">p</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">p</span>) <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createVector</span>(<span style="color:#a6e22e">random</span>(<span style="color:#a6e22e">width</span>), <span style="color:#a6e22e">random</span>(<span style="color:#a6e22e">height</span>));

    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">v</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">v</span>) <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createVector</span>(
      <span style="color:#a6e22e">random</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;maximumVelocity&#34;</span>], <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;maximumVelocity&#34;</span>]),
      <span style="color:#a6e22e">random</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;maximumVelocity&#34;</span>], <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;maximumVelocity&#34;</span>])
    );
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">limit</span>(<span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;maximumVelocity&#34;</span>]);

    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">c</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">c</span>) <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">c</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">color</span>(<span style="color:#a6e22e">random</span>(<span style="color:#ae81ff">256</span>), <span style="color:#a6e22e">random</span>(<span style="color:#ae81ff">256</span>), <span style="color:#a6e22e">random</span>(<span style="color:#ae81ff">256</span>));
  }

  <span style="color:#a6e22e">update</span>() {
    <span style="color:#75715e">// Fix boid count
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">boids</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;boidCount&#34;</span>]) <span style="color:#a6e22e">boids</span>.<span style="color:#a6e22e">push</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Boid</span>());
    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">boids</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;boidCount&#34;</span>]) <span style="color:#a6e22e">boids</span>.<span style="color:#a6e22e">pop</span>();

    <span style="color:#75715e">// Seperation
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">other</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">boids</span>) {
      <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">dist</span>(<span style="color:#a6e22e">other</span>.<span style="color:#a6e22e">p</span>) <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;boidVision&#34;</span>]) {
        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span> <span style="color:#f92672">=</span>
          <span style="color:#a6e22e">p5</span>.<span style="color:#a6e22e">Vector</span>.<span style="color:#a6e22e">sub</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>, <span style="color:#a6e22e">other</span>.<span style="color:#a6e22e">p</span>)
          .<span style="color:#a6e22e">normalize</span>()
          .<span style="color:#a6e22e">mult</span>(<span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;seperationForce&#34;</span>] <span style="color:#f92672">*</span> <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;maximumVelocity&#34;</span>])
          .<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span>);
      }
    }

    <span style="color:#75715e">// Calculate the average boid of the local flock
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">flock</span> <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> (<span style="color:#a6e22e">other</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">boids</span>) {
      <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">other</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">dist</span>(<span style="color:#a6e22e">other</span>.<span style="color:#a6e22e">p</span>) <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;boidVision&#34;</span>]) {
        <span style="color:#a6e22e">flock</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">other</span>);
      }
    }

    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">flock</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">average</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">flock</span>.<span style="color:#a6e22e">reduce</span>((<span style="color:#a6e22e">average</span>, <span style="color:#a6e22e">boid</span>) =&gt; <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Boid</span>(
        <span style="color:#a6e22e">p5</span>.<span style="color:#a6e22e">Vector</span>.<span style="color:#a6e22e">add</span>(<span style="color:#a6e22e">average</span>.<span style="color:#a6e22e">p</span>, <span style="color:#a6e22e">boid</span>.<span style="color:#a6e22e">p</span>),
        <span style="color:#a6e22e">p5</span>.<span style="color:#a6e22e">Vector</span>.<span style="color:#a6e22e">add</span>(<span style="color:#a6e22e">average</span>.<span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">boid</span>.<span style="color:#a6e22e">v</span>),
      ));
      <span style="color:#a6e22e">average</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">div</span>(<span style="color:#a6e22e">flock</span>.<span style="color:#a6e22e">length</span>);
      <span style="color:#a6e22e">average</span>.<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">div</span>(<span style="color:#a6e22e">flock</span>.<span style="color:#a6e22e">length</span>);

      <span style="color:#75715e">// Alignment
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">add</span>(<span style="color:#a6e22e">p5</span>.<span style="color:#a6e22e">Vector</span>.<span style="color:#a6e22e">mult</span>(<span style="color:#a6e22e">average</span>.<span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;alignmentForce&#34;</span>]));

      <span style="color:#75715e">// Cohesion
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span> <span style="color:#f92672">=</span>
        <span style="color:#a6e22e">p5</span>.<span style="color:#a6e22e">Vector</span>.<span style="color:#a6e22e">sub</span>(<span style="color:#a6e22e">average</span>.<span style="color:#a6e22e">p</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>)
        .<span style="color:#a6e22e">normalize</span>()
        .<span style="color:#a6e22e">mult</span>(<span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;cohesionForce&#34;</span>] <span style="color:#f92672">*</span> <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;maximumVelocity&#34;</span>])
        .<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span>);
    }

    <span style="color:#75715e">// Clamp and move
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">limit</span>(<span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;maximumVelocity&#34;</span>]);
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">v</span>);

    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">x</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">x</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">width</span>) <span style="color:#f92672">%</span> <span style="color:#a6e22e">width</span>;
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">y</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">y</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">height</span>) <span style="color:#f92672">%</span> <span style="color:#a6e22e">height</span>;
  }

  <span style="color:#a6e22e">draw</span>() {
    <span style="color:#a6e22e">fill</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">c</span>);
    <span style="color:#a6e22e">noStroke</span>();
    <span style="color:#a6e22e">ellipse</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">x</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">y</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>);
    
    <span style="color:#a6e22e">noFill</span>();
    <span style="color:#a6e22e">stroke</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">c</span>);
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;displayVision&#34;</span>]) {
      <span style="color:#a6e22e">ellipse</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">x</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">y</span>, <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;boidVision&#34;</span>], <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;boidVision&#34;</span>]);
    }
  }
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">setup</span>() {
  <span style="color:#a6e22e">createCanvas</span>(<span style="color:#ae81ff">400</span>, <span style="color:#ae81ff">400</span>);
  <span style="color:#a6e22e">gui</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createGuiPanel</span>(<span style="color:#e6db74">&#39;boids&#39;</span>);
  <span style="color:#a6e22e">gui</span>.<span style="color:#a6e22e">addObject</span>(<span style="color:#a6e22e">params</span>);
  <span style="color:#a6e22e">gui</span>.<span style="color:#a6e22e">setPosition</span>(<span style="color:#ae81ff">420</span>, <span style="color:#ae81ff">0</span>);

  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;boidCount&#34;</span>]; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
    <span style="color:#a6e22e">boids</span>.<span style="color:#a6e22e">push</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Boid</span>());
  }
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">draw</span>() {
  <span style="color:#a6e22e">fill</span>(<span style="color:#a6e22e">color</span>(<span style="color:#ae81ff">256</span>, <span style="color:#ae81ff">256</span>, <span style="color:#ae81ff">256</span>, <span style="color:#ae81ff">256</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">params</span>[<span style="color:#e6db74">&#34;fade&#34;</span>]));
  <span style="color:#a6e22e">noStroke</span>();
  <span style="color:#a6e22e">rect</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">width</span>, <span style="color:#a6e22e">height</span>);

  <span style="color:#a6e22e">boids</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">boid</span>) =&gt; <span style="color:#a6e22e">boid</span>.<span style="color:#a6e22e">update</span>());
  <span style="color:#a6e22e">boids</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">boid</span>) =&gt; <span style="color:#a6e22e">boid</span>.<span style="color:#a6e22e">draw</span>());
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">keyTyped</span>() {
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">key</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;s&#39;</span>) {
    <span style="color:#a6e22e">saveCanvas</span>(<span style="color:#e6db74">&#39;photo&#39;</span>, <span style="color:#e6db74">&#39;png&#39;</span>);
  }

  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">key</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;c&#39;</span>) {
    <span style="color:#a6e22e">clear</span>();
  }
}

</code></pre></div>
    </div>

<p>I&rsquo;ve added the <a href="https://github.com/bitcraftlab/p5.gui">p5.gui.js</a> library for creating mostly automatic GUIs with the variables of the simulation, so you can add/remove Boids, change the forces around (even make them negative), and other things. Pretty fun to play with!</p>
<p>You can do some pretty crazy things with these. One setting I found looks awfully like a cell:</p>
<figure>
    <img src="/embeds/2020/boid-cell.png"/> 
</figure>

<p>Weird!</p></div>
</article></div>
        </div><footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li><li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li></ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>
</div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js" integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js" integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin="anonymous"></script>

<script src="/custom.js"></script>
</body>
</html>
