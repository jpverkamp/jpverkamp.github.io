<!DOCTYPE html>
<html onclick >
<head>
    <title>Cracker Barrel Peg Game, Part 2 â€“ jverkamp.com</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8"><link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css" integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" />

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper"><header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a> *
            <a href="/resume">Resume</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>
    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation"><li><a href="https://blog.jverkamp.com/photography/">Photography</a></li><li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li><li><a href="https://blog.jverkamp.com/maker/">Maker</a></li><li><a href="https://blog.jverkamp.com/programming/">Programming</a></li><li><a href="https://blog.jverkamp.com/writing/">Writing</a></li><li><a href="https://blog.jverkamp.com/research/">Research</a></li><li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>
<div id="page-content-wrapper">
            <div id="page-content"><article>
	<header>
		<h1 class="entry-title">Cracker Barrel Peg Game, Part 2</h1>

        <div class="entry-meta"><span class="entry-date">2014-07-09</span>
            </div>

        <div class="entry-taxonomies"><div class="entry-tags"><ul class="taxonomy-keys"><li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2014/07/05/cracker-barrel-peg-game/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/racket">Racket</a><a href="https://blog.jverkamp.com/2014/07/10/cracker-barrel-peg-game-part-3/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2014/07/05/cracker-barrel-peg-game/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/scheme">Scheme</a><a href="https://blog.jverkamp.com/2014/07/10/cracker-barrel-peg-game-part-3/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/topics/">Topics</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2014/07/05/cracker-barrel-peg-game/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/games">Games</a><a href="https://blog.jverkamp.com/2014/07/10/cracker-barrel-peg-game-part-3/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2014/07/05/cracker-barrel-peg-game/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/graph-theory">Graph Theory</a><a href="https://blog.jverkamp.com/2014/07/10/cracker-barrel-peg-game-part-3/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/series/">Series</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2014/07/05/cracker-barrel-peg-game/" class="previous-link"></a><a class="taxonomy-value" href="/series/cracker-barrel-peg-game">Cracker Barrel Peg Game</a><a href="https://blog.jverkamp.com/2014/07/10/cracker-barrel-peg-game-part-3/" class="next-link"></a></li></ul>
        </li><li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2014/07/05/cracker-barrel-peg-game/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2014/07/10/cracker-barrel-peg-game-part-3/" class="next-link">Next</a></ul>
        </li><li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2014/07/05/cracker-barrel-peg-game/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2014/07/10/cracker-barrel-peg-game-part-3/" class="next-link">Next</a></ul>
        </li></ul>
</div>
</div>
    </header>

	<div class="entry-content"><p>Hey, remember that post a few days ago about the <a href="https://blog.jverkamp.com/2014/07/10/cracker-barrel-peg-game-part-3/">Cracker Barrel peg game</a>? Right at the end, I mentioned that there would be a part two, all about how to bend the puzzle at least a bit to your advantage. Basically, rather than finding the first solution to the peg game, we&rsquo;re going to find <em>all</em> of them. From there, we can determine which moves are easier to win from, which are harder, and which are downright impossible. Let&rsquo;s do it!</p>
<p>Okay, first things first. Remember how we represented the puzzles as either a 15 element vector or 15 bit integer? Well that gives us a pretty solid upper bound on how many possible ways that the puzzle can end up being arrange. Specifically, <span class="latex-inline">2^{15</span>
 = 32768} total states. For a computer&hellip; that&rsquo;s actually not that big of a number. First, let&rsquo;s see how many of those we can actually reach.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Count how many total states are reachable from any initial state</span>
<span style="color:#75715e">; By default, start with one copy of each peg missing</span>
(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">reachable</span> [queue (<span style="color:#a6e22e">for/list</span> ([i (<span style="color:#a6e22e">in-range</span> <span style="color:#ae81ff">15</span>)])
                            (<span style="color:#a6e22e">invert</span> (<span style="color:#a6e22e">make-puzzle</span> (expt <span style="color:#ae81ff">2</span> i))))])
  (<span style="color:#66d9ef">let </span>loop ([reached (<span style="color:#a6e22e">hash</span>)] [queue queue])
    (<span style="color:#a6e22e">cond</span>
      <span style="color:#75715e">; Queue is empty, done</span>
      [(null? queue)
       reached]
      <span style="color:#75715e">; Already checked this state, check the rest</span>
      [(<span style="color:#a6e22e">hash-ref</span> reached (<span style="color:#a6e22e">index</span> (<span style="color:#a6e22e">first</span> queue)) <span style="color:#66d9ef">#f</span>)
       (<span style="color:#a6e22e">loop</span> reached (<span style="color:#a6e22e">rest</span> queue))]
      <span style="color:#75715e">; New state, add it to the hash and all next states to the queue</span>
      [else
       (<span style="color:#a6e22e">loop</span> (<span style="color:#a6e22e">hash-set</span> reached (<span style="color:#a6e22e">index</span> (<span style="color:#a6e22e">first</span> queue)) <span style="color:#66d9ef">#t</span>)
             (append (<span style="color:#a6e22e">rest</span> queue) (<span style="color:#a6e22e">next</span> (<span style="color:#a6e22e">first</span> queue))))])))
</code></pre></div><p>Hopefully straight forward algorithm, basically we start with an (empty) index of which nodes we&rsquo;ve visited&ndash;a hash in our case. Start with each of the fifteen opening moves in a queue. Then, keep taking one nodes off the queue. For new nodes, add that to the list of visited nodes and all its neighbors to the queue. A <a href="https://en.wikipedia.org/wiki/Breadth-first_search">breadth-first search</a>. Give it a run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (<span style="color:#a6e22e">hash-count</span> (<span style="color:#a6e22e">reachable</span>))
<span style="color:#ae81ff">13935</span>
</code></pre></div><p>So only 42.5%. Huh. A few examples of states that can&rsquo;t be reached:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (<span style="color:#66d9ef">define </span>r (<span style="color:#a6e22e">reachable</span>))
&gt; (<span style="color:#a6e22e">for/list</span> ([i (<span style="color:#a6e22e">in-range</span> <span style="color:#ae81ff">5</span>)])
    (<span style="color:#66d9ef">let </span>loop ()
      (<span style="color:#66d9ef">define </span>p (<span style="color:#a6e22e">make-puzzle</span> (<span style="color:#a6e22e">random</span> (expt <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">15</span>))))
      (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">hash-ref</span> r (<span style="color:#a6e22e">index</span> p) <span style="color:#66d9ef">#f</span>)
          (<span style="color:#a6e22e">render</span> p)
          (<span style="color:#a6e22e">loop</span>))))
</code></pre></div><p><figure>
    <img src="/embeds/2014/unreachable-1.png"/> 
</figure>
 <figure>
    <img src="/embeds/2014/unreachable-2.png"/> 
</figure>
 <figure>
    <img src="/embeds/2014/unreachable-3.png"/> 
</figure>
 <figure>
    <img src="/embeds/2014/unreachable-4.png"/> 
</figure>
 <figure>
    <img src="/embeds/2014/unreachable-5.png"/> 
</figure>
</p>
<p>But that doesn&rsquo;t necessary tell us which starting positions are easier. For that, we need something more like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (<span style="color:#a6e22e">require</span> plot)
&gt; (<span style="color:#a6e22e">plot</span> (<span style="color:#a6e22e">discrete-histogram</span>
         (<span style="color:#a6e22e">for/list</span> ([i (<span style="color:#a6e22e">in-range</span> <span style="color:#ae81ff">15</span>)])
           (vector (+ i <span style="color:#ae81ff">1</span>) 
                   (<span style="color:#a6e22e">hash-count</span> (<span style="color:#a6e22e">reachable</span> (list (<span style="color:#a6e22e">invert</span> (<span style="color:#a6e22e">make-puzzle</span> (expt <span style="color:#ae81ff">2</span> i))))))))))
</code></pre></div><figure>
    <img src="/embeds/2014/reachable-by-initial.png"/> 
</figure>

<p>Interesting. So there are three states that reach the most (4, 6, and 13), three on the next tier (1, 11, and 15), 6 on the next, and 3 that reach the least (5, 8, and 9). If you think about it, that makes a lot of sense. For each position, there are two other identical positions&ndash;rotations:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Rotate a puzzle clockwise</span>
(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">rotate</span> p)
  (<span style="color:#a6e22e">puzzle</span> (<span style="color:#a6e22e">for/vector</span> ([i (<span style="color:#a6e22e">in-list</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">11</span> <span style="color:#ae81ff">12</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">13</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">14</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">15</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1</span>))])
            (vector-ref (<span style="color:#a6e22e">puzzle-data</span> p) (- i <span style="color:#ae81ff">1</span>)))))

&gt; (<span style="color:#66d9ef">define </span>random-puzzle (<span style="color:#a6e22e">make-puzzle</span> (<span style="color:#a6e22e">random</span> (expt <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">15</span>))))
&gt; (map render (list random-puzzle 
                    (<span style="color:#a6e22e">rotate</span> random-puzzle)
                    (<span style="color:#a6e22e">rotate</span> (<span style="color:#a6e22e">rotate</span> random-puzzle))))
</code></pre></div><p><figure>
    <img src="/embeds/2014/rotation-example-1.png"/> 
</figure>
 <figure>
    <img src="/embeds/2014/rotation-example-2.png"/> 
</figure>
 <figure>
    <img src="/embeds/2014/rotation-example-3.png"/> 
</figure>
</p>
<p>Further than that, there are also reflections:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Reflect a puzzle left to right</span>
(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">reflect</span> p)
  (<span style="color:#a6e22e">puzzle</span> (<span style="color:#a6e22e">for/vector</span> ([i (<span style="color:#a6e22e">in-list</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">15</span> <span style="color:#ae81ff">14</span> <span style="color:#ae81ff">13</span> <span style="color:#ae81ff">12</span> <span style="color:#ae81ff">11</span>))])
            (vector-ref (<span style="color:#a6e22e">puzzle-data</span> p) (- i <span style="color:#ae81ff">1</span>)))))
</code></pre></div><p><figure>
    <img src="/embeds/2014/reflection-example-2.png"/> 
</figure>
 <figure>
    <img src="/embeds/2014/reflection-example-1.png"/> 
</figure>
</p>
<p>This is what I meant last time, when I said that there were only four initial states (1, 2, 4, and 5). All of the rest are reflections and/or rotations of one of those 4.</p>
<p>Finally, if you combine these two functions, it should be possible to get a real idea of how many truly unique states there are. Since each puzzle has a numeric form and each puzzle has up to six unique states (three rotations, each with two reflections), we can consistently find the one of those six with the lowest value. Something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Minimize a puzzle by finding the reflection/rotation with the minimal vector</span>
(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">minify</span> p)
  (<span style="color:#66d9ef">define </span>r1 (<span style="color:#a6e22e">rotate</span> p))
  (<span style="color:#66d9ef">define </span>r2 (<span style="color:#a6e22e">rotate</span> r1))
  (<span style="color:#a6e22e">first</span> (<span style="color:#a6e22e">sort</span> (list p r1 r2 (<span style="color:#a6e22e">reflect</span> p) (<span style="color:#a6e22e">reflect</span> r1) (<span style="color:#a6e22e">reflect</span> r2))
               (<span style="color:#a6e22e">Î»</span> (<span style="color:#a6e22e">p1</span> p2)
                 (&lt; (<span style="color:#a6e22e">index</span> p1) (<span style="color:#a6e22e">index</span> p2))))))

&gt; (map index (list random-puzzle
                   (<span style="color:#a6e22e">reflect</span> random-puzzle)
                   (<span style="color:#a6e22e">rotate</span> random-puzzle)
                   (<span style="color:#a6e22e">reflect</span> (<span style="color:#a6e22e">rotate</span> random-puzzle))
                   (<span style="color:#a6e22e">rotate</span> (<span style="color:#a6e22e">rotate</span> random-puzzle))
                   (<span style="color:#a6e22e">reflect</span> (<span style="color:#a6e22e">rotate</span> (<span style="color:#a6e22e">rotate</span> random-puzzle)))))
<span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">26794</span> <span style="color:#ae81ff">21322</span> <span style="color:#ae81ff">10025</span> <span style="color:#ae81ff">7474</span> <span style="color:#ae81ff">12412</span> <span style="color:#ae81ff">12679</span>)
&gt; (<span style="color:#a6e22e">index</span> (<span style="color:#a6e22e">minify</span> random-puzzle))
<span style="color:#ae81ff">7474</span>
&gt; (<span style="color:#a6e22e">render</span> (<span style="color:#a6e22e">minify</span> random-puzzle))
</code></pre></div><figure>
    <img src="/embeds/2014/minimum-random-puzzle.png"/> 
</figure>

<p>So how many states do we get if we take only the minimum form? Both overall and reachable?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (<span style="color:#a6e22e">set-count</span> 
   (<span style="color:#a6e22e">for/set</span> ([i (<span style="color:#a6e22e">in-range</span> (expt <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">15</span>))])
     (<span style="color:#a6e22e">index</span> (<span style="color:#a6e22e">minify</span> (<span style="color:#a6e22e">make-puzzle</span> i)))))
<span style="color:#ae81ff">5728</span>

<span style="color:#75715e">; Modification of reachable states, only minified </span>
<span style="color:#75715e">; By default, start with one copy of each peg missing</span>
(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">reachable-min</span> [queue (<span style="color:#a6e22e">for/list</span> ([i (<span style="color:#a6e22e">in-range</span> <span style="color:#ae81ff">15</span>)])
                                (<span style="color:#a6e22e">invert</span> (<span style="color:#a6e22e">make-puzzle</span> (expt <span style="color:#ae81ff">2</span> i))))])
  (<span style="color:#66d9ef">let </span>loop ([reached (<span style="color:#a6e22e">hash</span>)] [queue queue])
    (<span style="color:#a6e22e">cond</span>
      <span style="color:#75715e">; Queue is empty, done</span>
      [(null? queue)
       reached]
      <span style="color:#75715e">; Already checked this state, check the rest</span>
      [else
       (<span style="color:#66d9ef">define </span>p (<span style="color:#a6e22e">minify</span> (<span style="color:#a6e22e">first</span> queue)))
       (<span style="color:#66d9ef">define </span>i (<span style="color:#a6e22e">index</span> p))
       (<span style="color:#a6e22e">cond</span>
         [(<span style="color:#a6e22e">hash-ref</span> reached i <span style="color:#66d9ef">#f</span>) 
          (<span style="color:#a6e22e">loop</span> reached (<span style="color:#a6e22e">rest</span> queue))]
         [else
          (<span style="color:#a6e22e">loop</span> (<span style="color:#a6e22e">hash-set</span> reached i <span style="color:#66d9ef">#t</span>)
                (append (<span style="color:#a6e22e">rest</span> queue) (<span style="color:#a6e22e">next</span> p)))])])))

&gt; (<span style="color:#a6e22e">hash-count</span> (<span style="color:#a6e22e">reachable-min</span>))
<span style="color:#ae81ff">2383</span>
</code></pre></div><p>Still about the same (technically slightly lower, it&rsquo;s only 41.6%). That&rsquo;s a good sign. We&rsquo;re all of the way down to 2,383 states from the original potential 32,768. A lot more manageable.</p>
<p>Next, let&rsquo;s shift to moves rather than states. Given two states, they are connected with a move if you could make a single jump to get from one to the other. So now rather than a set, we have a graph. Something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Find a map of all possible moves from a given puzzle</span>
(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">all-moves</span> p)
  (<span style="color:#66d9ef">define </span>moves (<span style="color:#a6e22e">make-hash</span>))
  (<span style="color:#66d9ef">let </span>loop ([p p])
    (<span style="color:#66d9ef">let </span>([p (<span style="color:#a6e22e">minify</span> p)])
      (<span style="color:#66d9ef">define </span>i (<span style="color:#a6e22e">index</span> (<span style="color:#a6e22e">minify</span> p)))
      (<span style="color:#a6e22e">when</span> (not (<span style="color:#a6e22e">hash-has-key?</span> moves i))
        (<span style="color:#66d9ef">define </span>next-ps (<span style="color:#a6e22e">next</span> p))
        (<span style="color:#a6e22e">hash-set!</span> moves i (<span style="color:#a6e22e">list-&gt;set</span> (map index (map minify next-ps))))
        (map loop next-ps))))
  moves)
</code></pre></div><p>From there, we can recursively build up a count for each state how many times we win (end up with only a single peg) and how many times we lose.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Count the number of winning and losing states from a given puzzle</span>
(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">score</span> p)
  (<span style="color:#66d9ef">define </span>moves (<span style="color:#a6e22e">all-moves</span> p))
  (<span style="color:#a6e22e">define-values</span> (<span style="color:#a6e22e">wins</span> losses)
    (<span style="color:#66d9ef">let </span>loop ([i (<span style="color:#a6e22e">index</span> (<span style="color:#a6e22e">minify</span> p))])
      (<span style="color:#66d9ef">define </span>nxt (<span style="color:#a6e22e">hash-ref</span> moves i (<span style="color:#a6e22e">set</span>)))
      (<span style="color:#a6e22e">cond</span>
        [(<span style="color:#a6e22e">set-empty?</span> nxt)
         (<span style="color:#66d9ef">if </span>(= <span style="color:#ae81ff">1</span> (<span style="color:#a6e22e">count</span> (<span style="color:#a6e22e">make-puzzle</span> i)))
             (values <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>)
             (values <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>))]
        [else
         (<span style="color:#a6e22e">for/fold</span> ([wins <span style="color:#ae81ff">0</span>] [losses <span style="color:#ae81ff">0</span>]) ([n (<span style="color:#a6e22e">in-set</span> nxt)])
           (<span style="color:#a6e22e">define-values</span> (<span style="color:#a6e22e">r-wins</span> r-losses) (<span style="color:#a6e22e">loop</span> n))
           (values (+ wins   r-wins)
                   (+ losses r-losses)))])))
  (* <span style="color:#ae81ff">1.0</span> (/ wins (+ wins losses))))
</code></pre></div><p>That way we can tell how &lsquo;hard&rsquo; each puzzle is, assuming that you always rotate/reflect to avoid potential duplicate state:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (<span style="color:#a6e22e">for/list</span> ([i (<span style="color:#a6e22e">in-list</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">5</span>))])
    (list i (<span style="color:#a6e22e">score</span> (<span style="color:#a6e22e">invert</span> (<span style="color:#a6e22e">make-puzzle</span> i)))))

<span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0.05239514926876435</span>)
  (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0.05138285262741999</span>)
  (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0.08392304995059131</span>)
  (<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">0.08392304995059131</span>))
</code></pre></div><p>So there you have it. If you&rsquo;re playing optimally, it&rsquo;s slightly easier to do so starting with a corner or the second. The center or center of each edge are slightly harder.</p>
<p>And that&rsquo;s all we have for today. Originally, I meant to use the graph library I&rsquo;ve used a number of times before to visualize the solution space (there&rsquo;s a function that will do that on GitHub), but the graphs honestly aren&rsquo;t that helpful. There nodes are too nested and there are just too many to helpfully visualize. So it goes. Still, I think we found a few interesting things.</p>
<p>As always, the code is available on GitHub: <a href="https://github.com/jpverkamp/small-projects/blob/master/blog/pegs.rkt">pegs.rkt</a></p></div>
</article></div>
        </div><footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li><li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li></ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>
</div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js" integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js" integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin="anonymous"></script>

<script src="/custom.js"></script>
</body>
</html>
