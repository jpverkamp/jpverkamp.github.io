<!doctype html><html><head><title>Trigonometric Triangle Trouble – jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css integrity=sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel=stylesheet><link rel=stylesheet href=/custom.css defer><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js></script></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=//www.google.com/search method=get onsubmit='(function(e){e.q.value="site:blog.jverkamp.com "+e.qfront.value})(this)' class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=hidden>
<input name=qfront type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article><header><h1 class=entry-title>Trigonometric Triangle Trouble</h1><div class=entry-meta><span class=entry-date>2014-05-02</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2014/04/01/gorellian-sorting/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/racket>Racket</a><a href=https://blog.jverkamp.com/2014/05/19/novel-compression/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2014/04/01/gorellian-sorting/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/scheme>Scheme</a><a href=https://blog.jverkamp.com/2014/05/19/novel-compression/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2014/02/27/dis/re-emvowelification/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/daily-programmer>Daily Programmer</a><a href=https://blog.jverkamp.com/2014/05/19/novel-compression/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/03/28/path-to-philosophy/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/backtracking>Backtracking</a><a href=https://blog.jverkamp.com/2014/07/05/cracker-barrel-peg-game/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2014/01/03/overlapping-circles/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/geometry>Geometry</a><a href=https://blog.jverkamp.com/2016/12/03/aoc-2016-day-3-triangle-validator/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2014/02/27/crossing-hands/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/mathematics>Mathematics</a><a href=https://blog.jverkamp.com/2014/05/23/amicable-chains/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2013/03/18/approximating-pi-with-buffons-needle/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/trigonometry>Trigonometry</a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2014/04/01/gorellian-sorting/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2014/05/19/novel-compression/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2014/04/19/yosemite/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2014/05/10/the-amazing-spider-man-2/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p><a href=http://www.reddit.com/r/dailyprogrammer/comments/24hr25/522014_challenge_160_hard_trigonometric_triangle/>Yesterday&rsquo;s post</a> at <a href=http://www.reddit.com/r/dailyprogrammer/>/r/dailyprogrammer</a> managed to pique my interest<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><blockquote><p>A triangle on a flat plane is described by its angles and side lengths, and you don&rsquo;t need all of the angles and side lengths to work out everything about the triangle. (This is the same as last time.) However, this time, the triangle will not necessarily have a right angle. This is where more trigonometry comes in. Break out your trig again, people.</p></blockquote><p>I am going to skip over a bit of the problem (that of parsing the input), but I think what&rsquo;s left is more than enough to make an interesting problem.</p><p>Thinking back to high school, triangles are defined by six pieces of information: three sides and three angles:</p><figure><img src=/embeds/2014/triangle.png></figure><p>But really, you only need any three pieces of those (with the exception of the three angles, with just that you have no sense of scale). More specifically, there are a set of relationships between the sides and angles in a triangle such that you can derive all six:</p><table><thead><tr><th>Sum of angles</th><th>Rule of sines</th><th>Rule of cosines</th></tr></thead><tbody><tr><td><div class=latex-block>\alpha + \beta + \gamma = \pi</div></td><td><div class=latex-block>\frac{a}{sin\ \alpha} = \frac{b}{sin\ \beta} = \frac{c}{sin\ \gamma}</div></td><td><div class=latex-block>a^2 = b^2 + c^2 - 2bc\ cos\ \alpha</div></td></tr></tbody></table><p>Sounds good, right? But how do we turn that into code?</p><p>First, we need some structure to work with. Perhaps a structure that represents the eventual information about the triangle that we are going to solve<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; Represent a triangle as three angles and three sides</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Angles can be in either degrees or radians so long as all three are the same</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Any value is either numeric or #f if it is currently unknown</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>struct</span> triangle (<span style=color:#960050;background-color:#1e0010>∠</span>ɑ <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>γ a b c) <span style=color:#f92672>#</span>:transparent)
</span></span></code></pre></div><p>Fair enough.</p><p>Next, how do we know when we&rsquo;re done? Since we&rsquo;re representing both angles and sides as numbers, we just need all six fields to be numeric. We could have a giant <code>and</code>, or we could play with a few neat functions. Specifically <code><a href="http://docs.racket-lang.org/search/index.html?q=struct-%3e">struct-></a></code>
:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; If all six fields are numeric, we&#39;ve solved the triangle</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>solved?</span> t)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>andmap</span> number? (cdr (vector-&gt;list (<span style=color:#a6e22e>struct-&gt;vector</span> t)))))
</span></span></code></pre></div><p>(If you&rsquo;d like to follow along, the full code is here: <a href=https://github.com/jpverkamp/small-projects/blob/master/blog/triangle-trouble.rkt>triangle-trouble.rkt</a>)</p><p>We need that extra <code>cdr</code> in there since the first field is struct id (<code>triangle</code>).</p><p>Luckily though, that should be all of the framework we need for the moment. Next, we just need a solver.</p><p>At first glance, this might not look like a particularly recursive problem. In recursion, you need to be able to identify one or more base cases (in this case: the triangle is solved) and then break the problem into small steps, each of which is &lsquo;smaller&rsquo; than the original problem. So if we can figure out how to at least make some progress / solve one additional side or angle, that should be good enough, right?</p><p>On first glance, the easiest solution would be to work out all of the possible cases. Perhaps we know a, b, and ∠ɑ. Perhaps ∠ɑ, ∠β, and c. But that&rsquo;s a lot of cases. Specifically:</p><div class=latex-block>{6 \choose 3} = 20</div><p>We can do better than that.</p><p>Let&rsquo;s start with the framework:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; Given some of the sides/angles of a triangle try to solve for the rest</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>solve</span> t)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>let </span>loop ([t t])
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>match</span> t
</span></span><span style=display:flex><span>      <span style=color:#75715e>; We have all three sides and angles, return</span>
</span></span><span style=display:flex><span>      [(<span style=color:#a6e22e>?</span> solved?) t]
</span></span><span style=display:flex><span>      <span style=color:#75715e>; Two angles, solve for the third</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>; Sine rule</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>; Cosine rule</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>; Reorder</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>...</span>)))
</span></span></code></pre></div><p>We&rsquo;re using <code><a href="http://docs.racket-lang.org/search/index.html?q=match">match</a></code>
because <code>match</code> is awesome. More specifically because <code>match</code> is great at pattern matching against structs. For example, take the first case&ndash;two angles, solving for the third:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Two angles, solve for the third</span>
</span></span><span style=display:flex><span>[(<span style=color:#a6e22e>triangle</span> (<span style=color:#a6e22e>?</span> number? <span style=color:#960050;background-color:#1e0010>∠</span>ɑ) (<span style=color:#a6e22e>?</span> number? <span style=color:#960050;background-color:#1e0010>∠</span>β) <span style=color:#66d9ef>#f</span> a b c)
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>loop</span> (<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>ɑ <span style=color:#960050;background-color:#1e0010>∠</span>β (- pi <span style=color:#960050;background-color:#1e0010>∠</span>ɑ <span style=color:#960050;background-color:#1e0010>∠</span>β) a b c))]
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span></code></pre></div><p>Here we&rsquo;re matching against the six values that make up a triangle. For the first two clauses, we have the form <code>(? number? ∠ɑ)</code>. The <code>?</code> signifies that we are matching against a predicate, <code>number?</code>. The last part is the name we&rsquo;re binding to that value. After that, we&rsquo;re matching a literal <code>#f</code> (an unspecified third angle). Finally, we have the three sides. As they are, they will match any values, either numeric or <code>#f</code>.</p><p>So this case matches if and only if the first two angles are solved and the third is not, ignoring the sides for the moment. If this pattern doesn&rsquo;t match, we&rsquo;ll move on to the next (we&rsquo;ll deal with the case that it&rsquo;s ∠ɑ or ∠β that we&rsquo;re missing in a bit). Then, all we have to do is calculate the new value of ∠γ. Since Racket&rsquo;s trig functions work in radians<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup><sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>, we&rsquo;ll subtract from 180° = π.</p><p>Straight forward. Now how about the sine rule. Well, it turns out that there are two cases we can use this for. Since we&rsquo;re relating matched sides and angles, we can take a matching side and angle along with <em>either</em> a second side or angle to solve for the other. More specifically, we can solve: ∠ɑ, a, ∠β → b or ∠ɑ, a, b → ∠β. In either case, we need to rearrange the equation slightly:</p><ul><li>∠ɑ, a, ∠β → b</li><li><div class=latex-block>= \frac{a}{sin\ \alpha}</div></li><li><div class=latex-block>b = \frac{a}{sin\ \alpha}\ sin\ \beta</div></li></ul><p>And another:</p><ul><li>∠ɑ, a, ∠β → b</li><li><div class=latex-block>\frac{sin\ \beta}{b} = \frac{sin\ \alpha}{a}</div></li><li><div class=latex-block>sin\ \beta = b \frac{sin\ \alpha}{a}</div></li><li><div class=latex-block>\beta = arcsin \bigl( b \frac{sin\ \alpha}{a} \bigr)</div></li></ul><p>Turning that into Racket and we have:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Sine rule 1: Matching side/angle + angle, solve for missing side</span>
</span></span><span style=display:flex><span>[(<span style=color:#a6e22e>triangle</span> (<span style=color:#a6e22e>?</span> number? <span style=color:#960050;background-color:#1e0010>∠</span>ɑ) (<span style=color:#a6e22e>?</span> number? <span style=color:#960050;background-color:#1e0010>∠</span>β) <span style=color:#960050;background-color:#1e0010>∠</span>γ
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>?</span> number?  a)             <span style=color:#66d9ef>#f</span>   c)
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>loop</span> (<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>ɑ <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>γ a (/ (* a (sin <span style=color:#960050;background-color:#1e0010>∠</span>β)) (sin <span style=color:#960050;background-color:#1e0010>∠</span>ɑ)) c))]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Sine rule 2: Matching side/angle + side, solve for missing angle</span>
</span></span><span style=display:flex><span>[(<span style=color:#a6e22e>triangle</span> (<span style=color:#a6e22e>?</span> number? <span style=color:#960050;background-color:#1e0010>∠</span>ɑ)            <span style=color:#66d9ef>#f</span> <span style=color:#960050;background-color:#1e0010>∠</span>γ
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>?</span> number?  a) (<span style=color:#a6e22e>?</span> number?  b) c)
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>loop</span> (<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>ɑ (asin (/ (* b (sin <span style=color:#960050;background-color:#1e0010>∠</span>ɑ)) a)) <span style=color:#960050;background-color:#1e0010>∠</span>γ a b c))]
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span></code></pre></div><p>After that, we have the law of cosines. From here, we can work with two sides and the mismatched angle or directly with three sides:</p><ul><li>∠ɑ, b, c → a</li><li><div class=latex-block>a^2 = b^2 + c^2 - 2bc\ cos\ \alpha</div></li><li><div class=latex-block>a = \sqrt{b^2 + c^2 - 2bc\ cos\ \alpha}</div></li></ul><p>Second one:</p><ul><li>a, b, c → ∠ɑ</li><li><div class=latex-block>b^2 + c^2 - 2bc\ cos\ \alpha = a^2</div></li><li><div class=latex-block>-2bc\ cos\ \alpha = a^2 - b^2 - c^2</div></li><li><div class=latex-block>cos\ \alpha = -\frac{a^2 - b^2 - c^2}{2bc}</div></li><li><div class=latex-block>\alpha = arccos\bigl(-\frac{a^2 - b^2 - c^2}{2bc}\bigr)</div></li></ul><p>In Racket:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Cosine rule 1: Angle and the other two sides, solve for third side</span>
</span></span><span style=display:flex><span>[(<span style=color:#a6e22e>triangle</span> (<span style=color:#a6e22e>?</span> number? <span style=color:#960050;background-color:#1e0010>∠</span>ɑ)           <span style=color:#960050;background-color:#1e0010>∠</span>β             <span style=color:#960050;background-color:#1e0010>∠</span>γ
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>#f</span>             (<span style=color:#a6e22e>?</span> number?  b) (<span style=color:#a6e22e>?</span> number?  c))
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>loop</span> (<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>ɑ <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>γ (sqrt (+ (<span style=color:#a6e22e>sqr</span> b) (<span style=color:#a6e22e>sqr</span> c) (- (* b c (cos <span style=color:#960050;background-color:#1e0010>∠</span>ɑ)))))))]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Cosine rule 2: Three sides, solve for one angle</span>
</span></span><span style=display:flex><span>[(<span style=color:#a6e22e>triangle</span> <span style=color:#66d9ef>#f</span>                        <span style=color:#960050;background-color:#1e0010>∠</span>β             <span style=color:#960050;background-color:#1e0010>∠</span>γ
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>?</span> number?  a) (<span style=color:#a6e22e>?</span> number?  b) (<span style=color:#a6e22e>?</span> number?  c))
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>loop</span> (<span style=color:#a6e22e>triangle</span> (acos (/ (+ (<span style=color:#a6e22e>sqr</span> b) (<span style=color:#a6e22e>sqr</span> c) (- (<span style=color:#a6e22e>sqr</span> a))) (* <span style=color:#ae81ff>2</span> b c))) <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>γ a b c))]
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span></code></pre></div><p>Those are all of the hard cases. But as I said, we still have to deal with reordering. Here&rsquo;s where one concession that I&rsquo;m making compared to the original problem comes into play: I do not care what order the final sides / angles are in, just so long as the triangles are equivalent. So we&rsquo;re perfectly fine to rotate the sides and angles, just so long as we do it to both:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Try another ordering</span>
</span></span><span style=display:flex><span>[(<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>ɑ <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>γ a b c)
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>loop</span> (<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>γ <span style=color:#960050;background-color:#1e0010>∠</span>ɑ b c a))]
</span></span></code></pre></div><p>This won&rsquo;t <em>quite</em> work though. Can you see why?</p><p>Well what happens if the variables are just ordered badly. Right now, it&rsquo;s possible that none of the cases will trigger in any of these three orderings. What happens then?</p><p>Well, right now we&rsquo;ll keep looping forever.</p><p>Oops.</p><p>There are a few ways that we can deal with this. We could keep a counter. If we&rsquo;ve tried three rotations without moving forward, we&rsquo;re done. But even more elegant (in my mind), we could keep a list of partial solutions we&rsquo;ve already tried. Even better, that will let us backtrack. So if we get to a case we&rsquo;ve already seen (that didn&rsquo;t work), back up naturally using the structure of recursion. All together, it will look something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; Given some of the sides/angles of a triangle try to solve for the rest</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>solve</span> t)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>tried <span style=color:#f92672>&#39;</span>())
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>let </span>loop ([t t])
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>set! </span>tried (cons t tried))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>match</span> t
</span></span><span style=display:flex><span>      <span style=color:#75715e>; We have all three sides and angles, return</span>
</span></span><span style=display:flex><span>      [(<span style=color:#a6e22e>?</span> solved?) t]
</span></span><span style=display:flex><span>      <span style=color:#75715e>; We&#39;ve already tried this solution, backtrack</span>
</span></span><span style=display:flex><span>      [(<span style=color:#a6e22e>?</span> (<span style=color:#a6e22e>curryr</span> member (cdr tried)))
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>#f</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>...</span>)))
</span></span></code></pre></div><p>We could have done without the explicit mutation, either using a <code><a href="http://docs.racket-lang.org/search/index.html?q=parameter">parameter</a></code>
to make the dynamic scope more obvious or by passing the <code>tried</code> variable around in the loop. Personally though, I think this is probably the &lsquo;cleanest&rsquo; solution.</p><p>So plug in the rules from above and we&rsquo;re good to go, right?</p><p>Well, not quite. There are still a few ordering issues. Sometimes the sides and angles just aren&rsquo;t lined up 5 rules that we have. So the last thing we need is a second ordering rule:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Try another ordering</span>
</span></span><span style=display:flex><span>[(<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>ɑ <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>γ a b c)
</span></span><span style=display:flex><span> (<span style=color:#66d9ef>or </span>(<span style=color:#a6e22e>loop</span> (<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>γ <span style=color:#960050;background-color:#1e0010>∠</span>ɑ b c a))
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>loop</span> (<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>ɑ <span style=color:#960050;background-color:#1e0010>∠</span>γ b a c)))]
</span></span></code></pre></div><p>This is actually pretty elegant for two reasons: Because we return <code>#f</code> when we backtrack, that will go to the second case if and only if the first doesn&rsquo;t find a solution. This works because anything not exactly <code>#f</code> in Racket is true and <code>or</code> returns the first non-<code>#f</code> argument (if one exists).</p><p>And that&rsquo;s it. It can already solve a good number of problems:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (<span style=color:#a6e22e>solve</span> (<span style=color:#a6e22e>triangle</span> <span style=color:#66d9ef>#f</span> <span style=color:#66d9ef>#f</span> <span style=color:#66d9ef>#f</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> (sqrt <span style=color:#ae81ff>2</span>)))
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>triangle</span> <span style=color:#ae81ff>0.785</span> <span style=color:#ae81ff>0.785</span> <span style=color:#ae81ff>1.571</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1.414</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&gt; (<span style=color:#a6e22e>solve</span> (<span style=color:#a6e22e>triangle</span> (/ pi <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>#f</span> <span style=color:#66d9ef>#f</span> (sqrt <span style=color:#ae81ff>2</span>) <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>#f</span>))
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>triangle</span> <span style=color:#ae81ff>0.785</span> <span style=color:#ae81ff>0.785</span> <span style=color:#ae81ff>1.571</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1.000</span> <span style=color:#ae81ff>1.414</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&gt; (<span style=color:#a6e22e>solve</span> (<span style=color:#a6e22e>triangle</span> (/ pi <span style=color:#ae81ff>3</span>) (/ pi <span style=color:#ae81ff>3</span>) <span style=color:#66d9ef>#f</span> <span style=color:#66d9ef>#f</span> <span style=color:#66d9ef>#f</span> <span style=color:#ae81ff>3</span>))
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>triangle</span> <span style=color:#ae81ff>1.0472</span> <span style=color:#ae81ff>1.0472</span> <span style=color:#ae81ff>1.0472</span> <span style=color:#ae81ff>2.999</span> <span style=color:#ae81ff>2.999</span> <span style=color:#ae81ff>3</span>)
</span></span></code></pre></div><p>We do have a fair few rounding errors creeping in, but unfortunately that&rsquo;s just part of the price we have to pay when working with real (analog) numbers in a digital computer.</p><p>And that&rsquo;s pretty much it. Or it would be, if not for one little extra feature I wanted to throw in. Remember how I said that because Racket&rsquo;s trig functions deal in radians, so too would our triangles? Well, just in case, here are a few conversion functions (since <code><a href="http://docs.racket-lang.org/search/index.html?q=radians-%3edegrees">radians->degrees</a></code>
and <code><a href="http://docs.racket-lang.org/search/index.html?q=degrees-%3eradians">degrees->radians</a></code>
are both built in if you&rsquo;re using the full <code><a href="http://docs.racket-lang.org/search/index.html?q=racket">racket</a></code>
module):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; Convert all angles in a triangle from radians to degrees</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>triangle-radians-&gt;degrees</span> t)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>r-&gt;d</span> <span style=color:#960050;background-color:#1e0010>∠</span>) (<span style=color:#66d9ef>and </span><span style=color:#960050;background-color:#1e0010>∠</span> (<span style=color:#a6e22e>radians-&gt;degrees</span> <span style=color:#960050;background-color:#1e0010>∠</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>match</span> t
</span></span><span style=display:flex><span>    [(<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>ɑ <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>γ a b c)
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>triangle</span> (<span style=color:#a6e22e>r-&gt;d</span> <span style=color:#960050;background-color:#1e0010>∠</span>ɑ) (<span style=color:#a6e22e>r-&gt;d</span> <span style=color:#960050;background-color:#1e0010>∠</span>β) (<span style=color:#a6e22e>r-&gt;d</span> <span style=color:#960050;background-color:#1e0010>∠</span>γ) a b c)]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>#f</span> <span style=color:#66d9ef>#f</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Convert all angles in a triangle from degrees to radians</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>triangle-degrees-&gt;radians</span> t)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>d-&gt;r</span> <span style=color:#960050;background-color:#1e0010>∠</span>) (<span style=color:#66d9ef>and </span><span style=color:#960050;background-color:#1e0010>∠</span> (<span style=color:#a6e22e>degrees-&gt;radians</span> <span style=color:#960050;background-color:#1e0010>∠</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>match</span> t
</span></span><span style=display:flex><span>    [(<span style=color:#a6e22e>triangle</span> <span style=color:#960050;background-color:#1e0010>∠</span>ɑ <span style=color:#960050;background-color:#1e0010>∠</span>β <span style=color:#960050;background-color:#1e0010>∠</span>γ a b c)
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>triangle</span> (<span style=color:#a6e22e>d-&gt;r</span> <span style=color:#960050;background-color:#1e0010>∠</span>ɑ) (<span style=color:#a6e22e>d-&gt;r</span> <span style=color:#960050;background-color:#1e0010>∠</span>β) (<span style=color:#a6e22e>d-&gt;r</span> <span style=color:#960050;background-color:#1e0010>∠</span>γ) a b c)]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>#f</span> <span style=color:#66d9ef>#f</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Given some of the sides/angles of a triangle try to solve for the rest</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>solve/radians</span> t)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>tried <span style=color:#f92672>&#39;</span>())
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>let </span>loop ([t t])
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Given some of the sides/angles of a triangle try to solve for the rest</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>solve/degrees</span> t)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>triangle-radians-&gt;degrees</span> (<span style=color:#a6e22e>solve/radians</span> (<span style=color:#a6e22e>triangle-degrees-&gt;radians</span> t))))
</span></span></code></pre></div><p>Now you can solve the examples given in the problem:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (<span style=color:#a6e22e>solve/degrees</span> (<span style=color:#a6e22e>triangle</span> <span style=color:#ae81ff>39.0</span> <span style=color:#ae81ff>56.0</span> <span style=color:#66d9ef>#f</span> <span style=color:#ae81ff>2.45912</span> <span style=color:#66d9ef>#f</span> <span style=color:#66d9ef>#f</span>))
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>triangle</span> <span style=color:#ae81ff>56.0</span> <span style=color:#ae81ff>85.0</span> <span style=color:#ae81ff>39.0</span> <span style=color:#ae81ff>3.240</span> <span style=color:#ae81ff>3.893</span> <span style=color:#ae81ff>2.459</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&gt; (<span style=color:#a6e22e>solve/degrees</span> (<span style=color:#a6e22e>triangle</span> <span style=color:#ae81ff>43.0</span> <span style=color:#66d9ef>#f</span> <span style=color:#ae81ff>70.0</span> <span style=color:#66d9ef>#f</span> <span style=color:#66d9ef>#f</span> <span style=color:#ae81ff>7</span>))
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>triangle</span> <span style=color:#ae81ff>43.0</span> <span style=color:#ae81ff>67.0</span> <span style=color:#ae81ff>70.0</span> <span style=color:#ae81ff>5.080</span> <span style=color:#ae81ff>6.857</span> <span style=color:#ae81ff>7</span>)
</span></span></code></pre></div><p>And that&rsquo;s it. You can find the full code on GitHub here: <a href=https://github.com/jpverkamp/small-projects/blob/master/blog/triangle-trouble.rkt>triangle-trouble.rkt</a></p><p>Bonus round:</p><ol><li>Without actually running it, can you figure out what will happen if you give it an impossible triangle? Such as three angles or two angles already too large?</li></ol><p>Bonus bonus round:
2) What about cases with three sides that <em>should</em> be impossible but technically have a solution<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>&mldr; Such as a=1, b=2, c=4.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Or is it peek? Peak?&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>I love Racket&rsquo;s / DrRacket&rsquo;s native unicode support, having the ∠ character in a variable name is just cool&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>As do most sane languages&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>Although I&rsquo;m sure there are those that don&rsquo;t&mldr;&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>If only you can imagine&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div><script defer src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin=anonymous></script>
<script defer src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin=anonymous></script>
<script defer src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js integrity=sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h crossorigin=anonymous></script>
<script defer src=https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script defer src=/custom.js></script></body></html>