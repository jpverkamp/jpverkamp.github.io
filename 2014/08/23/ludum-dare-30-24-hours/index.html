<!DOCTYPE html>
<html onclick >
<head>
    <title>Ludum Dare 30: 24 hours â€“ jverkamp.com</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8"><link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css" integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" />

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper"><header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a> *
            <a href="/resume">Resume</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>
    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation"><li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li><li><a href="https://blog.jverkamp.com/maker/">Maker</a></li><li><a href="https://blog.jverkamp.com/programming/">Programming</a></li><li><a href="https://blog.jverkamp.com/photography/">Photography</a></li><li><a href="https://blog.jverkamp.com/writing/">Writing</a></li><li><a href="https://blog.jverkamp.com/research/">Research</a></li><li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>
<div id="page-content-wrapper">
            <div id="page-content"><article>
	<header>
		<h1 class="entry-title">Ludum Dare 30: 24 hours</h1>

        <div class="entry-meta"><span class="entry-date">2014-08-23</span>
            </div>

        <div class="entry-taxonomies"><div class="entry-tags"><ul class="taxonomy-keys"><li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-hints-of-a-game/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/html">HTML</a><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-programmer-art-and-simple-ai/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-hints-of-a-game/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/javascript">JavaScript</a><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-programmer-art-and-simple-ai/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/sources/">Sources</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-hints-of-a-game/" class="previous-link"></a><a class="taxonomy-value" href="/programming/sources/ludum-dare">Ludum Dare</a><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-programmer-art-and-simple-ai/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/topics/">Topics</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-hints-of-a-game/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/cellular-automata">Cellular Automata</a><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-programmer-art-and-simple-ai/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-hints-of-a-game/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/games">Games</a><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-programmer-art-and-simple-ai/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/series/">Series</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-hints-of-a-game/" class="previous-link"></a><a class="taxonomy-value" href="/series/ludum-dare-30">Ludum Dare 30</a><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-programmer-art-and-simple-ai/" class="next-link"></a></li></ul>
        </li><li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-hints-of-a-game/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-programmer-art-and-simple-ai/" class="next-link">Next</a></ul>
        </li><li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-hints-of-a-game/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2014/08/23/ludum-dare-30-programmer-art-and-simple-ai/" class="next-link">Next</a></ul>
        </li></ul>
</div>
</div>
    </header>

	<div class="entry-content"><p>Here we are, 24 hours into the competition.</p>
<p>A lot of the last few hours has been spent doing a fair amount of restructing. Before, I had a single &lsquo;thread&rsquo;<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> for each of the tiles, along with another thread listening for user input. Unfortunately though, that lead to all sorts of race conditions.
Specifically, whenever two tiles overlapped, it was often the case that one was doing the falling step (which copies from one internal buffer to another) while the other was in the swap step (which copies from tile to another). Then after the first finished, it would copy the second buffer over&hellip; overwriting anything that had been swapped.</p>
<p>Oops.</p>
<p>Well, it turns out that the solution wasn&rsquo;t that bad. Rather than having a bunch of threads running around, I&rsquo;ve just put the entire thing into lockstep. Now, we go through the entire sequence (sand falls, swaps happen, rendering happens, move tiles) once ever frame, in that order. It&rsquo;s a bit more expensive when it comes to performance, but really not that much, since technically JavaScript doesn&rsquo;t do more than one thing at a time anyways.</p>
<p>In exchange though, the game is playing great:</p>
<figure>
    <img src="/embeds/2014/in-game-2.png"/> 
</figure>

<p>Another thing that I did was to do some styling, converting the game from a big mess of an HTML page into a nice layered style that all fits within the 600x400 game area that I&rsquo;ve set aside (I doubt I&rsquo;ll make that changeable, although it shouldn&rsquo;t be hard). Specifically:</p>
<figure>
    <img src="/embeds/2014/start-screen.png"/> 
</figure>

<p>If you click options, these fade in (jQuery transitions are awesome for this):</p>
<figure>
    <img src="/embeds/2014/options.png"/> 
</figure>

<p>If you click play, all of the button and options fading out, taking you into the game:</p>
<figure>
    <img src="/embeds/2014/in-game-1.png"/> 
</figure>

<p>At the end of the game (the timer is in the bottom right, set to a static 1 minute at the moment), you get the new scoring screen. I think I worked about 2 hours on this, which sounds crazy, but I think the effect is pretty awesome:</p>
<figure>
    <img src="/embeds/2014/scoring-in-progress.png"/> 
</figure>

<p>You can&rsquo;t see it in the screenshot there, but it will go through each player one by one, scoring the region from bottom to top, counting up each kind of sand individually. That should make scoring modes much easier if/when I add more options. I can just do things like discount (or even count negative) your own sand, or only count it.</p>
<p>And finally, once it&rsquo;s done counting:</p>
<figure>
    <img src="/embeds/2014/game-over.png"/> 
</figure>

<p>I&rsquo;d like to have some sort of background motion going on both here and during the opening menu. Something like having the tiles bounce around using some sort of AI. Speaking of which, here is a tentative feature list that I&rsquo;d like to see in the next 24 hours (in no particular order):</p>
<ul>
<li>AI players; at the very least one that moves randomly, but optimally several different kinds</li>
<li>Pending the previous, a selector on the options screen that can turn each player either off, on, or to any of the current AIs</li>
<li>Pending the first, AI players playing in the background, periodically resetting before the game has started and between games</li>
<li>Music and/or sound effects; of course with options to turn those on and off</li>
<li>Some sort of high score menu, probably not live (although I certainly could)</li>
<li>Stylings around the page; probably some sort of thick border that bleeds a little in and out, looking different per player</li>
</ul>
<p>I think that&rsquo;s about it. If you have any ideas, I&rsquo;d love to hear them. There&rsquo;s not much (well, any) code this time, since nothing major has changed (other than refactoring). It&rsquo;s pretty much all tweaks. If you&rsquo;d like to see the entire source (warning: ugly, bit getting a little better), it&rsquo;s still right here: <a href="https://github.com/jpverkamp/sandbox-battle">jpverkamp/sandbox-battle</a></p>
<p>Demo time!</p>
<iframewidth="660"height="440"frameBorder="no"scrolling="yes"src="/embeds/2014/demo.embed.htm">
</iframe>

<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><code>setTimeout</code> chain, JavaScript doesn&rsquo;t have true threads <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section></div>
</article></div>
        </div><footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li><li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li></ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>
</div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js" integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js" integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin="anonymous"></script>

<script src="/custom.js"></script>
</body>
</html>
