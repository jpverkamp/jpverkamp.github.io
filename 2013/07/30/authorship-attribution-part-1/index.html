<!DOCTYPE html>
<html>
<head>
    <title>
    Authorship attribution: Part 1 – jverkamp.com
</title>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/css/themes/light/nanogallery_light.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css">

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />


    
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper">
        <header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://twitter.com/jpverkamp">Twitter</a> *
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>

    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
        
            
        
            
            <li><a href="https://blog.jverkamp.com/photography/">Photography</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/programming/">Programming</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/research/">Research</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/writing/">Writing</a></li>
            
        
            <li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>


        <div id="page-content-wrapper">
            <div id="page-content">
            
<article>
	<header>
		<h1 class="entry-title">Authorship attribution: Part 1</h1>

        <div class="entry-meta">
            
            <span class="entry-date">2013-07-30</span>
            
            
        </div>

        <div class="entry-tags">
    
    

    <ul class="taxonomy-keys">
    
        
        

        
        

        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2013/07/19/racket-roguelike-post-mortem/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/languages/racket">Racket</a>
                        <a href="https://blog.jverkamp.com/2013/08/02/authorship-attribution-part-2/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2013/06/29/a-programming-puzzle-ffn---n/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/languages/scheme">Scheme</a>
                        <a href="https://blog.jverkamp.com/2013/08/02/authorship-attribution-part-2/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/topics/">Topics</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2010/05/21/flairs-2010---augmenting-n-gram-based-authorship-attribution-with-neural-networks/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/topics/computational-linguistics">Computational Linguistics</a>
                        <a href="https://blog.jverkamp.com/2013/08/02/authorship-attribution-part-2/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2013/06/29/a-programming-puzzle-ffn---n/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/topics/mathematics">Mathematics</a>
                        <a href="https://blog.jverkamp.com/2013/08/02/authorship-attribution-part-2/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2010/05/21/flairs-2010---augmenting-n-gram-based-authorship-attribution-with-neural-networks/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/topics/research">Research</a>
                        <a href="https://blog.jverkamp.com/2013/08/02/authorship-attribution-part-2/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2013/05/21/ludum-dare-26---vtanks---results/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/topics/vectors">Vectors</a>
                        <a href="https://blog.jverkamp.com/2013/08/02/authorship-attribution-part-2/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    

    
        
        <li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li>
                
                <a href="https://blog.jverkamp.com/2013/07/19/racket-roguelike-post-mortem/" class="previous-link">Prev</a>
                

                
                <a href="https://blog.jverkamp.com/2013/08/02/authorship-attribution-part-2/" class="next-link">Next</a>
                
            </ul>
        </li>
        

        
        <li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li>
                
                <a href="https://blog.jverkamp.com/2013/07/30/the-wolverine/" class="previous-link">Prev</a>
                

                
                <a href="https://blog.jverkamp.com/2013/08/02/authorship-attribution-part-2/" class="next-link">Next</a>
                
            </ul>
        </li>
        
    
    </ul>
</div>

    </header>

	<div class="entry-content">
		<p>About two weeks ago, the new crime fiction novel <a href="http://www.amazon.com/gp/product/0316206849/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0316206849&amp;linkCode=as2&amp;tag=jverkampcom-20">Cuckoo&rsquo;s Calling</a> was revealed to have actually been written by J.K. Rowling under the pseudonym Robert Galbraith. What&rsquo;s interesting is exactly how they came to that conclusion. Here&rsquo;s a quote from <a title="J.K. Rowling’s Secret: A Forensic Linguist Explains How He Figured It Out" href="http://entertainment.time.com/2013/07/15/j-k-rowlings-secret-a-forensic-linguist-explains-how-he-figured-it-out/">Time</a> magazine (via <a title="J K Rowling" href="http://programmingpraxis.com/2013/07/19/j-k-rowling/">Programming Praxis</a>):</p>

<p></p>

<blockquote>
<p>As one part of his work, Juola uses a program to pull out the hundred most frequent words across an author’s vocabulary. This step eliminates rare words, character names and plot points, leaving him with words like of and but, ranked by usage. Those words might seem inconsequential, but they leave an authorial fingerprint on any work.</p>

<p>“Propositions and articles and similar little function words are actually very individual,” Juola says. “It’s actually very, very hard to change them because they’re so subconscious.”</p>
</blockquote>

<p>It&rsquo;s actually pretty similar to what I did a few years ago for my undergraduate thesis: <a title="AnnGram" href="http://blog.jverkamp.com/category/programming/anngram/">AnnGram</a>. In that case, I used a similar technique to what they described above, <a href="https://en.wikipedia.org/wiki/n-grams">n-grams</a>, and <a href="https://en.wikipedia.org/wiki/Self%20organizing%20map">self organizing maps</a> to classify works by author. It&rsquo;s been awhile, but let&rsquo;s take a crack at re-implementing some of these techniques.</p>

<p>(If you&rsquo;d like to follow along, you can see the full code here: <a href="https://github.com/jpverkamp/small-projects/tree/master/authorship">authorship attribution on github</a>)</p>

<p>First, we&rsquo;ll use the technique described above. The idea is to take the most common words throughout a book and rank them. Theoretically, this will give us a unique fingerprint for each author that should be able to identify them even under a pseudonym.</p>

<p>Let&rsquo;s start by cleaning up the words. For the time being, we want only alphabetic characters and only in lowercase. That way we should avoid position in sentences and the like. This should be an easy enough way to do that:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Remove non word characters</span>
(<span style="color:#66d9ef">define </span>(fix-word word)
  (list-&gt;string 
   (for/list ([c (in-string word)] 
              <span style="color:#f92672">#</span>:when (char-alphabetic? c)) 
     (char-downcase c))))</code></pre></div>
<p>Easy enough. So let&rsquo;s actually count the words. To start, we&rsquo;ll keep a hash of counts. They&rsquo;re easy enough to work with in Racket, albeit not quite so easy as say Python. With that, we only need to loop through the words in the text:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Store the word counts</span>
(<span style="color:#66d9ef">define </span>counts (make-hash))

<span style="color:#75715e">; Count all of the base words in the text</span>
(for* ([line (in-lines in)]
       [word (in-list (string-split line))])
  (<span style="color:#66d9ef">define </span>fixed (fix-word word))
  (hash-set! counts fixed (add1 (hash-ref counts fixed <span style="color:#ae81ff">0</span>))))</code></pre></div>
<p>Using the three argument form of <code>hash-ref</code> allows us to specify a default. That way the <code>hash</code> is effectively acting like Python&rsquo;s <code>defaultdict</code> (a particular favorite data structure of mine).</p>

<p>After we&rsquo;ve done that, we can find the <code>top-n</code> most common words:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Extract the top limit words</span>
(<span style="color:#66d9ef">define </span>top-n
  (map first
       (take
        (sort 
         (for/list ([(word count) (in-hash counts)])
           (list word count))
         (<span style="color:#66d9ef">lambda </span>(a b) (&gt; (second a) (second b))))
        limit)))</code></pre></div>
<p>Finally, we want to replace the count with the ordering. Later, we&rsquo;ll try using the relative frequencies but at the moment the ordering will do well enough. Since we&rsquo;re going to later use a default value of 0 which should be near to a low rank, we&rsquo;ll count down.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Add an order to each, descending</span>
(for/hash ([i (in-range limit <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">-1</span>)]
           [word (in-list top-n)])
  (values word i)))</code></pre></div>
<p>All together, this can take a text file (as input port) and return the most common words. For example, using Cuckoo&rsquo;s Calling:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (with-input-from-file <span style="color:#e6db74">&#34;Cuckoo&#39;s Calling.txt&#34;</span> word-rank)
<span style="color:#f92672">&#39;#</span>hash((<span style="color:#e6db74">&#34;the&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">10</span>)  (<span style="color:#e6db74">&#34;to&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">9</span>)   (<span style="color:#e6db74">&#34;and&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">8</span>)
       (<span style="color:#e6db74">&#34;a&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">7</span>)     (<span style="color:#e6db74">&#34;of&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">6</span>)   (<span style="color:#e6db74">&#34;he&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">5</span>)
       (<span style="color:#e6db74">&#34;was&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">4</span>)   (<span style="color:#e6db74">&#34;she&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">3</span>)  (<span style="color:#e6db74">&#34;in&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">2</span>)
       (<span style="color:#e6db74">&#34;her&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">1</span>))</code></pre></div>
<p>If the post was correct (and they did identify JK Rowling after all), then this should be a similar ordering for any book written by her while other authors will be slightly different. Let&rsquo;s take for example the text of the 7th Harry Potter book:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (with-input-from-file <span style="color:#e6db74">&#34;Deathly Hallows.txt&#34;</span> word-rank)
<span style="color:#f92672">&#39;#</span>hash((<span style="color:#e6db74">&#34;the&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">10</span>)  (<span style="color:#e6db74">&#34;and&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">9</span>)    (<span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">8</span>)
       (<span style="color:#e6db74">&#34;to&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">7</span>)    (<span style="color:#e6db74">&#34;of&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">6</span>)     (<span style="color:#e6db74">&#34;he&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">5</span>)
       (<span style="color:#e6db74">&#34;a&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">4</span>)     (<span style="color:#e6db74">&#34;harry&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">3</span>)  (<span style="color:#e6db74">&#34;was&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">2</span>)
       (<span style="color:#e6db74">&#34;it&#34;</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">1</span>))</code></pre></div>
<p>It seems that <strong>and</strong> has moved up, <strong>a</strong> and <strong>she</strong> have swapped, and <strong>harry</strong> is there&ndash;It&rsquo;s pretty impressive that&rsquo;s the 7th most common word in the entire book but rather unlikely to appear in Cuckoo&rsquo;s Calling. But overall, it&rsquo;s pretty similar. So let&rsquo;s try to compare it to a few more books.</p>

<p>We do need one more peace first though. We need to be able to tell how similar two books are. In this case, we&rsquo;ll use the idea of <a href="https://en.wikipedia.org/wiki/cosine%20similarity">cosine similarity</a>. Essentially, given two vectors we can calculate the angle between them. The more similar two vectors are, the closer to zero the result will be.</p>

<p>One problem is that we have hashes instead of vectors. We can&rsquo;t even guarantee that the same words will appear in two different lists. So first, we&rsquo;ll unify the keys. Add zeros for missing words, put them in the same order, and we have vectors we can measure:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; Calculate the similarity between two vectors</span>
<span style="color:#75715e">; If inputs are hashes, merge them before calculating similarity</span>
(<span style="color:#66d9ef">define </span>(cosine-similarity a b)
  (cond
    [(<span style="color:#66d9ef">and </span>(hash? a) (hash? b))
     (<span style="color:#66d9ef">define </span>keys
       (set-&gt;list (set-union (list-&gt;set (hash-keys a))
                             (list-&gt;set (hash-keys b)))))
     (cosine-similarity
      (for/vector ([k (in-list keys)]) (hash-ref a k <span style="color:#ae81ff">0</span>))
      (for/vector ([k (in-list keys)]) (hash-ref b k <span style="color:#ae81ff">0</span>)))]
    [else
     (<span style="color:#66d9ef">define </span>cossim (acos (/ (dot-product a b) (* (magnitude a) (magnitude b)))))
     (- <span style="color:#ae81ff">1.0</span> (/ (abs cossim) (/ pi <span style="color:#ae81ff">2</span>)))]))</code></pre></div>
<p>The last line normalizes it to the range [0, 1.0] where the higher the number, the better match. This isn&rsquo;t strictly necessary, but I think it looks nicer. 😄</p>

<p>Finally, we can calculate the similarity between two books. So how similar are Cuckoo&rsquo;s Calling and the Deathly Hallows?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (<span style="color:#66d9ef">let </span>([a (with-input-from-file <span style="color:#e6db74">&#34;Cuckoo&#39;s Calling.txt&#34;</span> word-rank)]
        [b (with-input-from-file <span style="color:#e6db74">&#34;Deathly Hallows.txt&#34;</span> word-rank)])
    (cosine-similarity a b))
<span style="color:#ae81ff">0.6965</span></code></pre></div>
<p>About 70% (not that the numbers mean particularly much). So let&rsquo;s try a few more.</p>

<p>Unfortunately, I don&rsquo;t have much in the way of crime fiction&ndash;I&rsquo;m more interested in science fiction and fantasy. But that should work well enough. Using a bit of framework (<a href="https://github.com/jpverkamp/small-projects/blob/master/authorship/main.rkt">linky</a>), we can measure this easily enough.</p>

<p>So, who among the author I have could have written Cuckoo&rsquo;s Calling? Here are the most similar books:</p>

<table>
<thead>
<tr>
<th>1</th>
<th>0.740</th>
<th>Butcher, Jim</th>
<th>Storm Front</th>
</tr>
</thead>

<tbody>
<tr>
<td>2</td>
<td>0.739</td>
<td>Butcher, Jim</td>
<td>Side Jobs</td>
</tr>

<tr>
<td>3</td>
<td>0.738</td>
<td>Butcher, Jim</td>
<td>Turn Coat</td>
</tr>

<tr>
<td>4</td>
<td>0.736</td>
<td>Butcher, Jim</td>
<td>Small Favor</td>
</tr>

<tr>
<td>5</td>
<td>0.735</td>
<td>Butcher, Jim</td>
<td>White Night</td>
</tr>

<tr>
<td>6</td>
<td>0.734</td>
<td>Butcher, Jim</td>
<td>Cold Days</td>
</tr>

<tr>
<td>7</td>
<td>0.731</td>
<td>Butcher, Jim</td>
<td>Proven Guilty</td>
</tr>

<tr>
<td>8</td>
<td>0.729</td>
<td>Butcher, Jim</td>
<td>Ghost Story</td>
</tr>

<tr>
<td>9</td>
<td>0.728</td>
<td>Stirling, S. M. &amp; Meier, Shirley</td>
<td>Shadow&rsquo;s Son</td>
</tr>

<tr>
<td>10</td>
<td>0.728</td>
<td>Stephen, King</td>
<td>Wizard and Glass</td>
</tr>

<tr>
<td>11</td>
<td>0.728</td>
<td>Lovegrove, James</td>
<td>The Age of Zeus</td>
</tr>

<tr>
<td>12</td>
<td>0.726</td>
<td>Butcher, Jim</td>
<td>Dead Beat</td>
</tr>

<tr>
<td>13</td>
<td>0.726</td>
<td>Duncan, Glen</td>
<td>Last Werewolf, The</td>
</tr>

<tr>
<td>14</td>
<td>0.724</td>
<td>Butcher, Jim</td>
<td>Fool Moon</td>
</tr>

<tr>
<td>15</td>
<td>0.723</td>
<td>Stephen, King</td>
<td>The Drawing of the Three</td>
</tr>

<tr>
<td>16</td>
<td>0.723</td>
<td>Adams, Douglas</td>
<td>So Long, and Thanks for All the Fish</td>
</tr>

<tr>
<td>17</td>
<td>0.722</td>
<td>Stephen, King</td>
<td>The Dark Tower</td>
</tr>

<tr>
<td>18</td>
<td>0.718</td>
<td>Lovegrove, James</td>
<td>The Age of Odin</td>
</tr>

<tr>
<td>19</td>
<td>0.718</td>
<td>Butcher, Jim</td>
<td>Changes</td>
</tr>

<tr>
<td>20</td>
<td>0.715</td>
<td>Chima, Cinda Williams</td>
<td>The Wizard Heir</td>
</tr>
</tbody>
</table>

<p>Perhaps it&rsquo;s not surprising that Jim Butcher&rsquo;s books are at the top of the list. After all, it&rsquo;s about the closest thing that I have to crime fiction. Still, it doesn&rsquo;t look good that absolutely none of JK Rowling&rsquo;s books are in the top 20. In fact, we have to go all of the way down to 43 to find Harry Potter and the Half-Blood Prince, with a score of 0.704.</p>

<p>What if we average each author&rsquo;s books? Perhaps JK Rowling is more consistently matched against Cuckoo&rsquo;s Calling?</p>

<p><table class="table table-striped">
<tr><td>1</td><td>0.714</td><td>Stephen, King</td></tr>
<tr><td>2</td><td>0.709</td><td>Butcher, Jim</td></tr>
<tr><td>3</td><td>0.704</td><td>Briggs, Patricia</td></tr>
<tr><td>4</td><td>0.704</td><td>Benson, Amber</td></tr>
<tr><td>5</td><td>0.698</td><td>Robinson, Kim Stanley</td></tr>
<tr><td>6</td><td>0.694</td><td>Colfer, Eoin</td></tr>
<tr><td>7</td><td>0.693</td><td>Jordan, Robert</td></tr>
<tr><td>8</td><td>0.692</td><td>Rowling, J.K.</td></tr>
<tr><td>9</td><td>0.687</td><td>Steele, Allen</td></tr>
<tr><td>10</td><td>0.687</td><td>Orwell, George</td></tr>
<tr><td>11</td><td>0.682</td><td>Croggon, Alison</td></tr>
<tr><td>12</td><td>0.681</td><td>Adams, Douglas</td></tr>
<tr><td>13</td><td>0.680</td><td>Riordan, Rick</td></tr>
<tr><td>14</td><td>0.679</td><td>Card, Orson Scott</td></tr>
<tr><td>15</td><td>0.671</td><td>Brin, David</td></tr>
<table class="table table-striped"></p>

<p>Not so much better, that. I have a few ideas though. Perhaps in a few days, we&rsquo;ll see what we can do.</p>

<p>If you&rsquo;d like to see the full source, you can do so here: <a href="https://github.com/jpverkamp/small-projects/tree/master/authorship">authorship attribution on github</a></p>
	</div>

    
<div class="entry-comments">
    <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = "jverkamp";
            var disqus_title = "Authorship attribution: Part 1";
            var disqus_url = "https:\/\/blog.jverkamp.com\/2013\/07\/30\/authorship-attribution-part-1\/";

             
            (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>


</article>

            </div>
        </div>

        <footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup>

<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li>

            
            <li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup>

<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li>
            
        </ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>

    </div>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/jquery.nanogallery.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js"></script>

<script type="text/javascript" src="/custom.js" defer></script>

</body>
</html>
