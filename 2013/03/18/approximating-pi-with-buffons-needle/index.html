<!DOCTYPE html>
<html onclick >
<head>
    <title>Approximating Pi with Buffon&#39;s Needle â€“ jverkamp.com</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8"><link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css" integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" />

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper"><header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a> *
            <a href="/resume">Resume</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>
    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation"><li><a href="https://blog.jverkamp.com/photography/">Photography</a></li><li><a href="https://blog.jverkamp.com/programming/">Programming</a></li><li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li><li><a href="https://blog.jverkamp.com/maker/">Maker</a></li><li><a href="https://blog.jverkamp.com/writing/">Writing</a></li><li><a href="https://blog.jverkamp.com/research/">Research</a></li><li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>
<div id="page-content-wrapper">
            <div id="page-content"><article>
	<header>
		<h1 class="entry-title">Approximating Pi with Buffon&#39;s Needle</h1>

        <div class="entry-meta"><span class="entry-date">2013-03-18</span>
            </div>

        <div class="entry-taxonomies"><div class="entry-tags"><ul class="taxonomy-keys"><li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2013/03/06/partitioning-the-dutch-national-flag/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/html">HTML</a><a href="https://blog.jverkamp.com/2014/08/22/ludum-dare-30-sandbox-battle/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2013/03/06/partitioning-the-dutch-national-flag/" class="previous-link"></a><a class="taxonomy-value" href="/programming/languages/javascript">JavaScript</a><a href="https://blog.jverkamp.com/2014/01/13/csrf-protection-injection-with-jquery-and-zend/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/sources/">Sources</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2013/03/11/knight-moves/" class="previous-link"></a><a class="taxonomy-value" href="/programming/sources/programming-praxis">Programming Praxis</a><a href="https://blog.jverkamp.com/2013/04/09/cyclic-equality/" class="next-link"></a></li></ul>
        </li><li>
            <a class="taxonomy-key" href="/programming/topics/">Topics</a>
            <ul class="taxonomy-values"><li><a href="https://blog.jverkamp.com/2013/01/20/triangle-trilemma/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/mathematics">Mathematics</a><a href="https://blog.jverkamp.com/2013/04/11/perlin-and-simplex-noise-in-racket/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2013/01/20/triangle-trilemma/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/trigonometry">Trigonometry</a><a href="https://blog.jverkamp.com/2014/05/02/trigonometric-triangle-trouble/" class="next-link"></a></li><li><a href="https://blog.jverkamp.com/2013/03/06/partitioning-the-dutch-national-flag/" class="previous-link"></a><a class="taxonomy-value" href="/programming/topics/web-development">Web Development</a><a href="https://blog.jverkamp.com/2014/01/13/csrf-protection-injection-with-jquery-and-zend/" class="next-link"></a></li></ul>
        </li><li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2013/03/17/the-house-on-the-hill-postmortem/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2013/03/28/path-to-philosophy/" class="next-link">Next</a></ul>
        </li><li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li><a href="https://blog.jverkamp.com/2013/03/17/the-house-on-the-hill-postmortem/" class="previous-link">Prev</a>
                <a href="https://blog.jverkamp.com/2013/03/28/path-to-philosophy/" class="next-link">Next</a></ul>
        </li></ul>
</div>
</div>
    </header>

	<div class="entry-content"><p>I&rsquo;m a bit late for Pi Day, but Programming Praxis had <a href="http://programmingpraxis.com/2013/03/15/buffons-needle/" title="Buffon's Needle">a neat problem on Friday</a> that I wanted to check out:</p>
<blockquote>
<p>Suppose we have a floor made of parallel strips of wood, each the same width, and we drop a needle onto the floor. What is the probability that the needle will lie across a line between two strips?</p>
</blockquote>
<p>It turns out (as you might have guessed from the title) that the probability ends up being equal to 2/pi. How can we show that? Well in this case, I have a nice JavaScript simulation for you (down at the end of the post). The code is actually really straight forward:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// Drop a bunch of needles
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">x1</span>, <span style="color:#a6e22e">y1</span>, <span style="color:#a6e22e">theta</span>, <span style="color:#a6e22e">x2</span>, <span style="color:#a6e22e">y2</span>;
<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">numberToDrop</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
	<span style="color:#75715e">// Drop a new needle
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">x1</span> <span style="color:#f92672">=</span> (Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> (<span style="color:#a6e22e">width</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">needleLength</span>)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">needleLength</span>;
	<span style="color:#a6e22e">y1</span> <span style="color:#f92672">=</span> (Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> (<span style="color:#a6e22e">height</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">needleLength</span>)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">needleLength</span>;
	<span style="color:#a6e22e">theta</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> Math.<span style="color:#a6e22e">PI</span>;

	<span style="color:#a6e22e">x2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">x1</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">needleLength</span> <span style="color:#f92672">*</span> Math.<span style="color:#a6e22e">cos</span>(<span style="color:#a6e22e">theta</span>);
	<span style="color:#a6e22e">y2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">y1</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">needleLength</span> <span style="color:#f92672">*</span> Math.<span style="color:#a6e22e">sin</span>(<span style="color:#a6e22e">theta</span>);

	<span style="color:#75715e">// Check if it crosses a line
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// Yes, this isn&#39;t the best way to do this
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">crossesLine</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">needleLength</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>; <span style="color:#a6e22e">x</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">canvas</span>.<span style="color:#a6e22e">width</span>; <span style="color:#a6e22e">x</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">needleLength</span>) {
		<span style="color:#66d9ef">if</span> ((<span style="color:#a6e22e">x1</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">x2</span>) <span style="color:#f92672">||</span> (<span style="color:#a6e22e">x2</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">x1</span>))
			<span style="color:#a6e22e">crossesLine</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
	}

	<span style="color:#75715e">// Record the toss
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">tossed</span> <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>;
	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">crossesLine</span>) <span style="color:#a6e22e">crossed</span> <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>;
}

<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;pi ~ &#34;</span> <span style="color:#f92672">+</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">tossed</span> <span style="color:#f92672">/</span> <span style="color:#a6e22e">crossed</span>));
</code></pre></div><p>I know that there are better ways to figure out if a needle crosses the line, but this works well enough. Plus, I wanted to make a really neat visualization. Speaking of which (note: red needles are crossing the line, blue are not):</p>
<script type="text/javascript">
jQuery(function($) {
	// Context to draw with
	var canvas = $('#canvas')[0];
	var context = canvas.getContext('2d');
	var progress = $('#progress');

	// Experiment parameters
	var drawEnabled = true;
	var pendingDrop = false;
	var tickTime = 1000000;
	var speedBoost = 1;
	var roundingDigits = 1000000;
	var maxBufferSize = 10;
	var needleBuffer = [];
	var needleLength = canvas.width / 20;
	var tossed = 0;
	var crossed = 0;

	// Draw lines
	function drawLines() {
		for (var x = needleLength / 2; x <= canvas.width; x += needleLength) {
			context.beginPath();
			context.strokeStyle = 'black';
			context.moveTo(x, 0);
			context.lineTo(x, canvas.height);
			context.stroke();
		}
	}

	// Drop a single needle on the canvas
	function dropNeedle() {
		var x1, y1, theta, x2, y2;
		// In accelerated mode, do multiple at a time
		for (var i = 0; i < speedBoost; i++) {
			// Drop a new needle
			x1 = (Math.random() * (canvas.width - 2 * needleLength)) + needleLength;
			y1 = (Math.random() * (canvas.height - 2 * needleLength)) + needleLength;
			theta = Math.random() * 2 * Math.PI;

			x2 = x1 + needleLength * Math.cos(theta);
			y2 = y1 + needleLength * Math.sin(theta);

			// Check if it crosses a line
			// Yes, this isn't the best way to do this
			var crossesLine = false;
			for (var x = needleLength / 2; x <= canvas.width; x += needleLength) {
				if ((x1 <= x && x <= x2) || (x2 <= x && x <= x1))
					crossesLine = true;
			}

			// Record the toss
			tossed += 1;
			if (crossesLine)
				crossed += 1;
		}

		// Potentially disable drawing
		if (drawEnabled) {
			// Buffer the drawn needles to erase them later
			needleBuffer.push([x1, y1, x2, y2])

			// Draw the needle
			context.beginPath();
			context.strokeStyle = (crossesLine ? 'red' : 'blue');
			context.moveTo(x1, y1);
			context.lineTo(x2, y2);
			context.stroke();

			// Fade out old needles
			if (needleBuffer.length >= maxBufferSize) {
				var toErase = needleBuffer.shift();

				context.beginPath();
				context.strokeStyle = 'white';
				context.moveTo(toErase[0], toErase[1]);
				context.lineTo(toErase[2], toErase[3]);
				context.stroke();
			}
		}

		// Update the progress (slowly if draw is disabled)
		progress.html(
			'Needles tossed: ' + tossed + ', ' +
			'crossing lines: ' + crossed + '. <br />' +
			'Current approximation: ' + (Math.round(roundingDigits * 2 * tossed / crossed) / roundingDigits)
		);

		// Call the next function
		pendingDrop = setTimeout(dropNeedle, tickTime);
	}

	// Update the simulation speed
	$('input[name="speed"]').click(function() {
		tickTime = parseInt($(this).val());
		drawEnabled = true;
		speedBoost = 1;

		if (tickTime <= -1) {
			speedBoost = Math.abs(tickTime);
			drawEnabled = false;
			tickTime = 0;
		}

		if (tickTime == 0) {
			var next = $(this).val() * 10;
			if (next == 0) next = -10;
			$('input[value="' + next + '"]').parent().show();
		}

		if (pendingDrop) clearTimeout(pendingDrop);
		pendingDrop = setTimeout(dropNeedle, tickTime);
	});

	// Reset the simulation
	$('input[name="reset"]').click(function() {
		tossed = 0;
		crossed = 0;

		context.clearRect(0, 0, canvas.width, canvas.height);
		drawLines();
		if (pendingDrop) clearTimeout(pendingDrop);
		pendingDrop = setTimeout(dropNeedle, tickTime);
	});

	// Start with the super fast speeds hidden
	$('.hide').hide();

	// Start the simulation
	drawLines();
});
</script>
<h3 id="demo">Demo</h3>
<p><canvas id="canvas" width="400" height="400" style="border: 1px solid black;"></canvas><br />
<input type="button" name="reset" value="Reset" /></p>
<h3 id="results">Results</h3>
<p id="progress"></p>
<h3 id="simulation-speed">Simulation speed</h3>
<p><input type="radio" name="speed" value="1000000" checked="checked">stopped <br />
<input type="radio" name="speed" value="1000">slow (1.0 Hz)<br />
<input type="radio" name="speed" value="500">normal (0.5 Hz)<br />
<input type="radio" name="speed" value="100">fast (0.1 Hz)<br />
<input type="radio" name="speed" value="10">very fast (0.01 Hz)<br />
<input type="radio" name="speed" value="0">as fast as possible<br />
<span class="hide"><input type="radio" name="speed" value="-10">even faster<br /></span>
<span class="hide"><input type="radio" name="speed" value="-100">light speed<br /></span>
<span class="hide"><input type="radio" name="speed" value="-1000">ludicrous speed<br /></span>
<span class="hide"><input type="radio" name="speed" value="-10000">&hellip;<br /></span></p>
<p><br /><br /></p></div>
</article></div>
        </div><footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li><li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li></ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>
</div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js" integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js" integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin="anonymous"></script>

<script src="/custom.js"></script>
</body>
</html>
