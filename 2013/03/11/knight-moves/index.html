<!doctype html><html><head><title>Knight moves – jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_5823201688106629450.min.8c7d803d89ebdecf2416d468f4ecb981a3acf645154a7a336f2e5d0190ea8163.js integrity="sha256-jH2APYnr3s8kFtRo9Oy5gaOs9kUVSnozby5dAZDqgWM=" defer></script>
<script src=/jquery.fancybox_6181813213021922412.min.921ca906a32e718ab61ac0b4da24e0eaa6bdd41912654a33b44bd3fc2f0c2a4d.js integrity="sha256-khypBqMucYq2GsC02iTg6qa91BkSZUoztEvT/C8MKk0=" defer></script>
<script src=/katex_12008035502722260518.min.1c3dce03daaf56a7d2fe0d0ec49bf35256837226f835adaf52c09502ef9bc5d1.js integrity="sha256-HD3OA9qvVqfS/g0OxJvzUlaDcib4Na2vUsCVAu+bxdE=" defer></script>
<script src=/auto-render_2152414756166376840.min.45ae2f6b03d0c7b867df0a6cb7d43215ec78369998685a5748c5b12f502321f2.js integrity="sha256-Ra4vawPQx7hn3wpst9QyFex4NpmYaFpXSMWxL1AjIfI=" defer></script>
<script src=/bigfoot_8444447145154709333.min.5e80bd85ebaeb95607834d6777bfe7013d1d161f0f02a31b845e4bd765898316.js integrity="sha256-XoC9heuuuVYHg01nd7/nAT0dFh8PAqMbhF5L12WJgxY=" defer></script>
<script src=/mermaid_12365941879912544862.min.973b5415b3fa1835d620c0e58236f859d5f80891f447e240cbbb9eb825251ff0.js integrity="sha256-lztUFbP6GDXWIMDlgjb4WdX4CJH0R+JAy7ueuCUlH/A=" defer></script>
<script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script>
<link rel=stylesheet href=/katex_14163593549783030822.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_16482899066638414220.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_16222217791602823071.min.e28b5d7d9d89efacb5f708ac30cbd76b1b9a0f816dfd9da96631d1d09cbbdd76.css integrity="sha256-4otdfZ2J76y19wisMMvXaxuaD4Ft/Z2pZjHR0Jy73XY="><link rel=stylesheet href=/css_4780214198035419921.min.246b6f8e7620eeb717bca5e7b121037906e5dfaa05805f427fcc5a09b6c99f5c.css integrity="sha256-JGtvjnYg7rcXvKXnsSEDeQbl36oFgF9Cf8xaCbbJn1w="><link rel=stylesheet href=/main.min.7a29c6e86e28b6da48d6e8a526f4fa597dfba1464ca3f975ea9e0fb8c00052b7.css integrity="sha256-einG6G4ottpI1uilJvT6WX37oUZMo/l16p4PuMAAUrc="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/home-automation/>Home Automation</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>Knight moves</h1><div class=entry-meta><span class=entry-date>2013-03-11</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/03/06/partitioning-the-dutch-national-flag/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/racket>Racket</a><a href=https://blog.jverkamp.com/2013/03/12/the-house-on-the-hill-day-1/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2013/03/06/partitioning-the-dutch-national-flag/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/scheme>Scheme</a><a href=https://blog.jverkamp.com/2013/03/12/the-house-on-the-hill-day-1/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/03/06/partitioning-the-dutch-national-flag/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/programming-praxis>Programming Praxis</a><a href=https://blog.jverkamp.com/2013/03/18/approximating-pi-with-buffons-needle/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/02/01/#1gam-chesslike-1.0-did-it/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/chess>Chess</a><a href=https://blog.jverkamp.com/2014/08/21/chess-puzzles-1-get-moving/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2013/03/06/partitioning-the-dutch-national-flag/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2013/03/12/the-house-on-the-hill-day-1/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2013/03/11/oz-the-great-and-powerful/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2013/03/12/the-house-on-the-hill-day-1/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>How many ways are there for a knight in chess from the top left to the bottom right of a chess board in exactly <em>n=6</em> moves?</p><p>Well, that&rsquo;s exactly the problem stated in the most recent <a title="Knight Moves" href=http://programmingpraxis.com/2013/03/08/knight-moves/>Programming Praxis post</a> from Friday. The goal is to generalize to any path length, but the general solution is actually somewhat easier to write.</p><p>The general idea for this problem is to think recursively. You have three variables that you need to contend with: the <em>source</em> square you are moving from (which will change at each step of the recursion), the <em>destination</em> square you are eventually moving to (which will not), and the <em>number of moves</em> you have left to reach it. If, at each step, you can calculate all of the possible next moves, you can recur on the number of remaining moves. Let the base case be when the *number of moves *reaches zero (and <em>source</em> may or may not equal <em>destination</em>). So we&rsquo;re looking at something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; find all paths from src to dst in exactly the given moves</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>knight-moves</span> src dst moves)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; if we&#39;re out of moves, check if we&#39;ve found a solution</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; either return just the destination or the empty list</span>
</span></span><span style=display:flex><span>    [(= moves <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>     (<span style=color:#66d9ef>if </span>(equal? src dst) (list dst) <span style=color:#f92672>&#39;</span>())]
</span></span><span style=display:flex><span>    <span style=color:#75715e>; otherwise, step in all 8 possible directions</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; only keep solutions that stay on the board</span>
</span></span><span style=display:flex><span>    [else
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>for/list</span> ([nxt (<span style=color:#a6e22e>in-list</span> (<span style=color:#a6e22e>knight-neighbors</span> src))]
</span></span><span style=display:flex><span>                <span style=color:#f92672>#</span>:when (<span style=color:#a6e22e>in-bounds?</span> nxt) 
</span></span><span style=display:flex><span>                [recur (<span style=color:#a6e22e>in-list</span> (<span style=color:#a6e22e>knight-moves</span> nxt dst (- moves <span style=color:#ae81ff>1</span>)))])
</span></span><span style=display:flex><span>       (cons src recur))]))
</span></span></code></pre></div><p>The advantage here is that we can use the <em>for</em> with a *#:when <em>to loop over the possible knight moves, but only include the ones that stay on the board. Also, dividing the two conditions by a <em>#:when</em> essentially makes the <em>for</em> act like a <em>for</em></em>, making the loop nested. That way we will automatically take out paths that do not end with a valid solution, since they will not take part in the inner loop.</p><p>To get this working though, we need a function that will return the neighbors (so far as a knight is concerned) for a given point:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; return the eight neighboring points for a knight</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; a for loop without for* will loop in sync across the lists</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>knight-neighbors</span> pt)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>for/list</span> ([xd (<span style=color:#a6e22e>in-list</span> <span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>-2</span> <span style=color:#ae81ff>-2</span> <span style=color:#ae81ff>-1</span> <span style=color:#ae81ff>-1</span>  <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2</span>))]
</span></span><span style=display:flex><span>             [yd (<span style=color:#a6e22e>in-list</span> <span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>-1</span>  <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>-2</span>  <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>-2</span>  <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>-1</span>  <span style=color:#ae81ff>1</span>))])
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>make-point</span> (+ (<span style=color:#a6e22e>point-x</span> pt) xd)
</span></span><span style=display:flex><span>                (+ (<span style=color:#a6e22e>point-y</span> pt) yd))))
</span></span></code></pre></div><p>This time, we&rsquo;re using the <em>for</em> loop without the nesting, so that the two iteration variables (<em>xd</em> and <em>yd</em>) are kept in sync.</p><p>And that&rsquo;s basically all that we need. Technically, I haven&rsquo;t included the code for <em>in-bounds?</em> or the structure definition, but both of those are rather straight forward. You can see the <a title="Knight moves source" href=https://github.com/jpverkamp/small-projects/blob/master/blog/knight-moves.rkt>full source on GitHub</a>.</p><p>In answer to the original question:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt; (length (<span style=color:#a6e22e>knight-moves</span> (<span style=color:#a6e22e>make-point</span> <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>                        (<span style=color:#a6e22e>make-point</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>7</span>)
</span></span><span style=display:flex><span>                        <span style=color:#ae81ff>6</span>))
</span></span><span style=display:flex><span><span style=color:#ae81ff>108</span>
</span></span></code></pre></div><p>So there are exactly 108 ways that you can get a knight from the top left to the bottom right (or top right to bottom left I guess) of a chess board in exactly six moves. It takes about 15 ms to calculate that too, so none too shabby. I&rsquo;m sure that if we were looking at a larger, more generic version of the problem (say any <em>m</em> x <em>n</em> board or generating paths that are any longer), then a dynamic solution which would cache subpaths might be helpful, but for the standard chess board size and <em>≤6</em>, it&rsquo;s not necessary. Perhaps another day.</p></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>