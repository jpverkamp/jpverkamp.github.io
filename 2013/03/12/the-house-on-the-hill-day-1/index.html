<!doctype html><html><head><title>The House on the Hill - Day 1 – jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_17422284542669262002.min.834c1e2313951f0c25b90152fe8b62250eab4a2e8cbd2560fa1a1cdc91c71733.js integrity="sha256-g0weIxOVHwwluQFS/otiJQ6rSi6MvSVg+hoc3JHHFzM=" defer></script><script src=/jquery.fancybox_16245765822111608191.min.ef050764ff69f3287c89ff655825479dd8304dcd9bc653d1ddd4772a701ad445.js integrity="sha256-7wUHZP9p8yh8if9lWCVHndgwTc2bxlPR3dR3KnAa1EU=" defer></script><script src=/katex_17296078054267651618.min.deed0e78a77391517d530a00324ce7b760ac204134992ef22d36f583615ae498.js integrity="sha256-3u0OeKdzkVF9UwoAMkznt2CsIEE0mS7yLTb1g2Fa5Jg=" defer></script><script src=/auto-render_14944144240389301023.min.e694d9d5eae2917984179683ead27b998784a81398e8836c369373d2c67fc32a.js integrity="sha256-5pTZ1erikXmEF5aD6tJ7mYeEqBOY6INsNpNz0sZ/wyo=" defer></script><script src=/bigfoot_28293813221957978.min.af671f08986f0a2267c5a0cb2748b005489e47fa25f55479b200e2a563d23022.js integrity="sha256-r2cfCJhvCiJnxaDLJ0iwBUieR/ol9VR5sgDipWPSMCI=" defer></script><script src=/mermaid_9520146763733687737.min.bfe50b47c0387e3c3bf97ec5f338bba94f7ccb02f962a4aec8cf0b4d68c8434d.js integrity="sha256-v+ULR8A4fjw7+X7F8zi7qU98ywL5YqSuyM8LTWjIQ00=" defer></script><script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script><link rel=stylesheet href=/katex_13658330645258633971.min.64e42891d651aee0b8cd02ec9227ff271d37bcf06dae985d1acf0eba1623e850.css integrity="sha256-ZOQokdZRruC4zQLskif/Jx03vPBtrphdGs8OuhYj6FA="><link rel=stylesheet href=/bigfoot-default_8781527669040159104.min.0d2b289fa3451447692959fcee5676b846532fe7ab50ddc4660824c42d4adcd7.css integrity="sha256-DSson6NFFEdpKVn87lZ2uEZTL+erUN3EZggkxC1K3Nc="><link rel=stylesheet href=/jquery.fancybox_5330465509389191777.min.67505d77381ebd82623ab9296c1989c44ec828d867c00296e80e52ef860cac37.css integrity="sha256-Z1BddzgevYJiOrkpbBmJxE7IKNhnwAKW6A5S74YMrDc="><link rel=stylesheet href=/css_1846377409604050217.min.fffe842bc000dd1fe8661ac6427a392a08faa95e8edab1ea7fb98c5f8dac6a6f.css integrity="sha256-//6EK8AA3R/oZhrGQno5Kgj6qV6O2rHqf7mMX42sam8="><link rel=stylesheet href=/main.min.34a34d86b8aae11b989d80a1626629c053029d012419a1993cfb6c12ea175737.css integrity="sha256-NKNNhriq4RuYnYChYmYpwFMCnQEkGaGZPPtsEuoXVzc="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/home-automation/>Home Automation</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>The House on the Hill - Day 1</h1><div class=entry-meta><span class=entry-date>2013-03-12</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/03/11/knight-moves/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/racket>Racket</a><a href=https://blog.jverkamp.com/2013/03/13/the-house-on-the-hill-day-2/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2013/03/11/knight-moves/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/scheme>Scheme</a><a href=https://blog.jverkamp.com/2013/03/13/the-house-on-the-hill-day-2/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/03/01/february-%231gam-post-mortem/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/one-game-a-month>One Game a Month</a><a href=https://blog.jverkamp.com/2013/03/13/the-house-on-the-hill-day-2/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/03/01/february-%231gam-post-mortem/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/games>Games</a><a href=https://blog.jverkamp.com/2013/03/13/the-house-on-the-hill-day-2/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2013/02/01/%231gam-chesslike-1.0-did-it/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/roguelikes>Roguelikes</a><a href=https://blog.jverkamp.com/2013/03/13/the-house-on-the-hill-day-2/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2013/03/11/knight-moves/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2013/03/13/the-house-on-the-hill-day-2/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2013/03/11/knight-moves/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2013/03/13/jack-the-giant-slayer/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>This week marks 2013&rsquo;s 7-day Roguelike (7DRL) challenge, a contest where entrants attempt to write an entire Roguelike in 7 days. Since I haven&rsquo;t started my #1GAM a month for March (and since my <a href=https://blog.jverkamp.com/2013/02/01/%231gam-chesslike-1.0-did-it/>successfully completed January game</a> was a Roguelike as well), it seems like the perfect opportunity to kill two birds with one stone.</p><p>My idea is to base a Roguelike on the excellent board game <a title="Betrayal at House on the Hill" href=http://boardgamegeek.com/boardgame/10547/betrayal-at-house-on-the-hill>Betrayal at House on the Hill</a>. In that game, up to six ostensibly ordinary men and women (and occasionally children) venture into the eponymous &lsquo;house on the hill&rsquo; and set out to explore it. The rooms are randomly placed each game, making the house exceedingly strange at times, but the best part comes halfway through.</p><p>At a semi-random point in each game, one of the players will trigger the Betrayal. When that happens, one or more of the players (or occasionally none at all) will become the Traitor. They will be given a new set of rules and goals, directly opposing all non-Traitor players. There&rsquo;s a wonderful us-versus-them mechanic for the second half of the game. It&rsquo;s not always (or not even often) balanced, but it&rsquo;s definitely interesting, particularly since neither side can actually be sure of the other&rsquo;s rules.</p><p>I&rsquo;m not sure how much of that us-versus-them feeling I can get out of five days (I won&rsquo;t be able to work much next weekend if at all), but I&rsquo;m going to at least get down the dynamic (and hopefully creepy) feeling of the house. The best part of the house is the dynamic layout, so that&rsquo;s one thing I&rsquo;m definitely working hard on. To that end, I wrote a dynamic plugin system for rooms that should be flexible enough for just about anything that would be possible in the original game (and more!).</p><p>To showcase what I have, here&rsquo;s an example of one of the room definitions (it&rsquo;s written in <a title="The Racket Language" href=http://racket-lang.org/>Racket</a>, a cousin of Scheme/Lisp, but don&rsquo;t be scared off by all the parenthesis &#x1f604; ):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>(<span style=color:#a6e22e>define-room</span> 
</span></span><span style=display:flex><span>  <span style=color:#f92672>#</span>:name <span style=color:#e6db74>&#34;Chasm&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>#</span>:description <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>#</span>:floors <span style=color:#f92672>&#39;</span>(basement)
</span></span><span style=display:flex><span>  <span style=color:#f92672>#</span>:doors <span style=color:#f92672>&#39;</span>(west east)
</span></span><span style=display:flex><span>  <span style=color:#f92672>#</span>:floorplan 
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;         &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;         &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;         &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;||| |||||&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;|||||| ||&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;|||||||||&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;         &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;         &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;         &#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>#</span>:tiles
</span></span><span style=display:flex><span>  (list 
</span></span><span style=display:flex><span>   (<span style=color:#a6e22e>define-tile</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>#</span>:tile <span style=color:#e6db74>#\space</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>#</span>:name <span style=color:#e6db74>&#34;empty space&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>#</span>:description <span style=color:#e6db74>&#34;a seemingly endless drop into darkness&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>#</span>:walkable <span style=color:#66d9ef>#t</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>#</span>:onWalk 
</span></span><span style=display:flex><span>     (<span style=color:#66d9ef>lambda </span>(<span style=color:#a6e22e>player</span> tile)
</span></span><span style=display:flex><span>       (<span style=color:#66d9ef>and </span>(<span style=color:#f92672>.</span>ask <span style=color:#e6db74>&#34;Are you sure you want to step into the empty space?&#34;</span>)
</span></span><span style=display:flex><span>            (<span style=color:#f92672>.</span>kill player <span style=color:#e6db74>&#34;You fall screaming into the abyss.&#34;</span>))))
</span></span><span style=display:flex><span>   (<span style=color:#a6e22e>define-tile</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>#</span>:tile <span style=color:#e6db74>#\|</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>#</span>:name <span style=color:#e6db74>&#34;rickety bridge&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>#</span>:description <span style=color:#e6db74>&#34;half rotten planks of wood; they look like they might break at any moment&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>#</span>:walkable <span style=color:#66d9ef>#t</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>#</span>:onWalk
</span></span><span style=display:flex><span>     (<span style=color:#66d9ef>lambda </span>(<span style=color:#a6e22e>player</span> tile)
</span></span><span style=display:flex><span>       (<span style=color:#f92672>.</span>set tile (+ <span style=color:#ae81ff>1</span> (<span style=color:#f92672>.</span>get tile <span style=color:#e6db74>&#39;steps</span> <span style=color:#ae81ff>0</span>)))
</span></span><span style=display:flex><span>       (<span style=color:#66d9ef>define </span>steps (<span style=color:#f92672>.</span>get tile <span style=color:#e6db74>&#39;steps</span> <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>         [(<span style=color:#66d9ef>and </span>(&gt;= steps <span style=color:#ae81ff>5</span>) (&gt; (<span style=color:#a6e22e>random</span>) <span style=color:#ae81ff>0.5</span>))
</span></span><span style=display:flex><span>          (<span style=color:#f92672>.</span>kill player <span style=color:#e6db74>&#34;The step beneath you gives way, plunging you into the endless abyss.&#34;</span>)]
</span></span><span style=display:flex><span>         [(<span style=color:#66d9ef>or </span>(= steps <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>              (<span style=color:#66d9ef>and </span>(&gt; steps <span style=color:#ae81ff>2</span>) (&gt; (<span style=color:#a6e22e>random</span>) <span style=color:#ae81ff>0.5</span>)))
</span></span><span style=display:flex><span>          (<span style=color:#f92672>.</span>say <span style=color:#e6db74>&#34;The step beneath you creaks, threatening to give way at any moment.&#34;</span>)])))))
</span></span></code></pre></div><p>The basic idea here is that all of the room definitions are source code files in their own right which can be dynamically loaded. So you can add any sort of dynamic behavior that you want. In this case, we have dynamic behavior in the <code>#:onWalk</code> events, both for the &rsquo;empty space&rsquo; of the chasm and the &lsquo;rickety bridge&rsquo; hanging over it.</p><p>In the first case, the game will warning you if you try to walk out into space. If you don&rsquo;t heed the warning&ndash;game over. In the latter, it will keep track of how many times you hit each step. After enough times, there&rsquo;s an ever increasing chance that you&rsquo;ll plunge to your doom!</p><p>I&rsquo;m not sure how much I&rsquo;m going to change / expand the API by the time I&rsquo;m done, but I think this is a pretty solid start. Any additional changes should be much easier since the basic groundwork is already done.</p><p>Goals for Day 2:</p><ul><li>Figure out how to draw the game to the screen in Racket</li><li>Generate random rooms, lining up the doorways</li></ul><p>I&rsquo;ll be cross posting this series both on <a title=jverkamp.com href=http://blog.jverkamp.com>my personal blog</a> and on the <a title="7DRL BLog" href=http://7drl.org/>7DRL blog</a>. If you&rsquo;d like to see the source code, it&rsquo;s available <a href=https://github.com/jpverkamp/house-on-the-hill title="House on the Hill source">on GitHub</a>. Theoretically, I&rsquo;ll have an initial download (or at least screenshots) in the next day or two. If everything goes perfectly (which it rarely does, but one can hope), I&rsquo;ll have a web-based version as well, using <a title="Whalesong: a Racket to JavaScript compiler" href=http://hashcollision.org/whalesong/>Whalesong</a>. I&rsquo;ve never used it before, so we&rsquo;ll see how that goes. &#x1f604;</p></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>