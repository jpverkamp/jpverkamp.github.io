<!DOCTYPE html>
<html>
<head>
        
        

        <title>The House on the Hill - Day 4 | jverkamp.com | John-Paul Verkamp</title>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" />
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css" />
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/3.0.3a/ekko-lightbox.min.css" />
        <script src="//cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/3.0.3a/ekko-lightbox.min.js"></script>

        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.transit/0.9.9/jquery.transit.min.js"></script>

        <!-- Highlight.js for syntax highlighting -->
        <link rel="stylesheet" href="/highlight/styles/tomorrow-night.css" />
        <script src="/highlight/highlight.pack.js"></script>

        <!-- MathJax for LaTeX support -->
        <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- nanoGallery for Flickr Galleries -->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/css/themes/light/nanogallery_light.css" />
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/jquery.nanogallery.min.js"></script>

        <!-- Any custom CSS or JS that I've written; this should be kept minimal -->
        <link rel="stylesheet" href="/custom.css" />
        <script src="/custom.js"></script>

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
        <header class="container">
        <nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://jpverkamp.github.io"><span style="color: green;">jv</span>erkamp.com</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav"><li class="dropdown"><a href="http://jpverkamp.github.io/category/archives" class="dropdown-toggle">Archives<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://jpverkamp.github.io/category/archives/2004">2004</a></li><li><a href="http://jpverkamp.github.io/category/archives/2005">2005</a></li><li><a href="http://jpverkamp.github.io/category/archives/2006">2006</a></li><li><a href="http://jpverkamp.github.io/category/archives/2007">2007</a></li><li><a href="http://jpverkamp.github.io/category/archives/2008">2008</a></li><li><a href="http://jpverkamp.github.io/category/archives/2009">2009</a></li><li><a href="http://jpverkamp.github.io/category/archives/2010">2010</a></li><li><a href="http://jpverkamp.github.io/category/archives/2011">2011</a></li><li><a href="http://jpverkamp.github.io/category/archives/2012">2012</a></li><li><a href="http://jpverkamp.github.io/category/archives/2013">2013</a></li><li><a href="http://jpverkamp.github.io/category/archives/2014">2014</a></li></ul></li><li class="dropdown"><a href="http://jpverkamp.github.io/category/other" class="dropdown-toggle">Other<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://jpverkamp.github.io/category/other/board-game-reviews">Board Game Reviews</a></li><li><a href="http://jpverkamp.github.io/category/other/cooking">Cooking</a></li><li><a href="http://jpverkamp.github.io/category/other/movie-reviews">Movie Reviews</a></li></ul></li><li class="dropdown"><a href="http://jpverkamp.github.io/category/photography" class="dropdown-toggle">Photography<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://jpverkamp.github.io/category/photography/dp-challenge">DP Challenge</a></li><li><a href="http://jpverkamp.github.io/category/photography/photosets">Photosets</a></li><li><a href="http://jpverkamp.github.io/category/photography/photosynth">Photosynth</a></li></ul></li><li class="dropdown"><a href="http://jpverkamp.github.io/category/programming" class="dropdown-toggle">Programming<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://jpverkamp.github.io/category/programming/by-language">By Language</a></li><li><a href="http://jpverkamp.github.io/category/programming/by-project">By Project</a></li><li><a href="http://jpverkamp.github.io/category/programming/by-source">By Source</a></li><li><a href="http://jpverkamp.github.io/category/programming/by-topic">By Topic</a></li><li><a href="http://jpverkamp.github.io/category/programming/libraries">Libraries</a></li></ul></li><li class="dropdown"><a href="http://jpverkamp.github.io/category/research" class="dropdown-toggle">Research<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://jpverkamp.github.io/category/research/by-topic">By Topic</a></li><li><a href="http://jpverkamp.github.io/category/research/publications">Publications</a></li></ul></li><li class="dropdown"><a href="http://jpverkamp.github.io/category/writing" class="dropdown-toggle">Writing<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://jpverkamp.github.io/category/writing/by-genre">By Genre</a></li><li><a href="http://jpverkamp.github.io/category/writing/nanowrimo">NaNoWriMo</a></li><li><a href="http://jpverkamp.github.io/category/writing/novels">Novels</a></li><li><a href="http://jpverkamp.github.io/category/writing/other">Other</a></li><li><a href="http://jpverkamp.github.io/category/writing/short-stories">Short Stories</a></li></ul></li></ul>

      <!--
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>
      </form>
      -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
        </header>

        <article class="container">
                <header>
                        <h1 class="entry-title">The House on the Hill - Day 4</h1>

                        <div class="entry-meta">
                                <span class="posted-on"><time class="entry-date" datetime="2013-03-15"><span class="year">2013</span> <span class="month">Mar</span> <span class="day">15</span></time></span>
                                <span class="tags"><ul class="tag-list list-inline"><li><a href="http://jpverkamp.github.io/category/programming/by-topic/games">Games</a></li><li><a href="http://jpverkamp.github.io/category/programming/by-topic/games/roguelikes">Roguelikes</a></li><li><a href="http://jpverkamp.github.io/category/programming">Programming</a></li><li><a href="http://jpverkamp.github.io/category/programming/by-project/games/the-house-on-the-hill">The House on the Hill</a></li><li><a href="http://jpverkamp.github.io/category/programming/by-source/one-game-a-month">One Game a Month</a></li><li><a href="http://jpverkamp.github.io/category/programming/by-language/scheme">Scheme</a></li><li><a href="http://jpverkamp.github.io/category/programming/by-language/racket">Racket</a></li></ul></span>
                        </div>

                        <hr />
                </header>
                <div class="entry-content">
                        <p>Today was fairly productive, although even with that I managed to fall a bit behind. So it goes.</p>
<!--more-->
<p>The first thing that I did today was to rewrite the drawing code so that it loops across the rooms rather than the tiles (<a href="http://jpverkamp.github.io/2013/03/14/the-house-on-the-hill-day-3">as I mentioned yesterday</a>). The code is not only far more efficient, it actually wasn't as complicated as I feared. It also lets me draw the walls between rooms only on rooms that have already been generated. Here's a screen shots of that in action:</p>
<p><a data-toggle="lightbox" href="http://jpverkamp.github.io/2013/03/15/the-house-on-the-hill-day-4/3-a-few-more.png"><img src="http://jpverkamp.github.io/2013/03/15/the-house-on-the-hill-day-4/3-a-few-more.png" /></a></p>
<p>This also shows a few of the new rooms that I've defined. The two in the top are ballrooms (that's supposed to be a piano in the top right...) and the one on the right is a garden with a stone table. In addition to those, we now have definitions for a coal chute, a dining room, and a graveyard.</p>
<p>Another thing that I did was actually hook up the code for the player. Now that code I showed back on <a href="http://jpverkamp.github.io/2013/03/12/the-house-on-the-hill-day-1">Day 1</a> with the <em>on-walk</em> events actually works. Granted, I've changed the syntax from Racket's <code><a href="http://docs.racket-lang.org/search/index.html?q=keyword arguments">keyword arguments</a></code> to their <code><a href="http://docs.racket-lang.org/search/index.html?q=object oriented model">object oriented model</a></code>, but it's the same idea. To see what it would look like now, here's the chasm definition:</p>
<pre class="scheme"><code>(define-room
  [name "chasm"]
  [floors '(basement)]
  [doors '(west east)]
  [floorplan
   '("         "
     "         "
     "         "
     "||| |||||"
     "|||||| ||"
     "|||||||||"
     "         "
     "         "
     "         ")]
  [tiles
   (list
    (define-tile
      [tile " "]
      [name "empty space"]
      [description "a seemingly endless drop into darkness"]
      [on-walk
       (lambda (player tile)
         (when (send player ask "Are you sure you want to step into the empty space?")
           (send player die "You fall screaming into the abyss.")))])
   ...)])</code></pre>
<p>I think the syntax is a lot cleaner and more Racket-like. I am wrapping the call to <code>(new room% ...)</code> with a macro that rewrites it to <code>define-room</code>, but that's it.</p>
<p>So at this point, we actually have a mostly playable game. You can wonder around the house for quite a while and there are several ways to lose the game (you'll either have to play it or read the source code to find out how :) ). Granted, there are no events and no ways to win, but I'm getting there! I may actually have some time this weekend to work, so all is not lost.</p>
<p>Here are a few more screenshots:</p>
<p><a data-toggle="lightbox" href="http://jpverkamp.github.io/2013/03/15/the-house-on-the-hill-day-4/4-error-tiles.png"><img src="http://jpverkamp.github.io/2013/03/15/the-house-on-the-hill-day-4/4-error-tiles.png" /></a></p>
<p>Here's what happens if you forget to define a tile in a room definition. Rather than freezing up the game (as it was doing a little while ago), now it will display a pink § character. If you so happen to be using that as one of the characters in the game... oops? I do need to figure out how to fix the tiles that are extending beyond the bottom of a given square. It's common enough that it's becoming annoying. Most likely, all that it will need is a different font.</p>
<p>And yes, this is the same as the original board game. You can build a nice circular house that completely encloses the entrance. It's non-trivial but entirely doable.</p>
<p><a data-toggle="lightbox" href="http://jpverkamp.github.io/2013/03/15/the-house-on-the-hill-day-4/6-oops.png"><img src="http://jpverkamp.github.io/2013/03/15/the-house-on-the-hill-day-4/6-oops.png" /></a></p>
<p>And here's what happens if you manage to lose. There are a few ways to do this now (for example jumping into empty space in the chasm definition above), but I'm sure there will be many more before all is said and done.</p>
<p>Well, that's it. (Up to) three more days. It should be an interesting weekend.</p>
<p><strong>Side note: </strong>Apparently someone posted this project to the <a title="Reddit: Racket" href="http://www.reddit.com/r/Racket">Racket sub-Reddit</a>.</p>
<p>I was wondering where that random spike in traffic was coming from. :)</p>
<p>Quick disclaimer: The current series of posts is more about progress on the game and far less about how you might write a Roguelike in Racket. There is <a title="GitHub: House on the Hill source" href="https://github.com/jpverkamp/house-on-the-hill" rel="nofollow">source code</a> available on GitHub, but at the moment that's about it.</p>
<p>After 7DRL is over, I plan on going back and factoring out any code that might be useful for others to write Roguelikes into a PLaneT package in addition to writing a series of posts detailing how the guts of the project actually work (and all that I've learned about how to write OO code in Racket--and how not to).</p>
<p>So if you're interested in that part of it, stick around. I should get to it sometime next week.</p>
<p>&nbsp;</p>
                </div>
                <div class="entry-footnotes">
                        <div id="footnotes"><ol></ol></div>
                </div>

                <div id="disqus_thread"></div>
<script type="text/javascript">
var disqus_shortname = "jverkamp";
var disqus_title = "The House on the Hill - Day 4";
var disqus_url = "http://blog.jverkamp.com/2013/03/15/the-house-on-the-hill-day-4/";
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </article>

        <footer class="container" role="contentinfo">
                <nav class="navbar navbar-default" role="navigation"><ul class="nav navbar-nav nav-justified"><li><a href="http://jpverkamp.github.io/2013/03/14/the-house-on-the-hill-day-3">← The House on the Hill - Day 3</a></li><li><a href="http://jpverkamp.github.io/category/archives">Archives</a></li><li><a href="http://jpverkamp.github.io/2013/03/16/the-house-on-the-hill-day-5">The House on the Hill - Day 5 →</a></li></ul><ul class="nav navbar-nav nav-justified"><li><a href="http://jpverkamp.github.io/2013/03/14/the-house-on-the-hill-day-3">← The House on the Hill - Day 3</a></li><li><a href="http://jpverkamp.github.io/category/programming">Programming</a></li><li><a href="http://jpverkamp.github.io/2013/03/16/the-house-on-the-hill-day-5">The House on the Hill - Day 5 →</a></li></ul></nav>

                <div class="legal">
                        All posts unless otherwise mentioned are licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png" /></a><br />
                        Any source code unless otherwise mentioned is licensed under the <a href="http://directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
                </div>
        </footer>
</body>
</html>