<!DOCTYPE html>
<html>
<head>
        
        

        <title>Rock-paper-scissors | jverkamp.com | John-Paul Verkamp</title>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" />
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css" />
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/3.0.3a/ekko-lightbox.min.css" />
        <script src="//cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/3.0.3a/ekko-lightbox.min.js"></script>

        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.transit/0.9.9/jquery.transit.min.js"></script>

        <!-- Highlight.js for syntax highlighting -->
        <link rel="stylesheet" href="/highlight/styles/tomorrow-night.css" />
        <script src="/highlight/highlight.pack.js"></script>

        <!-- MathJax for LaTeX support -->
        <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- nanoGallery for Flickr Galleries -->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/css/themes/light/nanogallery_light.css" />
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/jquery.nanogallery.min.js"></script>

        <!-- Any custom CSS or JS that I've written; this should be kept minimal -->
        <link rel="stylesheet" href="/custom.css" />
        <script src="/custom.js"></script>

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="http://blog.jverkamp.com/feed/" />
</head>
<body>
        <header class="container">
        <nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://blog.jverkamp.com"><span style="color: green;">jv</span>erkamp.com</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav"><li class="dropdown"><a href="http://blog.jverkamp.com/category/archives" class="dropdown-toggle">Archives<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://blog.jverkamp.com/category/archives/2004">2004</a></li><li><a href="http://blog.jverkamp.com/category/archives/2005">2005</a></li><li><a href="http://blog.jverkamp.com/category/archives/2006">2006</a></li><li><a href="http://blog.jverkamp.com/category/archives/2007">2007</a></li><li><a href="http://blog.jverkamp.com/category/archives/2008">2008</a></li><li><a href="http://blog.jverkamp.com/category/archives/2009">2009</a></li><li><a href="http://blog.jverkamp.com/category/archives/2010">2010</a></li><li><a href="http://blog.jverkamp.com/category/archives/2011">2011</a></li><li><a href="http://blog.jverkamp.com/category/archives/2012">2012</a></li><li><a href="http://blog.jverkamp.com/category/archives/2013">2013</a></li><li><a href="http://blog.jverkamp.com/category/archives/2014">2014</a></li></ul></li><li class="dropdown"><a href="http://blog.jverkamp.com/category/other" class="dropdown-toggle">Other<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://blog.jverkamp.com/category/other/board-game-reviews">Board Game Reviews</a></li><li><a href="http://blog.jverkamp.com/category/other/cooking">Cooking</a></li><li><a href="http://blog.jverkamp.com/category/other/movie-reviews">Movie Reviews</a></li></ul></li><li class="dropdown"><a href="http://blog.jverkamp.com/category/photography" class="dropdown-toggle">Photography<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://blog.jverkamp.com/category/photography/dp-challenge">DP Challenge</a></li><li><a href="http://blog.jverkamp.com/category/photography/photosets">Photosets</a></li><li><a href="http://blog.jverkamp.com/category/photography/photosynth">Photosynth</a></li></ul></li><li class="dropdown"><a href="http://blog.jverkamp.com/category/programming" class="dropdown-toggle">Programming<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://blog.jverkamp.com/category/programming/by-language">By Language</a></li><li><a href="http://blog.jverkamp.com/category/programming/by-project">By Project</a></li><li><a href="http://blog.jverkamp.com/category/programming/by-source">By Source</a></li><li><a href="http://blog.jverkamp.com/category/programming/by-topic">By Topic</a></li><li><a href="http://blog.jverkamp.com/category/programming/libraries">Libraries</a></li></ul></li><li class="dropdown"><a href="http://blog.jverkamp.com/category/research" class="dropdown-toggle">Research<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://blog.jverkamp.com/category/research/by-topic">By Topic</a></li><li><a href="http://blog.jverkamp.com/category/research/publications">Publications</a></li></ul></li><li class="dropdown"><a href="http://blog.jverkamp.com/category/writing" class="dropdown-toggle">Writing<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="http://blog.jverkamp.com/category/writing/by-genre">By Genre</a></li><li><a href="http://blog.jverkamp.com/category/writing/nanowrimo">NaNoWriMo</a></li><li><a href="http://blog.jverkamp.com/category/writing/novels">Novels</a></li><li><a href="http://blog.jverkamp.com/category/writing/other">Other</a></li><li><a href="http://blog.jverkamp.com/category/writing/short-stories">Short Stories</a></li></ul></li></ul>

      <form action="http://www.google.com/search" method="get" onSubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input name="q" type="hidden" />
          <input name="qfront" type="text" class="form-control" placeholder="Search" />
          <button type="submit" class="btn btn-default" value="Search">Search</button>
        </p>
      </form>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
        </header>

        <article class="container">
                <header>
                        <h1 class="entry-title">Rock-paper-scissors</h1>

                        <div class="entry-meta">
                                <span class="posted-on"><time class="entry-date" datetime="2013-12-21"><span class="year">2013</span> <span class="month">Dec</span> <span class="day">21</span></time></span>
                                <span class="tags"><ul class="tag-list list-inline"><li><a href="http://blog.jverkamp.com/category/programming">Programming</a></li><li><a href="http://blog.jverkamp.com/category/programming/by-topic/artificial-intelligence">Artificial intelligence</a></li><li><a href="http://blog.jverkamp.com/category/programming/by-language/scheme">Scheme</a></li><li><a href="http://blog.jverkamp.com/category/programming/by-language/racket">Racket</a></li></ul></span>
                        </div>

                        <hr />
                </header>
                <div class="entry-content">
                        <p>Quick and to the point: let's write a program to play rock-paper-scissors<span class="footnote"><sup><a href="#footnote-1">[1]</a></sup></span><span class="footnote"><sup><a href="#footnote-2">[2]</a></sup></span>.<!--more--></b></p>
<p>How do we do it? Well, first we need to decide on a scheme for user input. Since Racket is pretty much awesome and <code>read</code> will deal rather nicely with symbolic input, let's go ahead and use <code>rock</code> for rock, <code>paper</code> for paper, etc<span class="footnote"><sup><a href="#footnote-3">[3]</a></sup></span>. Then we can impose an ordering on the three possible values:</p>
<pre class="scheme"><code>; Ordering function for rock/paper/scissors
(define (rps&gt;? p1 p2)
  (or (and (eq? p1 'rock)     (eq? p2 'scissors))
      (and (eq? p1 'scissors) (eq? p2 'paper))
      (and (eq? p1 'paper)    (eq? p2 'rock))))</code></pre>
<p>Now we want a <a href="https://en.wikipedia.org/wiki/REPL">REPL</a>--a read, eval, print loop. Basically, we want to <code>read</code> in input from the user, <code>eval</code>uate it as either a play or a special <code>quit</code> command, print out the results, and then loop back (unless we're told to <code>quit</code>.) Sounds straight forward enough:</p>
<pre class="scheme"><code>; Play a game of rock/paper/scissors against a given opponent
(define (play-rps brain)
  (printf "Enter rock, paper, or scissors (quit to exit).\n")

  ; Read player input, evaulate it, print response, loop (unless quit)
  (let repl ([wins 0] [rounds 0])
    (printf "&gt; ")
    (define player (read))
    (case player
      ; Playing a round, run the computer brain
      [(rock paper scissors)
       (define computer (brain))
       (printf " computer chooses ~a" computer)
       (cond
         ; Player beats computer
         [(rps&gt;? player computer)
          (printf ", you win!\n")
          (brain 'lose)
          (repl (+ wins 1) (+ rounds 1))]
         ; Computer beats player
         [(rps&gt;? computer player)
          (printf ", computer wins :(\n")
          (brain 'win)
          (repl wins (+ rounds 1))]
         ; Player and computer tie
         [else
          (printf ", it's a tie\n")
          (brain 'tie)
          (repl (+ wins 1/2) (+ rounds 1))])]
      ; Done player, print stats and exit
      [(quit)
       (printf "You won ~a%. Good job.\n" (round (* 100 (/ wins rounds))))]
      ; Who knows. Maybe if we repeat ourselves it will be helpful
      [else
       (printf "Unknown input.\nEnter rock, paper, or scissors (quit to exit).\n")
       (repl wins rounds)])))</code></pre>
<p>One particular oddity that might stand out in this code is the usage of the <code>brain</code> function which is passed in as our opponent. There are two different ways that it could be called. Either it's called with no arguments in order to chose a next play or it's given a single argument (either <code>win</code>, <code>lose</code>, or <code>tie</code>) to potentially update the brain's internal state. That's really all you need to do some really interesting things as we get to later.</p>
<p>To start with though, let's make a really simple, completely random brain:</p>
<pre class="scheme"><code>(define (random-symbol)
  (list-ref '(rock paper scissors) (random 3)))

; Just choose at random
(define random-brain
  (case-lambda
    [()
     (random-symbol)]
    [(result)
     (void)]))</code></pre>
<p>Here, we'll use <code>case-lambda</code> to control which way we're calling the function and a helper function to choose a random symbol (we'll need that again later). In this case, the update functionality never actually does anything. Let's see it in practice:</p>
<pre class="scheme"><code>&gt; (play-rps random-brain)
Enter rock, paper, or scissors (quit to exit).
&gt; rock
 computer chooses paper, computer wins :(
&gt; rock
 computer chooses rock, it's a tie
&gt; paper
 computer chooses scissors, computer wins :(
&gt; scissors
 computer chooses rock, computer wins :(
&gt; rock
 computer chooses paper, computer wins :(
&gt; rock
 computer chooses paper, computer wins :(
&gt; quit
You won 8%. Good job.</code></pre>
<p>Sarcastic, isn't it? Anyways, let's try to right a few more brains. For example, what if we make a really stubborn brain that always chooses the same symbol, no matter what:</p>
<pre class="scheme"><code>; Always choose the same thing
(define (make-stubborn-brain favorite)
  (case-lambda
    [()
     favorite]
    [(result)
     (void)]))
</code></pre>
<p>Here we're using a higher order function. If we wanted to play with a stubborn brain, we'd do it something like this:</p>
<pre class="scheme"><code>&gt; (play-rps (make-stubborn-brain 'rock))</code></pre>
<p>Or perhaps one that tends to play in streaks and only rarely (and randomly) changes what they're going to play:</p>
<pre class="scheme"><code>(define (random-symbol-except not-me)
  (let loop ([maybe-me (random-symbol)])
    (if (eq? maybe-me not-me)
        (loop (random-symbol))
        maybe-me)))

; Tend to be 'streaky', potentially change reponse a given % of the time
(define (make-streaky-brain swap-chance)
  (define current-choice (random-symbol))
  (case-lambda
    [()
     (when (&lt; (random) swap-chance)
       (when (currently-chatty)
         (printf "It's okay, I didn't like ~a anyways...\n" current-choice))
       (set! current-choice (random-symbol-except current-choice)))
     current-choice]
    [(result)
     (void)]))</code></pre>
<p>Interesting, you can also make the exact opposite (a brain that always changes) by upping that to 100%:</p>
<pre class="scheme"><code>&gt; (play-rps (make-streaky-brain 1.0))</code></pre>
<p>Now we have a second function that choose a random <em>different</em> symbol. Only sometimes do we change the state of the brain. Also mostly because it's amusing, we can now have chatty brains. To do that though, you'll have to turn on the <code>currently-chatty</code> parameter:</p>
<pre class="scheme"><code>&gt; (parameterize ([currently-chatty #t])
    (play-rps (make-streaky-brain 0.25)))
Enter rock, paper, or scissors (quit to exit).
&gt; rock
 computer chooses paper, computer wins :(
&gt; scissors
 computer chooses paper, you win!
&gt; scissors
It's okay, I didn't like paper anyways...
 computer chooses scissors, it's a tie
&gt; quit
You won 50%. Good job.</code></pre>
<p>Building on that idea, we could actually make use of the feedback and make a scaredy brain. For this one, it will play the same thing over and over until it loses and then switches.</p>
<pre class="scheme"><code>; Choose the same thing until you lose, then switch
(define scaredy-brain
  (let ([current-choice (random-symbol)])
    (case-lambda
      [()
       current-choice]
      [(result)
       (case result
         [(lose)
          (when (currently-chatty)
            (printf "Maybe ~a isn't so great after all...\n" current-choice)
            (set! current-choice (random-symbol-except current-choice)))])])))</code></pre>
<p>It does have a pretty big weakness though, can you figure out what it is?</p>
<p>Finally, let's do something a little more complicated and make a copycat. Basically, whatever you play, it will play next round:</p>
<pre class="scheme"><code>; Copy the last thing the player chose
(define copycat-brain
  (let ([next-choice (random-symbol)])
    (case-lambda
      [()
       next-choice]
      [(result)
       (set! next-choice
             (case (list next-choice result)
               [((rock win) (scissors tie) (paper lose)) 'scissors]
               [((rock tie) (scissors lose) (paper win)) 'rock]
               [((rock lose) (scissors win) (paper tie)) 'paper]))])))</code></pre>
<p>That same technique could easily be used to always choose the symbol that would beat your last play (based on the idea that you'll be streaky). Why don't you try it out yourself?</p>
<p>Now we have a bunch of different brains, what if we wanted to play them against each other? Well, you can just write another function, a lot like <code>play-rps</code> above. Only this time, we'll pass in two brains and a number of rounds to play:</p>
<pre class="scheme"><code>; Play two computers versus each other for n rounds
(define (play-cpu/cpu brain1 brain2 rounds)
  (define wins
    (for/sum ([i (in-range rounds)])
      (define play1 (brain1))
      (define play2 (brain2))
      (cond
        [(rps&gt;? play1 play2)
         (brain1 'win) (brain2 'lose)
         1]
        [(rps&gt;? play2 play1)
         (brain1 'lose) (brain2 'win)
         0]
        [else
         (brain1 'tie) (brain2 'tie)
         1/2])))
  (printf "Player 1 won ~a% of ~a rounds.\n" (round (* 100 (/ wins rounds))) rounds)
  wins)</code></pre>
<p>Let's write up a quick script to try all of the different brains off against each other:</p>
<table class="table table-striped">
<tr><td></td><td>random</td><td>stubborn:rock</td><td>stubborn:paper</td><td>streaky:0.1</td><td>streaky:1.0</td><td>scaredy</td><td>copycat</td></tr>
<tr><td>random</td><td>50%</td><td>50%</td><td>50%</td><td>50%</td><td>50%</td><td>50%</td><td>50%</td></tr>
<tr><td>stubborn:rock</td><td>50%</td><td>50%</td><td>0%</td><td>49%</td><td>50%</td><td>100%</td><td>50%</td></tr>
<tr><td>stubborn:paper</td><td>50%</td><td>100%</td><td>50%</td><td>53%</td><td>50%</td><td>0%</td><td>50%</td></tr>
<tr><td>streaky:0.1</td><td>50%</td><td>51%</td><td>48%</td><td>50%</td><td>50%</td><td>49%</td><td>50%</td></tr>
<tr><td>streaky:1.0</td><td>50%</td><td>50%</td><td>50%</td><td>50%</td><td>51%</td><td>50%</td><td>50%</td></tr>
<tr><td>scaredy</td><td>50%</td><td>0%</td><td>100%</td><td>50%</td><td>50%</td><td>50%</td><td>50%</td></tr>
<tr><td>copycat</td><td>50%</td><td>50%</td><td>50%</td><td>50%</td><td>50%</td><td>50%</td><td>50%</td></tr>
</table>
<p>Yay for pretty much completely arbitrary comparisons!<span class="footnote"><sup><a href="#footnote-4">[4]</a></sup></span></p>
<p>And that's all there is to it. Like always, I've got my code up on GitHub: <a href="https://github.com/jpverkamp/small-projects/blob/master/blog/rps.rkt">jpverkamp:rps.rkt</a></p>
<p>Enjoy!</p>
                </div>
                <div class="entry-footnotes">
                        <div id="footnotes"><ol><li><a name="footnote-1"></a>Or <b><a href="https://en.wikipedia.org/wiki/roshambo">roshambo</a> for those of you otherwise inclined</li><li><a name="footnote-2"></a>Inspired by <a href="http://programmingpraxis.com/2013/12/10/rock-paper-scissors/">a post on Programming Praxis</a></li><li><a name="footnote-3"></a>You get the idea</li><li><a name="footnote-4"></a>Can you figure out why almost all of them are 50%?</li></ol></div>
                </div>

                <div id="disqus_thread"></div>
<script type="text/javascript">
var disqus_shortname = "jverkamp";
var disqus_title = "Rock-paper-scissors";
var disqus_url = "http://blog.jverkamp.com/2013/12/21/rock-paper-scissors/";
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </article>

        <footer class="container" role="contentinfo">
                <nav class="navbar navbar-default" role="navigation"><ul class="nav navbar-nav nav-justified"><li><a href="http://blog.jverkamp.com/2013/12/18/chapter-13-descent">← Chapter 13 -- Descent</a></li><li><a href="http://blog.jverkamp.com/category/archives">Archives</a></li><li><a href="http://blog.jverkamp.com/2013/12/21/chapter-14-maxwells-demon">Chapter 14 - Maxwell's Demon →</a></li></ul><ul class="nav navbar-nav nav-justified"><li><a href="http://blog.jverkamp.com/2013/11/30/twitter-puddle">← Twitter puddle</a></li><li><a href="http://blog.jverkamp.com/category/programming">Programming</a></li><li><a href="http://blog.jverkamp.com/2013/12/23/edges-to-adjacency">Edges to adjacency →</a></li></ul></nav>

                <div class="legal">
                        <a href="http://blog.jverkamp.com/feed/atom.xml">feed <img style="border: 0;" src="http://blog.jverkamp.com/rss.png" /></a><br />
                        All posts unless otherwise mentioned are licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png" /></a><br />
                        Any source code unless otherwise mentioned is licensed under the <a href="http://directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
                </div>
        </footer>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-53688146-1', 'auto');
ga('send', 'pageview');
</script>
</body>
</html>