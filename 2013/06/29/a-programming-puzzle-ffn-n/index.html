<!doctype html><html><head><title>A programming puzzle: f(f(n)) = -n â€“ jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_5823201688106629450.min.8c7d803d89ebdecf2416d468f4ecb981a3acf645154a7a336f2e5d0190ea8163.js integrity="sha256-jH2APYnr3s8kFtRo9Oy5gaOs9kUVSnozby5dAZDqgWM=" defer></script>
<script src=/jquery.fancybox_6181813213021922412.min.921ca906a32e718ab61ac0b4da24e0eaa6bdd41912654a33b44bd3fc2f0c2a4d.js integrity="sha256-khypBqMucYq2GsC02iTg6qa91BkSZUoztEvT/C8MKk0=" defer></script>
<script src=/katex_12008035502722260518.min.1c3dce03daaf56a7d2fe0d0ec49bf35256837226f835adaf52c09502ef9bc5d1.js integrity="sha256-HD3OA9qvVqfS/g0OxJvzUlaDcib4Na2vUsCVAu+bxdE=" defer></script>
<script src=/bigfoot_8444447145154709333.min.5e80bd85ebaeb95607834d6777bfe7013d1d161f0f02a31b845e4bd765898316.js integrity="sha256-XoC9heuuuVYHg01nd7/nAT0dFh8PAqMbhF5L12WJgxY=" defer></script>
<script src=/mermaid_12365941879912544862.min.973b5415b3fa1835d620c0e58236f859d5f80891f447e240cbbb9eb825251ff0.js integrity="sha256-lztUFbP6GDXWIMDlgjb4WdX4CJH0R+JAy7ueuCUlH/A=" defer></script>
<script src=/main.min.982c2d7bb434b4cf8b19c2cf38ef7e7f7162ddbed610e5bdddbb937001e26574.js integrity="sha256-mCwte7Q0tM+LGcLPOO9+f3Fi3b7WEOW93buTcAHiZXQ=" defer></script>
<link rel=stylesheet href=/katex_14163593549783030822.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_16482899066638414220.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_16222217791602823071.min.e28b5d7d9d89efacb5f708ac30cbd76b1b9a0f816dfd9da96631d1d09cbbdd76.css integrity="sha256-4otdfZ2J76y19wisMMvXaxuaD4Ft/Z2pZjHR0Jy73XY="><link rel=stylesheet href=/css_4780214198035419921.min.246b6f8e7620eeb717bca5e7b121037906e5dfaa05805f427fcc5a09b6c99f5c.css integrity="sha256-JGtvjnYg7rcXvKXnsSEDeQbl36oFgF9Cf8xaCbbJn1w="><link rel=stylesheet href=/main.min.e0e68b86dea32185ab89b0b9cc01649107cc6b0be3290c8c7b13c716bc0dabfa.css integrity="sha256-4OaLht6jIYWribC5zAFkkQfMawvjKQyMexPHFrwNq/o="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>A programming puzzle: f(f(n)) = -n</h1><div class=entry-meta><span class=entry-date>2013-06-29</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/06/28/racket-roguelike-9-daedalus-wrath/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/racket>Racket</a><a href=https://blog.jverkamp.com/2013/07/05/racket-roguelike-10-levels-via-automata/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2013/06/26/swap-list-nodes/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/scheme>Scheme</a><a href=https://blog.jverkamp.com/2013/07/30/authorship-attribution-part-1/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/04/16/adventures-in-optimization-re-typed-racket/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/mathematics>Mathematics</a><a href=https://blog.jverkamp.com/2013/07/30/authorship-attribution-part-1/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2013/06/28/racket-roguelike-9-daedalus-wrath/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2013/07/05/racket-roguelike-10-levels-via-automata/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2013/06/28/racket-roguelike-9-daedalus-wrath/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2013/07/03/us/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>Two Programming Praxis puzzles in a week? Madness! Let&rsquo;s do it!</p><p><a href=http://programmingpraxis.com/2013/06/28/a-programming-puzzle/>This time</a>, the puzzle at first seems rather minimal:</p><blockquote><p>Write a function f so that f(f(n)) = -n for all integers n.</p></blockquote><p>If you haven&rsquo;t seen this problem before, take a moment to think though it. It&rsquo;s a neat little problem&ndash;a close cousin to a lateral thinking puzzle.</p><p>Okay, time&rsquo;s up. After a bit of thinking, I ended up with basically four ways of solving the puzzle.</p><p>The first idea is to realize that the function didn&rsquo;t necessarily specify that <code>f</code> only be defined for integers, just that all integers must be negated after two applications. So what sort of mathematical object gives a negative after two applications? Imaginary numbers!</p><p>Essentially, we use the fact that <span class=latex-inline>i^2 = -1</span>
where <span class=latex-inline>i = sqrt(-1)</span>
. So if we multiply by <span class=latex-inline>i</span>
once, we get <span class=latex-inline>ni</span>
; twice gives us <span class=latex-inline>ni^2 = -n</span>
. Perfect:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; Rotate in the complex numbers</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>f1</span> n)
</span></span><span style=display:flex><span>  (* n <span style=color:#ae81ff>0</span>+1i))
</span></span></code></pre></div><p>That seems a little unfair though, using complex numbers. Can we do it with only integers?</p><p>Of course we can!</p><p>To do this, we need to realize that positive/negative is only one axis that splits up the integers. In addition, we could use something like even/odd. This way, we can convert from one to the other (and then back), only applying the negation once.</p><p>Specifically, we&rsquo;ll move all even numbers closer from zero. Any odd numbers, we&rsquo;ll negate then move away from zero. That means we&rsquo;ll only negate once:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; Only negate odd numbers, offset by +- 1</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>f2</span> n)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>e? (even? n))
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>p? (positive? n))
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>n? (negative? n))
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>    [(<span style=color:#66d9ef>and </span>e? n?) (+ n <span style=color:#ae81ff>1</span>)]
</span></span><span style=display:flex><span>    [(<span style=color:#66d9ef>and </span>e? p?) (- n <span style=color:#ae81ff>1</span>)]
</span></span><span style=display:flex><span>    [n?          (+ (- n) <span style=color:#ae81ff>1</span>)]
</span></span><span style=display:flex><span>    [p?          (- (- n) <span style=color:#ae81ff>1</span>)]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>else </span>       <span style=color:#ae81ff>0</span>]))
</span></span></code></pre></div><p>Alternatively, we could get really tricksy and mess with the range/domain of <code>f</code> even more (just like the complex numbers). For example, we could cast to a string and back, only negating on the way back:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; Wrap as a string, negate on conversion back</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>(<span style=color:#a6e22e>f3</span> n)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>    [(string? n) (- (string-&gt;number n))]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>else </span>       (number-&gt;string n)]))
</span></span></code></pre></div><p>Finally, we can take advantage of the fact that the function will be applied in pairs. So we can add a bit of state to the function. In this example, we create a toggle which is switched on each application of the function. Then, if and only if the toggle is false will we negate the value:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; Use a state variable</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>f4
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>let </span>([toggle (<span style=color:#a6e22e>make-parameter</span> <span style=color:#66d9ef>#t</span>)])
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>lambda </span>(<span style=color:#a6e22e>n</span>)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>toggle</span> (not (<span style=color:#a6e22e>toggle</span>)))
</span></span><span style=display:flex><span>      (<span style=color:#66d9ef>if </span>(<span style=color:#a6e22e>toggle</span>) n (- n)))))
</span></span></code></pre></div><p>So, do all of these methods work? Well, you could just take my word for it, or you could run some testing. All we care about is double application of integers (single applications and non-integers can return anything), so we&rsquo;ll try to cover the general cases:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>(<span style=color:#a6e22e>module+</span> test
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>require</span> rackunit)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>for</span> ([f (<span style=color:#a6e22e>in-list</span> (list f1 f2 f3 f4))])
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Positive integers</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>for</span> ([i (<span style=color:#a6e22e>in-range</span> <span style=color:#ae81ff>10</span>)])
</span></span><span style=display:flex><span>      (<span style=color:#66d9ef>define </span>n (<span style=color:#a6e22e>random</span> <span style=color:#ae81ff>100</span>))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>check-equal?</span> (<span style=color:#a6e22e>f</span> (<span style=color:#a6e22e>f</span> n)) (- n) (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;~s(~s(~s))&#34;</span> f f n)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Negative integers</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>for</span> ([i (<span style=color:#a6e22e>in-range</span> <span style=color:#ae81ff>10</span>)])
</span></span><span style=display:flex><span>      (<span style=color:#66d9ef>define </span>n (- (<span style=color:#a6e22e>random</span> <span style=color:#ae81ff>100</span>)))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>check-equal?</span> (<span style=color:#a6e22e>f</span> (<span style=color:#a6e22e>f</span> n)) (- n) (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;~s(~s(~s))&#34;</span> f f n)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Zero and +- 1</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>for</span> ([n (<span style=color:#a6e22e>in-list</span> <span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>-1</span> <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>1</span>))])
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>check-equal?</span> (<span style=color:#a6e22e>f</span> (<span style=color:#a6e22e>f</span> n)) (- n) (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;~s(~s(0))&#34;</span> f f)))))
</span></span></code></pre></div><p>Running this, all is good. Theoretically, we could have missed an edge case, but the functions are simple enough that this seems unlikely.</p><p>If you&rsquo;d like to check out the full code, you can do so here:</p><ul><li><a href=https://github.com/jpverkamp/small-projects/blob/master/blog/double-negative.rkt>double negative source on GitHub</a></li></ul></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>