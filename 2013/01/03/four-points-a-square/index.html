<!DOCTYPE html>
<html>
<head>
    <title>
    Four points, a square? â€“ jverkamp.com
</title>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css" integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" />

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />


    
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper">
        <header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://twitter.com/jpverkamp">Twitter</a> *
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>

    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
        
            
            <li><a href="https://blog.jverkamp.com/photography/">Photography</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/programming/">Programming</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/writing/">Writing</a></li>
            
        
            
        
            
            <li><a href="https://blog.jverkamp.com/research/">Research</a></li>
            
        
            <li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>


        <div id="page-content-wrapper">
            <div id="page-content">
            
<article>
	<header>
		<h1 class="entry-title">Four points, a square?</h1>

        <div class="entry-meta">
            
            <span class="entry-date">2013-01-03</span>
            
            
        </div>

        <div class="entry-tags">
    
    

    <ul class="taxonomy-keys">
    
        
        

        
        

        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2013/01/02/happy-new-year/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/languages/racket">Racket</a>
                        <a href="https://blog.jverkamp.com/2013/01/16/translate-csv-to-html/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2013/01/02/happy-new-year/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/languages/scheme">Scheme</a>
                        <a href="https://blog.jverkamp.com/2013/01/06/wombat-ide-its-alive-bug-fixes/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/sources/">Sources</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2013/01/02/happy-new-year/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/sources/programming-praxis">Programming Praxis</a>
                        <a href="https://blog.jverkamp.com/2013/01/16/translate-csv-to-html/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/topics/">Topics</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    

                    
                    

                    <li>
                        
                        <a class="taxonomy-value" href="/programming/topics/geometry">Geometry</a>
                        <a href="https://blog.jverkamp.com/2013/01/20/triangle-trilemma/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2013/01/02/happy-new-year/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/topics/mathematics">Mathematics</a>
                        <a href="https://blog.jverkamp.com/2013/01/20/triangle-trilemma/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    

    
        
        <li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li>
                
                <a href="https://blog.jverkamp.com/2013/01/02/happy-new-year/" class="previous-link">Prev</a>
                

                
                <a href="https://blog.jverkamp.com/2013/01/06/wombat-ide-its-alive-bug-fixes/" class="next-link">Next</a>
                
            </ul>
        </li>
        

        
        <li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li>
                
                <a href="https://blog.jverkamp.com/2013/01/03/confession-day-62/" class="previous-link">Prev</a>
                

                
                <a href="https://blog.jverkamp.com/2013/01/04/confession-day-63/" class="next-link">Next</a>
                
            </ul>
        </li>
        
    
    </ul>
</div>

    </header>

	<div class="entry-content">
		<p><a title="Four Points Determine a Square" href="http://programmingpraxis.com/2013/01/02/four-points-determine-a-square/">Another post</a> from Programming Praxis. This one was originally intended for Friday but they posted it early, so I figured I would go ahead and do the same. The problem is actually deceptively straight forward:</p>

<p>Given four points, do they form a square?</p>

<p>My first thought was to directly calculate the angles between each trio of points. You should be able to determine which trios are ordered by finding the 90 degree angles and you could then check the distances. Before I got too far into my old geometry textbooks to figure out how to calculate those angles though, I realized that you&rsquo;d don&rsquo;t actually need the angles at all.</p>

<p>Instead, all you need is three distances. If you calculate the distances from one point to the other three, a square will always have two equal and short distances on the sides and another multiple of the square root of two across the diagonal. Better yet, only squares have those three distances. So just start at any one point and run these calculations:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; test if four points for a square</span>
(<span style="color:#66d9ef">define </span>(square? pts)
  <span style="color:#75715e">; calculate and sort the pairwise distances</span>
  (<span style="color:#66d9ef">define </span>dists
    (sort
     (list (dist (car pts) (cadr pts))
           (dist (car pts) (caddr pts))
           (dist (car pts) (cadddr pts)))
     &lt;))

  <span style="color:#75715e">; two must be equal, those are edges</span>
  <span style="color:#75715e">; the last is the diagonal and should be sqrt 2 * edge</span>
  (<span style="color:#66d9ef">and </span>(= (car dists)
          (cadr dists))
       (= (caddr dists)
          (* (sqrt <span style="color:#ae81ff">2</span>) (car dists)))))</code></pre></div>
<p>This is assuming that you have <code>sqr</code> and <code>dist</code> defined as such:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; square a number</span>
(<span style="color:#66d9ef">define </span>(sqr x) (* x x))

<span style="color:#75715e">; standard distance function</span>
(<span style="color:#66d9ef">define </span>(dist p1 p2)
  (sqrt (+ (sqr (- (cadr p2) (cadr p1)))
           (sqr (- (car p2) (car p1))))))</code></pre></div>
<p>To test it out, we&rsquo;ll run all of the tests provided in the original post from Programming Praxis:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt;(square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>))) <span style="color:#75715e">; unit square</span>
<span style="color:#66d9ef">#t</span>
&gt;(square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">-1</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">-2</span>))) <span style="color:#75715e">; at an angle</span>
<span style="color:#66d9ef">#t</span>
&gt;(square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>))) <span style="color:#75715e">; re-ordered points</span>
<span style="color:#66d9ef">#t</span>
&gt;(square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span>) (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span>) (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>))) <span style="color:#75715e">; rectangle</span>
<span style="color:#66d9ef">#f</span>
&gt;(square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span>) (<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">4</span>) (<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">0</span>))) <span style="color:#75715e">; rhombus</span>
<span style="color:#66d9ef">#f</span>
&gt;(square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>))) <span style="color:#75715e">; not a polygon</span>
<span style="color:#66d9ef">#f</span>
&gt;(square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>))) <span style="color:#75715e">; not a polygon</span>
<span style="color:#66d9ef">#f</span></code></pre></div>
<p>Looks good to go. It&rsquo;s interesting how something like that can actually be pretty simple. Just three distance calculations and you&rsquo;re golden.</p>

<p>Except, it turns out that it&rsquo;s not quite so simple. This actually ended up being the same idea as the <a href="http://programmingpraxis.com/2013/01/02/four-points-determine-a-square/2/" title="Solution for Four Points Determine a Square">original solution</a> provided at Programming Praxis, but as another commenter pointed out (<a href="http://bonsaicode.wordpress.com/2013/01/02/programming-praxis-four-points-determine-a-square/" title="Programming Praxis - Four Points Determine a Square">their solution in Haskell</a>), there&rsquo;s one test case that this method fails on:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">&gt; (square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">-1</span> <span style="color:#ae81ff">-1</span>))) <span style="color:#75715e">; designed to fail</span>
<span style="color:#66d9ef">#f</span></code></pre></div>
<p>In this case, the distances are all correct (you have two sides and a square root of 2 multiple for the diagonal) but unfortunately the diagonal goes the wrong direction. So how do you fix that case?</p>

<p>Well, you should just be able to test the sides from the far point. That requires figuring out which distance that belonged to though (which isn&rsquo;t horrible), but I wanted something a bit more amusing. So what I&rsquo;ve done here is extend the function out to calculate all 16 pairwise distances between the points (including self comparisons):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; calculate all pairwise distances</span>
(<span style="color:#66d9ef">define </span>dists
  (sort
   (for*/list ([a (in-list pts)]
               [b (in-list pts)])
     (dist a b))
   &lt;))</code></pre></div>
<p>What we should get is four zeros (for the self comparisons), eight copies of the sides (because order isn&rsquo;t preserved we have both the side <em>ab</em> and <em>ba</em> for each side), and four copies of the diagonal at a square root of two multiple. Using <code>take</code> and <code>drop</code> on a sorted list to pull out those sections and making sure they are equal (it&rsquo;s times like these that I remember and am glad that <code>=</code> takes two <em>or more</em> arguments), and everything should work out nicely:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme"><span style="color:#75715e">; we should have:</span>
(and
 <span style="color:#75715e">; 4x zero for self matches</span>
 (apply = (cons <span style="color:#ae81ff">0</span> (take dists <span style="color:#ae81ff">4</span>)))
 <span style="color:#75715e">; 8x identical distances for the sides</span>
 (apply = (take (drop dists <span style="color:#ae81ff">4</span>) <span style="color:#ae81ff">8</span>))
 <span style="color:#75715e">; 4x sqrt(2) * side for the diagonals</span>
 (apply = (cons (* (sqrt <span style="color:#ae81ff">2</span>) (car (drop dists <span style="color:#ae81ff">4</span>)))
                (drop dists <span style="color:#ae81ff">12</span>))))</code></pre></div>
<p>It&rsquo;s a bit strange and definitely not the most efficient (<code>take</code> and <code>drop</code> are duplicating work and I believe that <code>apply</code> isn&rsquo;t necessarily the most efficient thing, although I could be wrong), but for the number of tests we&rsquo;re doing, it&rsquo;s still essentially instantanous.</p>

<p>This time, I also added a series of <code><a href="http://docs.racket-lang.org/search/index.html?q=RackUnit">RackUnit</a></code>
 tests to make sure everything works:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(check-true (square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>))) <span style="color:#e6db74">&#34;unit square&#34;</span>)
(check-true (square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">-1</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">-2</span>))) <span style="color:#e6db74">&#34;at an angle&#34;</span>)
(check-true (square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>))) <span style="color:#e6db74">&#34;re-ordered points&#34;</span>)

(check-false (square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span>) (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span>) (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>))) <span style="color:#e6db74">&#34;rectangle&#34;</span>)
(check-false (square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span>) (<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">4</span>) (<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">0</span>))) <span style="color:#e6db74">&#34;rhombus&#34;</span>)
(check-false (square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>))) <span style="color:#e6db74">&#34;not a polygon&#34;</span>)
(check-false (square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>))) <span style="color:#e6db74">&#34;not a polygon&#34;</span>)

(check-false (square? <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>) (<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>) (<span style="color:#ae81ff">-1</span> <span style="color:#ae81ff">-1</span>))) <span style="color:#e6db74">&#34;failed original test&#34;</span>)</code></pre></div>
<p>Running it, there are no errors, so everything appears to be good. Hopefully there isn&rsquo;t another sneaky sort of error going on, but for the moment I doubt it.</p>

<p>As mentioned, this is the sort of thing that you may see on those puzzle sort of interview questions. While I don&rsquo;t personally think there&rsquo;s much worth in that sort of question (more often than not, you&rsquo;re testing if someone has heard the question before), they&rsquo;re still often fun to work out the first time. I&rsquo;d be particularly interested to see how an interviewer would deal with the first (incorrect) solution and how the interviewee could deal with being told that there&rsquo;s a corner case that they missed but not which one.</p>

<p>If you&rsquo;d like to see the entire source code for this post, you can do so here:</p>

<ul>
<li><a title="Four points a square source on GitHub" href="https://github.com/jpverkamp/small-projects/blob/master/blog/four-points-a-square.rkt">four-points-a-square.rkt</a></li>
</ul>
	</div>

    
<div class="entry-comments">
    <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = "jverkamp";
            var disqus_title = "Four points, a square?";
            var disqus_url = "https:\/\/blog.jverkamp.com\/2013\/01\/03\/four-points-a-square\/";

             
            (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>


</article>

            </div>
        </div>

        <footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup>

<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li>

            
            <li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup>

<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li>
            
        </ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js" integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js" integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin="anonymous"></script>

<script type="text/javascript" src="/custom.js" defer></script>

</body>
</html>
