<!doctype html><html><head><title>Racket Roguelike 3: Rats, rats, everywhere! – jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_17422284542669262002.min.834c1e2313951f0c25b90152fe8b62250eab4a2e8cbd2560fa1a1cdc91c71733.js integrity="sha256-g0weIxOVHwwluQFS/otiJQ6rSi6MvSVg+hoc3JHHFzM=" defer></script><script src=/jquery.fancybox_16245765822111608191.min.ef050764ff69f3287c89ff655825479dd8304dcd9bc653d1ddd4772a701ad445.js integrity="sha256-7wUHZP9p8yh8if9lWCVHndgwTc2bxlPR3dR3KnAa1EU=" defer></script><script src=/katex_17296078054267651618.min.deed0e78a77391517d530a00324ce7b760ac204134992ef22d36f583615ae498.js integrity="sha256-3u0OeKdzkVF9UwoAMkznt2CsIEE0mS7yLTb1g2Fa5Jg=" defer></script><script src=/auto-render_14944144240389301023.min.e694d9d5eae2917984179683ead27b998784a81398e8836c369373d2c67fc32a.js integrity="sha256-5pTZ1erikXmEF5aD6tJ7mYeEqBOY6INsNpNz0sZ/wyo=" defer></script><script src=/bigfoot_28293813221957978.min.af671f08986f0a2267c5a0cb2748b005489e47fa25f55479b200e2a563d23022.js integrity="sha256-r2cfCJhvCiJnxaDLJ0iwBUieR/ol9VR5sgDipWPSMCI=" defer></script><script src=/mermaid_9520146763733687737.min.bfe50b47c0387e3c3bf97ec5f338bba94f7ccb02f962a4aec8cf0b4d68c8434d.js integrity="sha256-v+ULR8A4fjw7+X7F8zi7qU98ywL5YqSuyM8LTWjIQ00=" defer></script><script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script><link rel=stylesheet href=/katex_13658330645258633971.min.64e42891d651aee0b8cd02ec9227ff271d37bcf06dae985d1acf0eba1623e850.css integrity="sha256-ZOQokdZRruC4zQLskif/Jx03vPBtrphdGs8OuhYj6FA="><link rel=stylesheet href=/bigfoot-default_8781527669040159104.min.0d2b289fa3451447692959fcee5676b846532fe7ab50ddc4660824c42d4adcd7.css integrity="sha256-DSson6NFFEdpKVn87lZ2uEZTL+erUN3EZggkxC1K3Nc="><link rel=stylesheet href=/jquery.fancybox_5330465509389191777.min.67505d77381ebd82623ab9296c1989c44ec828d867c00296e80e52ef860cac37.css integrity="sha256-Z1BddzgevYJiOrkpbBmJxE7IKNhnwAKW6A5S74YMrDc="><link rel=stylesheet href=/css_1846377409604050217.min.fffe842bc000dd1fe8661ac6427a392a08faa95e8edab1ea7fb98c5f8dac6a6f.css integrity="sha256-//6EK8AA3R/oZhrGQno5Kgj6qV6O2rHqf7mMX42sam8="><link rel=stylesheet href=/main.min.34a34d86b8aae11b989d80a1626629c053029d012419a1993cfb6c12ea175737.css integrity="sha256-NKNNhriq4RuYnYChYmYpwFMCnQEkGaGZPPtsEuoXVzc="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/home-automation/>Home Automation</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>Racket Roguelike 3: Rats, rats, everywhere!</h1><div class=entry-meta><span class=entry-date>2013-04-18</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/04/18/a-prototype-object-system-for-racket/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/racket>Racket</a><a href=https://blog.jverkamp.com/2013/04/23/user-space-continuation-based-thread-pool/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/04/11/racket-roguelike-2-infinite-caves/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/7drl>7DRL</a><a href=https://blog.jverkamp.com/2013/04/25/racket-roguelike-4-slightly-smarter-critters/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/04/11/racket-roguelike-2-infinite-caves/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/games>Games</a><a href=https://blog.jverkamp.com/2013/04/25/racket-roguelike-4-slightly-smarter-critters/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2013/04/11/racket-roguelike-2-infinite-caves/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/roguelikes>Roguelikes</a><a href=https://blog.jverkamp.com/2013/04/25/racket-roguelike-4-slightly-smarter-critters/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/series/>Series</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2013/04/11/racket-roguelike-2-infinite-caves/ class=previous-link></a><a class=taxonomy-value href=/series/racket-roguelike>Racket Roguelike</a><a href=https://blog.jverkamp.com/2013/04/25/racket-roguelike-4-slightly-smarter-critters/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2013/04/18/a-prototype-object-system-for-racket/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2013/04/23/user-space-continuation-based-thread-pool/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2013/04/18/a-prototype-object-system-for-racket/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2013/04/23/user-space-continuation-based-thread-pool/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>So far, we&rsquo;ve <a href=https://blog.jverkamp.com/2013/04/04/racket-roguelike-1-a-gui-screens-i/o-and-you/>worked out our GUI and I/O</a> and <a href=https://blog.jverkamp.com/2013/04/11/racket-roguelike-2-infinite-caves/>created procedurally generated caves</a>. So what does that leave for today? Something to fight!</p><p>If you&rsquo;d like to start at the beginning, click here: <a href=https://blog.jverkamp.com/2013/04/04/racket-roguelike-1-a-gui-screens-i/o-and-you/>Racket Roguelike 1: A GUI, screens, I/O, and you!</a></p><p>Today&rsquo;s changes are pretty substantial, so it might be worth it to grab the source and get it handy while we go. In particularly, I&rsquo;ve added the ⟦ crosslink &ldquo;a-prototype-object-system-for-racket&rdquo; &ldquo;prototype &ldquo;thing&rdquo; code&rdquo; ⟧ from last night, refactored the point code into it&rsquo;s <a title="point source" href=https://github.com/jpverkamp/racket-roguelike/blob/master/src/point.rkt>own file</a>, and created a <a title="world source" href=https://github.com/jpverkamp/racket-roguelike/blob/master/src/world.rkt>&lsquo;world&rsquo; abstraction</a> to hold things like the player and tiles. I&rsquo;ll mention each of those in turn, but really not much changed in either, things just moved around.</p><p>That being said, what do we need to get everything working?</p><ul><li>Create entity / enemy &rsquo;things&rsquo;</li><li>Create the world abstraction</li><li>Get the enemies moving around</li><li>Entities attack each other when they move into each other</li><li>Entities (and the player) can die</li><li>Logging functionality</li></ul><p>So let&rsquo;s get to it, shall we?</p><p>First, let&rsquo;s use the <a href=https://blog.jverkamp.com/2013/04/18/a-prototype-object-system-for-racket/>&rsquo;thing&rsquo; framework</a> to create some enemies. If you haven&rsquo;t already read about the system, you probably should. But after that, it should be pretty straight forward. We&rsquo;ll start with basic entities. An entity is anything that has a location but isn&rsquo;t a tile in the map. So enemies and (in the future) items:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; entities.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; All entities have:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; - a location on the map</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; - attack and defense strengths</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; - hitpoints</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define-thing</span> entity
</span></span><span style=display:flex><span>  [character <span style=color:#e6db74>#\x</span>]
</span></span><span style=display:flex><span>  [color <span style=color:#e6db74>&#34;white&#34;</span>]
</span></span><span style=display:flex><span>  [location (<span style=color:#a6e22e>pt</span> <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>)])
</span></span></code></pre></div><p>Each one has the character and color used to describe it and a location in the world. From here, we can extend this to enemies. These will have statistics for attack, defense, and health, along with an <code>act</code> method that will be called each tick to update the enemy:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; entities.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; An enemy must have an act method</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; It should mutate the world with it&#39;s updated state</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; The default enemy does nothing</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define-thing</span> enemy entity
</span></span><span style=display:flex><span>  [name <span style=color:#e6db74>&#34;enemy&#34;</span>]
</span></span><span style=display:flex><span>  [color <span style=color:#e6db74>&#34;gray&#34;</span>]
</span></span><span style=display:flex><span>  [attack <span style=color:#ae81ff>10</span>]
</span></span><span style=display:flex><span>  [defense <span style=color:#ae81ff>10</span>]
</span></span><span style=display:flex><span>  [health <span style=color:#ae81ff>10</span>]
</span></span><span style=display:flex><span>  [(<span style=color:#a6e22e>act</span> me world) (<span style=color:#a6e22e>void</span>)])
</span></span></code></pre></div><p>The real beauty of a prototype based system comes in when we extend that enemy function in turn with a method that implements random movement:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; entities.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; A wandering enemy randomly chooses a neighboring open square</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define-thing</span> wandering-enemy enemy
</span></span><span style=display:flex><span>  [(<span style=color:#a6e22e>act</span> me world)
</span></span><span style=display:flex><span>   <span style=color:#75715e>; Choose a random possible move</span>
</span></span><span style=display:flex><span>   (<span style=color:#a6e22e>send</span> world try-move
</span></span><span style=display:flex><span>         me
</span></span><span style=display:flex><span>         (+ (<span style=color:#a6e22e>thing-get</span> me <span style=color:#e6db74>&#39;location</span>)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>pt</span> (- (<span style=color:#a6e22e>random</span> <span style=color:#ae81ff>3</span>) <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                (- (<span style=color:#a6e22e>random</span> <span style=color:#ae81ff>3</span>) <span style=color:#ae81ff>1</span>))))])
</span></span></code></pre></div><p>We&rsquo;ll still have to define <code>try-move</code>, but it&rsquo;s a good start.</p><p>Finally, here&rsquo;s our first enemy:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; entities.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>make-thing</span> wandering-enemy
</span></span><span style=display:flex><span>  [name <span style=color:#e6db74>&#34;rat&#34;</span>]
</span></span><span style=display:flex><span>  [character <span style=color:#e6db74>#\r</span>])
</span></span></code></pre></div><p>But all of this is completely worthless if we don&rsquo;t actually add them to the world. So let&rsquo;s do that. In order to do so though, this is where we want to factor out the <code>world</code> into it&rsquo;s own file so that we can keep it separate from the rest of the <code>game-screen%</code> functionality.</p><p>In parts, we have:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; world.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>world%
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>class</span> object%
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Store the player</span>
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>define </span>player
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>make-thing</span> entity
</span></span><span style=display:flex><span>        [name <span style=color:#e6db74>&#34;player&#34;</span>]
</span></span><span style=display:flex><span>        [attack <span style=color:#ae81ff>10</span>]
</span></span><span style=display:flex><span>        [defense <span style=color:#ae81ff>10</span>]
</span></span><span style=display:flex><span>        [health <span style=color:#ae81ff>100</span>]))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>define/public</span> (<span style=color:#a6e22e>get-player</span>) player)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Get the contents of a given point, caching for future use</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Hash on (x y) =&gt; char</span>
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>define </span>tiles (<span style=color:#a6e22e>make-hash</span>))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>define/public</span> (<span style=color:#a6e22e>get-tile</span> x y)
</span></span><span style=display:flex><span>      <span style=color:#f92672>...</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Try to move an entity to a given location</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>define/public</span> (<span style=color:#a6e22e>try-move</span> entity target)
</span></span><span style=display:flex><span>      <span style=color:#f92672>...</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Store a list of non-player entities</span>
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>define </span>npcs <span style=color:#f92672>&#39;</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>define/public</span> (<span style=color:#a6e22e>update-npcs</span>)
</span></span><span style=display:flex><span>      <span style=color:#f92672>...</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>define/public</span> (<span style=color:#a6e22e>draw-npcs</span> canvas)
</span></span><span style=display:flex><span>      <span style=color:#f92672>...</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>super-new</span>)))
</span></span></code></pre></div><p>Let&rsquo;s go through each function in turn. First, we have the <code>get-tile</code> function. It&rsquo;s the same thing that we used in last week&rsquo;s post to generate the map in the first place, but now it&rsquo;s been extended to generate enemies as well. The trick here is that we tie enemy generation into new tile generation. So whenever we generate a new (open) tile&ndash;by moving into unexplored territory for example&ndash;there&rsquo;s a random chance of generating a random enemy as well. So far, we only have rats, but the framework is already there to add any number of enemies.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; world.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Get the contents of a given point, caching for future use</span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Hash on (x y) =&gt; char</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>tiles (<span style=color:#a6e22e>make-hash</span>))
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define/public</span> (<span style=color:#a6e22e>get-tile</span> x y)
</span></span><span style=display:flex><span>  <span style=color:#75715e>; If the tile doesn&#39;t already exist, generate it</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>unless</span> (<span style=color:#a6e22e>hash-has-key?</span> tiles (list x y))
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Generate a random tile</span>
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>define </span>new-tile
</span></span><span style=display:flex><span>      (<span style=color:#66d9ef>let </span>()
</span></span><span style=display:flex><span>        (<span style=color:#66d9ef>define </span>wall?  (&gt; (<span style=color:#a6e22e>simplex</span> (* <span style=color:#ae81ff>0.1</span> x) (* <span style=color:#ae81ff>0.1</span> y) <span style=color:#ae81ff>0</span>)         <span style=color:#ae81ff>0.0</span>))
</span></span><span style=display:flex><span>        (<span style=color:#66d9ef>define </span>water? (&gt; (<span style=color:#a6e22e>simplex</span> (* <span style=color:#ae81ff>0.1</span> x) <span style=color:#ae81ff>0</span>         (* <span style=color:#ae81ff>0.1</span> y)) <span style=color:#ae81ff>0.5</span>))
</span></span><span style=display:flex><span>        (<span style=color:#66d9ef>define </span>tree?  (&gt; (<span style=color:#a6e22e>simplex</span> <span style=color:#ae81ff>0</span>         (* <span style=color:#ae81ff>0.1</span> x) (* <span style=color:#ae81ff>0.1</span> y)) <span style=color:#ae81ff>0.5</span>))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>          [wall?  wall]
</span></span><span style=display:flex><span>          [water? water]
</span></span><span style=display:flex><span>          [tree?  tree]
</span></span><span style=display:flex><span>          [<span style=color:#66d9ef>else </span>  empty])))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>hash-set!</span> tiles (list x y) new-tile)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Sometimes, generate a new enemy</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; Only if the new tile is walkable</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>when</span> (<span style=color:#66d9ef>and </span>(<span style=color:#a6e22e>thing-get</span> new-tile <span style=color:#e6db74>&#39;walkable</span>)
</span></span><span style=display:flex><span>               (&lt; (<span style=color:#a6e22e>random</span> <span style=color:#ae81ff>100</span>) <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>      (<span style=color:#66d9ef>define </span>new-thing
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>make-thing</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>; Base it off a randomly chosen enemy</span>
</span></span><span style=display:flex><span>          (vector-ref random-enemies
</span></span><span style=display:flex><span>                      (<span style=color:#a6e22e>random</span> (vector-length random-enemies)))
</span></span><span style=display:flex><span>          <span style=color:#75715e>; This is it&#39;s location</span>
</span></span><span style=display:flex><span>          [location (<span style=color:#a6e22e>pt</span> x y)]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>; Store it in the npc list</span>
</span></span><span style=display:flex><span>      (<span style=color:#66d9ef>set! </span>npcs (cons new-thing npcs))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>; Return the tile (newly generated or not)</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>hash-ref</span> tiles (list x y)))
</span></span></code></pre></div><p>You may notice that the tiles returned aren&rsquo;t simple symbols anymore. Instead, they&rsquo;re another parallel thing hierarchy:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; world.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Define tile types</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define-thing</span> tile
</span></span><span style=display:flex><span>  [walkable <span style=color:#66d9ef>#f</span>]
</span></span><span style=display:flex><span>  [character <span style=color:#e6db74>#\space</span>]
</span></span><span style=display:flex><span>  [color <span style=color:#e6db74>&#34;black&#34;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define-thing</span> empty tile
</span></span><span style=display:flex><span>  [walkable <span style=color:#66d9ef>#t</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define-thing</span> wall tile
</span></span><span style=display:flex><span>  [character <span style=color:#e6db74>#\#</span>]
</span></span><span style=display:flex><span>  [color <span style=color:#e6db74>&#34;white&#34;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define-thing</span> water tile
</span></span><span style=display:flex><span>  [character <span style=color:#e6db74>#\u</span><span style=color:#ae81ff>00</span>db]
</span></span><span style=display:flex><span>  [color <span style=color:#e6db74>&#34;blue&#34;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define-thing</span> tree tile
</span></span><span style=display:flex><span>  [character <span style=color:#e6db74>#\u</span><span style=color:#ae81ff>0005</span>]
</span></span><span style=display:flex><span>  [color <span style=color:#e6db74>&#34;green&#34;</span>])
</span></span></code></pre></div><p>Other than that, the code should theoretically be straightforward. One neat part is that each critter is instantiated as it&rsquo;s generated simply by using <code>make-thing</code> to extend it (and override the location). This is that nice overlap with extending and instantiating classes that I noted in the <a href=https://blog.jverkamp.com/2013/04/18/a-prototype-object-system-for-racket/>prototype post</a>.</p><p>What about<code> try-move</code>? Originally, the player movement and the entity movement (in <code>wandering-enemy</code>&rsquo;s <code>act</code> method) duplicated the code that checked for enemies. But this wasn&rsquo;t particularly helpful. Instead, we want a method that can handle the three possible cases when moving to a new tile:</p><ul><li>If the tile isn&rsquo;t walkable, do nothing</li><li>If the tile is walkable and not otherwise occupied, update the location</li><li>If the tile is walkable and occupied, attack the occupant and stay where you are</li></ul><p>All of that translates pretty directly to this code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; world.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Try to move an entity to a given location</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define/public</span> (<span style=color:#a6e22e>try-move</span> entity target)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>tile (<span style=color:#a6e22e>send</span> this get-tile (<span style=color:#a6e22e>pt-x</span> target) (<span style=color:#a6e22e>pt-y</span> target)))
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>define </span>others
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>filter</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>; Only get ones at the target location that aren&#39;t me</span>
</span></span><span style=display:flex><span>     (<span style=color:#66d9ef>lambda </span>(<span style=color:#a6e22e>thing</span>) (<span style=color:#66d9ef>and </span>(not (eqv? thing entity))
</span></span><span style=display:flex><span>                          (= (<span style=color:#a6e22e>thing-get</span> thing <span style=color:#e6db74>&#39;location</span>) target)))
</span></span><span style=display:flex><span>     <span style=color:#75715e>; Include the player and all npcs</span>
</span></span><span style=display:flex><span>     (cons player npcs)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; If it&#39;s not walkable, do nothing</span>
</span></span><span style=display:flex><span>    [(not (<span style=color:#a6e22e>thing-get</span> tile <span style=color:#e6db74>&#39;walkable</span>))
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>void</span>)]
</span></span><span style=display:flex><span>    <span style=color:#75715e>; If it&#39;s walkable and not occupied, update the location</span>
</span></span><span style=display:flex><span>    [(null? others)
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>thing-set!</span> entity <span style=color:#e6db74>&#39;location</span> target)]
</span></span><span style=display:flex><span>    <span style=color:#75715e>; If it&#39;s walkable and occupied, attack the occupant and don&#39;t move</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>; damage = max(0, rand(min(1, attack)) - rand(min(1, defense)))</span>
</span></span><span style=display:flex><span>    [else
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>for</span> ([other (<span style=color:#a6e22e>in-list</span> others)])
</span></span><span style=display:flex><span>       <span style=color:#75715e>; Do the damage</span>
</span></span><span style=display:flex><span>       (<span style=color:#66d9ef>define </span>damage
</span></span><span style=display:flex><span>         (max <span style=color:#ae81ff>0</span> (- (<span style=color:#a6e22e>random</span> (max <span style=color:#ae81ff>1</span> (<span style=color:#a6e22e>thing-get</span> entity <span style=color:#e6db74>&#39;attack</span>)))
</span></span><span style=display:flex><span>                   (<span style=color:#a6e22e>random</span> (max <span style=color:#ae81ff>1</span> (<span style=color:#a6e22e>thing-get</span> other <span style=color:#e6db74>&#39;defense</span>))))))
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>thing-set!</span> other <span style=color:#e6db74>&#39;health</span> (- (<span style=color:#a6e22e>thing-get</span> other <span style=color:#e6db74>&#39;health</span>) damage))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#75715e>; Log a message</span>
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>send</span> this log
</span></span><span style=display:flex><span>             (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;~a attacked ~a, did ~a damage&#34;</span>
</span></span><span style=display:flex><span>                     (<span style=color:#a6e22e>thing-get</span> entity <span style=color:#e6db74>&#39;name</span>)
</span></span><span style=display:flex><span>                     (<span style=color:#a6e22e>thing-get</span> other <span style=color:#e6db74>&#39;name</span>)
</span></span><span style=display:flex><span>                     damage)))]))
</span></span></code></pre></div><p>The first part gets the tile and any other entities that could be in the target tile. Right now, there&rsquo;s no way that more than one entity should ever be in the same tile, but that&rsquo;s not a hard restriction, it could change in the future.</p><p>The second part controls the three conditions. The first two are straightforward, either doing nothing or just updating the location. The last part is a little more complicated because we have to deal with doing damage. For the moment, I&rsquo;m using a completely made up damage function with a nice degree of randomness:</p><div class=latex-block>damage = max(0, random(1, max(1, attack)) - random(1, max(1, defense)))</div><p>This means that it&rsquo;s not possible to do 0 damage and that the minimum attack and defense values are 1. This was a bit of a problem at first, when I used <code>min</code> instead of <code>max</code> on the inner two parts. That meant everything had an attack and defense of 1&ndash;which means no one could do any damage. Oops.</p><p>Finally, we log the message. I&rsquo;ll talk about that later.</p><p>There are two more parts that we have to deal with, updating and drawing the NPCs. To update them, we have to call each of their <code>act</code> methods in turn then filter out the ones that have fallen to 0 or less <code>health</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; world.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define/public</span> (<span style=color:#a6e22e>update-npcs</span>)
</span></span><span style=display:flex><span>  <span style=color:#75715e>; Allow each to move</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>for</span> ([npc (<span style=color:#a6e22e>in-list</span> npcs)])
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>thing-call</span> npc <span style=color:#e6db74>&#39;act</span> npc this))
</span></span><span style=display:flex><span>  <span style=color:#75715e>; Check for (and remove) any dead npcs</span>
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>set! </span>npcs
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>filter</span>
</span></span><span style=display:flex><span>         (<span style=color:#66d9ef>lambda </span>(<span style=color:#a6e22e>npc</span>)
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>when</span> (&lt;= (<span style=color:#a6e22e>thing-get</span> npc <span style=color:#e6db74>&#39;health</span>) <span style=color:#ae81ff>0</span>)              (<span style=color:#a6e22e>send</span> this log (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;~a has died&#34;</span> (<span style=color:#a6e22e>thing-get</span> npc <span style=color:#e6db74>&#39;name</span>))))            (&gt; (<span style=color:#a6e22e>thing-get</span> npc <span style=color:#e6db74>&#39;health</span>) <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span>         npcs)))
</span></span></code></pre></div><p>This does allow for an oddity that an NPC could die during the action loop but then still take it&rsquo;s turn. It&rsquo;s suboptimal but on the flip side I think it&rsquo;s fair. Think of it as the NPCs attack in parallel rather than in turn and everything is fine.</p><p>The draw method is pretty much the same. Again, we take advantage of the fact that points are complex numbers and can thus be used mathematically:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; world.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define/public</span> (<span style=color:#a6e22e>draw-npcs</span> canvas)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>for</span> ([npc (<span style=color:#a6e22e>in-list</span> npcs)])
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>define </span>x/y (<span style=color:#a6e22e>recenter</span> canvas (- (<span style=color:#a6e22e>thing-get</span> player <span style=color:#e6db74>&#39;location</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#a6e22e>thing-get</span> npc <span style=color:#e6db74>&#39;location</span>))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>when</span> (<span style=color:#66d9ef>and </span>(&lt;= <span style=color:#ae81ff>0</span> (<span style=color:#a6e22e>pt-x</span> x/y) (<span style=color:#a6e22e>sub1</span> (<span style=color:#a6e22e>send</span> canvas get-width-in-characters)))
</span></span><span style=display:flex><span>               (&lt;= <span style=color:#ae81ff>0</span> (<span style=color:#a6e22e>pt-y</span> x/y) (<span style=color:#a6e22e>sub1</span> (<span style=color:#a6e22e>send</span> canvas get-height-in-characters))))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>send</span> canvas write
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>thing-get</span> npc <span style=color:#e6db74>&#39;character</span>)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>pt-x</span> x/y)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>pt-y</span> x/y)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>thing-get</span> npc <span style=color:#e6db74>&#39;color</span>)))))
</span></span></code></pre></div><p>That&rsquo;s the majorities of the changes for this week. What&rsquo;s left is checking if the player is dead, which we do in <code>game-screen%</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; game-screen.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Process keyboard events</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>game-over <span style=color:#66d9ef>#f</span>)
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define/override</span> (<span style=color:#a6e22e>update</span> key-event)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>    [game-over (<span style=color:#a6e22e>new</span> game-screen%)]
</span></span><span style=display:flex><span>    [else
</span></span><span style=display:flex><span>     <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>; Check if the player is dead</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>; If so, tell the player they lost</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>; Otherwise, keep on the current screen</span>
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>when</span> (&lt;= (<span style=color:#a6e22e>thing-get</span> player <span style=color:#e6db74>&#39;health</span>) <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>send</span> world log <span style=color:#e6db74>&#34;You lose!&#34;</span>)
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>send</span> world log <span style=color:#e6db74>&#34;Press any key to continue.&#34;</span>)
</span></span><span style=display:flex><span>       (<span style=color:#66d9ef>set! </span>game-over <span style=color:#66d9ef>#t</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     this]))
</span></span></code></pre></div><p>What this does is check for a game over and then run for one more update so that the player can read the game over message. Then it creates an entirely new game and throws you right back into the fun. The beauty of it all is that everything we had before should all be garbage collected now. That&rsquo;s the fun of not having to manually manage memory. &#x1f604;</p><p>Finally, the logging functionality. Optimally, this should be in <code>game-screen%</code>, but a <code>world%</code> doesn&rsquo;t know about the <code>game-screen%</code> so this is non-trivial to hook up. So <code>world%</code> handles the logging and <code>game-screen%</code> asks it for new messages when it updates.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span><span style=color:#75715e>; world.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Log messages to display to the player</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>log-messages <span style=color:#f92672>&#39;</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define/public</span> (log msg)
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>set! </span>log-messages (cons msg log-messages)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>define/public</span> (<span style=color:#a6e22e>get-log</span> [count <span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>let </span>loop ([i <span style=color:#ae81ff>0</span>] [msgs log-messages])
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>cond</span>
</span></span><span style=display:flex><span>      [(= i count) <span style=color:#f92672>&#39;</span>()]
</span></span><span style=display:flex><span>      [(null? msgs) (cons <span style=color:#e6db74>&#34;&#34;</span> (<span style=color:#a6e22e>loop</span> (+ i <span style=color:#ae81ff>1</span>) msgs))]
</span></span><span style=display:flex><span>      [else
</span></span><span style=display:flex><span>       (cons (car msgs)
</span></span><span style=display:flex><span>             (<span style=color:#a6e22e>loop</span> (+ i <span style=color:#ae81ff>1</span>) (cdr msgs)))])))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; game-screen.rkt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; Draw recent log messages</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>for</span> ([i (<span style=color:#a6e22e>in-naturals</span>)]
</span></span><span style=display:flex><span>      [msg (<span style=color:#a6e22e>in-list</span> (<span style=color:#a6e22e>send</span> world get-log <span style=color:#ae81ff>3</span>))])
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>send</span> canvas write-string
</span></span><span style=display:flex><span>        msg
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>1</span> (- (<span style=color:#a6e22e>send</span> canvas get-height-in-characters) i <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;green&#34;</span>))
</span></span></code></pre></div><p>And that&rsquo;s everything. Perhaps we should get some screenshots? Because screenshots are cool<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><figure><img src=/embeds/2013/1-starting-out.png></figure><p>First, we&rsquo;re just starting out. The caves look much the same (as they should), but now we have a bunch of ratty buddies just sort of hanging out. Since we have a 1% chance per newly generated tile and the map is originally 960 tiles (and a little more than half full) we might expect about 5 rats. I count three and there might be another hidden under the text in the top left, so everything seems good to go.</p><figure><img src=/embeds/2013/2-rat-hunting.png></figure><p>Now we&rsquo;re chasing down a rat. We don&rsquo;t have any AI yet, so they&rsquo;re remarkably dumb. That&rsquo;s the goal for next week, to have monsters that will either run away from you (as the rats will probably do) or chase you down. This should be one of the more interesting parts of the project.</p><figure><img src=/embeds/2013/3-attack.png></figure><p>We&rsquo;ve finally managed to see some real damage here. Interestingly, the monsters can attack each other. I didn&rsquo;t intentionally plan for this, I just didn&rsquo;t put in any code that will prevent it. The AI should be smart enough eventually to avoid it, but I think having it as an option is pretty nice. Also, since the rats have equal attack and defense more often than not we shouldn&rsquo;t see any damage.</p><figure><img src=/embeds/2013/4-one-down.png></figure><p>Bam. Dead rat. The nice thing is that any NPCs that are killed are removed from the NPC list, so that should help both with efficiency and error checking.</p><figure><img src=/embeds/2013/5-they-keep-coming.png></figure><p>We&rsquo;re starting to get a bit more afield and there&rsquo;s just more and more rats. We got another one here, but there are four more just waiting for us.</p><figure><img src=/embeds/2013/6-doom.png></figure><p>And finally, the game over screen. I had to add another monster type (the <code>doom</code>) that had a higher attack to actually kill the player in any reasonable amount of time. The rats are just too weak. That&rsquo;s definitaly a topic for a later article&ndash;how do you balance all of this?</p><p>And there you have it. Week 3 of writing a roguelike in Racket.</p><p>As always, if you&rsquo;d like to see all of the code for this project, you can do so on GitHub:</p><ul><li><a href=https://github.com/jpverkamp/racket-roguelike/tree/day-3 title="Racket Roguelike on GitHub">Racket Roguelike - Day 3</a></li><li><a href=https://github.com/jpverkamp/racket-roguelike title="Racket Roguelike on GitHub">Racket Roguelike - Up to date</a></li></ul><p>If you&rsquo;d like to try it yourself, you&rsquo;ll need to have both <a href=http://git-scm.com/>Git</a> and <a href=http://racket-lang.org/>Racket</a> and run the following series of commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone git://github.com/jpverkamp/racket-roguelike.git
</span></span><span style=display:flex><span>cd racket-roguelike
</span></span><span style=display:flex><span>git checkout day-3
</span></span><span style=display:flex><span>git submodule init
</span></span><span style=display:flex><span>git submodule update
</span></span><span style=display:flex><span>racket main.rkt
</span></span></code></pre></div><p><strong>Edit:</strong></p><p>It seems that the submodules wondered off at some point. Instead, you can install the three libraries this uses directly using <code><a href="http://docs.racket-lang.org/search/index.html?q=pkg">pkg</a></code>
, and then run the code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>raco pkg install github://github.com:jpverkamp/ascii-canvas/master
</span></span><span style=display:flex><span>raco pkg install github://github.com:jpverkamp/noise/master
</span></span><span style=display:flex><span>raco pkg install github://github.com:jpverkamp/thing/master
</span></span><span style=display:flex><span>git clone git://github.com/jpverkamp/racket-roguelike.git
</span></span><span style=display:flex><span>cd racket-roguelike
</span></span><span style=display:flex><span>git checkout day-3
</span></span><span style=display:flex><span>racket main.rkt
</span></span></code></pre></div><p>If you already have the code, you&rsquo;ll still have to <code>init</code> and <code>update</code> the submodules since I added a third one. Theoretically, I should be using <a href=http://planet.racket-lang.org/>PLaneT</a> for this instead, but that&rsquo;s something to put off for another day.</p><p>For part 4, click here: <a href=https://blog.jverkamp.com/2013/04/25/racket-roguelike-4-slightly-smarter-critters/>Racket Roguelike 4: Slightly smarter critters!</a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>I may or may not have been watching Doctor Who for the last few hours&mldr;&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>