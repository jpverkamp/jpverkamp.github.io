(function(e){var n={};function t(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,s){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:s})},t.r=function(e){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(n&1&&(e=t(e)),n&8)return e;if(n&4&&typeof e=="object"&&e&&e.__esModule)return e;var o,s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),n&2&&typeof e!="string")for(o in e)t.d(s,o,function(t){return e[t]}.bind(null,o));return s},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=40)})([function(e,t,n){var s;!(s=function(){"use strict";function e(e,t){this.isUndef(e)||1===e?this.input=this.context.createGain():1<e&&(this.input=new Array(e)),this.isUndef(t)||1===t?this.output=this.context.createGain():1<t&&(this.output=new Array(e))}var t;return e.prototype.set=function(t,n,s){this.isObject(t)?s=n:this.isString(t)&&(l={},l[t]=n,t=l);t:for(i in t){if(n=t[i],a=this,-1!==i.indexOf(".")){for(var o,i,a,l,d,r=i.split("."),c=0;c<r.length-1;c++)if((a=a[r[c]])instanceof e){r.splice(0,c+1),d=r.join("."),a.set(d,n);continue t}i=r[r.length-1]}o=a[i],this.isUndef(o)||(e.Signal&&o instanceof e.Signal||e.Param&&o instanceof e.Param?o.value!==n&&(this.isUndef(s)?o.value=n:o.rampTo(n,s)):o instanceof AudioParam?o.value!==n&&(o.value=n):o instanceof e?o.set(n):o!==n&&(a[i]=n))}return this},e.prototype.get=function(t){this.isUndef(t)?t=this._collectDefaults(this.constructor):this.isString(t)&&(t=[t]);for(l={},r=0;r<t.length;r++){var n,i,a,r,c,l,s=t[r],d=this,o=l;if(-1!==s.indexOf(".")){for(i=s.split("."),c=0;c<i.length-1;c++)a=i[c],o[a]=o[a]||{},o=o[a],d=d[a];s=i[i.length-1]}n=d[s],this.isObject(t[s])?o[s]=n.get():e.Signal&&n instanceof e.Signal?o[s]=n.value:e.Param&&n instanceof e.Param?o[s]=n.value:n instanceof AudioParam?o[s]=n.value:n instanceof e?o[s]=n.get():this.isFunction(n)||this.isUndef(n)||(o[s]=n)}return l},e.prototype._collectDefaults=function(e){if(t=[],this.isUndef(e.defaults)||(t=Object.keys(e.defaults)),!this.isUndef(e._super))for(var t,s=this._collectDefaults(e._super),n=0;n<s.length;n++)-1===t.indexOf(s[n])&&t.push(s[n]);return t},e.prototype.toString=function(){for(t in e){var t,n=t[0].match(/^[A-Z]$/),s=e[t]===this.constructor;if(this.isFunction(e[t])&&n&&s)return t}return"Tone"},Object.defineProperty(e.prototype,"numberOfInputs",{get:function(){return this.input?this.isArray(this.input)?this.input.length:1:0}}),Object.defineProperty(e.prototype,"numberOfOutputs",{get:function(){return this.output?this.isArray(this.output)?this.output.length:1:0}}),e.prototype.dispose=function(){return this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this},e.prototype.connect=function(e,t,n){return Array.isArray(this.output)?(t=this.defaultArg(t,0),this.output[t].connect(e,0,n)):this.output.connect(e,t,n),this},e.prototype.disconnect=function(e,t,n){this.isArray(this.output)?this.isNumber(e)?this.output[e].disconnect():(t=this.defaultArg(t,0),this.output[t].disconnect(e,0,n)):this.output.disconnect.apply(this.output,arguments)},e.prototype.connectSeries=function(){if(1<arguments.length)for(var t,n=arguments[0],e=1;e<arguments.length;e++)t=arguments[e],n.connect(t),n=t;return this},e.prototype.chain=function(){if(0<arguments.length)for(var t,n=this,e=0;e<arguments.length;e++)t=arguments[e],n.connect(t),n=t;return this},e.prototype.fan=function(){if(0<arguments.length)for(var e=0;e<arguments.length;e++)this.connect(arguments[e]);return this},AudioNode.prototype.chain=e.prototype.chain,AudioNode.prototype.fan=e.prototype.fan,e.prototype.defaultArg=function(e,t){if(this.isObject(e)&&this.isObject(t)){var s,o,n={};for(s in e)n[s]=this.defaultArg(t[s],e[s]);for(o in t)n[o]=this.defaultArg(e[o],t[o]);return n}return this.isUndef(e)?t:e},e.prototype.optionsObject=function(e,t,n){var s,o={};if(1===e.length&&this.isObject(e[0]))o=e[0];else for(s=0;s<t.length;s++)o[t[s]]=e[s];return this.isUndef(n)?o:this.defaultArg(o,n)},e.prototype.isUndef=function(e){return 0[0]===e},e.prototype.isFunction=function(e){return"function"==typeof e},e.prototype.isNumber=function(e){return"number"==typeof e},e.prototype.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object},e.prototype.isBoolean=function(e){return"boolean"==typeof e},e.prototype.isArray=function(e){return Array.isArray(e)},e.prototype.isString=function(e){return"string"==typeof e},e.noOp=function(){},e.prototype._readOnly=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this._readOnly(e[t]);else Object.defineProperty(this,e,{writable:!1,enumerable:!0})},e.prototype._writable=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this._writable(e[t]);else Object.defineProperty(this,e,{writable:!0})},e.State={Started:"started",Stopped:"stopped",Paused:"paused"},e.prototype.equalPowerScale=function(e){var t=.5*Math.PI;return Math.sin(e*t)},e.prototype.dbToGain=function(e){return 2**(e/6)},e.prototype.gainToDb=function(e){return Math.log(e)/Math.LN10*20},e.prototype.intervalToFrequencyRatio=function(e){return 2**(e/12)},e.prototype.now=function(){return e.context.now()},e.now=function(){return e.context.now()},e.extend=function(t,n){function s(){}e.prototype.isUndef(n)&&(n=e),s.prototype=n.prototype,t.prototype=new s,(t.prototype.constructor=t)._super=n},Object.defineProperty(e,"context",{get:function(){return t},set:function(n){t=e.Context&&n instanceof e.Context?n:new e.Context(n),e.Context&&e.Context.emit("init",t)}}),Object.defineProperty(e.prototype,"context",{get:function(){return e.context}}),e.setContext=function(t){e.context=t},Object.defineProperty(e.prototype,"blockTime",{get:function(){return 128/this.context.sampleRate}}),Object.defineProperty(e.prototype,"sampleTime",{get:function(){return 1/this.context.sampleRate}}),Object.defineProperty(e,"supported",{get:function(){var e=window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"),t=window.hasOwnProperty("Promise"),n=window.hasOwnProperty("Worker");return e&&t&&n}}),e.version="r10",window.TONE_SILENCE_VERSION_LOGGING||console.log("%c * Tone.js "+e.version+" * ","background: #000; color: #fff"),e}.call(t,n,t,e),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(2),n(10)],s=function(e){"use strict";return e.Multiply=function(t){this.createInsOuts(2,0),this._mult=this.input[0]=this.output=new e.Gain,this._param=this.input[1]=this.output.gain,this._param.value=this.defaultArg(t,0)},e.extend(e.Multiply,e.Signal),e.Multiply.prototype.dispose=function(){return e.prototype.dispose.call(this),this._mult.dispose(),this._mult=null,this._param=null,this},e.Multiply}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(6),n(9),n(18),n(10)],s=function(e){"use strict";return e.Signal=function(){var t=this.optionsObject(arguments,["value","units"],e.Signal.defaults);this.output=this._gain=this.context.createGain(),t.param=this._gain.gain,e.Param.call(this,t),this.input=this._param=this._gain.gain,this.context.getConstant(1).chain(this._gain)},e.extend(e.Signal,e.Param),e.Signal.defaults={value:0,units:e.Type.Default,convert:!0},e.Signal.prototype.connect=e.SignalBase.prototype.connect,e.Signal.prototype.dispose=function(){return e.Param.prototype.dispose.call(this),this._param=null,this._gain.disconnect(),this._gain=null,this},e.Signal}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return l}),n.d(t,"c",function(){return d});var s,o=n(22),i=n.n(o),a=n(0),r=n.n(a),c=n(12),u=n.n(c);e.TONE_SILENCE_VERSION_LOGGING=!0,s=new window.AudioContext,r.a.setContext(s);function l(){return s}function d(e,t){var n=e;return e instanceof p5.Element?n=e.elt:e instanceof Array&&e[0]instanceof p5.Element&&(n=e.map(function(e){return e.elt})),i()(s,n,t)}t.a=s}).call(this,n(26))},function(e,t,n){var s,o;!(o=[n(0),n(2),n(10)],s=function(e){"use strict";return e.Add=function(t){this.createInsOuts(2,0),this._sum=this.input[0]=this.input[1]=this.output=new e.Gain,this._param=this.input[1]=new e.Signal(t),this._param.connect(this._sum)},e.extend(e.Add,e.Signal),e.Add.prototype.dispose=function(){return e.prototype.dispose.call(this),this._sum.dispose(),this._sum=null,this._param.dispose(),this._param=null,this},e.Add}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e){e.exports={recorderProcessor:"recorder-processor",soundFileProcessor:"sound-file-processor",amplitudeProcessor:"amplitude-processor"}},function(e,t,n){var s,o;!(o=[n(0),n(15)],s=function(e){"use strict";return e.WaveShaper=function(e,t){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(e)?this.curve=e:isFinite(e)||this.isUndef(e)?this._curve=new Float32Array(this.defaultArg(e,1024)):this.isFunction(e)&&(this._curve=new Float32Array(this.defaultArg(t,1024)),this.setMap(e))},e.extend(e.WaveShaper,e.SignalBase),e.WaveShaper.prototype.setMap=function(e){for(var s,t=0,n=this._curve.length;t<n;t++)s=t/(n-1)*2-1,this._curve[t]=e(s,t);return this._shaper.curve=this._curve,this},Object.defineProperty(e.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(e){this._curve=new Float32Array(e),this._shaper.curve=this._curve}}),Object.defineProperty(e.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(e){if(-1===["none","2x","4x"].indexOf(e))throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");this._shaper.oversample=e}}),e.WaveShaper.prototype.dispose=function(){return e.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this},e.WaveShaper}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(2),n(19)],s=function(e){"use strict";return e.TimelineSignal=function(){var t=this.optionsObject(arguments,["value","units"],e.Signal.defaults);this._events=new e.Timeline(10),e.Signal.apply(this,t),t.param=this._param,e.Param.call(this,t),this._initial=this._fromUnits(this._param.value)},e.extend(e.TimelineSignal,e.Param),e.TimelineSignal.Type={Linear:"linear",Exponential:"exponential",Target:"target",Curve:"curve",Set:"set"},Object.defineProperty(e.TimelineSignal.prototype,"value",{get:function(){var e=this.now(),t=this.getValueAtTime(e);return this._toUnits(t)},set:function(e){var t=this._fromUnits(e);this._initial=t,this.cancelScheduledValues(),this._param.value=t}}),e.TimelineSignal.prototype.setValueAtTime=function(t,n){return t=this._fromUnits(t),n=this.toSeconds(n),this._events.add({type:e.TimelineSignal.Type.Set,value:t,time:n}),this._param.setValueAtTime(t,n),this},e.TimelineSignal.prototype.linearRampToValueAtTime=function(t,n){return t=this._fromUnits(t),n=this.toSeconds(n),this._events.add({type:e.TimelineSignal.Type.Linear,value:t,time:n}),this._param.linearRampToValueAtTime(t,n),this},e.TimelineSignal.prototype.exponentialRampToValueAtTime=function(t,n){n=this.toSeconds(n);var o,s=this._searchBefore(n);return s&&0===s.value&&this.setValueAtTime(this._minOutput,s.time),t=this._fromUnits(t),o=Math.max(t,this._minOutput),this._events.add({type:e.TimelineSignal.Type.Exponential,value:o,time:n}),t<this._minOutput?(this._param.exponentialRampToValueAtTime(this._minOutput,n-this.sampleTime),this.setValueAtTime(0,n)):this._param.exponentialRampToValueAtTime(t,n),this},e.TimelineSignal.prototype.setTargetAtTime=function(t,n,s){return t=this._fromUnits(t),t=Math.max(this._minOutput,t),s=Math.max(this._minOutput,s),n=this.toSeconds(n),this._events.add({type:e.TimelineSignal.Type.Target,value:t,time:n,constant:s}),this._param.setTargetAtTime(t,n,s),this},e.TimelineSignal.prototype.setValueCurveAtTime=function(t,n,s,o){o=this.defaultArg(o,1);for(var a,c,i=new Array(t.length),r=0;r<i.length;r++)i[r]=this._fromUnits(t[r])*o;n=this.toSeconds(n),s=this.toSeconds(s),this._events.add({type:e.TimelineSignal.Type.Curve,value:i,time:n,duration:s}),this._param.setValueAtTime(i[0],n);for(a=1;a<i.length;a++)c=n+a/(i.length-1)*s,this._param.linearRampToValueAtTime(i[a],c);return this},e.TimelineSignal.prototype.cancelScheduledValues=function(e){return e=this.toSeconds(e),this._events.cancel(e),this._param.cancelScheduledValues(e),this},e.TimelineSignal.prototype.setRampPoint=function(t){t=this.toSeconds(t);var o,s=this._toUnits(this.getValueAtTime(t)),n=this._searchBefore(t);return n&&n.time===t?this.cancelScheduledValues(t+this.sampleTime):n&&n.type===e.TimelineSignal.Type.Curve&&n.time+n.duration>t?(this.cancelScheduledValues(t),this.linearRampToValueAtTime(s,t)):(o=this._searchAfter(t),o&&(this.cancelScheduledValues(t),o.type===e.TimelineSignal.Type.Linear?this.linearRampToValueAtTime(s,t):o.type===e.TimelineSignal.Type.Exponential&&this.exponentialRampToValueAtTime(s,t)),this.setValueAtTime(s,t)),this},e.TimelineSignal.prototype.linearRampToValueBetween=function(e,t,n){return this.setRampPoint(t),this.linearRampToValueAtTime(e,n),this},e.TimelineSignal.prototype.exponentialRampToValueBetween=function(e,t,n){return this.setRampPoint(t),this.exponentialRampToValueAtTime(e,n),this},e.TimelineSignal.prototype._searchBefore=function(e){return this._events.get(e)},e.TimelineSignal.prototype._searchAfter=function(e){return this._events.getAfter(e)},e.TimelineSignal.prototype.getValueAtTime=function(t){t=this.toSeconds(t);var i,a,s=this._searchAfter(t),n=this._searchBefore(t),o=this._initial;return null===n?o=this._initial:n.type===e.TimelineSignal.Type.Target?(i=this._events.getBefore(n.time),a=null===i?this._initial:i.value,o=this._exponentialApproach(n.time,a,n.value,n.constant,t)):o=n.type===e.TimelineSignal.Type.Curve?this._curveInterpolate(n.time,n.value,n.duration,t):null===s?n.value:s.type===e.TimelineSignal.Type.Linear?this._linearInterpolate(n.time,n.value,s.time,s.value,t):s.type===e.TimelineSignal.Type.Exponential?this._exponentialInterpolate(n.time,n.value,s.time,s.value,t):n.value,o},e.TimelineSignal.prototype.connect=e.SignalBase.prototype.connect,e.TimelineSignal.prototype._exponentialApproach=function(e,t,n,s,o){return n+(t-n)*Math.exp(-(o-e)/s)},e.TimelineSignal.prototype._linearInterpolate=function(e,t,n,s,o){return t+(o-e)/(n-e)*(s-t)},e.TimelineSignal.prototype._exponentialInterpolate=function(e,t,n,s,o){return(t=Math.max(this._minOutput,t))*(s/t)**((o-e)/(n-e))},e.TimelineSignal.prototype._curveInterpolate=function(e,t,n,s){if(o=t.length,e+n<=s)return t[o-1];if(s<=e)return t[0];var o,i=(s-e)/n,a=Math.floor((o-1)*i),r=Math.ceil((o-1)*i),c=t[a],l=t[r];return r===a?c:this._linearInterpolate(a,c,r,l,i*(o-1))},e.TimelineSignal.prototype.dispose=function(){e.Signal.prototype.dispose.call(this),e.Param.prototype.dispose.call(this),this._events.dispose(),this._events=null},e.TimelineSignal}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(4),n(1),n(2)],s=function(e){"use strict";return e.Scale=function(t,n){this._outputMin=this.defaultArg(t,0),this._outputMax=this.defaultArg(n,1),this._scale=this.input=new e.Multiply(1),this._add=this.output=new e.Add(0),this._scale.connect(this._add),this._setRange()},e.extend(e.Scale,e.SignalBase),Object.defineProperty(e.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(e){this._outputMin=e,this._setRange()}}),Object.defineProperty(e.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(e){this._outputMax=e,this._setRange()}}),e.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},e.Scale.prototype.dispose=function(){return e.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},e.Scale}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(16),n(30),n(31),n(12)],s=function(e){return e.Type={Default:"number",Time:"time",Frequency:"frequency",TransportTime:"transportTime",Ticks:"ticks",NormalRange:"normalRange",AudioRange:"audioRange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",BarsBeatsSixteenths:"barsBeatsSixteenths",Samples:"samples",Hertz:"hertz",Note:"note",Milliseconds:"milliseconds",Seconds:"seconds",Notation:"notation"},e.prototype.toSeconds=function(t){return this.isNumber(t)?t:this.isUndef(t)?this.now():this.isString(t)?new e.Time(t).toSeconds():t instanceof e.TimeBase?t.toSeconds():0[0]},e.prototype.toFrequency=function(t){return this.isNumber(t)?t:this.isString(t)||this.isUndef(t)?new e.Frequency(t).valueOf():t instanceof e.TimeBase?t.toFrequency():0[0]},e.prototype.toTicks=function(t){return this.isNumber(t)||this.isString(t)?new e.TransportTime(t).toTicks():this.isUndef(t)?e.Transport.ticks:t instanceof e.TimeBase?t.toTicks():0[0]},e}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(18),n(9)],s=function(e){"use strict";return window.GainNode&&!AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),e.Gain=function(){var t=this.optionsObject(arguments,["gain","units"],e.Gain.defaults);this.input=this.output=this._gainNode=this.context.createGain(),this.gain=new e.Param({param:this._gainNode.gain,units:t.units,value:t.gain,convert:t.convert}),this._readOnly("gain")},e.extend(e.Gain),e.Gain.defaults={gain:1,convert:!0},e.Gain.prototype.dispose=function(){e.Param.prototype.dispose.call(this),this._gainNode.disconnect(),this._gainNode=null,this._writable("gain"),this.gain.dispose(),this.gain=null},e.prototype.createInsOuts=function(t,n){1===t?this.input=new e.Gain:1<t&&(this.input=new Array(t)),1===n?this.output=new e.Gain:1<n&&(this.output=new Array(t))},e.Gain}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(7),n(39),n(14),n(12)],s=function(e){"use strict";return e.Clock=function(){e.Emitter.call(this);var t=this.optionsObject(arguments,["callback","frequency"],e.Clock.defaults);this.callback=t.callback,this._nextTick=0,this._lastState=e.State.Stopped,this.frequency=new e.TimelineSignal(t.frequency,e.Type.Frequency),this._readOnly("frequency"),this.ticks=0,this._state=new e.TimelineState(e.State.Stopped),this._boundLoop=this._loop.bind(this),this.context.on("tick",this._boundLoop)},e.extend(e.Clock,e.Emitter),e.Clock.defaults={callback:e.noOp,frequency:1,lookAhead:"auto"},Object.defineProperty(e.Clock.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}}),e.Clock.prototype.start=function(t,n){return t=this.toSeconds(t),this._state.getValueAtTime(t)!==e.State.Started&&this._state.add({state:e.State.Started,time:t,offset:n}),this},e.Clock.prototype.stop=function(t){return t=this.toSeconds(t),this._state.cancel(t),this._state.setStateAtTime(e.State.Stopped,t),this},e.Clock.prototype.pause=function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)===e.State.Started&&this._state.setStateAtTime(e.State.Paused,t),this},e.Clock.prototype._loop=function(){for(var t,n,s,o=this.now()+this.context.lookAhead+this.context.updateInterval+2*this.context.lag;o>this._nextTick&&this._state;)t=this._state.getValueAtTime(this._nextTick),t!==this._lastState&&(this._lastState=t,n=this._state.get(this._nextTick),t===e.State.Started?(this._nextTick=n.time,this.isUndef(n.offset)||(this.ticks=n.offset),this.emit("start",n.time,this.ticks)):t===e.State.Stopped?(this.ticks=0,this.emit("stop",n.time)):t===e.State.Paused&&this.emit("pause",n.time)),s=this._nextTick,this.frequency&&(this._nextTick+=1/this.frequency.getValueAtTime(this._nextTick),t===e.State.Started&&(this.callback(s),this.ticks++))},e.Clock.prototype.getStateAtTime=function(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)},e.Clock.prototype.dispose=function(){e.Emitter.prototype.dispose.call(this),this.context.off("tick",this._boundLoop),this._writable("frequency"),this.frequency.dispose(),this.frequency=null,this._boundLoop=null,this._nextTick=1/0,this.callback=null,this._state.dispose(),this._state=null},e.Clock}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(14)],s=function(e){function n(n,s,o){if(n.input)Array.isArray(n.input)?(e.prototype.isUndef(o)&&(o=0),this.connect(n.input[o])):this.connect(n.input,s,o);else try{n instanceof AudioNode?t.call(this,n,s,o):t.call(this,n,s)}catch(e){throw new Error("error connecting to node: "+n+`
`+e)}}var t,s;return!window.hasOwnProperty("AudioContext")&&window.hasOwnProperty("webkitAudioContext")&&(window.AudioContext=window.webkitAudioContext),e.Context=function(t){for(var n in e.Emitter.call(this),t=t||new window.AudioContext,this._context=t,this._context)this._defineProperty(this._context,n);this._latencyHint="interactive",this._lookAhead=.1,this._updateInterval=this._lookAhead/3,this._computedUpdateInterval=0,this._worker=this._createWorker(),this._constants={}},e.extend(e.Context,e.Emitter),e.Emitter.mixin(e.Context),e.Context.prototype._defineProperty=function(e,t){this.isUndef(this[t])&&Object.defineProperty(this,t,{get:function(){return"function"==typeof e[t]?e[t].bind(e):e[t]},set:function(n){e[t]=n}})},e.Context.prototype.now=function(){return this._context.currentTime},e.Context.prototype._createWorker=function(){window.URL=window.URL||window.webkitURL;var t=new Blob(["var timeoutTime = "+(1e3*this._updateInterval).toFixed(1)+";self.onmessage = function(msg){	timeoutTime = parseInt(msg.data);};function tick(){	setTimeout(tick, timeoutTime);	self.postMessage('tick');}tick();"]),n=URL.createObjectURL(t),e=new Worker(n);return e.addEventListener("message",function(){this.emit("tick")}.bind(this)),e.addEventListener("message",function(){var t,e=this.now();this.isNumber(this._lastUpdate)&&(t=e-this._lastUpdate,this._computedUpdateInterval=Math.max(t,.97*this._computedUpdateInterval)),this._lastUpdate=e}.bind(this)),e},e.Context.prototype.getConstant=function(e){if(this._constants[e])return this._constants[e];for(var t,s=this._context.createBuffer(1,128,this._context.sampleRate),o=s.getChannelData(0),n=0;n<o.length;n++)o[n]=e;return t=this._context.createBufferSource(),t.channelCount=1,t.channelCountMode="explicit",t.buffer=s,t.loop=!0,t.start(0),this._constants[e]=t},Object.defineProperty(e.Context.prototype,"lag",{get:function(){var e=this._computedUpdateInterval-this._updateInterval;return e=Math.max(e,0)}}),Object.defineProperty(e.Context.prototype,"lookAhead",{get:function(){return this._lookAhead},set:function(e){this._lookAhead=e}}),Object.defineProperty(e.Context.prototype,"updateInterval",{get:function(){return this._updateInterval},set:function(t){this._updateInterval=Math.max(t,e.prototype.blockTime),this._worker.postMessage(Math.max(1e3*t,1))}}),Object.defineProperty(e.Context.prototype,"latencyHint",{get:function(){return this._latencyHint},set:function(e){var t=e;if(this._latencyHint=e,this.isString(e))switch(e){case"interactive":t=.1,this._context.latencyHint=e;break;case"playback":t=.8,this._context.latencyHint=e;break;case"balanced":t=.25,this._context.latencyHint=e;break;case"fastest":t=.01}this.lookAhead=t,this.updateInterval=t/3}}),e.supported?(t=AudioNode.prototype.connect,s=AudioNode.prototype.disconnect,AudioNode.prototype.connect!==n&&(AudioNode.prototype.connect=n,AudioNode.prototype.disconnect=function(t,n,o){if(t&&t.input&&Array.isArray(t.input))e.prototype.isUndef(o)&&(o=0),this.disconnect(t.input[o],n,o);else if(t&&t.input)this.disconnect(t.input,n,o);else try{s.apply(this,arguments)}catch(e){throw new Error("error disconnecting node: "+t+`
`+e)}}),e.context=new e.Context):console.warn("This browser does not support Tone.js"),e.Context}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(4),n(20),n(2),n(10)],s=function(e){"use strict";return e.Subtract=function(t){this.createInsOuts(2,0),this._sum=this.input[0]=this.output=new e.Gain,this._neg=new e.Negate,this._param=this.input[1]=new e.Signal(t),this._param.chain(this._neg,this._sum)},e.extend(e.Subtract,e.Signal),e.Subtract.prototype.dispose=function(){return e.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this._param.dispose(),this._param=null,this},e.Subtract}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0)],s=function(e){"use strict";return e.Emitter=function(){this._events={}},e.extend(e.Emitter),e.Emitter.prototype.on=function(e,t){for(var n,o=e.split(/\W+/),s=0;s<o.length;s++)n=o[s],this._events.hasOwnProperty(n)||(this._events[n]=[]),this._events[n].push(t);return this},e.Emitter.prototype.off=function(t,n){for(var s,o,a=t.split(/\W+/),i=0;i<a.length;i++)if(t=a[i],this._events.hasOwnProperty(t))if(e.prototype.isUndef(n))this._events[t]=[];else for(o=this._events[t],s=0;s<o.length;s++)o[s]===n&&o.splice(s,1);return this},e.Emitter.prototype.emit=function(e){if(this._events&&(n=Array.apply(null,arguments).slice(1),this._events.hasOwnProperty(e)))for(var n,s=this._events[e],t=0,o=s.length;t<o;t++)s[t].apply(this,n);return this},e.Emitter.mixin=function(t){s=["on","off","emit"],t._events={};for(n=0;n<s.length;n++){var n,s,o=s[n],i=e.Emitter.prototype[o];t[o]=i}},e.Emitter.prototype.dispose=function(){return e.prototype.dispose.call(this),this._events=null,this},e.Emitter}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0)],s=function(e){"use strict";return e.SignalBase=function(){},e.extend(e.SignalBase),e.SignalBase.prototype.connect=function(t,n,s){return e.Signal&&e.Signal===t.constructor||e.Param&&e.Param===t.constructor||e.TimelineSignal&&e.TimelineSignal===t.constructor?(t._param.cancelScheduledValues(0),t._param.value=0,t.overridden=!0):t instanceof AudioParam&&(t.cancelScheduledValues(0),t.value=0),e.prototype.connect.call(this,t,n,s),this},e.SignalBase}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(17)],s=function(e){return e.Time=function(t,n){if(!(this instanceof e.Time))return new e.Time(t,n);this._plusNow=!1,e.TimeBase.call(this,t,n)},e.extend(e.Time,e.TimeBase),e.Time.prototype._unaryExpressions=Object.create(e.TimeBase.prototype._unaryExpressions),e.Time.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(t){return e.Transport.nextSubdivision(t())}},e.Time.prototype._unaryExpressions.now={regexp:/^\+/,method:function(e){return this._plusNow=!0,e()}},e.Time.prototype.quantize=function(e,t){return t=this.defaultArg(t,1),this._expr=function(e,t,n){return e=e(),t=t.toSeconds(),e+(Math.round(e/t)*t-e)*n}.bind(this,this._expr,new this.constructor(e),t),this},e.Time.prototype.addNow=function(){return this._plusNow=!0,this},e.Time.prototype._defaultExpr=function(){return this._plusNow=!0,this._noOp},e.Time.prototype.copy=function(t){return e.TimeBase.prototype.copy.call(this,t),this._plusNow=t._plusNow,this},e.Time.prototype.toNotation=function(){var e=this.toSeconds(),t=this._toNotationHelper(e,["1m","2n","4n","8n","16n","32n","64n","128n"]),n=this._toNotationHelper(e,["1m","2n","2t","4n","4t","8n","8t","16n","16t","32n","32t","64n","64t","128n"]);return n.split("+").length<t.split("+").length?n:t},e.Time.prototype._toNotationHelper=function(e,t){for(var n,i,a=this._notationToUnits(t[t.length-1]),s="",o=0;o<t.length;o++)if(i=this._notationToUnits(t[o]),n=e/i,1-n%1<1e-6&&(n+=1e-6),0<(n=Math.floor(n))){if(s+=1===n?t[o]:n.toString()+"*"+t[o],(e-=n*i)<a)break;s+=" + "}return""===s&&(s="0"),s},e.Time.prototype._notationToUnits=function(e){for(var s,o,t=this._primaryExpressions,i=[t.n,t.t,t.m],n=0;n<i.length;n++)if(s=i[n],o=e.match(s.regexp),o)return s.method.call(this,o[1])},e.Time.prototype.toBarsBeatsSixteenths=function(){var n=this._beatsToUnits(1),e=this.toSeconds()/n,s=Math.floor(e/this._timeSignature()),t=e%1*4;return e=Math.floor(e)%this._timeSignature(),3<(t=t.toString()).length&&(t=parseFloat(t).toFixed(3)),[s,e,t].join(":")},e.Time.prototype.toTicks=function(){var t=this._beatsToUnits(1),n=this.valueOf()/t;return Math.floor(n*e.Transport.PPQ)},e.Time.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate},e.Time.prototype.toFrequency=function(){return 1/this.toSeconds()},e.Time.prototype.toSeconds=function(){return this.valueOf()},e.Time.prototype.toMilliseconds=function(){return 1e3*this.toSeconds()},e.Time.prototype.valueOf=function(){return this._expr()+(this._plusNow?this.now():0)},e.Time}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0)],s=function(e){return e.TimeBase=function(t,n){if(!(this instanceof e.TimeBase))return new e.TimeBase(t,n);if(this._expr=this._noOp,t instanceof e.TimeBase)this.copy(t);else if(!this.isUndef(n)||this.isNumber(t)){n=this.defaultArg(n,this._defaultUnits);var s=this._primaryExpressions[n].method;this._expr=s.bind(this,t)}else this.isString(t)?this.set(t):this.isUndef(t)&&(this._expr=this._defaultExpr())},e.extend(e.TimeBase),e.TimeBase.prototype.set=function(e){return this._expr=this._parseExprString(e),this},e.TimeBase.prototype.clone=function(){var e=new this.constructor;return e.copy(this),e},e.TimeBase.prototype.copy=function(e){var t=e._expr();return this.set(t)},e.TimeBase.prototype._primaryExpressions={n:{regexp:/^(\d+)n/i,method:function(e){return 1===(e=parseInt(e))?this._beatsToUnits(this._timeSignature()):this._beatsToUnits(4/e)}},t:{regexp:/^(\d+)t/i,method:function(e){return e=parseInt(e),this._beatsToUnits(8/(3*parseInt(e)))}},m:{regexp:/^(\d+)m/i,method:function(e){return this._beatsToUnits(parseInt(e)*this._timeSignature())}},i:{regexp:/^(\d+)i/i,method:function(e){return this._ticksToUnits(parseInt(e))}},hz:{regexp:/^(\d+(?:\.\d+)?)hz/i,method:function(e){return this._frequencyToUnits(parseFloat(e))}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(e,t,n){var s=0;return e&&"0"!==e&&(s+=this._beatsToUnits(this._timeSignature()*parseFloat(e))),t&&"0"!==t&&(s+=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(s+=this._beatsToUnits(parseFloat(n)/4)),s}},s:{regexp:/^(\d+(?:\.\d+)?s)/,method:function(e){return this._secondsToUnits(parseFloat(e))}},samples:{regexp:/^(\d+)samples/,method:function(e){return parseInt(e)/this.context.sampleRate}},default:{regexp:/^(\d+(?:\.\d+)?)/,method:function(e){return this._primaryExpressions[this._defaultUnits].method.call(this,e)}}},e.TimeBase.prototype._binaryExpressions={"+":{regexp:/^\+/,precedence:2,method:function(e,t){return e()+t()}},"-":{regexp:/^-/,precedence:2,method:function(e,t){return e()-t()}},"*":{regexp:/^\*/,precedence:1,method:function(e,t){return e()*t()}},"/":{regexp:/^\//,precedence:1,method:function(e,t){return e()/t()}}},e.TimeBase.prototype._unaryExpressions={neg:{regexp:/^-/,method:function(e){return-e()}}},e.TimeBase.prototype._syntaxGlue={"(":{regexp:/^\(/},")":{regexp:/^\)/}},e.TimeBase.prototype._tokenize=function(e){for(var n,s=-1,t=[];0<e.length;)n=o(e=e.trim(),this),t.push(n),e=e.substr(n.value.length);function o(e,t){for(o=["_binaryExpressions","_unaryExpressions","_primaryExpressions","_syntaxGlue"],n=0;n<o.length;n++){i=t[o[n]];for(r in i){var n,o,i,r,s=i[r],c=s.regexp,a=e.match(c);if(null!==a)return{method:s.method,precedence:s.precedence,regexp:s.regexp,value:a[0]}}}throw new SyntaxError("Tone.TimeBase: Unexpected token "+e)}return{next:function(){return t[++s]},peek:function(){return t[s+1]}}},e.TimeBase.prototype._matchGroup=function(e,t,n){if(!this.isUndef(e))for(o in t){var o,s=t[o];if(s.regexp.test(e.value)){if(this.isUndef(n))return s;if(s.precedence===n)return s}}return!1},e.TimeBase.prototype._parseBinary=function(e,t){this.isUndef(t)&&(t=2);for(var s=t<0?this._parseUnary(e):this._parseBinary(e,t-1),n=e.peek();n&&this._matchGroup(n,this._binaryExpressions,t);)s=(n=e.next()).method.bind(this,s,this._parseBinary(e,t-1)),n=e.peek();return s},e.TimeBase.prototype._parseUnary=function(e){var n,t=e.peek(),s=this._matchGroup(t,this._unaryExpressions);return s?(t=e.next(),n=this._parseUnary(e),s.method.bind(this,n)):this._parsePrimary(e)},e.TimeBase.prototype._parsePrimary=function(e){if(t=e.peek(),this.isUndef(t))throw new SyntaxError("Tone.TimeBase: Unexpected end of expression");if(this._matchGroup(t,this._primaryExpressions)){var t,s,n=(t=e.next()).value.match(t.regexp);return t.method.bind(this,n[1],n[2],n[3])}if(t&&"("===t.value){if(e.next(),s=this._parseBinary(e),!(t=e.next())||")"!==t.value)throw new SyntaxError("Expected )");return s}throw new SyntaxError("Tone.TimeBase: Cannot process token "+t.value)},e.TimeBase.prototype._parseExprString=function(e){this.isString(e)||(e=e.toString());var t=this._tokenize(e);return this._parseBinary(t)},e.TimeBase.prototype._noOp=function(){return 0},e.TimeBase.prototype._defaultExpr=function(){return this._noOp},e.TimeBase.prototype._defaultUnits="s",e.TimeBase.prototype._frequencyToUnits=function(e){return 1/e},e.TimeBase.prototype._beatsToUnits=function(t){return 60/e.Transport.bpm.value*t},e.TimeBase.prototype._secondsToUnits=function(e){return e},e.TimeBase.prototype._ticksToUnits=function(t){return t*(this._beatsToUnits(1)/e.Transport.PPQ)},e.TimeBase.prototype._timeSignature=function(){return e.Transport.timeSignature},e.TimeBase.prototype._pushExpr=function(t,n,s){return t instanceof e.TimeBase||(t=new this.constructor(t,s)),this._expr=this._binaryExpressions[n].method.bind(this,this._expr,t._expr),this},e.TimeBase.prototype.add=function(e,t){return this._pushExpr(e,"+",t)},e.TimeBase.prototype.sub=function(e,t){return this._pushExpr(e,"-",t)},e.TimeBase.prototype.mult=function(e,t){return this._pushExpr(e,"*",t)},e.TimeBase.prototype.div=function(e,t){return this._pushExpr(e,"/",t)},e.TimeBase.prototype.valueOf=function(){return this._expr()},e.TimeBase.prototype.dispose=function(){this._expr=null},e.TimeBase}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(9)],s=function(e){"use strict";return e.Param=function(){var t=this.optionsObject(arguments,["param","units","convert"],e.Param.defaults);this._param=this.input=t.param,this.units=t.units,this.convert=t.convert,this.overridden=!1,this._lfo=null,this.isObject(t.lfo)?this.value=t.lfo:this.isUndef(t.value)||(this.value=t.value)},e.extend(e.Param),e.Param.defaults={units:e.Type.Default,convert:!0,param:0[0]},Object.defineProperty(e.Param.prototype,"value",{get:function(){return this._toUnits(this._param.value)},set:function(t){if(this.isObject(t)){if(this.isUndef(e.LFO))throw new Error("Include 'Tone.LFO' to use an LFO as a Param value.");this._lfo&&this._lfo.dispose(),this._lfo=new e.LFO(t).start(),this._lfo.connect(this.input)}else{var n=this._fromUnits(t);this._param.cancelScheduledValues(0),this._param.value=n}}}),e.Param.prototype._fromUnits=function(t){if(!this.convert&&!this.isUndef(this.convert))return t;switch(this.units){case e.Type.Time:return this.toSeconds(t);case e.Type.Frequency:return this.toFrequency(t);case e.Type.Decibels:return this.dbToGain(t);case e.Type.NormalRange:return Math.min(Math.max(t,0),1);case e.Type.AudioRange:return Math.min(Math.max(t,-1),1);case e.Type.Positive:return Math.max(t,0);default:return t}},e.Param.prototype._toUnits=function(t){if(!this.convert&&!this.isUndef(this.convert))return t;switch(this.units){case e.Type.Decibels:return this.gainToDb(t);default:return t}},e.Param.prototype._minOutput=1e-5,e.Param.prototype.setValueAtTime=function(e,t){return e=this._fromUnits(e),(t=this.toSeconds(t))<=this.now()+this.blockTime?this._param.value=e:this._param.setValueAtTime(e,t),this},e.Param.prototype.setRampPoint=function(e){e=this.defaultArg(e,this.now());var t=this._param.value;return 0===t&&(t=this._minOutput),this._param.setValueAtTime(t,e),this},e.Param.prototype.linearRampToValueAtTime=function(e,t){return e=this._fromUnits(e),this._param.linearRampToValueAtTime(e,this.toSeconds(t)),this},e.Param.prototype.exponentialRampToValueAtTime=function(e,t){return e=this._fromUnits(e),e=Math.max(this._minOutput,e),this._param.exponentialRampToValueAtTime(e,this.toSeconds(t)),this},e.Param.prototype.exponentialRampToValue=function(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this},e.Param.prototype.linearRampToValue=function(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this},e.Param.prototype.setTargetAtTime=function(e,t,n){return e=this._fromUnits(e),e=Math.max(this._minOutput,e),n=Math.max(this._minOutput,n),this._param.setTargetAtTime(e,this.toSeconds(t),n),this},e.Param.prototype.setValueCurveAtTime=function(e,t,n){for(var s=0;s<e.length;s++)e[s]=this._fromUnits(e[s]);return this._param.setValueCurveAtTime(e,this.toSeconds(t),this.toSeconds(n)),this},e.Param.prototype.cancelScheduledValues=function(e){return this._param.cancelScheduledValues(this.toSeconds(e)),this},e.Param.prototype.rampTo=function(t,n,s){return n=this.defaultArg(n,0),this.units===e.Type.Frequency||this.units===e.Type.BPM||this.units===e.Type.Decibels?this.exponentialRampToValue(t,n,s):this.linearRampToValue(t,n,s),this},Object.defineProperty(e.Param.prototype,"lfo",{get:function(){return this._lfo}}),e.Param.prototype.dispose=function(){return e.prototype.dispose.call(this),this._param=null,this._lfo&&(this._lfo.dispose(),this._lfo=null),this},e.Param}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(9)],s=function(e){"use strict";return e.Timeline=function(){var t=this.optionsObject(arguments,["memory"],e.Timeline.defaults);this._timeline=[],this._toRemove=[],this._iterating=!1,this.memory=t.memory},e.extend(e.Timeline),e.Timeline.defaults={memory:1/0},Object.defineProperty(e.Timeline.prototype,"length",{get:function(){return this._timeline.length}}),e.Timeline.prototype.add=function(e){if(this.isUndef(e.time))throw new Error("Tone.Timeline: events must have a time attribute");if(this._timeline.length){var t,n=this._search(e.time);this._timeline.splice(n+1,0,e)}else this._timeline.push(e);return this.length>this.memory&&(t=this.length-this.memory,this._timeline.splice(0,t)),this},e.Timeline.prototype.remove=function(e){if(this._iterating)this._toRemove.push(e);else{var t=this._timeline.indexOf(e);-1!==t&&this._timeline.splice(t,1)}return this},e.Timeline.prototype.get=function(e){var t=this._search(e);return-1!==t?this._timeline[t]:null},e.Timeline.prototype.peek=function(){return this._timeline[0]},e.Timeline.prototype.shift=function(){return this._timeline.shift()},e.Timeline.prototype.getAfter=function(e){var t=this._search(e);return t+1<this._timeline.length?this._timeline[t+1]:null},e.Timeline.prototype.getBefore=function(e){var n,t=this._timeline.length;return 0<t&&this._timeline[t-1].time<e?this._timeline[t-1]:(n=this._search(e),0<=n-1?this._timeline[n-1]:null)},e.Timeline.prototype.cancel=function(e){if(1<this._timeline.length){var n,t=this._search(e);if(0<=t)if(this._timeline[t].time===e){for(n=t;0<=n&&this._timeline[n].time===e;n--)t=n;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else 1===this._timeline.length&&this._timeline[0].time>=e&&(this._timeline=[]);return this},e.Timeline.prototype.cancelBefore=function(e){if(this._timeline.length){var t=this._search(e);0<=t&&(this._timeline=this._timeline.slice(t+1))}return this},e.Timeline.prototype._search=function(e){var n,s=0,o=this._timeline.length,a=o;if(0<o&&this._timeline[o-1].time<=e)return o-1;for(;s<a;){var t=Math.floor(s+(a-s)/2),i=this._timeline[t],r=this._timeline[t+1];if(i.time===e){for(n=t;n<this._timeline.length;n++)this._timeline[n].time===e&&(t=n);return t}if(i.time<e&&r.time>e)return t;i.time>e?a=t:i.time<e&&(s=t+1)}return-1},e.Timeline.prototype._iterate=function(e,t,n){this._iterating=!0,t=this.defaultArg(t,0),n=this.defaultArg(n,this._timeline.length-1);for(var s,i,o=t;o<=n;o++)e(this._timeline[o]);if(this._iterating=!1,0<this._toRemove.length){for(s=0;s<this._toRemove.length;s++)i=this._timeline.indexOf(this._toRemove[s]),-1!==i&&this._timeline.splice(i,1);this._toRemove=[]}},e.Timeline.prototype.forEach=function(e){return this._iterate(e),this},e.Timeline.prototype.forEachBefore=function(e,t){var n=this._search(e);return-1!==n&&this._iterate(t,0,n),this},e.Timeline.prototype.forEachAfter=function(e,t){var n=this._search(e);return this._iterate(t,n+1),this},e.Timeline.prototype.forEachFrom=function(e,t){for(var n=this._search(e);0<=n&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this},e.Timeline.prototype.forEachAtTime=function(e,t){var n=this._search(e);return-1!==n&&this._iterate(function(n){n.time===e&&t(n)},0,n),this},e.Timeline.prototype.dispose=function(){e.prototype.dispose.call(this),this._timeline=null,this._toRemove=null},e.Timeline}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(1),n(2)],s=function(e){"use strict";return e.Negate=function(){this._multiply=this.input=this.output=new e.Multiply(-1)},e.extend(e.Negate,e.SignalBase),e.Negate.prototype.dispose=function(){return e.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},e.Negate}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(2),n(1),n(6)],s=function(e){"use strict";return e.GreaterThanZero=function(){this._thresh=this.output=new e.WaveShaper(function(e){return e<=0?0:1},127),this._scale=this.input=new e.Multiply(1e4),this._scale.connect(this._thresh)},e.extend(e.GreaterThanZero,e.SignalBase),e.GreaterThanZero.prototype.dispose=function(){return e.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},e.GreaterThanZero}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t){var s,o,i;!function(n,a){!(i=[],s=a,o=typeof s=="function"?s.apply(t,i):s,o!==0[0]&&(e.exports=o))}(this,function(){var e=function(e,t){this._dragged=!1,this._element=e,this._bindedMove=this._moved.bind(this),this._bindedEnd=this._ended.bind(this,t),e.addEventListener("touchstart",this._bindedEnd),e.addEventListener("touchmove",this._bindedMove),e.addEventListener("touchend",this._bindedEnd),e.addEventListener("mouseup",this._bindedEnd)};function t(e){return"running"===e.state}return e.prototype._moved=function(){this._dragged=!0},e.prototype._ended=function(e){this._dragged||function(e){var n=e.createBuffer(1,1,e.sampleRate),t=e.createBufferSource();t.buffer=n,t.connect(e.destination),t.start(0),e.resume&&e.resume()}(e),this._dragged=!1},e.prototype.dispose=function(){this._element.removeEventListener("touchstart",this._bindedEnd),this._element.removeEventListener("touchmove",this._bindedMove),this._element.removeEventListener("touchend",this._bindedEnd),this._element.removeEventListener("mouseup",this._bindedEnd),this._bindedMove=null,this._bindedEnd=null,this._element=null},function(n,s,o){var a=new Promise(function(e){!function(e,n){t(e)?n():function s(){t(e)?n():(requestAnimationFrame(s),e.resume&&e.resume())}()}(n,e)}),i=[];return function t(n,s,o){if(Array.isArray(n)||NodeList&&n instanceof NodeList)for(var a,i=0;i<n.length;i++)t(n[i],s,o);else"string"==typeof n?t(document.querySelectorAll(n),s,o):n.jquery&&"function"==typeof n.toArray?t(n.toArray(),s,o):Element&&n instanceof Element&&(a=new e(n,o),s.push(a))}(s=s||document.body,i,n),a.then(function(){for(var e=0;e<i.length;e++)i[e].dispose();i=null,o&&o()}),a}})},function(e,t,n){var s,o;!(o=[n(0),n(2),n(32),n(38),n(10)],s=function(e){"use strict";return e.CrossFade=function(t){this.createInsOuts(2,1),this.a=this.input[0]=new e.Gain,this.b=this.input[1]=new e.Gain,this.fade=new e.Signal(this.defaultArg(t,.5),e.Type.NormalRange),this._equalPowerA=new e.EqualPowerGain,this._equalPowerB=new e.EqualPowerGain,this._invert=new e.Expr("1 - $0"),this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),this.fade.chain(this._invert,this._equalPowerA,this.a.gain),this._readOnly("fade")},e.extend(e.CrossFade),e.CrossFade.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this.a.dispose(),this.a=null,this.b.dispose(),this.b=null,this},e.CrossFade}.apply(t,o),s!==0[0]&&(e.exports=s))},function(){!function(){var e,t=[];function i(e){var i,a,r=this,s={},o=-1;this.parameters.forEach(function(e,n){var i=t[++o]||(t[o]=new Float32Array(r.bufferSize));i.fill(e.value),s[n]=i}),this.processor.realm.exec("self.sampleRate=sampleRate="+this.context.sampleRate+";self.currentTime=currentTime="+this.context.currentTime),i=n(e.inputBuffer),a=n(e.outputBuffer),this.instance.process([i],[a],s)}function n(e){for(var n=[],t=0;t<e.numberOfChannels;t++)n[t]=e.getChannelData(t);return n}function s(e){return e.$$processors||(e.$$processors={})}function o(e){this.$$context=e}"function"!=typeof AudioWorkletNode&&(self.AudioWorkletNode=function(t,n,o){var c,l,d,u,h,r=s(t)[n],a=t.createScriptProcessor(0[0],2,o&&o.outputChannelCount?o.outputChannelCount[0]:2);if(a.parameters=new Map,r.properties)for(c=0;c<r.properties.length;c++)l=r.properties[c],d=t.createGain().gain,d.value=l.defaultValue,a.parameters.set(l.name,d);return u=new MessageChannel,e=u.port2,h=new r.Processor(o||{}),e=null,a.port=u.port1,a.processor=r,a.instance=h,a.onaudioprocess=i,a},Object.defineProperty((self.AudioContext||self.webkitAudioContext).prototype,"audioWorklet",{get:function(){return this.$$audioWorklet||(this.$$audioWorklet=new self.AudioWorklet(this))}}),self.AudioWorklet=(o.prototype.addModule=function(t,n){var o=this;return fetch(t).then(function(e){if(!e.ok)throw Error(e.status);return e.text()}).then(function(t){var i={sampleRate:0,currentTime:0,AudioWorkletProcessor:function(){this.port=e},registerProcessor:function(e,t){s(o.$$context)[e]={realm:a,context:i,Processor:t,properties:t.parameterDescriptors||[]}}},a=new function(e,t){s=document.createElement("iframe"),s.style.cssText="position:absolute;left:0;top:-999px;width:1px;height:1px;",t.appendChild(s);var s,a,r,c,o=s.contentWindow,i=o.document,n="var window,$hook";for(a in o)a in e||"eval"===a||(n+=",",n+=a);for(c in e)n+=",",n+=c,n+="=self.",n+=c;r=i.createElement("script"),r.appendChild(i.createTextNode(`function $hook(self,console) {"use strict";
        `+n+";return function() {return eval(arguments[0])}}")),i.body.appendChild(r),this.exec=o.$hook(e,console)}(i.self=i,document.documentElement);return a.exec((n&&n.transpile||String)(t)),null})},o))}()},function(){(function(){function e(e){if(!e)return;e.setTargetAtTime||(e.setTargetAtTime=e.setTargetValueAtTime)}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=window.webkitAudioContext,typeof AudioContext.prototype.createGain!="function"&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),typeof AudioContext.prototype.createDelay!="function"&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),typeof AudioContext.prototype.createScriptProcessor!="function"&&(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),typeof AudioContext.prototype.createPeriodicWave!="function"&&(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var t=this.internal_createGain();return e(t.gain),t},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(t){var n=t?this.internal_createDelay(t):this.internal_createDelay();return e(n.delayTime),n},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var t=this.internal_createBufferSource();return t.start?(t.internal_start=t.start,t.start=function(e,n,s){typeof s!="undefined"?t.internal_start(e||0,n,s):t.internal_start(e||0,n||0)}):t.start=function(e,t,n){t||n?this.noteGrainOn(e||0,t,n):this.noteOn(e||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(e){this.noteOff(e||0)},e(t.playbackRate),t},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var t=this.internal_createDynamicsCompressor();return e(t.threshold),e(t.knee),e(t.ratio),e(t.reduction),e(t.attack),e(t.release),t},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var t=this.internal_createBiquadFilter();return e(t.frequency),e(t.detune),e(t.Q),e(t.gain),t},typeof AudioContext.prototype.createOscillator!="function"&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var t=this.internal_createOscillator();return t.start?(t.internal_start=t.start,t.start=function(e){t.internal_start(e||0)}):t.start=function(e){this.noteOn(e||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(e){this.noteOff(e||0)},t.setPeriodicWave||(t.setPeriodicWave=t.setWaveTable),e(t.frequency),e(t.detune),t})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=window.webkitOfflineAudioContext)})(window),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var s,o,i,a,r,n=document.createElement("audio");p5.prototype.isSupported=function(){return!!n.canPlayType},s=function(){return!!n.canPlayType&&n.canPlayType('audio/ogg; codecs="vorbis"')},o=function(){return!!n.canPlayType&&n.canPlayType("audio/mpeg;")},i=function(){return!!n.canPlayType&&n.canPlayType('audio/wav; codecs="1"')},a=function(){return!!n.canPlayType&&(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/aac;"))},r=function(){return!!n.canPlayType&&n.canPlayType("audio/x-aiff;")},p5.prototype.isFileSupported=function(e){switch(e.toLowerCase()){case"mp3":return o();case"wav":return i();case"ogg":return s();case"aac":case"m4a":case"mp4":return a();case"aif":case"aiff":return r();default:return!1}}},function(e){var n=function(){return this}();try{n=n||new Function("return this")()}catch{"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t),t.default=`function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

// import dependencies via preval.require so that they're available as values at compile time
var processorNames = {
  "recorderProcessor": "recorder-processor",
  "soundFileProcessor": "sound-file-processor",
  "amplitudeProcessor": "amplitude-processor"
};
var RingBuffer = {
  "default":
  /*#__PURE__*/
  function () {
    /**
     * @constructor
     * @param  {number} length Buffer length in frames.
     * @param  {number} channelCount Buffer channel count.
     */
    function RingBuffer(length, channelCount) {
      _classCallCheck(this, RingBuffer);

      this._readIndex = 0;
      this._writeIndex = 0;
      this._framesAvailable = 0;
      this._channelCount = channelCount;
      this._length = length;
      this._channelData = [];

      for (var i = 0; i < this._channelCount; ++i) {
        this._channelData[i] = new Float32Array(length);
      }
    }
    /**
     * Getter for Available frames in buffer.
     *
     * @return {number} Available frames in buffer.
     */


    _createClass(RingBuffer, [{
      key: "push",

      /**
       * Push a sequence of Float32Arrays to buffer.
       *
       * @param  {array} arraySequence A sequence of Float32Arrays.
       */
      value: function push(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // Transfer data from the |arraySequence| storage to the internal buffer.
        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;

        for (var i = 0; i < sourceLength; ++i) {
          var writeIndex = (this._writeIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            this._channelData[channel][writeIndex] = arraySequence[channel][i];
          }
        }

        this._writeIndex += sourceLength;

        if (this._writeIndex >= this._length) {
          this._writeIndex = 0;
        } // For excessive frames, the buffer will be overwritten.


        this._framesAvailable += sourceLength;

        if (this._framesAvailable > this._length) {
          this._framesAvailable = this._length;
        }
      }
      /**
       * Pull data out of buffer and fill a given sequence of Float32Arrays.
       *
       * @param  {array} arraySequence An array of Float32Arrays.
       */

    }, {
      key: "pull",
      value: function pull(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // If the FIFO is completely empty, do nothing.
        if (this._framesAvailable === 0) {
          return;
        }

        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.

        for (var i = 0; i < destinationLength; ++i) {
          var readIndex = (this._readIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            arraySequence[channel][i] = this._channelData[channel][readIndex];
          }
        }

        this._readIndex += destinationLength;

        if (this._readIndex >= this._length) {
          this._readIndex = 0;
        }

        this._framesAvailable -= destinationLength;

        if (this._framesAvailable < 0) {
          this._framesAvailable = 0;
        }
      }
    }, {
      key: "framesAvailable",
      get: function get() {
        return this._framesAvailable;
      }
    }]);

    return RingBuffer;
  }()
}["default"];

var RecorderProcessor =
/*#__PURE__*/
function (_AudioWorkletProcesso) {
  _inherits(RecorderProcessor, _AudioWorkletProcesso);

  function RecorderProcessor(options) {
    var _this;

    _classCallCheck(this, RecorderProcessor);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(RecorderProcessor).call(this));
    var processorOptions = options.processorOptions || {};
    _this.numOutputChannels = options.outputChannelCount || 2;
    _this.numInputChannels = processorOptions.numInputChannels || 2;
    _this.bufferSize = processorOptions.bufferSize || 1024;
    _this.recording = false;

    _this.clear();

    _this.port.onmessage = function (event) {
      var data = event.data;

      if (data.name === 'start') {
        _this.record(data.duration);
      } else if (data.name === 'stop') {
        _this.stop();
      }
    };

    return _this;
  }

  _createClass(RecorderProcessor, [{
    key: "process",
    value: function process(inputs) {
      if (!this.recording) {
        return true;
      } else if (this.sampleLimit && this.recordedSamples >= this.sampleLimit) {
        this.stop();
        return true;
      }

      var input = inputs[0];
      this.inputRingBuffer.push(input);

      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {
        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);

        for (var channel = 0; channel < this.numOutputChannels; ++channel) {
          var inputChannelCopy = this.inputRingBufferArraySequence[channel].slice();

          if (channel === 0) {
            this.leftBuffers.push(inputChannelCopy);

            if (this.numInputChannels === 1) {
              this.rightBuffers.push(inputChannelCopy);
            }
          } else if (channel === 1 && this.numInputChannels > 1) {
            this.rightBuffers.push(inputChannelCopy);
          }
        }

        this.recordedSamples += this.bufferSize;
      }

      return true;
    }
  }, {
    key: "record",
    value: function record(duration) {
      if (duration) {
        this.sampleLimit = Math.round(duration * sampleRate);
      }

      this.recording = true;
    }
  }, {
    key: "stop",
    value: function stop() {
      this.recording = false;
      var buffers = this.getBuffers();
      var leftBuffer = buffers[0].buffer;
      var rightBuffer = buffers[1].buffer;
      this.port.postMessage({
        name: 'buffers',
        leftBuffer: leftBuffer,
        rightBuffer: rightBuffer
      }, [leftBuffer, rightBuffer]);
      this.clear();
    }
  }, {
    key: "getBuffers",
    value: function getBuffers() {
      var buffers = [];
      buffers.push(this.mergeBuffers(this.leftBuffers));
      buffers.push(this.mergeBuffers(this.rightBuffers));
      return buffers;
    }
  }, {
    key: "mergeBuffers",
    value: function mergeBuffers(channelBuffer) {
      var result = new Float32Array(this.recordedSamples);
      var offset = 0;
      var lng = channelBuffer.length;

      for (var i = 0; i < lng; i++) {
        var buffer = channelBuffer[i];
        result.set(buffer, offset);
        offset += buffer.length;
      }

      return result;
    }
  }, {
    key: "clear",
    value: function clear() {
      var _this2 = this;

      this.leftBuffers = [];
      this.rightBuffers = [];
      this.inputRingBuffer = new RingBuffer(this.bufferSize, this.numInputChannels);
      this.inputRingBufferArraySequence = new Array(this.numInputChannels).fill(null).map(function () {
        return new Float32Array(_this2.bufferSize);
      });
      this.recordedSamples = 0;
      this.sampleLimit = null;
    }
  }]);

  return RecorderProcessor;
}(_wrapNativeSuper(AudioWorkletProcessor));

registerProcessor(processorNames.recorderProcessor, RecorderProcessor);`},function(e,t,n){"use strict";n.r(t),t.default=`function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

// import dependencies via preval.require so that they're available as values at compile time
var processorNames = {
  "recorderProcessor": "recorder-processor",
  "soundFileProcessor": "sound-file-processor",
  "amplitudeProcessor": "amplitude-processor"
};
var RingBuffer = {
  "default":
  /*#__PURE__*/
  function () {
    /**
     * @constructor
     * @param  {number} length Buffer length in frames.
     * @param  {number} channelCount Buffer channel count.
     */
    function RingBuffer(length, channelCount) {
      _classCallCheck(this, RingBuffer);

      this._readIndex = 0;
      this._writeIndex = 0;
      this._framesAvailable = 0;
      this._channelCount = channelCount;
      this._length = length;
      this._channelData = [];

      for (var i = 0; i < this._channelCount; ++i) {
        this._channelData[i] = new Float32Array(length);
      }
    }
    /**
     * Getter for Available frames in buffer.
     *
     * @return {number} Available frames in buffer.
     */


    _createClass(RingBuffer, [{
      key: "push",

      /**
       * Push a sequence of Float32Arrays to buffer.
       *
       * @param  {array} arraySequence A sequence of Float32Arrays.
       */
      value: function push(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // Transfer data from the |arraySequence| storage to the internal buffer.
        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;

        for (var i = 0; i < sourceLength; ++i) {
          var writeIndex = (this._writeIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            this._channelData[channel][writeIndex] = arraySequence[channel][i];
          }
        }

        this._writeIndex += sourceLength;

        if (this._writeIndex >= this._length) {
          this._writeIndex = 0;
        } // For excessive frames, the buffer will be overwritten.


        this._framesAvailable += sourceLength;

        if (this._framesAvailable > this._length) {
          this._framesAvailable = this._length;
        }
      }
      /**
       * Pull data out of buffer and fill a given sequence of Float32Arrays.
       *
       * @param  {array} arraySequence An array of Float32Arrays.
       */

    }, {
      key: "pull",
      value: function pull(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // If the FIFO is completely empty, do nothing.
        if (this._framesAvailable === 0) {
          return;
        }

        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.

        for (var i = 0; i < destinationLength; ++i) {
          var readIndex = (this._readIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            arraySequence[channel][i] = this._channelData[channel][readIndex];
          }
        }

        this._readIndex += destinationLength;

        if (this._readIndex >= this._length) {
          this._readIndex = 0;
        }

        this._framesAvailable -= destinationLength;

        if (this._framesAvailable < 0) {
          this._framesAvailable = 0;
        }
      }
    }, {
      key: "framesAvailable",
      get: function get() {
        return this._framesAvailable;
      }
    }]);

    return RingBuffer;
  }()
}["default"];

var SoundFileProcessor =
/*#__PURE__*/
function (_AudioWorkletProcesso) {
  _inherits(SoundFileProcessor, _AudioWorkletProcesso);

  function SoundFileProcessor(options) {
    var _this;

    _classCallCheck(this, SoundFileProcessor);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(SoundFileProcessor).call(this));
    var processorOptions = options.processorOptions || {};
    _this.bufferSize = processorOptions.bufferSize || 256;
    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, 1);
    _this.inputRingBufferArraySequence = [new Float32Array(_this.bufferSize)];
    return _this;
  }

  _createClass(SoundFileProcessor, [{
    key: "process",
    value: function process(inputs) {
      var input = inputs[0]; // we only care about the first input channel, because that contains the position data

      this.inputRingBuffer.push([input[0]]);

      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {
        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);
        var inputChannel = this.inputRingBufferArraySequence[0];
        var position = inputChannel[inputChannel.length - 1] || 0;
        this.port.postMessage({
          name: 'position',
          position: position
        });
      }

      return true;
    }
  }]);

  return SoundFileProcessor;
}(_wrapNativeSuper(AudioWorkletProcessor));

registerProcessor(processorNames.soundFileProcessor, SoundFileProcessor);`},function(e,t,n){"use strict";n.r(t),t.default=`function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

// import dependencies via preval.require so that they're available as values at compile time
var processorNames = {
  "recorderProcessor": "recorder-processor",
  "soundFileProcessor": "sound-file-processor",
  "amplitudeProcessor": "amplitude-processor"
};
var RingBuffer = {
  "default":
  /*#__PURE__*/
  function () {
    /**
     * @constructor
     * @param  {number} length Buffer length in frames.
     * @param  {number} channelCount Buffer channel count.
     */
    function RingBuffer(length, channelCount) {
      _classCallCheck(this, RingBuffer);

      this._readIndex = 0;
      this._writeIndex = 0;
      this._framesAvailable = 0;
      this._channelCount = channelCount;
      this._length = length;
      this._channelData = [];

      for (var i = 0; i < this._channelCount; ++i) {
        this._channelData[i] = new Float32Array(length);
      }
    }
    /**
     * Getter for Available frames in buffer.
     *
     * @return {number} Available frames in buffer.
     */


    _createClass(RingBuffer, [{
      key: "push",

      /**
       * Push a sequence of Float32Arrays to buffer.
       *
       * @param  {array} arraySequence A sequence of Float32Arrays.
       */
      value: function push(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // Transfer data from the |arraySequence| storage to the internal buffer.
        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;

        for (var i = 0; i < sourceLength; ++i) {
          var writeIndex = (this._writeIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            this._channelData[channel][writeIndex] = arraySequence[channel][i];
          }
        }

        this._writeIndex += sourceLength;

        if (this._writeIndex >= this._length) {
          this._writeIndex = 0;
        } // For excessive frames, the buffer will be overwritten.


        this._framesAvailable += sourceLength;

        if (this._framesAvailable > this._length) {
          this._framesAvailable = this._length;
        }
      }
      /**
       * Pull data out of buffer and fill a given sequence of Float32Arrays.
       *
       * @param  {array} arraySequence An array of Float32Arrays.
       */

    }, {
      key: "pull",
      value: function pull(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // If the FIFO is completely empty, do nothing.
        if (this._framesAvailable === 0) {
          return;
        }

        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.

        for (var i = 0; i < destinationLength; ++i) {
          var readIndex = (this._readIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            arraySequence[channel][i] = this._channelData[channel][readIndex];
          }
        }

        this._readIndex += destinationLength;

        if (this._readIndex >= this._length) {
          this._readIndex = 0;
        }

        this._framesAvailable -= destinationLength;

        if (this._framesAvailable < 0) {
          this._framesAvailable = 0;
        }
      }
    }, {
      key: "framesAvailable",
      get: function get() {
        return this._framesAvailable;
      }
    }]);

    return RingBuffer;
  }()
}["default"];

var AmplitudeProcessor =
/*#__PURE__*/
function (_AudioWorkletProcesso) {
  _inherits(AmplitudeProcessor, _AudioWorkletProcesso);

  function AmplitudeProcessor(options) {
    var _this;

    _classCallCheck(this, AmplitudeProcessor);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(AmplitudeProcessor).call(this));
    var processorOptions = options.processorOptions || {};
    _this.numOutputChannels = options.outputChannelCount || 1;
    _this.numInputChannels = processorOptions.numInputChannels || 2;
    _this.normalize = processorOptions.normalize || false;
    _this.smoothing = processorOptions.smoothing || 0;
    _this.bufferSize = processorOptions.bufferSize || 2048;
    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, _this.numInputChannels);
    _this.outputRingBuffer = new RingBuffer(_this.bufferSize, _this.numOutputChannels);
    _this.inputRingBufferArraySequence = new Array(_this.numInputChannels).fill(null).map(function () {
      return new Float32Array(_this.bufferSize);
    });
    _this.stereoVol = [0, 0];
    _this.stereoVolNorm = [0, 0];
    _this.volMax = 0.001;

    _this.port.onmessage = function (event) {
      var data = event.data;

      if (data.name === 'toggleNormalize') {
        _this.normalize = data.normalize;
      } else if (data.name === 'smoothing') {
        _this.smoothing = Math.max(0, Math.min(1, data.smoothing));
      }
    };

    return _this;
  } // TO DO make this stereo / dependent on # of audio channels


  _createClass(AmplitudeProcessor, [{
    key: "process",
    value: function process(inputs, outputs) {
      var input = inputs[0];
      var output = outputs[0];
      var smoothing = this.smoothing;
      this.inputRingBuffer.push(input);

      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {
        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);

        for (var channel = 0; channel < this.numInputChannels; ++channel) {
          var inputBuffer = this.inputRingBufferArraySequence[channel];
          var bufLength = inputBuffer.length;
          var sum = 0;

          for (var i = 0; i < bufLength; i++) {
            var x = inputBuffer[i];

            if (this.normalize) {
              sum += Math.max(Math.min(x / this.volMax, 1), -1) * Math.max(Math.min(x / this.volMax, 1), -1);
            } else {
              sum += x * x;
            }
          } // ... then take the square root of the sum.


          var rms = Math.sqrt(sum / bufLength);
          this.stereoVol[channel] = Math.max(rms, this.stereoVol[channel] * smoothing);
          this.volMax = Math.max(this.stereoVol[channel], this.volMax);
        } // calculate stero normalized volume and add volume from all channels together


        var volSum = 0;

        for (var index = 0; index < this.stereoVol.length; index++) {
          this.stereoVolNorm[index] = Math.max(Math.min(this.stereoVol[index] / this.volMax, 1), 0);
          volSum += this.stereoVol[index];
        } // volume is average of channels


        var volume = volSum / this.stereoVol.length; // normalized value

        var volNorm = Math.max(Math.min(volume / this.volMax, 1), 0);
        this.port.postMessage({
          name: 'amplitude',
          volume: volume,
          volNorm: volNorm,
          stereoVol: this.stereoVol,
          stereoVolNorm: this.stereoVolNorm
        }); // pass input through to output

        this.outputRingBuffer.push(this.inputRingBufferArraySequence);
      } // pull 128 frames out of the ring buffer
      // if the ring buffer does not have enough frames, the output will be silent


      this.outputRingBuffer.pull(output);
      return true;
    }
  }]);

  return AmplitudeProcessor;
}(_wrapNativeSuper(AudioWorkletProcessor));

registerProcessor(processorNames.amplitudeProcessor, AmplitudeProcessor);`},function(e,t,n){var s,o;!(o=[n(0),n(17)],s=function(e){e.Frequency=function(t,n){if(!(this instanceof e.Frequency))return new e.Frequency(t,n);e.TimeBase.call(this,t,n)},e.extend(e.Frequency,e.TimeBase),e.Frequency.prototype._primaryExpressions=Object.create(e.TimeBase.prototype._primaryExpressions),e.Frequency.prototype._primaryExpressions.midi={regexp:/^(\d+(?:\.\d+)?midi)/,method:function(e){return this.midiToFrequency(e)}},e.Frequency.prototype._primaryExpressions.note={regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(e,n){var s=t[e.toLowerCase()]+12*(parseInt(n)+1);return this.midiToFrequency(s)}},e.Frequency.prototype._primaryExpressions.tr={regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(e,t,n){var s=1;return e&&"0"!==e&&(s*=this._beatsToUnits(this._timeSignature()*parseFloat(e))),t&&"0"!==t&&(s*=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(s*=this._beatsToUnits(parseFloat(n)/4)),s}},e.Frequency.prototype.transpose=function(e){return this._expr=function(e,t){return e()*this.intervalToFrequencyRatio(t)}.bind(this,this._expr,e),this},e.Frequency.prototype.harmonize=function(e){return this._expr=function(e,t){for(var o=e(),s=[],n=0;n<t.length;n++)s[n]=o*this.intervalToFrequencyRatio(t[n]);return s}.bind(this,this._expr,e),this},e.Frequency.prototype.toMidi=function(){return this.frequencyToMidi(this.valueOf())},e.Frequency.prototype.toNote=function(){var o=this.valueOf(),i=Math.log(o/e.Frequency.A4)/Math.LN2,t=Math.round(12*i)+57,s=Math.floor(t/12);return s<0&&(t+=-12*s),n[t%12]+s.toString()},e.Frequency.prototype.toSeconds=function(){return 1/this.valueOf()},e.Frequency.prototype.toFrequency=function(){return this.valueOf()},e.Frequency.prototype.toTicks=function(){var t=this._beatsToUnits(1),n=this.valueOf()/t;return Math.floor(n*e.Transport.PPQ)},e.Frequency.prototype._frequencyToUnits=function(e){return e},e.Frequency.prototype._ticksToUnits=function(t){return 1/(60*t/(e.Transport.bpm.value*e.Transport.PPQ))},e.Frequency.prototype._beatsToUnits=function(t){return 1/e.TimeBase.prototype._beatsToUnits.call(this,t)},e.Frequency.prototype._secondsToUnits=function(e){return 1/e},e.Frequency.prototype._defaultUnits="hz";var t={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},n=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return e.Frequency.A4=440,e.Frequency.prototype.midiToFrequency=function(t){return e.Frequency.A4*2**((t-69)/12)},e.Frequency.prototype.frequencyToMidi=function(t){return 69+12*Math.log(t/e.Frequency.A4)/Math.LN2},e.Frequency}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(16)],s=function(e){return e.TransportTime=function(t,n){if(!(this instanceof e.TransportTime))return new e.TransportTime(t,n);e.Time.call(this,t,n)},e.extend(e.TransportTime,e.Time),e.TransportTime.prototype._unaryExpressions=Object.create(e.Time.prototype._unaryExpressions),e.TransportTime.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(t){var n=this._secondsToTicks(t()),s=Math.ceil(e.Transport.ticks/n);return this._ticksToUnits(s*n)}},e.TransportTime.prototype._secondsToTicks=function(t){var n=t/this._beatsToUnits(1);return Math.round(n*e.Transport.PPQ)},e.TransportTime.prototype.valueOf=function(){return this._secondsToTicks(this._expr())+(this._plusNow?e.Transport.ticks:0)},e.TransportTime.prototype.toTicks=function(){return this.valueOf()},e.TransportTime.prototype.toSeconds=function(){return this._expr()+(this._plusNow?e.Transport.seconds:0)},e.TransportTime.prototype.toFrequency=function(){return 1/this.toSeconds()},e.TransportTime}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(4),n(13),n(1),n(33),n(21),n(34),n(20),n(35),n(36),n(37)],s=function(e){"use strict";function n(e,t,n){var s=new e;return n._eval(t[0]).connect(s,0,0),n._eval(t[1]).connect(s,0,1),s}function t(e,t,n){var s=new e;return n._eval(t[0]).connect(s,0,0),s}function s(e){return e?parseFloat(e):0[0]}function o(e){return e&&e.args?parseFloat(e.args):0[0]}return e.Expr=function(){var e,s,o,t=this._replacements(Array.prototype.slice.call(arguments)),n=this._parseInputs(t);this._nodes=[],this.input=new Array(n);for(e=0;e<n;e++)this.input[e]=this.context.createGain();o=this._parseTree(t);try{s=this._eval(o)}catch{throw this._disposeNodes(),new Error("Tone.Expr: Could evaluate expression: "+t)}this.output=s},e.extend(e.Expr,e.SignalBase),e.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(t){return new e.Signal(s(t))}},input:{regexp:/^\$\d/,method:function(e,t){return t.input[s(e.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:t.bind(this,e.Abs)},mod:{regexp:/^mod/,method:function(t,n){var i=o(t[1]),s=new e.Modulo(i);return n._eval(t[0]).connect(s),s}},pow:{regexp:/^pow/,method:function(t,n){var i=o(t[1]),s=new e.Pow(i);return n._eval(t[0]).connect(s),s}},a2g:{regexp:/^a2g/,method:function(t,n){var s=new e.AudioToGain;return n._eval(t[0]).connect(s),s}}},binary:{"+":{regexp:/^\+/,precedence:1,method:n.bind(this,e.Add)},"-":{regexp:/^-/,precedence:1,method:function(s,o){return 1===s.length?t(e.Negate,s,o):n(e.Subtract,s,o)}},"*":{regexp:/^\*/,precedence:0,method:n.bind(this,e.Multiply)}},unary:{"-":{regexp:/^-/,method:t.bind(this,e.Negate)},"!":{regexp:/^!/,method:t.bind(this,e.NOT)}}},e.Expr.prototype._parseInputs=function(e){var t,o,n=e.match(/\$\d/g),s=0;if(null!==n)for(t=0;t<n.length;t++)o=parseInt(n[t].substr(1))+1,s=Math.max(s,o);return s},e.Expr.prototype._replacements=function(e){for(var t=e.shift(),n=0;n<e.length;n++)t=t.replace(/%/i,e[n]);return t},e.Expr.prototype._tokenize=function(t){for(var s,o=-1,n=[];0<t.length;)s=i(t=t.trim()),n.push(s),t=t.substr(s.value.length);function i(t){for(s in e.Expr._Expressions){n=e.Expr._Expressions[s];for(a in n){var n,s,a,o=n[a],r=o.regexp,i=t.match(r);if(null!==i)return{type:s,value:i[0],method:o.method}}}throw new SyntaxError("Tone.Expr: Unexpected token "+t)}return{next:function(){return n[++o]},peek:function(){return n[o+1]}}},e.Expr.prototype._parseTree=function(t){var n=this._tokenize(t),s=this.isUndef.bind(this);function o(e,t){return!s(e)&&"glue"===e.type&&e.value===t}function a(t,n,o){var i,r,a=e.Expr._Expressions[n];if(!s(t))for(r in a)if(i=a[r],i.regexp.test(t.value)){if(s(o))return!0;if(i.precedence===o)return!0}return!1}function i(e){s(e)&&(e=5);for(var o=e<0?function e(){var s,t=n.peek();return a(t,"unary")?(t=n.next(),s=e(),{operator:t.value,method:t.method,args:[s]}):r()}():i(e-1),t=n.peek();a(t,"binary",e);)o={operator:(t=n.next()).value,method:t.method,args:[o,i(e-1)]},t=n.peek();return o}function r(){var e,t;if(e=n.peek(),s(e))throw new SyntaxError("Tone.Expr: Unexpected termination of expression");if("func"===e.type)return function(e){var t=[];if(!o(n.next(),"("))throw new SyntaxError('Tone.Expr: Expected ( in a function call "'+e.value+'"');if(o(n.peek(),")")||(t=function(){for(var e,t=[];e=i(),!s(e)&&(t.push(e),o(n.peek(),","));)n.next();return t}()),o(n.next(),")"))return{method:e.method,args:t,name};throw new SyntaxError('Tone.Expr: Expected ) in a function call "'+e.value+'"')}(e=n.next());if("value"===e.type)return{method:(e=n.next()).method,args:e.value};if(o(e,"(")){if(n.next(),t=i(),!o(e=n.next(),")"))throw new SyntaxError("Expected )");return t}throw new SyntaxError("Tone.Expr: Parse error, cannot process token "+e.value)}return i()},e.Expr.prototype._eval=function(e){if(!this.isUndef(e)){var t=e.method(e.args,this);return this._nodes.push(t),t}},e.Expr.prototype._disposeNodes=function(){for(var e,t=0;t<this._nodes.length;t++)e=this._nodes[t],this.isFunction(e.dispose)?e.dispose():this.isFunction(e.disconnect)&&e.disconnect(),e=null,this._nodes[t]=null;this._nodes=null},e.Expr.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeNodes()},e.Expr}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(21),n(13),n(2)],s=function(e){"use strict";return e.GreaterThan=function(t){this.createInsOuts(2,0),this._param=this.input[0]=new e.Subtract(t),this.input[1]=this._param.input[1],this._gtz=this.output=new e.GreaterThanZero,this._param.connect(this._gtz)},e.extend(e.GreaterThan,e.Signal),e.GreaterThan.prototype.dispose=function(){return e.prototype.dispose.call(this),this._param.dispose(),this._param=null,this._gtz.dispose(),this._gtz=null,this},e.GreaterThan}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(6),n(15)],s=function(e){"use strict";return e.Abs=function(){this._abs=this.input=this.output=new e.WaveShaper(function(e){return 0===e?0:e<0?-e:e},127)},e.extend(e.Abs,e.SignalBase),e.Abs.prototype.dispose=function(){return e.prototype.dispose.call(this),this._abs.dispose(),this._abs=null,this},e.Abs}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(6),n(1),n(13)],s=function(e){"use strict";return e.Modulo=function(t){this.createInsOuts(1,0),this._shaper=new e.WaveShaper(2**16),this._multiply=new e.Multiply,this._subtract=this.output=new e.Subtract,this._modSignal=new e.Signal(t),this.input.fan(this._shaper,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(t)},e.extend(e.Modulo,e.SignalBase),e.Modulo.prototype._setWaveShaper=function(e){this._shaper.setMap(function(t){return Math.floor((t+1e-4)/e)})},Object.defineProperty(e.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(e){this._modSignal.value=e,this._setWaveShaper(e)}}),e.Modulo.prototype.dispose=function(){return e.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},e.Modulo}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(6)],s=function(e){"use strict";return e.Pow=function(t){this._exp=this.defaultArg(t,1),this._expScaler=this.input=this.output=new e.WaveShaper(this._expFunc(this._exp),8192)},e.extend(e.Pow,e.SignalBase),Object.defineProperty(e.Pow.prototype,"value",{get:function(){return this._exp},set:function(e){this._exp=e,this._expScaler.setMap(this._expFunc(this._exp))}}),e.Pow.prototype._expFunc=function(e){return function(t){return(t<0?-t:t)**e}},e.Pow.prototype.dispose=function(){return e.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},e.Pow}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(6),n(2)],s=function(e){"use strict";return e.AudioToGain=function(){this._norm=this.input=this.output=new e.WaveShaper(function(e){return(e+1)/2})},e.extend(e.AudioToGain,e.SignalBase),e.AudioToGain.prototype.dispose=function(){return e.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},e.AudioToGain}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(6)],s=function(e){"use strict";return e.EqualPowerGain=function(){this._eqPower=this.input=this.output=new e.WaveShaper(function(e){return(e<0?-e:e)<.001?0:this.equalPowerScale(e)}.bind(this),4096)},e.extend(e.EqualPowerGain,e.SignalBase),e.EqualPowerGain.prototype.dispose=function(){return e.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},e.EqualPowerGain}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){var s,o;!(o=[n(0),n(19),n(9)],s=function(e){"use strict";return e.TimelineState=function(t){e.Timeline.call(this),this._initial=t},e.extend(e.TimelineState,e.Timeline),e.TimelineState.prototype.getValueAtTime=function(e){var t=this.get(e);return null!==t?t.state:this._initial},e.TimelineState.prototype.setStateAtTime=function(e,t){this.add({state:e,time:t})},e.TimelineState}.apply(t,o),s!==0[0]&&(e.exports=s))},function(e,t,n){"use strict";n.r(t);var bt,s,i,yt,x,nn,u,sn,an,Se,a,Ce,Sn,zn,o,H,Bn,Kn,be,Ln,On,fe,on,Ht,Pt,k,Dt,h,zt,m,j,kt,xt,Me,Ot,C,wt,K,rt,it,le,Ie,He,Ge,Xe,Qe,Ze,ct,dt,ft,pt,gt,vt,_t,c,_,Nt,Lt,Rt,M,$e,Gt,cn,ln,mn,fn,En,kn,Hn,In,ye,_e,Dn,Oe,Fn,xe,Ae,F,jn,bn,hn,dn,tn,en,Qt,de,g,We,qt,Wt,$t,It,Tt,St,Re,mt,ut,at,st,nt,Je,qe,Ke,Ue,$o=n(24),Vo=n(25),r=n(3);function Co(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}bt=function e(){Co(this,e),this.input=r.a.createGain(),this.output=r.a.createGain(),this.limiter=r.a.createDynamicsCompressor(),this.limiter.threshold.value=-3,this.limiter.ratio.value=20,this.limiter.knee.value=1,this.audiocontext=r.a,this.output.disconnect(),this.input.connect(this.limiter),this.limiter.connect(this.output),this.meter=r.a.createGain(),this.fftMeter=r.a.createGain(),this.output.connect(this.meter),this.output.connect(this.fftMeter),this.output.connect(this.audiocontext.destination),this.soundArray=[],this.parts=[],this.extensions=[]},i=new bt,p5.prototype.getOutputVolume=function(){return i.output.gain.value},p5.prototype.outputVolume=function(e){var t,s,o=arguments.length>1&&arguments[1]!==0[0]?arguments[1]:0,n=arguments.length>2&&arguments[2]!==0[0]?arguments[2]:0;if(typeof e=="number")t=i.audiocontext.currentTime,s=i.output.gain.value,i.output.gain.cancelScheduledValues(t+n),i.output.gain.linearRampToValueAtTime(s,t+n),i.output.gain.linearRampToValueAtTime(e,t+n+o);else if(e)e.connect(i.output.gain);else return i.output.gain},p5.prototype.soundOut=p5.soundOut=i,p5.soundOut._silentNode=i.audiocontext.createGain(),p5.soundOut._silentNode.gain.value=0,p5.soundOut._silentNode.connect(i.audiocontext.destination),s=i,yt=n(5),x=n.n(yt);function oe(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?oe=function(t){return typeof t}:oe=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(e)}function vo(){return s.audiocontext.sampleRate}function At(e){var t=Math.log(e/440)/Math.log(2),n=Math.round(12*t)+69;return n}function J(e){return 440*2**((e-69)/12)}function X(e){if(typeof e!="string")return e;var n={A:21,B:23,C:24,D:26,E:28,F:29,G:31},t=n[e[0].toUpperCase()],s=~~e.slice(-1);switch(t+=12*(s-1),e[1]){case"#":t+=1;break;case"b":t-=1;break;default:break}return J(t)}function no(){s.extensions=[];for(var e=0;e<arguments.length;e++)if(arguments[e]=arguments[e].toLowerCase(),["mp3","wav","ogg","m4a","aac"].indexOf(arguments[e])>-1)s.extensions.push(arguments[e]);else throw arguments[e]+" is not a valid sound format!"}function eo(){for(var e=0;e<s.soundArray.length;e++)s.soundArray[e].dispose()}function Zs(e){if(typeof e=="string"){{t=e;var t,n,o,i,a,r,c,l,d,u,h,m,p,g,f=t.split(".").pop();if(["mp3","wav","ogg","m4a","aac"].indexOf(f)>-1){if(!p5.prototype.isFileSupported(f))for(n=t.split("."),i=n[n.length-1],c=0;c<s.extensions.length;c++)if(l=s.extensions[c],u=p5.prototype.isFileSupported(l),u){i="",n.length===2&&(i+=n[0]);for(r=1;r<=n.length-2;r++)h=n[r],i+="."+h;t=i+=".",t=t+=l;break}}else for(a=0;a<s.extensions.length;a++)if(d=s.extensions[a],m=p5.prototype.isFileSupported(d),m){t=t+"."+d;break}}}else if(oe(e)==="object")for(o=0;o<e.length;o++)if(p=e[o].split(".").pop(),g=p5.prototype.isFileSupported(p),g){t=e[o];break}return t}function Ao(e,t,n,s,o){for(var i in e.mathOps)e.mathOps[i]instanceof o&&(e.mathOps[i].dispose(),n=i,n<e.mathOps.length-1&&(s=e.mathOps[i+1]));return e.mathOps[n-1].disconnect(),e.mathOps[n-1].connect(t),t.connect(s),e.mathOps[n]=t,e}function ze(e){i=e.getChannelData(0),e.numberOfChannels>1?a=e.getChannelData(1):a=i;var o,i,a,r,c,l,n=Yt(i,a),d=new window.ArrayBuffer(44+n.length*2),t=new window.DataView(d);O(t,0,"RIFF"),t.setUint32(4,36+n.length*2,!0),O(t,8,"WAVE"),O(t,12,"fmt "),t.setUint32(16,16,!0),t.setUint16(20,1,!0),t.setUint16(22,2,!0),t.setUint32(24,s.audiocontext.sampleRate,!0),t.setUint32(28,s.audiocontext.sampleRate*4,!0),t.setUint16(32,4,!0),t.setUint16(34,16,!0),O(t,36,"data"),t.setUint32(40,n.length*2,!0);for(c=n.length,r=44,l=1,o=0;o<c;o++)t.setInt16(r,n[o]*(32767*l),!0),r+=2;return t}function Yt(e,t){for(var i=e.length+t.length,n=new Float32Array(i),s=0,o=0;o<i;)n[o++]=e[s],n[o++]=t[s],s++;return n}function O(e,t,n){for(var o=n.length,s=0;s<o;s++)e.setUint8(t+s,n.charCodeAt(s))}function V(e){var n=e,t=new AudioWorkletNode(s.audiocontext,x.a.soundFileProcessor);return t instanceof ScriptProcessorNode&&(n=t.bufferSize),t.disconnect(),t=null,n}function Hs(e,t){var n=ze(e.buffer);p5.prototype.writeFile([n],t,"wav")}nn=function(t,n,s){var i,a,o=new Error;return o.name=t,o.originalStack=o.stack+n,i=o.stack+n,o.failedPath=s,a=i.split(`
`).filter(function(e){return!e.match(/(p5.|native code|globalInit)/g)}),o.stack=a.join(`
`),o},u=nn,sn=[n(27).default,n(28).default,n(29).default],an=s.audiocontext,Se=!1;function ws(){return Promise.all(sn.map(function(e){var t=new Blob([e],{type:"application/javascript"}),n=URL.createObjectURL(t);return an.audioWorklet.addModule(n)}))}p5.prototype.registerMethod("init",function(){if(Se)return;!this.preload&&!window.preload&&(this.preload=function(){}),this._incrementPreload();var e=function(){Se=!0,this._decrementPreload()}.bind(this);ws().then(e)});function yn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _n(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function wn(e,t,n){return t&&_n(e.prototype,t),n&&_n(e,n),e}a=s.audiocontext,typeof a.createStereoPanner!="undefined"?(Sn=function(){function e(t,n){yn(this,e),this.stereoPanner=this.input=a.createStereoPanner(),t.connect(this.stereoPanner),this.stereoPanner.connect(n)}return wn(e,[{key:"pan",value:function(t,n){var s=n||0,o=a.currentTime+s;this.stereoPanner.pan.linearRampToValueAtTime(t,o)}},{key:"inputChannels",value:function(){}},{key:"connect",value:function(t){this.stereoPanner.connect(t)}},{key:"disconnect",value:function(){this.stereoPanner&&this.stereoPanner.disconnect()}}]),e}(),Ce=Sn):(zn=function(){function e(t,n,s){yn(this,e),this.input=a.createGain(),t.connect(this.input),this.left=a.createGain(),this.right=a.createGain(),this.left.channelInterpretation="discrete",this.right.channelInterpretation="discrete",s>1?(this.splitter=a.createChannelSplitter(2),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0)):(this.input.connect(this.left),this.input.connect(this.right)),this.output=a.createChannelMerger(2),this.left.connect(this.output,0,1),this.right.connect(this.output,0,0),this.output.connect(n)}return wn(e,[{key:"pan",value:function(t,n){var i=n||0,s=a.currentTime+i,o=(t+1)/2,r=Math.cos(o*Math.PI/2),c=Math.sin(o*Math.PI/2);this.left.gain.linearRampToValueAtTime(c,s),this.right.gain.linearRampToValueAtTime(r,s)}},{key:"inputChannels",value:function(t){t===1?(this.input.disconnect(),this.input.connect(this.left),this.input.connect(this.right)):t===2&&(typeof this.splitter=="undefined"&&(this.splitter=a.createChannelSplitter(2)),this.input.disconnect(),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0))}},{key:"connect",value:function(t){this.output.connect(t)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}}]),e}(),Ce=zn),H=Ce;function I(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?I=function(t){return typeof t}:I=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(e)}function Nn(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function Zn(e,t,n){return t&&Nn(e.prototype,t),n&&Nn(e,n),e}function Rn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}o=s.audiocontext,Bn=function(t){for(var i=t.length,s=o.createBuffer(1,t.length,o.sampleRate),a=s.getChannelData(0),n=0;n<i;n++)a[n]=n;return s},Kn=function e(t,n,s,o){Rn(this,e),this.callback=t,this.time=n,this.id=s,this.val=o};function Gn(e){var n=e.target,t=this;n._playing=!1,n.removeEventListener("ended",t._clearOnEnd),t._onended(t),t.bufferSourceNodes.map(function(e,t){return t}).reverse().forEach(function(e){var n=t.bufferSourceNodes[e];n._playing===!1&&t.bufferSourceNodes.splice(e,1)}),t.bufferSourceNodes.length===0&&(t._playing=!1)}be=function(){function e(t,n,o,i){if(Rn(this,e),typeof t!="undefined"){if(typeof t=="string"||typeof t[0]=="string"){var a=p5.prototype._checkFileFormats(t);this.url=a}else if(I(t)==="object"&&!(window.File&&window.FileReader&&window.FileList&&window.Blob))throw"Unable to load file because the File API is not supported";t.file&&(t=t.file),this.file=t}this._onended=function(){},this._looping=!1,this._playing=!1,this._paused=!1,this._pauseTime=0,this._cues=[],this._cueIDCounter=0,this._lastPos=0,this._counterNode=null,this._workletNode=null,this.bufferSourceNodes=[],this.bufferSourceNode=null,this.buffer=null,this.playbackRate=1,this.input=s.audiocontext.createGain(),this.output=s.audiocontext.createGain(),this.reversed=!1,this.startTime=0,this.endTime=null,this.pauseTime=0,this.mode="sustain",this.startMillis=null,this.panPosition=0,this.panner=new H(this.output,s.input,2),(this.url||this.file)&&this.load(n,o),s.soundArray.push(this),typeof i=="function"?this._whileLoading=i:this._whileLoading=function(){},this._clearOnEnd=Gn.bind(this),this.amp=this.setVolume,this.fade=this.setVolume}return Zn(e,[{key:"load",value:function(t,n){var i,a,s=this,r=(new Error).stack;this.url!==0[0]&&this.url!==""?(i=new XMLHttpRequest,i.addEventListener("progress",function(e){s._updateProgress(e)},!1),i.open("GET",this.url,!0),i.responseType="arraybuffer",i.onload=function(){if(i.status===200){if(!s.panner)return;o.decodeAudioData(i.response,function(e){if(!s.panner)return;s.buffer=e,s.panner.inputChannels(e.numberOfChannels),t&&t(s)},function(){if(!s.panner)return;var e=new u("decodeAudioData",r,s.url),t="AudioContext error at decodeAudioData for "+s.url;n?(e.msg=t,n(e)):console.error(t+`
 The error stack trace includes: 
`+e.stack)})}else{if(!s.panner)return;var e=new u("loadSound",r,s.url),a="Unable to load "+s.url+". The request status was: "+i.status+" ("+i.statusText+")";n?(e.message=a,n(e)):console.error(a+`
 The error stack trace includes: 
`+e.stack)}},i.onerror=function(){var e=new u("loadSound",r,s.url),t="There was no response from the server at "+s.url+". Check the url and internet connectivity.";n?(e.message=t,n(e)):console.error(t+`
 The error stack trace includes: 
`+e.stack)},i.send()):this.file!==0[0]&&(a=new FileReader,a.onload=function(){if(!s.panner)return;o.decodeAudioData(a.result,function(e){if(!s.panner)return;s.buffer=e,s.panner.inputChannels(e.numberOfChannels),t&&t(s)})},a.onerror=function(e){if(!s.panner)return;onerror&&onerror(e)},a.readAsArrayBuffer(this.file))}},{key:"_updateProgress",value:function(t){if(t.lengthComputable){var n=t.loaded/t.total*.99;this._whileLoading(n,t)}else this._whileLoading("size unknown")}},{key:"isLoaded",value:function(){return!!this.buffer}},{key:"play",value:function(t,n,o,i,a){if(!this.output){console.warn("SoundFile.play() called after dispose");return}var c,l,d=s.audiocontext.currentTime,r=t||0;if(r<0&&(r=0),r=r+d,typeof n!="undefined"&&this.rate(n),typeof o!="undefined"&&this.setVolume(o),this.buffer){if(this._pauseTime=0,this.mode==="restart"&&this.buffer&&this.bufferSourceNode&&(this.bufferSourceNode.stop(r),this._counterNode.stop(r)),this.mode==="untildone"&&this.isPlaying())return;if(this.bufferSourceNode=this._initSourceNode(),delete this._counterNode,this._counterNode=this._initCounterNode(),i)if(i>=0&&i<this.buffer.duration)c=i;else throw"start time out of range";else c=0;a&&(a=a<=this.buffer.duration-c?a:this.buffer.duration),this._paused?(this.bufferSourceNode.start(r,this.pauseTime,a),this._counterNode.start(r,this.pauseTime,a)):(this.bufferSourceNode.start(r,c,a),this._counterNode.start(r,c,a)),this._playing=!0,this._paused=!1,this.bufferSourceNodes.push(this.bufferSourceNode),this.bufferSourceNode._arrayIndex=this.bufferSourceNodes.length-1,this.bufferSourceNode.addEventListener("ended",this._clearOnEnd)}else throw"not ready to play file, buffer has yet to load. Try preload()";this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping,this._looping===!0&&(l=a||c-1e-15,this.bufferSourceNode.loopStart=c,this.bufferSourceNode.loopEnd=l,this._counterNode.loopStart=c,this._counterNode.loopEnd=l)}},{key:"playMode",value:function(t){var o,i,n=t.toLowerCase();if(n==="restart"&&this.buffer&&this.bufferSourceNode)for(o=0;o<this.bufferSourceNodes.length-1;o++)i=s.audiocontext.currentTime,this.bufferSourceNodes[o].stop(i);if(n==="restart"||n==="sustain"||n==="untildone")this.mode=n;else throw'Invalid play mode. Must be either "restart" or "sustain"'}},{key:"pause",value:function(t){var o=s.audiocontext.currentTime,i=t||0,n=i+o;this.isPlaying()&&this.buffer&&this.bufferSourceNode?(this._paused=!0,this._playing=!1,this.pauseTime=this.currentTime(),this.bufferSourceNode.stop(n),this._counterNode.stop(n),this._pauseTime=this.currentTime()):this._pauseTime=0}},{key:"loop",value:function(t,n,s,o,i){this._looping=!0,this.play(t,n,s,o,i)}},{key:"setLoop",value:function(t){if(t===!0)this._looping=!0;else if(t===!1)this._looping=!1;else throw"Error: setLoop accepts either true or false";this.bufferSourceNode&&(this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping)}},{key:"isLooping",value:function(){return!!this.bufferSourceNode&&this._looping===!0&&this.isPlaying()===!0}},{key:"isPlaying",value:function(){return this._playing}},{key:"isPaused",value:function(){return this._paused}},{key:"stop",value:function(t){var n,o,i=t||0;this.mode==="sustain"||this.mode==="untildone"?(this.stopAll(i),this._playing=!1,this.pauseTime=0,this._paused=!1):this.buffer&&this.bufferSourceNode&&(n=s.audiocontext.currentTime,o=i||0,this.pauseTime=0,this.bufferSourceNode.stop(n+o),this._counterNode.stop(n+o),this._playing=!1,this._paused=!1)}},{key:"stopAll",value:function(t){var n,a,o=s.audiocontext.currentTime,i=t||0;if(this.buffer&&this.bufferSourceNode){for(a in this.bufferSourceNodes)if(n=this.bufferSourceNodes[a],n)try{n.stop(o+i)}catch{}this._counterNode.stop(o+i)}}},{key:"getVolume",value:function(){return this.output.gain.value}},{key:"pan",value:function(t,n){this.panPosition=t,this.panner.pan(t,n)}},{key:"getPan",value:function(){return this.panPosition}},{key:"rate",value:function(t){var n,o=!1;return typeof t=="undefined"?this.playbackRate:(this.playbackRate=t,t===0?t=1e-13:t<0&&!this.reversed?(t=Math.abs(t),o=!0):t>0&&this.reversed&&(o=!0),this.bufferSourceNode&&(n=s.audiocontext.currentTime,this.bufferSourceNode.playbackRate.cancelScheduledValues(n),this.bufferSourceNode.playbackRate.linearRampToValueAtTime(Math.abs(t),n),this._counterNode.playbackRate.cancelScheduledValues(n),this._counterNode.playbackRate.linearRampToValueAtTime(Math.abs(t),n)),o&&this.reverseBuffer(),this.playbackRate)}},{key:"setPitch",value:function(t){var n=J(t)/J(60);this.rate(n)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setVolume",value:function(t,n,o){if(typeof t=="number"){var r=n||0,i=o||0,a=s.audiocontext.currentTime,c=this.output.gain.value;this.output.gain.cancelScheduledValues(a+i),this.output.gain.linearRampToValueAtTime(c,a+i),this.output.gain.linearRampToValueAtTime(t,a+i+r)}else if(t)t.connect(this.output.gain);else return this.output.gain}},{key:"duration",value:function(){return this.buffer?this.buffer.duration:0}},{key:"currentTime",value:function(){return this.reversed?Math.abs(this._lastPos-this.buffer.length)/o.sampleRate:this._lastPos/o.sampleRate}},{key:"jump",value:function(t,n){if(t<0||t>this.buffer.duration)throw"jump time out of range";if(n>this.buffer.duration-t)throw"end time out of range";var s=t||0,o=n||0[0];this.isPlaying()&&(this.stop(0),this.play(0,this.playbackRate,this.output.gain.value,s,o))}},{key:"channels",value:function(){return this.buffer.numberOfChannels}},{key:"sampleRate",value:function(){return this.buffer.sampleRate}},{key:"frames",value:function(){return this.buffer.length}},{key:"getPeaks",value:function(t){if(this.buffer){if(t||(t=window.width*5),this.buffer){for(var n,s,o,i,d,u,h,r=this.buffer,c=r.length/t,f=~~(c/10)||1,m=r.numberOfChannels,l=new Float32Array(Math.round(t)),a=0;a<m;a++)for(h=r.getChannelData(a),s=0;s<t;s++){for(d=~~(s*c),u=~~(d+c),n=0,i=d;i<u;i+=f)o=h[i],o>n?n=o:-o>n&&(n=o);(a===0||(n<0?-n:n)>l[s])&&(l[s]=n)}return l}}else throw"Cannot load peaks yet, buffer is not loaded"}},{key:"reverseBuffer",value:function(){if(this.buffer){var t,s,n=this._lastPos/o.sampleRate,i=this.getVolume();this.setVolume(0,.001);for(s=this.buffer.numberOfChannels,t=0;t<s;t++)this.buffer.getChannelData(t).reverse();this.reversed=!this.reversed,this.isPlaying()&&n&&this.jump(this.duration()-n),this.setVolume(i,.001)}else throw"SoundFile is not done loading"}},{key:"onended",value:function(t){return this._onended=t,this}},{key:"add",value:function(){}},{key:"dispose",value:function(){var t,n=s.audiocontext.currentTime,o=s.soundArray.indexOf(this);if(s.soundArray.splice(o,1),this.stop(n),this.buffer&&this.bufferSourceNode){for(t=0;t<this.bufferSourceNodes.length-1;t++)if(this.bufferSourceNodes[t]!==null){this.bufferSourceNodes[t].disconnect();try{this.bufferSourceNodes[t].stop(n)}catch{console.warn("no buffer source node to dispose")}this.bufferSourceNodes[t]=null}if(this.isPlaying()){try{this._counterNode.stop(n)}catch(e){console.log(e)}this._counterNode=null}}this.output&&(this.output.disconnect(),this.output=null),this.panner&&(this.panner.disconnect(),this.panner=null)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.panner.connect(t.input):this.panner.connect(t):this.panner.connect(s.input)}},{key:"disconnect",value:function(){this.panner&&this.panner.disconnect()}},{key:"getLevel",value:function(){console.warn("p5.SoundFile.getLevel has been removed from the library. Use p5.Amplitude instead")}},{key:"setPath",value:function(t,n){var s=p5.prototype._checkFileFormats(t);this.url=s,this.load(n)}},{key:"setBuffer",value:function(t){var n,a,s=t.length,r=t[0].length,i=o.createBuffer(s,r,o.sampleRate);t[0]instanceof Float32Array||(t[0]=new Float32Array(t[0]));for(n=0;n<s;n++)a=i.getChannelData(n),a.set(t[n]);this.buffer=i,this.panner.inputChannels(s)}},{key:"_initCounterNode",value:function(){var s=this,t=this,i=o.currentTime,n=o.createBufferSource(),a=V(256);return t._workletNode&&(t._workletNode.disconnect(),delete t._workletNode),t._workletNode=new AudioWorkletNode(o,x.a.soundFileProcessor,{processorOptions:{bufferSize:a}}),t._workletNode.port.onmessage=function(e){if(e.data.name==="position"){if(e.data.position===0)return;s._lastPos=e.data.position,s._onTimeUpdate(t._lastPos)}},n.buffer=Bn(t.buffer),n.playbackRate.setValueAtTime(t.playbackRate,i),n.connect(t._workletNode),t._workletNode.connect(p5.soundOut._silentNode),n}},{key:"_initSourceNode",value:function(){var t=o.createBufferSource();return t.buffer=this.buffer,t.playbackRate.value=this.playbackRate,t.connect(this.output),t}},{key:"processPeaks",value:function(){console.warn("processPeaks is deprecated")}},{key:"addCue",value:function(t,n,s){var o=this._cueIDCounter++,i=new Kn(n,t,o,s);return this._cues.push(i),o}},{key:"removeCue",value:function(t){for(var s,o=this._cues.length,n=0;n<o;n++)if(s=this._cues[n],s.id===t){this._cues.splice(n,1);break}}},{key:"clearCues",value:function(){this._cues=[]}},{key:"_onTimeUpdate",value:function(t){for(var n,o,a,r,c,i=t/this.buffer.sampleRate,l=this._cues.length,s=0;s<l;s++)n=this._cues[s],o=n.time,a=n.val,r=this._prevUpdateTime||0,c=i,r<=o&&o<=c&&n.callback(a);this._prevUpdateTime=i}},{key:"save",value:function(t){p5.prototype.saveSound(this,t,"wav")}},{key:"getBlob",value:function(){var t=ze(this.buffer);return new Blob([t],{type:"audio/wav"})}}]),e}();function Xn(e,t,n,s){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&window.alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var o=this,i=new be(e,function(){typeof t=="function"&&t.apply(o,arguments),typeof o._decrementPreload=="function"&&o._decrementPreload()},n,s);return i}Ln=be;function ts(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function An(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function ls(e,t,n){return t&&An(e.prototype,t),n&&An(e,n),e}On=function(){function e(t){ts(this,e),this.bufferSize=V(2048),this.audiocontext=s.audiocontext,this._workletNode=new AudioWorkletNode(this.audiocontext,x.a.amplitudeProcessor,{outputChannelCount:[1],parameterData:{smoothing:t||0},processorOptions:{normalize:!1,smoothing:t||0,numInputChannels:2,bufferSize:this.bufferSize}}),this._workletNode.port.onmessage=function(e){e.data.name==="amplitude"&&(this.volume=e.data.volume,this.volNorm=e.data.volNorm,this.stereoVol=e.data.stereoVol,this.stereoVolNorm=e.data.stereoVolNorm)}.bind(this),this.input=this._workletNode,this.output=this.audiocontext.createGain(),this.volume=0,this.volNorm=0,this.stereoVol=[0,0],this.stereoVolNorm=[0,0],this.normalize=!1,this._workletNode.connect(this.output),this.output.gain.value=0,this.output.connect(this.audiocontext.destination),s.meter.connect(this._workletNode),s.soundArray.push(this)}return ls(e,[{key:"setInput",value:function(t,n){s.meter.disconnect(),n&&(this._workletNode.parameters.get("smoothing").value=n),t==null?(console.log("Amplitude input source is not ready! Connecting to main output instead"),s.meter.connect(this._workletNode)):t?(t.connect(this._workletNode),this._workletNode.disconnect(),this._workletNode.connect(this.output)):s.meter.connect(this._workletNode)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):this.output.connect(t):this.output.connect(this.panner.connect(s.input))}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"getLevel",value:function(t){return typeof t!="undefined"?this.normalize?this.stereoVolNorm[t]:this.stereoVol[t]:this.normalize?this.volNorm:this.volume}},{key:"toggleNormalize",value:function(t){typeof t=="boolean"?this.normalize=t:this.normalize=!this.normalize,this._workletNode.port.postMessage({name:"toggleNormalize",normalize:this.normalize})}},{key:"smooth",value:function(t){t>=0&&t<1?this._workletNode.port.postMessage({name:"smoothing",smoothing:t}):console.log("Error: smoothing must be between 0 and 1")}},{key:"dispose",value:function(){var t=s.soundArray.indexOf(this);s.soundArray.splice(t,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._workletNode.disconnect(),delete this._workletNode}}]),e}(),fe=On;function hs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pn(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function xs(e,t,n){return t&&pn(e.prototype,t),n&&pn(e,n),e}on=function(){function e(t,n){hs(this,e),this.input=this.analyser=s.audiocontext.createAnalyser(),Object.defineProperties(this,{bins:{get:function(){return this.analyser.fftSize/2},set:function(t){this.analyser.fftSize=t*2},configurable:!0,enumerable:!0},smoothing:{get:function(){return this.analyser.smoothingTimeConstant},set:function(t){this.analyser.smoothingTimeConstant=t},configurable:!0,enumerable:!0}}),this.smooth(t),this.bins=n||1024,s.fftMeter.connect(this.analyser),this.freqDomain=new Uint8Array(this.analyser.frequencyBinCount),this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount),this.bass=[20,140],this.lowMid=[140,400],this.mid=[400,2600],this.highMid=[2600,5200],this.treble=[5200,14e3],s.soundArray.push(this)}return xs(e,[{key:"setInput",value:function(t){t?(t.output?t.output.connect(this.analyser):t.connect&&t.connect(this.analyser),s.fftMeter.disconnect()):s.fftMeter.connect(this.analyser)}},{key:"waveform",value:function(){for(var n,s,o,a,i=new Array,t=0;t<arguments.length;t++)typeof arguments[t]=="number"&&(s=arguments[t],this.analyser.fftSize=s*2),typeof arguments[t]=="string"&&(o=arguments[t]);if(o&&!p5.prototype._isSafari())return qn(this,this.timeDomain),this.analyser.getFloatTimeDomainData(this.timeDomain),this.timeDomain;so(this,this.timeDomain),this.analyser.getByteTimeDomainData(this.timeDomain);for(n=0;n<this.timeDomain.length;n++)a=p5.prototype.map(this.timeDomain[n],0,255,-1,1),i.push(a);return i}},{key:"analyze",value:function(){for(var n,s,t=0;t<arguments.length;t++)typeof arguments[t]=="number"&&(this.bins=arguments[t],this.analyser.fftSize=this.bins*2),typeof arguments[t]=="string"&&(n=arguments[t]);return n&&n.toLowerCase()==="db"?(Ts(this),this.analyser.getFloatFrequencyData(this.freqDomain),this.freqDomain):(Bs(this,this.freqDomain),this.analyser.getByteFrequencyData(this.freqDomain),s=Array.apply([],this.freqDomain),s)}},{key:"getEnergy",value:function(t,n){var o,a,r,c,l,d,u,h,i=s.audiocontext.sampleRate/2;if(t==="bass"?(t=this.bass[0],n=this.bass[1]):t==="lowMid"?(t=this.lowMid[0],n=this.lowMid[1]):t==="mid"?(t=this.mid[0],n=this.mid[1]):t==="highMid"?(t=this.highMid[0],n=this.highMid[1]):t==="treble"&&(t=this.treble[0],n=this.treble[1]),typeof t!="number")throw"invalid input for getEnergy()";if(!n)return c=Math.round(t/i*this.freqDomain.length),this.freqDomain[c];if(t&&n){t>n&&(l=n,n=t,t=l);for(d=Math.round(t/i*this.freqDomain.length),u=Math.round(n/i*this.freqDomain.length),a=0,r=0,o=d;o<=u;o++)a+=this.freqDomain[o],r+=1;return h=a/r,h}throw"invalid input for getEnergy()"}},{key:"getFreq",value:function(t,n){console.log("getFreq() is deprecated. Please use getEnergy() instead.");var s=this.getEnergy(t,n);return s}},{key:"getCentroid",value:function(){for(var o,a,r=s.audiocontext.sampleRate/2,i=0,n=0,t=0;t<this.freqDomain.length;t++)i+=t*this.freqDomain[t],n+=this.freqDomain[t];return o=0,n!==0&&(o=i/n),a=o*(r/this.freqDomain.length),a}},{key:"smooth",value:function(t){return typeof t!="undefined"&&(this.smoothing=t),this.smoothing}},{key:"dispose",value:function(){var t=s.soundArray.indexOf(this);s.soundArray.splice(t,1),this.analyser&&(this.analyser.disconnect(),delete this.analyser)}},{key:"linAverages",value:function(t){for(var a=t||16,i=this.freqDomain,r=i.length,c=Math.floor(r/a),s=new Array(a),o=0,n=0;n<r;n++)s[o]=s[o]!==0[0]?(s[o]+i[n])/2:i[n],n%c===c-1&&o++;return s}},{key:"logAverages",value:function e(t){for(var a,r=s.audiocontext.sampleRate/2,i=this.freqDomain,c=i.length,e=new Array(t.length),n=0,o=0;o<c;o++)a=Math.round(o*r/this.freqDomain.length),a>t[n].hi&&n++,e[n]=e[n]!==0[0]?(e[n]+i[o])/2:i[o];return e}},{key:"getOctaveBands",value:function(t,n){var o,l,a=t||3,r=n||15.625,c=[],i={lo:r/2**(1/(2*a)),ctr:r,hi:r*2**(1/(2*a))};for(c.push(i),l=s.audiocontext.sampleRate/2;i.hi<l;)o={},o.lo=i.hi,o.ctr=i.ctr*2**(1/a),o.hi=o.ctr*2**(1/(2*a)),c.push(o),i=o;return c}}]),e}();function Ts(e){e.freqDomain instanceof Float32Array===!1&&(e.freqDomain=new Float32Array(e.analyser.frequencyBinCount))}function Bs(e){e.freqDomain instanceof Uint8Array===!1&&(e.freqDomain=new Uint8Array(e.analyser.frequencyBinCount))}function qn(e){e.timeDomain instanceof Float32Array===!1&&(e.timeDomain=new Float32Array(e.analyser.frequencyBinCount))}function so(e){e.timeDomain instanceof Uint8Array===!1&&(e.timeDomain=new Uint8Array(e.analyser.frequencyBinCount))}Ht=on,Pt=n(4),k=n.n(Pt),Dt=n(1),h=n.n(Dt),zt=n(8),j=n.n(zt);function G(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?G=function(t){return typeof t}:G=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(e)}function T(e,t){return t&&(G(t)==="object"||typeof t=="function")?t:uo(e)}function uo(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(e)}function B(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}function we(e,t){return we=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},we(e,t)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ft(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function po(e,t,n){return t&&Ft(e.prototype,t),n&&Ft(e,n),e}function Ee(e,t,n,s,o){var i,a=e.oscillator;for(i in e.mathOps)e.mathOps[i]instanceof o&&(a.disconnect(),e.mathOps[i].dispose(),n=i,n<e.mathOps.length-2&&(s=e.mathOps[i+1]));return n===e.mathOps.length-1&&e.mathOps.push(s),i>0&&(a=e.mathOps[i-1]),a.disconnect(),a.connect(t),t.connect(s),e.mathOps[n]=t,e}m=function(){function e(t,n){if(E(this,e),typeof t=="string"){var o,i=n;n=t,t=i}typeof n=="number"&&(o=n,n=t,t=o),this.started=!1,this.phaseAmount=0[0],this.oscillator=s.audiocontext.createOscillator(),this.f=t||440,this.oscillator.type=n||"sine",this.oscillator.frequency.setValueAtTime(this.f,s.audiocontext.currentTime),this.output=s.audiocontext.createGain(),this._freqMods=[],this.output.gain.value=.5,this.output.gain.setValueAtTime(.5,s.audiocontext.currentTime),this.oscillator.connect(this.output),this.panPosition=0,this.connection=s.input,this.panner=new H(this.output,this.connection,1),this.mathOps=[this.output],s.soundArray.push(this),this.fade=this.amp}return po(e,[{key:"start",value:function(t,n){if(this.started){var o,i,a,r=s.audiocontext.currentTime;this.stop(r)}if(!this.started){o=n||this.f,i=this.oscillator.type,this.oscillator&&(this.oscillator.disconnect(),delete this.oscillator),this.oscillator=s.audiocontext.createOscillator(),this.oscillator.frequency.value=o<0?-o:o,this.oscillator.type=i,this.oscillator.connect(this.output),t=t||0,this.oscillator.start(t+s.audiocontext.currentTime),this.freqNode=this.oscillator.frequency;for(a in this._freqMods)typeof this._freqMods[a].connect!="undefined"&&this._freqMods[a].connect(this.oscillator.frequency);this.started=!0}}},{key:"stop",value:function(t){if(this.started){var n=t||0,o=s.audiocontext.currentTime;this.oscillator.stop(n+o),this.started=!1}}},{key:"amp",value:function(t){var n,o=arguments.length>1&&arguments[1]!==0[0]?arguments[1]:0,i=arguments.length>2&&arguments[2]!==0[0]?arguments[2]:0;if(typeof t=="number")n=s.audiocontext.currentTime,this.output.gain.linearRampToValueAtTime(t,n+i+o);else if(t)t.connect(this.output.gain);else return this.output.gain}},{key:"getAmp",value:function(){return this.output.gain.value}},{key:"freq",value:function(t){var n,o=arguments.length>1&&arguments[1]!==0[0]?arguments[1]:0,i=arguments.length>2&&arguments[2]!==0[0]?arguments[2]:0;if(typeof t=="number"&&!(t!=t))this.f=t,n=s.audiocontext.currentTime,o===0?this.oscillator.frequency.setValueAtTime(t,i+n):t>0?this.oscillator.frequency.exponentialRampToValueAtTime(t,i+o+n):this.oscillator.frequency.linearRampToValueAtTime(t,i+o+n),this.phaseAmount&&this.phase(this.phaseAmount);else if(t)t.output&&(t=t.output),t.connect(this.oscillator.frequency),this._freqMods.push(t);else return this.oscillator.frequency}},{key:"getFreq",value:function(){return this.oscillator.frequency.value}},{key:"setType",value:function(t){this.oscillator.type=t}},{key:"getType",value:function(){return this.oscillator.type}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?(this.panner.connect(t.input),this.connection=t.input):(this.panner.connect(t),this.connection=t):this.panner.connect(s.input)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect(),this.panner&&(this.panner.disconnect(),this.output&&this.output.connect(this.panner)),this.oscMods=[]}},{key:"pan",value:function(t,n){this.panPosition=t,this.panner.pan(t,n)}},{key:"getPan",value:function(){return this.panPosition}},{key:"dispose",value:function(){var t,n=s.soundArray.indexOf(this);s.soundArray.splice(n,1),this.oscillator&&(t=s.audiocontext.currentTime,this.stop(t),this.disconnect(),this.panner=null,this.oscillator=null),this.osc2&&this.osc2.dispose()}},{key:"phase",value:function(t){var n=p5.prototype.map(t,0,1,0,1/this.f),o=s.audiocontext.currentTime;this.phaseAmount=t,this.dNode||(this.dNode=s.audiocontext.createDelay(),this.oscillator.disconnect(),this.oscillator.connect(this.dNode),this.dNode.connect(this.output)),this.dNode.delayTime.setValueAtTime(n,o)}},{key:"add",value:function e(t){var e=new k.a(t),n=this.mathOps.length-1,s=this.output;return Ee(this,e,n,s,k.a)}},{key:"mult",value:function e(t){var e=new h.a(t),n=this.mathOps.length-1,s=this.output;return Ee(this,e,n,s,h.a)}},{key:"scale",value:function e(t,n,s,o){arguments.length===4?(i=p5.prototype.map(s,t,n,0,1)-.5,a=p5.prototype.map(o,t,n,0,1)-.5):(i=arguments[0],a=arguments[1]);var i,a,e=new j.a(i,a),r=this.mathOps.length-1,c=this.output;return Ee(this,e,r,c,j.a)}}]),e}(),kt=function(e){B(t,e);function t(e){return E(this,t),T(this,f(t).call(this,e,"sine"))}return t}(m),xt=function(e){B(t,e);function t(e){return E(this,t),T(this,f(t).call(this,e,"triangle"))}return t}(m),Me=function(e){B(t,e);function t(e){return E(this,t),T(this,f(t).call(this,e,"sawtooth"))}return t}(m),Ot=function(e){B(t,e);function t(e){return E(this,t),T(this,f(t).call(this,e,"square"))}return t}(m),C=m,wt=n(7),K=n.n(wt),p5.Envelope=function(e,t,n,o,i,a){this.aTime=e||.1,this.aLevel=t||1,this.dTime=n||.5,this.dLevel=o||0,this.rTime=i||0,this.rLevel=a||0,this._rampHighPercentage=.98,this._rampLowPercentage=.02,this.output=s.audiocontext.createGain(),this.control=new K.a,this._init(),this.control.connect(this.output),this.connection=null,this.mathOps=[this.control],this.isExponential=!1,this.sourceToClear=null,this.wasTriggered=!1,s.soundArray.push(this)},p5.Envelope.prototype._init=function(){var e=s.audiocontext.currentTime,t=e;this.control.setTargetAtTime(1e-5,t,.001),this._setRampAD(this.aTime,this.dTime)},p5.Envelope.prototype.set=function(e,t,n,s,o,i){this.aTime=e,this.aLevel=t,this.dTime=n||0,this.dLevel=s||0,this.rTime=o||0,this.rLevel=i||0,this._setRampAD(e,n)},p5.Envelope.prototype.setADSR=function(e,t,n,s){this.aTime=e,this.dTime=t||0,this.sPercent=n||0,this.dLevel=typeof n!="undefined"?n*(this.aLevel-this.rLevel)+this.rLevel:0,this.rTime=s||0,this._setRampAD(e,t)},p5.Envelope.prototype.setRange=function(e,t){this.aLevel=e||1,this.rLevel=t||0},p5.Envelope.prototype._setRampAD=function(e,t){this._rampAttackTime=this.checkExpInput(e),this._rampDecayTime=this.checkExpInput(t);var n=1,n=Math.log(1/this.checkExpInput(1-this._rampHighPercentage));this._rampAttackTC=e/this.checkExpInput(n),n=Math.log(1/this._rampLowPercentage),this._rampDecayTC=t/this.checkExpInput(n)},p5.Envelope.prototype.setRampPercentages=function(e,t){this._rampHighPercentage=this.checkExpInput(e),this._rampLowPercentage=this.checkExpInput(t);var n=1,n=Math.log(1/this.checkExpInput(1-this._rampHighPercentage));this._rampAttackTC=this._rampAttackTime/this.checkExpInput(n),n=Math.log(1/this._rampLowPercentage),this._rampDecayTC=this._rampDecayTime/this.checkExpInput(n)},p5.Envelope.prototype.setInput=function(){for(var e=0;e<arguments.length;e++)this.connect(arguments[e])},p5.Envelope.prototype.setExp=function(e){this.isExponential=e},p5.Envelope.prototype.checkExpInput=function(e){return e<=0&&(e=1e-8),e},p5.Envelope.prototype.play=function(e,t,n){var s=t||0;e&&this.connection!==e&&this.connect(e),this.triggerAttack(e,s),this.triggerRelease(e,s+this.aTime+this.dTime+~~n)},p5.Envelope.prototype.triggerAttack=function(e,t){var o,i=s.audiocontext.currentTime,a=t||0,n=i+a;this.lastAttack=n,this.wasTriggered=!0,e&&this.connection!==e&&this.connect(e),o=this.control.getValueAtTime(n),this.isExponential===!0?this.control.exponentialRampToValueAtTime(this.checkExpInput(o),n):this.control.linearRampToValueAtTime(o,n),n+=this.aTime,this.isExponential===!0?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.aLevel),n),o=this.checkExpInput(this.control.getValueAtTime(n)),this.control.cancelScheduledValues(n),this.control.exponentialRampToValueAtTime(o,n)):(this.control.linearRampToValueAtTime(this.aLevel,n),o=this.control.getValueAtTime(n),this.control.cancelScheduledValues(n),this.control.linearRampToValueAtTime(o,n)),n+=this.dTime,this.isExponential===!0?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.dLevel),n),o=this.checkExpInput(this.control.getValueAtTime(n)),this.control.cancelScheduledValues(n),this.control.exponentialRampToValueAtTime(o,n)):(this.control.linearRampToValueAtTime(this.dLevel,n),o=this.control.getValueAtTime(n),this.control.cancelScheduledValues(n),this.control.linearRampToValueAtTime(o,n))},p5.Envelope.prototype.triggerRelease=function(e,t){if(!this.wasTriggered)return;var o,i=s.audiocontext.currentTime,a=t||0,n=i+a;e&&this.connection!==e&&this.connect(e),o=this.control.getValueAtTime(n),this.isExponential===!0?this.control.exponentialRampToValueAtTime(this.checkExpInput(o),n):this.control.linearRampToValueAtTime(o,n),n+=this.rTime,this.isExponential===!0?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.rLevel),n),o=this.checkExpInput(this.control.getValueAtTime(n)),this.control.cancelScheduledValues(n),this.control.exponentialRampToValueAtTime(o,n)):(this.control.linearRampToValueAtTime(this.rLevel,n),o=this.control.getValueAtTime(n),this.control.cancelScheduledValues(n),this.control.linearRampToValueAtTime(o,n)),this.wasTriggered=!1},p5.Envelope.prototype.ramp=function(e,t,n,o){var c,l=s.audiocontext.currentTime,d=t||0,i=l+d,a=this.checkExpInput(n),r=typeof o!="undefined"?this.checkExpInput(o):0[0];if(e&&this.connection!==e&&this.connect(e),c=this.checkExpInput(this.control.getValueAtTime(i)),a>c?(this.control.setTargetAtTime(a,i,this._rampAttackTC),i+=this._rampAttackTime):a<c&&(this.control.setTargetAtTime(a,i,this._rampDecayTC),i+=this._rampDecayTime),r===0[0])return;r>a?this.control.setTargetAtTime(r,i,this._rampAttackTC):r<a&&this.control.setTargetAtTime(r,i,this._rampDecayTC)},p5.Envelope.prototype.connect=function(e){this.connection=e,(e instanceof p5.Oscillator||e instanceof p5.SoundFile||e instanceof p5.AudioIn||e instanceof p5.Reverb||e instanceof p5.Noise||e instanceof p5.Filter||e instanceof p5.Delay)&&(e=e.output.gain),e instanceof AudioParam&&e.setValueAtTime(0,s.audiocontext.currentTime),this.output.connect(e)},p5.Envelope.prototype.disconnect=function(){this.output&&this.output.disconnect()},p5.Envelope.prototype.add=function(e){var t=new k.a(e),n=this.mathOps.length,s=this.output;return p5.prototype._mathChain(this,t,n,s,k.a)},p5.Envelope.prototype.mult=function(e){var t=new h.a(e),n=this.mathOps.length,s=this.output;return p5.prototype._mathChain(this,t,n,s,h.a)},p5.Envelope.prototype.scale=function(e,t,n,s){var o=new j.a(e,t,n,s),i=this.mathOps.length,a=this.output;return p5.prototype._mathChain(this,o,i,a,j.a)},p5.Envelope.prototype.dispose=function(){var e,t=s.soundArray.indexOf(this);s.soundArray.splice(t,1),this.disconnect(),this.control&&(this.control.dispose(),this.control=null);for(e=1;e<this.mathOps.length;e++)this.mathOps[e].dispose()},p5.Env=function(e,t,n,s,o,i){console.warn("WARNING: p5.Env is now deprecated and may be removed in future versions. Please use the new p5.Envelope instead."),p5.Envelope.call(this,e,t,n,s,o,i)},p5.Env.prototype=Object.create(p5.Envelope.prototype),rt=p5.Envelope,it=rt;function ee(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ee=function(t){return typeof t}:ee=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(e)}function Ho(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ye(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function Io(e,t,n){return t&&Ye(e.prototype,t),n&&Ye(e,n),e}function Us(e,t){return t&&(ee(t)==="object"||typeof t=="function")?t:$s(e)}function $s(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e){return Te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Te(e)}function Ks(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}function Ve(e,t){return Ve=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},Ve(e,t)}le=function(){for(var n=2*s.audiocontext.sampleRate,e=s.audiocontext.createBuffer(1,n,s.audiocontext.sampleRate),o=e.getChannelData(0),t=0;t<n;t++)o[t]=Math.random()*2-1;return e.type="white",e}(),Ie=function(){for(var e,t,n,o,i,a,d,u=2*s.audiocontext.sampleRate,c=s.audiocontext.createBuffer(1,u,s.audiocontext.sampleRate),h=c.getChannelData(0),l=t=n=o=i=a=d=0,r=0;r<u;r++)e=Math.random()*2-1,l=.99886*l+e*.0555179,t=.99332*t+e*.0750759,n=.969*n+e*.153852,o=.8665*o+e*.3104856,i=.55*i+e*.5329522,a=-.7616*a-e*.016898,h[r]=l+t+n+o+i+a+d+e*.5362,h[r]*=.11,d=e*.115926;return c.type="pink",c}(),He=function(){for(var a,o=2*s.audiocontext.sampleRate,t=s.audiocontext.createBuffer(1,o,s.audiocontext.sampleRate),n=t.getChannelData(0),i=0,e=0;e<o;e++)a=Math.random()*2-1,n[e]=(i+.02*a)/1.02,i=n[e],n[e]*=3.5;return t.type="brown",t}(),Ge=function(e){Ks(t,e);function t(e){var n,s;return Ho(this,t),n=Us(this,Te(t).call(this)),delete n.f,delete n.freq,delete n.oscillator,e==="brown"?s=He:e==="pink"?s=Ie:s=le,n.buffer=s,n}return Io(t,[{key:"setType",value:function(t){switch(t){case"white":this.buffer=le;break;case"pink":this.buffer=Ie;break;case"brown":this.buffer=He;break;default:this.buffer=le}if(this.started){var n=s.audiocontext.currentTime;this.stop(n),this.start(n+.01)}}},{key:"getType",value:function(){return this.buffer.type}},{key:"start",value:function(){this.started&&this.stop(),this.noise=s.audiocontext.createBufferSource(),this.noise.buffer=this.buffer,this.noise.loop=!0,this.noise.connect(this.output);var t=s.audiocontext.currentTime;this.noise.start(t),this.started=!0}},{key:"stop",value:function(){var t=s.audiocontext.currentTime;this.noise&&(this.noise.stop(t),this.started=!1)}},{key:"dispose",value:function(){var t=s.audiocontext.currentTime,n=s.soundArray.indexOf(this);s.soundArray.splice(n,1),this.noise&&(this.noise.disconnect(),this.stop(t)),this.output&&this.output.disconnect(),this.panner&&this.panner.disconnect(),this.output=null,this.panner=null,this.buffer=null,this.noise=null}}]),t}(C),Xe=Ge,Qe=n(2),Ze=n.n(Qe);function ie(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ie=function(t){return typeof t}:ie=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(e)}function Ro(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tt(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function No(e,t,n){return t&&tt(e.prototype,t),n&&tt(e,n),e}function Do(e,t){return t&&(ie(t)==="object"||typeof t=="function")?t:To(e)}function To(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Le(e){return Le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Le(e)}function Mo(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}function Ne(e,t){return Ne=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},Ne(e,t)}ct=function(e){Mo(t,e);function t(e,n){Ro(this,t),o=Do(this,Le(t).call(this,e,"sawtooth")),o.w=n||0,o.osc2=new Me(e),o.dNode=s.audiocontext.createDelay(),o.dcOffset=lt(),o.dcGain=s.audiocontext.createGain(),o.dcOffset.connect(o.dcGain),o.dcGain.connect(o.output),o.f=e||440;var o,i=o.w/o.oscillator.frequency.value;return o.dNode.delayTime.value=i,o.dcGain.gain.value=1.7*(.5-o.w),o.osc2.disconnect(),o.osc2.panner.disconnect(),o.osc2.amp(-1),o.osc2.output.connect(o.dNode),o.dNode.connect(o.output),o.output.gain.value=1,o.output.connect(o.panner),o}return No(t,[{key:"width",value:function(t){if(typeof t=="number"){if(t<=1&&t>=0){this.w=t;var n,s,o,i=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=i}this.dcGain.gain.value=1.7*(.5-this.w)}else t.connect(this.dNode.delayTime),n=new Ze.a(-.5),t.connect(n),s=new h.a(-1),o=new h.a(1.7),n=n.connect(s).connect(o),n.connect(this.dcGain.gain)}},{key:"start",value:function(t,n){var a,r,o=s.audiocontext.currentTime,i=n||0;this.started||(a=t||this.f,r=this.oscillator.type,this.oscillator=s.audiocontext.createOscillator(),this.oscillator.frequency.setValueAtTime(a,o),this.oscillator.type=r,this.oscillator.connect(this.output),this.oscillator.start(i+o),this.osc2.oscillator=s.audiocontext.createOscillator(),this.osc2.oscillator.frequency.setValueAtTime(a,i+o),this.osc2.oscillator.type=r,this.osc2.oscillator.connect(this.osc2.output),this.osc2.start(i+o),this.freqNode=[this.oscillator.frequency,this.osc2.oscillator.frequency],this.dcOffset=lt(),this.dcOffset.connect(this.dcGain),this.dcOffset.start(i+o),this.mods!==0[0]&&this.mods.frequency!==0[0]&&(this.mods.frequency.connect(this.freqNode[0]),this.mods.frequency.connect(this.freqNode[1])),this.started=!0,this.osc2.started=!0)}},{key:"stop",value:function(t){if(this.started){var n=t||0,o=s.audiocontext.currentTime;this.oscillator.stop(n+o),this.osc2.oscillator&&this.osc2.oscillator.stop(n+o),this.dcOffset.stop(n+o),this.started=!1,this.osc2.started=!1}}},{key:"freq",value:function(t){var n,i,a=arguments.length>1&&arguments[1]!==0[0]?arguments[1]:0,o=arguments.length>2&&arguments[2]!==0[0]?arguments[2]:0;typeof t=="number"?(this.f=t,n=s.audiocontext.currentTime,i=this.oscillator.frequency.value,this.oscillator.frequency.cancelScheduledValues(n),this.oscillator.frequency.setValueAtTime(i,n+o),this.oscillator.frequency.exponentialRampToValueAtTime(t,o+a+n),this.osc2.oscillator.frequency.cancelScheduledValues(n),this.osc2.oscillator.frequency.setValueAtTime(i,n+o),this.osc2.oscillator.frequency.exponentialRampToValueAtTime(t,o+a+n),this.freqMod&&(this.freqMod.output.disconnect(),this.freqMod=null)):t.output&&(t.output.disconnect(),t.output.connect(this.oscillator.frequency),t.output.connect(this.osc2.oscillator.frequency),this.freqMod=t)}}]),t}(C);function lt(){for(var e,t=s.audiocontext,o=t.createBuffer(1,2048,t.sampleRate),i=o.getChannelData(0),n=0;n<2048;n++)i[n]=1;return e=t.createBufferSource(),e.buffer=o,e.loop=!0,e}dt=ct;function So(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ht(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function Yn(e,t,n){return t&&ht(e.prototype,t),n&&ht(e,n),e}s.inputSources=[],ft=function(){function e(t){So(this,e),this.input=s.audiocontext.createGain(),this.output=s.audiocontext.createGain(),this.stream=null,this.mediaStream=null,this.currentSource=null,this.enabled=!1,this.amplitude=new fe,this.output.connect(this.amplitude.input),(!window.MediaStreamTrack||!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)&&(t?t():window.alert("This browser does not support MediaStreamTrack and mediaDevices")),s.soundArray.push(this)}return Yn(e,[{key:"start",value:function(t,n){var i,a,o=this;this.stream&&this.stop(),a=s.inputSources[o.currentSource],i={audio:{sampleRate:s.audiocontext.sampleRate,echoCancellation:!1}},s.inputSources[this.currentSource]&&(i.audio.deviceId=a.deviceId),window.navigator.mediaDevices.getUserMedia(i).then(function(e){o.stream=e,o.enabled=!0,o.mediaStream=s.audiocontext.createMediaStreamSource(e),o.mediaStream.connect(o.output),o.amplitude.setInput(o.output),t&&t()}).catch(function(e){n?n(e):console.error(e)})}},{key:"stop",value:function(){this.stream&&(this.stream.getTracks().forEach(function(e){e.stop()}),this.mediaStream.disconnect(),delete this.mediaStream,delete this.stream)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):t.hasOwnProperty("analyser")?this.output.connect(t.analyser):this.output.connect(t):this.output.connect(s.input)}},{key:"disconnect",value:function(){this.output&&(this.output.disconnect(),this.output.connect(this.amplitude.input))}},{key:"getLevel",value:function(t){return t&&(this.amplitude.smoothing=t),this.amplitude.getLevel()}},{key:"amp",value:function(t,n){if(n){var o=n||0,i=this.output.gain.value;this.output.gain.cancelScheduledValues(s.audiocontext.currentTime),this.output.gain.setValueAtTime(i,s.audiocontext.currentTime),this.output.gain.linearRampToValueAtTime(t,o+s.audiocontext.currentTime)}else this.output.gain.cancelScheduledValues(s.audiocontext.currentTime),this.output.gain.setValueAtTime(t,s.audiocontext.currentTime)}},{key:"getSources",value:function(t,n){return new Promise(function(e,o){window.navigator.mediaDevices.enumerateDevices().then(function(n){s.inputSources=n.filter(function(e){return e.kind==="audioinput"}),e(s.inputSources),t&&t(s.inputSources)}).catch(function(e){o(e),n?n(e):console.error("This browser does not support MediaStreamTrack.getSources()")})})}},{key:"setSource",value:function(t){s.inputSources.length>0&&t<s.inputSources.length?(this.currentSource=t,console.log("set source to ",s.inputSources[this.currentSource])):console.log("unable to set input source"),this.stream&&this.stream.active&&this.start()}},{key:"dispose",value:function(){var t=s.soundArray.indexOf(this);s.soundArray.splice(t,1),this.stop(),this.output&&this.output.disconnect(),this.amplitude&&this.amplitude.disconnect(),delete this.amplitude,delete this.output}}]),e}(),pt=ft,gt=n(23),vt=n.n(gt);function Oo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jt(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function wo(e,t,n){return t&&jt(e.prototype,t),n&&jt(e,n),e}_t=function(){function e(){Oo(this,e),this.ac=s.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this._drywet=new vt.a(1),this.wet=this.ac.createGain(),this.input.connect(this._drywet.a),this.wet.connect(this._drywet.b),this._drywet.connect(this.output),this.connect(),s.soundArray.push(this)}return wo(e,[{key:"amp",value:function(t){var i=arguments.length>1&&arguments[1]!==0[0]?arguments[1]:0,a=arguments.length>2&&arguments[2]!==0[0]?arguments[2]:0,n=s.audiocontext.currentTime,o=n+a,r=o+i+.001,c=this.output.gain.value;this.output.gain.cancelScheduledValues(n),this.output.gain.linearRampToValueAtTime(c,o+.001),this.output.gain.linearRampToValueAtTime(t,r)}},{key:"chain",value:function(){if(arguments.length>0){this.connect(arguments[0]);for(var t=1;t<arguments.length;t+=1)arguments[t-1].connect(arguments[t])}return this}},{key:"drywet",value:function(t){return typeof t!="undefined"&&(this._drywet.fade.value=t),this._drywet.fade.value}},{key:"connect",value:function(t){var n=t||p5.soundOut.input;this.output.connect(n.input?n.input:n)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){var t=s.soundArray.indexOf(this);s.soundArray.splice(t,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._drywet&&(this._drywet.disconnect(),delete this._drywet),this.wet&&(this.wet.disconnect(),delete this.wet),this.ac=0[0]}}]),e}(),c=_t;function P(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?P=function(t){return typeof t}:P=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(e)}function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ct(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function jo(e,t,n){return t&&Ct(e.prototype,t),n&&Ct(e,n),e}function z(e,t){return t&&(P(t)==="object"||typeof t=="function")?t:go(e)}function go(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e,t,n){return typeof Reflect!="undefined"&&Reflect.get?L=Reflect.get:L=function(t,n,s){var o,i=mo(t,n);if(!i)return;return o=Object.getOwnPropertyDescriptor(i,n),o.get?o.get.call(s):o.value},L(e,t,n||e)}function mo(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t);)if(e=l(e),e===null)break;return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(e)}function $(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}function pe(e,t){return pe=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},pe(e,t)}_=function(e){$(t,e);function t(e){var n;return N(this,t),n=z(this,l(t).call(this)),n.biquad=n.ac.createBiquadFilter(),n.input.connect(n.biquad),n.biquad.connect(n.wet),e&&n.setType(e),n._on=!0,n._untoggledType=n.biquad.type,n}return jo(t,[{key:"process",value:function(t,n,s,o){t.connect(this.input),this.set(n,s,o)}},{key:"set",value:function(t,n,s){t&&this.freq(t,s),n&&this.res(n,s)}},{key:"freq",value:function(t,n){var s=n||0;return t<=0&&(t=1),typeof t=="number"?(this.biquad.frequency.cancelScheduledValues(this.ac.currentTime+.01+s),this.biquad.frequency.exponentialRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.biquad.frequency),this.biquad.frequency.value}},{key:"res",value:function(t,n){var s=n||0;return typeof t=="number"?(this.biquad.Q.value=t,this.biquad.Q.cancelScheduledValues(this.ac.currentTime+.01+s),this.biquad.Q.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.biquad.Q),this.biquad.Q.value}},{key:"gain",value:function(t,n){var s=n||0;return typeof t=="number"?(this.biquad.gain.value=t,this.biquad.gain.cancelScheduledValues(this.ac.currentTime+.01+s),this.biquad.gain.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.biquad.gain),this.biquad.gain.value}},{key:"toggle",value:function(){return this._on=!this._on,this._on===!0?this.biquad.type=this._untoggledType:this._on===!1&&(this.biquad.type="allpass"),this._on}},{key:"setType",value:function(t){this.biquad.type=t,this._untoggledType=this.biquad.type}},{key:"dispose",value:function(){L(l(t.prototype),"dispose",this).call(this),this.biquad&&(this.biquad.disconnect(),delete this.biquad)}}]),t}(c),Nt=function(e){$(t,e);function t(){return N(this,t),z(this,l(t).call(this,"lowpass"))}return t}(_),Lt=function(e){$(t,e);function t(){return N(this,t),z(this,l(t).call(this,"highpass"))}return t}(_),Rt=function(e){$(t,e);function t(){return N(this,t),z(this,l(t).call(this,"bandpass"))}return t}(_),M=_;function Y(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Y=function(t){return typeof t}:Y=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(e)}function lo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bt(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function ro(e,t,n){return t&&Bt(e.prototype,t),n&&Bt(e,n),e}function io(e,t){return t&&(Y(t)==="object"||typeof t=="function")?t:oo(e)}function oo(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e){return ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ue(e)}function Ys(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}function he(e,t){return he=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},he(e,t)}$e=function(e){Ys(t,e);function t(e,n){var s;return lo(this,t),s=io(this,ue(t).call(this,"peaking")),s.disconnect(),s.set(e,n),s.biquad.gain.value=0,delete s.input,delete s.output,delete s._drywet,delete s.wet,s}return ro(t,[{key:"amp",value:function(){console.warn("`amp()` is not available for p5.EQ bands. Use `.gain()`")}},{key:"drywet",value:function(){console.warn("`drywet()` is not available for p5.EQ bands.")}},{key:"connect",value:function(t){var n=t||p5.soundOut.input;this.biquad?this.biquad.connect(n.input?n.input:n):this.output.connect(n.input?n.input:n)}},{key:"disconnect",value:function(){this.biquad&&this.biquad.disconnect()}},{key:"dispose",value:function(){var t=s.soundArray.indexOf(this);s.soundArray.splice(t,1),this.disconnect(),delete this.biquad}}]),t}(M),Gt=$e;function re(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?re=function(t){return typeof t}:re=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},re(e)}function Ps(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zt(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function Ls(e,t,n){return t&&Zt(e.prototype,t),n&&Zt(e,n),e}function Ds(e,t){return t&&(re(t)==="object"||typeof t=="function")?t:zs(e)}function zs(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ae(e,t,n){return typeof Reflect!="undefined"&&Reflect.get?ae=Reflect.get:ae=function(t,n,s){var o,i=Ms(t,n);if(!i)return;return o=Object.getOwnPropertyDescriptor(i,n),o.get?o.get.call(s):o.value},ae(e,t,n||e)}function Ms(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t);)if(e=p(e),e===null)break;return e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(e)}function As(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}function me(e,t){return me=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},me(e,t)}cn=function(e){As(t,e);function t(e){Ps(this,t),n=Ds(this,p(t).call(this)),e=e===3||e===8?e:3,e===3?a=2**3:a=2,n.bands=[];for(var n,o,i,a,s=0;s<e;s++)s===e-1?(o=21e3,i=.01):s===0?(o=100,i=.1):s===1?(o=e===3?360*a:360,i=1):(o=n.bands[s-1].freq()*a,i=1),n.bands[s]=n._newBand(o,i),s>0?n.bands[s-1].connect(n.bands[s].biquad):n.input.connect(n.bands[s].biquad);return n.bands[e-1].connect(n.output),n}return Ls(t,[{key:"process",value:function(t){t.connect(this.input)}},{key:"set",value:function(){if(arguments.length===this.bands.length*2)for(var t=0;t<arguments.length;t+=2)this.bands[t/2].freq(arguments[t]),this.bands[t/2].gain(arguments[t+1]);else console.error("Argument mismatch. .set() should be called with "+this.bands.length*2+" arguments. (one frequency and gain value pair for each band of the eq)")}},{key:"_newBand",value:function(t,n){return new Gt(t,n)}},{key:"dispose",value:function(){if(ae(p(t.prototype),"dispose",this).call(this),this.bands){for(;this.bands.length>0;)delete this.bands.pop().dispose();delete this.bands}}}]),t}(c),ln=cn;function _s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function un(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function ys(e,t,n){return t&&un(e.prototype,t),n&&un(e,n),e}mn=function(){function e(){_s(this,e),this.ac=s.audiocontext,this.listener=this.ac.listener}return ys(e,[{key:"process",value:function(t){t.connect(this.input)}},{key:"position",value:function(t,n,s,o){return this.positionX(t,o),this.positionY(n,o),this.positionZ(s,o),[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}},{key:"positionX",value:function(t,n){var s=n||0;return typeof t=="number"?(this.listener.positionX.value=t,this.listener.positionX.cancelScheduledValues(this.ac.currentTime+.01+s),this.listener.positionX.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.listener.positionX),this.listener.positionX.value}},{key:"positionY",value:function(t,n){var s=n||0;return typeof t=="number"?(this.listener.positionY.value=t,this.listener.positionY.cancelScheduledValues(this.ac.currentTime+.01+s),this.listener.positionY.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.listener.positionY),this.listener.positionY.value}},{key:"positionZ",value:function(t,n){var s=n||0;return typeof t=="number"?(this.listener.positionZ.value=t,this.listener.positionZ.cancelScheduledValues(this.ac.currentTime+.01+s),this.listener.positionZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.listener.positionZ),this.listener.positionZ.value}},{key:"orient",value:function(t,n,s,o,i,a,r){return arguments.length===3||arguments.length===4?(r=arguments[3],this.orientForward(t,n,s,r)):(arguments.length===6||arguments===7)&&(this.orientForward(t,n,s),this.orientUp(o,i,a,r)),[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value,this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}},{key:"orientForward",value:function(t,n,s,o){return this.forwardX(t,o),this.forwardY(n,o),this.forwardZ(s,o),[this.listener.forwardX,this.listener.forwardY,this.listener.forwardZ]}},{key:"orientUp",value:function(t,n,s,o){return this.upX(t,o),this.upY(n,o),this.upZ(s,o),[this.listener.upX,this.listener.upY,this.listener.upZ]}},{key:"forwardX",value:function(t,n){var s=n||0;return typeof t=="number"?(this.listener.forwardX.value=t,this.listener.forwardX.cancelScheduledValues(this.ac.currentTime+.01+s),this.listener.forwardX.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.listener.forwardX),this.listener.forwardX.value}},{key:"forwardY",value:function(t,n){var s=n||0;return typeof t=="number"?(this.listener.forwardY.value=t,this.listener.forwardY.cancelScheduledValues(this.ac.currentTime+.01+s),this.listener.forwardY.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.listener.forwardY),this.listener.forwardY.value}},{key:"forwardZ",value:function(t,n){var s=n||0;return typeof t=="number"?(this.listener.forwardZ.value=t,this.listener.forwardZ.cancelScheduledValues(this.ac.currentTime+.01+s),this.listener.forwardZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.listener.forwardZ),this.listener.forwardZ.value}},{key:"upX",value:function(t,n){var s=n||0;return typeof t=="number"?(this.listener.upX.value=t,this.listener.upX.cancelScheduledValues(this.ac.currentTime+.01+s),this.listener.upX.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.listener.upX),this.listener.upX.value}},{key:"upY",value:function(t,n){var s=n||0;return typeof t=="number"?(this.listener.upY.value=t,this.listener.upY.cancelScheduledValues(this.ac.currentTime+.01+s),this.listener.upY.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.listener.upY),this.listener.upY.value}},{key:"upZ",value:function(t,n){var s=n||0;return typeof t=="number"?(this.listener.upZ.value=t,this.listener.upZ.cancelScheduledValues(this.ac.currentTime+.01+s),this.listener.upZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.listener.upZ),this.listener.upZ.value}}]),e}(),fn=mn;function se(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?se=function(t){return typeof t}:se=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(e)}function bs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vn(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function ps(e,t,n){return t&&vn(e.prototype,t),n&&vn(e,n),e}function fs(e,t){return t&&(se(t)==="object"||typeof t=="function")?t:ms(e)}function ms(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ne(e,t,n){return typeof Reflect!="undefined"&&Reflect.get?ne=Reflect.get:ne=function(t,n,s){var o,i=us(t,n);if(!i)return;return o=Object.getOwnPropertyDescriptor(i,n),o.get?o.get.call(s):o.value},ne(e,t,n||e)}function us(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t);)if(e=y(e),e===null)break;return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(e)}function ds(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}function ge(e,t){return ge=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},ge(e,t)}En=function(e){ds(t,e);function t(){var e;return bs(this,t),e=fs(this,y(t).call(this)),e.panner=e.ac.createPanner(),e.panner.panningModel="HRTF",e.panner.distanceModel="linear",e.panner.connect(e.output),e.input.connect(e.panner),e}return ps(t,[{key:"process",value:function(t){t.connect(this.input)}},{key:"set",value:function(t,n,s,o){return this.positionX(t,o),this.positionY(n,o),this.positionZ(s,o),[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}},{key:"positionX",value:function(t,n){var s=n||0;return typeof t=="number"?(this.panner.positionX.value=t,this.panner.positionX.cancelScheduledValues(this.ac.currentTime+.01+s),this.panner.positionX.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.panner.positionX),this.panner.positionX.value}},{key:"positionY",value:function(t,n){var s=n||0;return typeof t=="number"?(this.panner.positionY.value=t,this.panner.positionY.cancelScheduledValues(this.ac.currentTime+.01+s),this.panner.positionY.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.panner.positionY),this.panner.positionY.value}},{key:"positionZ",value:function(t,n){var s=n||0;return typeof t=="number"?(this.panner.positionZ.value=t,this.panner.positionZ.cancelScheduledValues(this.ac.currentTime+.01+s),this.panner.positionZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.panner.positionZ),this.panner.positionZ.value}},{key:"orient",value:function(t,n,s,o){return this.orientX(t,o),this.orientY(n,o),this.orientZ(s,o),[this.panner.orientationX.value,this.panner.orientationY.value,this.panner.orientationZ.value]}},{key:"orientX",value:function(t,n){var s=n||0;return typeof t=="number"?(this.panner.orientationX.value=t,this.panner.orientationX.cancelScheduledValues(this.ac.currentTime+.01+s),this.panner.orientationX.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.panner.orientationX),this.panner.orientationX.value}},{key:"orientY",value:function(t,n){var s=n||0;return typeof t=="number"?(this.panner.orientationY.value=t,this.panner.orientationY.cancelScheduledValues(this.ac.currentTime+.01+s),this.panner.orientationY.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.panner.orientationY),this.panner.orientationY.value}},{key:"orientZ",value:function(t,n){var s=n||0;return typeof t=="number"?(this.panner.orientationZ.value=t,this.panner.orientationZ.cancelScheduledValues(this.ac.currentTime+.01+s),this.panner.orientationZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):t&&t.connect(this.panner.orientationZ),this.panner.orientationZ.value}},{key:"setFalloff",value:function(t,n){this.maxDist(t),this.rolloff(n)}},{key:"maxDist",value:function(t){return typeof t=="number"&&(this.panner.maxDistance=t),this.panner.maxDistance}},{key:"rolloff",value:function(t){return typeof t=="number"&&(this.panner.rolloffFactor=t),this.panner.rolloffFactor}},{key:"dispose",value:function(){ne(y(t.prototype),"dispose",this).call(this),this.panner&&(this.panner.disconnect(),delete this.panner)}}]),t}(c),kn=En;function Z(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Z=function(t){return typeof t}:Z=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(e)}function cs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mn(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function rs(e,t,n){return t&&Mn(e.prototype,t),n&&Mn(e,n),e}function os(e,t){return t&&(Z(t)==="object"||typeof t=="function")?t:ns(e)}function ns(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q(e,t,n){return typeof Reflect!="undefined"&&Reflect.get?Q=Reflect.get:Q=function(t,n,s){var o,i=Jn(t,n);if(!i)return;return o=Object.getOwnPropertyDescriptor(i,n),o.get?o.get.call(s):o.value},Q(e,t,n||e)}function Jn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t);)if(e=w(e),e===null)break;return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},w(e)}function Qn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ve(e,t)}function ve(e,t){return ve=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},ve(e,t)}Hn=function(e){Qn(t,e);function t(){var e;return cs(this,t),e=os(this,w(t).call(this)),e._split=e.ac.createChannelSplitter(2),e._merge=e.ac.createChannelMerger(2),e._leftGain=e.ac.createGain(),e._rightGain=e.ac.createGain(),e.leftDelay=e.ac.createDelay(),e.rightDelay=e.ac.createDelay(),e._leftFilter=new M,e._rightFilter=new M,e._leftFilter.disconnect(),e._rightFilter.disconnect(),e._leftFilter.biquad.frequency.setValueAtTime(1200,e.ac.currentTime),e._rightFilter.biquad.frequency.setValueAtTime(1200,e.ac.currentTime),e._leftFilter.biquad.Q.setValueAtTime(.3,e.ac.currentTime),e._rightFilter.biquad.Q.setValueAtTime(.3,e.ac.currentTime),e.input.connect(e._split),e.leftDelay.connect(e._leftGain),e.rightDelay.connect(e._rightGain),e._leftGain.connect(e._leftFilter.input),e._rightGain.connect(e._rightFilter.input),e._merge.connect(e.wet),e._leftFilter.biquad.gain.setValueAtTime(1,e.ac.currentTime),e._rightFilter.biquad.gain.setValueAtTime(1,e.ac.currentTime),e.setType(0),e._maxDelay=e.leftDelay.delayTime.maxValue,e.feedback(.5),e}return rs(t,[{key:"process",value:function(t,n,s,o){var i=s||0,a=n||0;if(i>=1)throw new Error("Feedback value will force a positive feedback loop.");if(a>=this._maxDelay)throw new Error("Delay Time exceeds maximum delay time of "+this._maxDelay+" second.");t.connect(this.input),this.leftDelay.delayTime.setValueAtTime(a,this.ac.currentTime),this.rightDelay.delayTime.setValueAtTime(a,this.ac.currentTime),this._leftGain.gain.value=i,this._rightGain.gain.value=i,o&&(this._leftFilter.freq(o),this._rightFilter.freq(o))}},{key:"delayTime",value:function(t){typeof t!="number"?(t.connect(this.leftDelay.delayTime),t.connect(this.rightDelay.delayTime)):(this.leftDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.rightDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.leftDelay.delayTime.linearRampToValueAtTime(t,this.ac.currentTime),this.rightDelay.delayTime.linearRampToValueAtTime(t,this.ac.currentTime))}},{key:"feedback",value:function(t){if(t&&typeof t!="number")t.connect(this._leftGain.gain),t.connect(this._rightGain.gain);else if(t>=1)throw new Error("Feedback value will force a positive feedback loop.");else typeof t=="number"&&(this._leftGain.gain.value=t,this._rightGain.gain.value=t);return this._leftGain.gain.value}},{key:"filter",value:function(t,n){this._leftFilter.set(t,n),this._rightFilter.set(t,n)}},{key:"setType",value:function(t){switch(t===1&&(t="pingPong"),this._split.disconnect(),this._leftFilter.disconnect(),this._rightFilter.disconnect(),this._split.connect(this.leftDelay,0),this._split.connect(this.rightDelay,1),t){case"pingPong":this._rightFilter.setType(this._leftFilter.biquad.type),this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.rightDelay),this._rightFilter.output.connect(this.leftDelay);break;default:this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.leftDelay),this._rightFilter.output.connect(this.rightDelay)}}},{key:"dispose",value:function(){Q(w(t.prototype),"dispose",this).call(this),this._split.disconnect(),this._leftFilter.dispose(),this._rightFilter.dispose(),this._merge.disconnect(),this._leftGain.disconnect(),this._rightGain.disconnect(),this.leftDelay.disconnect(),this.rightDelay.disconnect(),this._split=0[0],this._leftFilter=0[0],this._rightFilter=0[0],this._merge=0[0],this._leftGain=0[0],this._rightGain=0[0],this.leftDelay=0[0],this.rightDelay=0[0]}}]),t}(c),In=Hn;function q(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?q=function(t){return typeof t}:q=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(e)}function Vn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $n(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function Wn(e,t,n){return t&&$n(e.prototype,t),n&&$n(e,n),e}function Un(e,t){return t&&(q(t)==="object"||typeof t=="function")?t:ko(e)}function ko(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t,n){return typeof Reflect!="undefined"&&Reflect.get?v=Reflect.get:v=function(t,n,s){var o,i=Ws(t,n);if(!i)return;return o=Object.getOwnPropertyDescriptor(i,n),o.get?o.get.call(s):o.value},v(e,t,n||e)}function Ws(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t);)if(e=d(e),e===null)break;return e}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(e)}function Pn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}function je(e,t){return je=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},je(e,t)}ye=function(e){Pn(t,e);function t(){var e;return Vn(this,t),e=Un(this,d(t).call(this)),e._initConvolverNode(),e.input.gain.value=.5,e._seconds=3,e._decay=2,e._reverse=!1,e._buildImpulse(),e}return Wn(t,[{key:"_initConvolverNode",value:function(){this.convolverNode=this.ac.createConvolver(),this.input.connect(this.convolverNode),this.convolverNode.connect(this.wet)}},{key:"_teardownConvolverNode",value:function(){this.convolverNode&&(this.convolverNode.disconnect(),delete this.convolverNode)}},{key:"_setBuffer",value:function(t){this._teardownConvolverNode(),this._initConvolverNode(),this.convolverNode.buffer=t}},{key:"process",value:function(t,n,s,o){t.connect(this.input);var i=!1;n&&(this._seconds=n,i=!0),s&&(this._decay=s),o&&(this._reverse=o),i&&this._buildImpulse()}},{key:"set",value:function(t,n,s){var o=!1;t&&(this._seconds=t,o=!0),n&&(this._decay=n),s&&(this._reverse=s),o&&this._buildImpulse()}},{key:"_buildImpulse",value:function(){var t,o,i=this.ac.sampleRate,n=i*this._seconds,a=this._decay,s=this.ac.createBuffer(2,n,i),r=s.getChannelData(0),c=s.getChannelData(1);for(t=0;t<n;t++)o=this._reverse?n-t:t,r[t]=(Math.random()*2-1)*(1-o/n)**a,c[t]=(Math.random()*2-1)*(1-o/n)**a;this._setBuffer(s)}},{key:"dispose",value:function(){v(d(t.prototype),"dispose",this).call(this),this._teardownConvolverNode()}}]),t}(c),_e=function(e){Pn(t,e);function t(e,n,s){var o;return Vn(this,t),o=Un(this,d(t).call(this)),o._initConvolverNode(),o.input.gain.value=.5,e?(o.impulses=[],o._loadBuffer(e,n,s)):(o._seconds=3,o._decay=2,o._reverse=!1,o._buildImpulse()),o.impulses=[],o.set=null,o}return Wn(t,[{key:"_loadBuffer",value:function(t,n,s){var c=p5.prototype._checkFileFormats(t),i=this,a=(new Error).stack,l=Object(r.b)(),o=new XMLHttpRequest;o.open("GET",c,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status===200)l.decodeAudioData(o.response,function(e){var t={},s=c.split("/");t.name=s[s.length-1],t.audioBuffer=e,i.impulses.push(t),i._setBuffer(t.audioBuffer),n&&n(t)},function(){var e=new u("decodeAudioData",a,i.url),t="AudioContext error at decodeAudioData for "+i.url;s?(e.msg=t,s(e)):console.error(t+`
 The error stack trace includes: 
`+e.stack)});else{var e=new u("loadConvolver",a,i.url),t="Unable to load "+i.url+". The request status was: "+o.status+" ("+o.statusText+")";s?(e.message=t,s(e)):console.error(t+`
 The error stack trace includes: 
`+e.stack)}},o.onerror=function(){var e=new u("loadConvolver",a,i.url),t="There was no response from the server at "+i.url+". Check the url and internet connectivity.";s?(e.message=t,s(e)):console.error(t+`
 The error stack trace includes: 
`+e.stack)},o.send()}},{key:"process",value:function(t){t.connect(this.input)}},{key:"addImpulse",value:function(t,n,s){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this._loadBuffer(t,n,s)}},{key:"resetImpulse",value:function(t,n,s){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this.impulses=[],this._loadBuffer(t,n,s)}},{key:"toggleImpulse",value:function(t){if(typeof t=="number"&&t<this.impulses.length&&this._setBuffer(this.impulses[t].audioBuffer),typeof t=="string")for(var n=0;n<this.impulses.length;n++)if(this.impulses[n].name===t){this._setBuffer(this.impulses[n].audioBuffer);break}}},{key:"dispose",value:function(){v(d(t.prototype),"dispose",this).call(this);for(var n in this.impulses)this.impulses[n]&&(this.impulses[n]=null)}}]),t}(ye);function es(e,t,n){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var s=this,o=new _e(e,function(e){typeof t=="function"&&t(e),typeof s._decrementPreload=="function"&&s._decrementPreload()},n);return o.impulses=[],o}Dn=n(11),Oe=n.n(Dn);function ss(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tn(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function is(e,t,n){return t&&Tn(e.prototype,t),n&&Tn(e,n),e}Fn=function(){function e(){ss(this,e),this.clock=new Oe.a({callback:this.ontick.bind(this)}),this.syncedParts=[],this.bpm=120,this._init(),this.prevTick=0,this.tatumTime=0,this.tickCallback=function(){}}return is(e,[{key:"ontick",value:function(t){var o,i=t-this.prevTick,n=t-s.audiocontext.currentTime;if(i-this.tatumTime<=-.02)return;this.prevTick=t,o=this,this.syncedParts.forEach(function(e){if(!e.isPlaying)return;e.incrementStep(n),e.phrases.forEach(function(e){var t=e.sequence,s=o.metroTicks%t.length;t[s]!==0&&(o.metroTicks<t.length||!e.looping)&&e.callback(n,t[s])})}),this.metroTicks+=1,this.tickCallback(n)}},{key:"setBPM",value:function(t){var o=arguments.length>1&&arguments[1]!==0[0]?arguments[1]:0,i=60/(t*this.tatums),n=s.audiocontext.currentTime;this.tatumTime=i,this.clock.frequency.setValueAtTime(this.clock.frequency.value,n),this.clock.frequency.linearRampToValueAtTime(t,n+o),this.bpm=t}},{key:"getBPM",value:function(){return this.clock.getRate()/this.tatums*60}},{key:"_init",value:function(){this.metroTicks=0}},{key:"resetSync",value:function(t){this.syncedParts=[t]}},{key:"pushSync",value:function(t){this.syncedParts.push(t)}},{key:"start",value:function(t){var n=t||0,o=s.audiocontext.currentTime;this.clock.start(o+n),this.setBPM(this.bpm)}},{key:"stop",value:function(t){var n=t||0,o=s.audiocontext.currentTime;this.clock.stop(o+n)}},{key:"beatLength",value:function(t){this.tatums=1/t/4}}]),e}(),xe=Fn;function Cn(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function xn(e,t,n){return t&&Cn(e.prototype,t),n&&Cn(e,n),e}function ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Ae=120,p5.prototype.setBPM=function(e,t){Ae=e;for(var n in s.parts)s.parts[n]&&s.parts[n].setBPM(e,t)},F=function e(t,n,s){ke(this,e),this.phraseStep=0,this.name=t,this.callback=n,this.sequence=s},jn=function(){function e(t,n){ke(this,e),this.length=t||0,this.partStep=0,this.phrases=[],this.isPlaying=!1,this.noLoop(),this.tatums=n||.0625,this.metro=new xe,this.metro._init(),this.metro.beatLength(this.tatums),this.metro.setBPM(Ae),s.parts.push(this),this.callback=function(){}}return xn(e,[{key:"setBPM",value:function(t,n){this.metro.setBPM(t,n)}},{key:"getBPM",value:function(){return this.metro.getBPM()}},{key:"start",value:function(t){if(!this.isPlaying){this.isPlaying=!0,this.metro.resetSync(this);var n=t||0;this.metro.start(n)}}},{key:"loop",value:function(t){this.looping=!0,this.onended=function(){this.partStep=0};var n=t||0;this.start(n)}},{key:"noLoop",value:function(){this.looping=!1,this.onended=function(){this.stop()}}},{key:"stop",value:function(t){this.partStep=0,this.pause(t)}},{key:"pause",value:function(t){this.isPlaying=!1;var n=t||0;this.metro.stop(n)}},{key:"addPhrase",value:function(t,n,s){var o;if(arguments.length===3)o=new F(t,n,s);else if(arguments[0]instanceof F)o=arguments[0];else throw"invalid input. addPhrase accepts name, callback, array or a p5.Phrase";this.phrases.push(o),o.sequence.length>this.length&&(this.length=o.sequence.length)}},{key:"removePhrase",value:function(t){for(var n in this.phrases)this.phrases[n].name===t&&this.phrases.splice(n,1)}},{key:"getPhrase",value:function(t){for(var n in this.phrases)if(this.phrases[n].name===t)return this.phrases[n]}},{key:"replaceSequence",value:function(t,n){for(var s in this.phrases)this.phrases[s].name===t&&(this.phrases[s].sequence=n)}},{key:"incrementStep",value:function(t){this.partStep<this.length-1?(this.callback(t),this.partStep+=1):!this.looping&&this.partStep===this.length-1&&this.onended()}},{key:"onStep",value:function(t){this.callback=t}}]),e}(),bn=function(){function e(){ke(this,e),this.parts=[],this.currentPart=new Array(arguments.length);var t,n=this;for(t in arguments)this.parts[t]=arguments[t],this.parts[t].nextPart=this.parts[t+1],this.parts[t].onended=function(){n.resetPart(t),gs(n)};this.looping=!1}return xn(e,[{key:"onended",value:function(){this.looping?this.parts[0].start():this.parts[this.parts.length-1].onended=function(){this.stop(),this.resetParts()},this.currentPart=0}},{key:"start",value:function(){this.parts[this.currentPart].start(),this.scoreStep=0}},{key:"stop",value:function(){this.parts[this.currentPart].stop(),this.currentPart=0,this.scoreStep=0}},{key:"pause",value:function(){this.parts[this.currentPart].stop()}},{key:"loop",value:function(){this.looping=!0,this.start()}},{key:"noLoop",value:function(){this.looping=!1}},{key:"resetParts",value:function(){var t=this;this.parts.forEach(function(e){t.resetParts[e]})}},{key:"resetPart",value:function(t){this.parts[t].stop(),this.parts[t].partStep=0;for(var n in this.parts[t].phrases)this.parts[t]&&(this.parts[t].phrases[n].phraseStep=0)}},{key:"setBPM",value:function(t,n){for(var s in this.parts)this.parts[s]&&this.parts[s].setBPM(t,n)}}]),e}();function gs(e){e.currentPart++,e.currentPart>=e.parts.length?(e.scoreStep=0,e.onended()):(e.scoreStep=0,e.parts[e.currentPart-1].stop(),e.parts[e.currentPart].start())}function vs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gn(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function js(e,t,n){return t&&gn(e.prototype,t),n&&gn(e,n),e}hn=function(){function e(t,n){vs(this,e),Object.defineProperty(this,"bpm",{get:function(){return this._bpm},set:function(t){this.musicalTimeMode||console.warn('Changing the BPM in "seconds" mode has no effect. BPM is only relevant in musicalTimeMode when the interval is specified as a string ("2n", "4n", "1m"...etc)'),this._bpm=t,this._update()}}),Object.defineProperty(this,"timeSignature",{get:function(){return this._timeSignature},set:function(t){this.musicalTimeMode||console.warn('Changing the timeSignature in "seconds" mode has no effect. BPM is only relevant in musicalTimeMode when the interval is specified as a string ("2n", "4n", "1m"...etc)'),this._timeSignature=t,this._update()}}),Object.defineProperty(this,"interval",{get:function(){return this._interval},set:function(t){this.musicalTimeMode=typeof t!="number",this._interval=t,this._update()}}),Object.defineProperty(this,"iterations",{get:function(){return this.clock.ticks}}),this.callback=t,this.musicalTimeMode=typeof this._interval!="number",this._interval=n||1,this._timeSignature=4,this._bpm=60,this.isPlaying=!1,this.maxIterations=1/0;var o=this;this.clock=new Oe.a({callback:function(t){var n=t-s.audiocontext.currentTime;n>0&&o.iterations<=o.maxIterations&&o.callback(n)},frequency:this._calcFreq()})}return js(e,[{key:"start",value:function(t){var n=t||0,o=s.audiocontext.currentTime;this.isPlaying||(this.clock.start(o+n),this.isPlaying=!0)}},{key:"stop",value:function(t){var n=t||0,o=s.audiocontext.currentTime;this.isPlaying&&(this.clock.stop(o+n),this.isPlaying=!1)}},{key:"pause",value:function(t){var n=t||0,o=s.audiocontext.currentTime;this.isPlaying&&(this.clock.pause(o+n),this.isPlaying=!1)}},{key:"syncedStart",value:function(t,n){var a,i=n||0,o=s.audiocontext.currentTime;t.isPlaying?t.isPlaying&&(a=t.clock._nextTick-s.audiocontext.currentTime,this.clock.start(o+a),this.isPlaying=!0):(t.clock.start(o+i),t.isPlaying=!0,this.clock.start(o+i),this.isPlaying=!0)}},{key:"_update",value:function(){this.clock.frequency.value=this._calcFreq()}},{key:"_calcFreq",value:function(){if(typeof this._interval=="number")return this.musicalTimeMode=!1,1/this._interval;if(typeof this._interval=="string")return this.musicalTimeMode=!0,this._bpm/60/this._convertNotation(this._interval)*(this._timeSignature/4)}},{key:"_convertNotation",value:function(t){var n=t.slice(-1);switch(t=Number(t.slice(0,-1)),n){case"m":return this._measure(t);case"n":return this._note(t);default:console.warn("Specified interval is not formatted correctly. See Tone.js timing reference for more info: https://github.com/Tonejs/Tone.js/wiki/Time")}}},{key:"_measure",value:function(t){return t*this._timeSignature}},{key:"_note",value:function(t){return this._timeSignature/t}}]),e}(),dn=hn;function D(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?D=function(t){return typeof t}:D=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(e)}function Os(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rn(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function Cs(e,t,n){return t&&rn(e.prototype,t),n&&rn(e,n),e}function Es(e,t){return t&&(D(t)==="object"||typeof t=="function")?t:ks(e)}function ks(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t,n){return typeof Reflect!="undefined"&&Reflect.get?R=Reflect.get:R=function(t,n,s){var o,i=Ss(t,n);if(!i)return;return o=Object.getOwnPropertyDescriptor(i,n),o.get?o.get.call(s):o.value},R(e,t,n||e)}function Ss(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t);)if(e=A(e),e===null)break;return e}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},A(e)}function Fs(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}function Fe(e,t){return Fe=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},Fe(e,t)}tn=function(e){Fs(t,e);function t(){var e;return Os(this,t),e=Es(this,A(t).call(this)),e.compressor=e.ac.createDynamicsCompressor(),e.input.connect(e.compressor),e.compressor.connect(e.wet),e}return Cs(t,[{key:"process",value:function(t,n,s,o,i,a){t.connect(this.input),this.set(n,s,o,i,a)}},{key:"set",value:function(t,n,s,o,i){typeof t!="undefined"&&this.attack(t),typeof n!="undefined"&&this.knee(n),typeof s!="undefined"&&this.ratio(s),typeof o!="undefined"&&this.threshold(o),typeof i!="undefined"&&this.release(i)}},{key:"attack",value:function(t,n){var s=n||0;return typeof t=="number"?(this.compressor.attack.value=t,this.compressor.attack.cancelScheduledValues(this.ac.currentTime+.01+s),this.compressor.attack.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):typeof t!="undefined"&&t.connect(this.compressor.attack),this.compressor.attack.value}},{key:"knee",value:function(t,n){var s=n||0;return typeof t=="number"?(this.compressor.knee.value=t,this.compressor.knee.cancelScheduledValues(this.ac.currentTime+.01+s),this.compressor.knee.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):typeof t!="undefined"&&t.connect(this.compressor.knee),this.compressor.knee.value}},{key:"ratio",value:function(t,n){var s=n||0;return typeof t=="number"?(this.compressor.ratio.value=t,this.compressor.ratio.cancelScheduledValues(this.ac.currentTime+.01+s),this.compressor.ratio.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):typeof t!="undefined"&&t.connect(this.compressor.ratio),this.compressor.ratio.value}},{key:"threshold",value:function(t,n){var s=n||0;return typeof t=="number"?(this.compressor.threshold.value=t,this.compressor.threshold.cancelScheduledValues(this.ac.currentTime+.01+s),this.compressor.threshold.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):typeof t!="undefined"&&t.connect(this.compressor.threshold),this.compressor.threshold.value}},{key:"release",value:function(t,n){var s=n||0;return typeof t=="number"?(this.compressor.release.value=t,this.compressor.release.cancelScheduledValues(this.ac.currentTime+.01+s),this.compressor.release.linearRampToValueAtTime(t,this.ac.currentTime+.02+s)):typeof number!="undefined"&&t.connect(this.compressor.release),this.compressor.release.value}},{key:"reduction",value:function(){return this.compressor.reduction.value}},{key:"dispose",value:function(){R(A(t.prototype),"dispose",this).call(this),this.compressor&&(this.compressor.disconnect(),delete this.compressor)}}]),t}(c),en=tn;function Ns(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jt(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function Rs(e,t,n){return t&&Jt(e.prototype,t),n&&Jt(e,n),e}Qt=function(){function e(t,n,s,o){Ns(this,e),this.framesPerPeak=o||20,this.framesSinceLastPeak=0,this.decayRate=.95,this.threshold=s||.35,this.cutoff=0,this.cutoffMult=1.5,this.energy=0,this.penergy=0,this.currentValue=0,this.isDetected=!1,this.f1=t||40,this.f2=n||2e4,this._onPeak=function(){}}return Rs(e,[{key:"update",value:function(t){var n=this.energy=t.getEnergy(this.f1,this.f2)/255;n>this.cutoff&&n>this.threshold&&n-this.penergy>0?(this._onPeak(),this.isDetected=!0,this.cutoff=n*this.cutoffMult,this.framesSinceLastPeak=0):(this.isDetected=!1,this.framesSinceLastPeak<=this.framesPerPeak?this.framesSinceLastPeak++:(this.cutoff*=this.decayRate,this.cutoff=Math.max(this.cutoff,this.threshold))),this.currentValue=n,this.penergy=n}},{key:"onPeak",value:function(t,n){var s=this;s._onPeak=function(){t(s.energy,n)}}}]),e}(),de=Qt;function Is(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xt(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function Vs(e,t,n){return t&&Xt(e.prototype,t),n&&Xt(e,n),e}g=s.audiocontext,We=function(){function e(){Is(this,e),this.input=g.createGain(),this.output=g.createGain(),this._inputChannels=2,this._outputChannels=2;var t=V(1024);this._workletNode=new AudioWorkletNode(g,x.a.recorderProcessor,{outputChannelCount:[this._outputChannels],processorOptions:{numInputChannels:this._inputChannels,bufferSize:t}}),this._workletNode.port.onmessage=function(e){if(e.data.name==="buffers"){var t=[new Float32Array(e.data.leftBuffer),new Float32Array(e.data.rightBuffer)];this._callback(t)}}.bind(this),this._callback=function(){},this._workletNode.connect(p5.soundOut._silentNode),this.setInput(),s.soundArray.push(this)}return Vs(e,[{key:"setInput",value:function(t){this.input.disconnect(),this.input=null,this.input=g.createGain(),this.input.connect(this._workletNode),this.input.connect(this.output),t?t.connect(this.input):p5.soundOut.output.connect(this.input)}},{key:"record",value:function(t,n,s){this._workletNode.port.postMessage({name:"start",duration:n}),t&&s?this._callback=function(e){t.setBuffer(e),s()}:t&&(this._callback=function(e){t.setBuffer(e)})}},{key:"stop",value:function(){this._workletNode.port.postMessage({name:"stop"})}},{key:"dispose",value:function(){var t=s.soundArray.indexOf(this);s.soundArray.splice(t,1),this._callback=function(){},this.input&&this.input.disconnect(),this.input=null,this._workletNode=null}}]),e}(),qt=We;function W(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?W=function(t){return typeof t}:W=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(e)}function qs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kt(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function Gs(e,t,n){return t&&Kt(e.prototype,t),n&&Kt(e,n),e}function Xs(e,t){return t&&(W(t)==="object"||typeof t=="function")?t:Qs(e)}function Qs(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(e,t,n){return typeof Reflect!="undefined"&&Reflect.get?U=Reflect.get:U=function(t,n,s){var o,i=Js(t,n);if(!i)return;return o=Object.getOwnPropertyDescriptor(i,n),o.get?o.get.call(s):o.value},U(e,t,n||e)}function Js(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t);)if(e=b(e),e===null)break;return e}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},b(e)}function to(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&De(e,t)}function De(e,t){return De=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},De(e,t)}function Ut(e){for(var s,o=typeof e=="number"?e:50,n=44100,i=new Float32Array(n),a=Math.PI/180,t=0;t<n;++t)s=t*2/n-1,i[t]=(3+o)*s*20*a/(Math.PI+o*(s<0?-s:s));return i}Wt=function(e){to(t,e);function t(e,n){if(qs(this,t),s=Xs(this,b(t).call(this)),typeof e=="undefined"&&(e=.25),typeof e!="number")throw new Error("amount must be a number");if(typeof n=="undefined"&&(n="2x"),typeof n!="string")throw new Error("oversample must be a String");var s,o=p5.prototype.map(e,0,1,0,2e3);return s.waveShaperNode=s.ac.createWaveShaper(),s.amount=o,s.waveShaperNode.curve=Ut(o),s.waveShaperNode.oversample=n,s.input.connect(s.waveShaperNode),s.waveShaperNode.connect(s.wet),s}return Gs(t,[{key:"process",value:function(t,n,s){t.connect(this.input),this.set(n,s)}},{key:"set",value:function(t,n){if(t){var s=p5.prototype.map(t,0,1,0,2e3);this.amount=s,this.waveShaperNode.curve=Ut(s)}n&&(this.waveShaperNode.oversample=n)}},{key:"getAmount",value:function(){return this.amount}},{key:"getOversample",value:function(){return this.waveShaperNode.oversample}},{key:"dispose",value:function(){U(b(t.prototype),"dispose",this).call(this),this.waveShaperNode&&(this.waveShaperNode.disconnect(),this.waveShaperNode=null)}}]),t}(c),$t=Wt;function ao(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vt(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function co(e,t,n){return t&&Vt(e.prototype,t),n&&Vt(e,n),e}It=function(){function e(){ao(this,e),this.ac=s.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.output),s.soundArray.push(this)}return co(e,[{key:"setInput",value:function(t){t.connect(this.input)}},{key:"connect",value:function(t){var n=t||p5.soundOut.input;this.output.connect(n.input?n.input:n)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"amp",value:function(t){var i=arguments.length>1&&arguments[1]!==0[0]?arguments[1]:0,o=arguments.length>2&&arguments[2]!==0[0]?arguments[2]:0,n=s.audiocontext.currentTime,a=this.output.gain.value;this.output.gain.cancelScheduledValues(n),this.output.gain.linearRampToValueAtTime(a,n+o),this.output.gain.linearRampToValueAtTime(t,n+o+i)}},{key:"dispose",value:function(){var t=s.soundArray.indexOf(this);s.soundArray.splice(t,1),this.output&&(this.output.disconnect(),delete this.output),this.input&&(this.input.disconnect(),delete this.input)}}]),e}(),Tt=It;function ho(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mt(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function fo(e,t,n){return t&&Mt(e.prototype,t),n&&Mt(e,n),e}St=function(){function e(){ho(this,e),this.ac=s.audiocontext,this.output=this.ac.createGain(),this.connect(),s.soundArray.push(this)}return fo(e,[{key:"play",value:function(){}},{key:"triggerAttack",value:function(){}},{key:"triggerRelease",value:function(){}},{key:"amp",value:function(){}},{key:"connect",value:function(t){var n=t||s.input;this.output.connect(n.input?n.input:n)}},{key:"disconnect",value:function(){this.output.disconnect()}},{key:"dispose",value:function(){this.output&&(this.output.disconnect(),delete this.output)}}]),e}(),Re=St;function te(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?te=function(t){return typeof t}:te=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(e)}function bo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Et(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function yo(e,t,n){return t&&Et(e.prototype,t),n&&Et(e,n),e}function _o(e,t){return t&&(te(t)==="object"||typeof t=="function")?t:Pe(e)}function Pe(e){if(e===0[0])throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ce(e,t,n){return typeof Reflect!="undefined"&&Reflect.get?ce=Reflect.get:ce=function(t,n,s){var o,i=xo(t,n);if(!i)return;return o=Object.getOwnPropertyDescriptor(i,n),o.get?o.get.call(s):o.value},ce(e,t,n||e)}function xo(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t);)if(e=S(e),e===null)break;return e}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},S(e)}function Eo(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}function Be(e,t){return Be=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},Be(e,t)}mt=.15,ut=function(e){Eo(t,e);function t(){var e;return bo(this,t),e=_o(this,S(t).call(this)),e.oscillator=new C,e.env=new it,e.env.setRange(1,0),e.env.setExp(!0),e.setADSR(.02,.25,.05,.35),e.oscillator.disconnect(),e.oscillator.connect(e.output),e.env.disconnect(),e.env.setInput(e.output.gain),e.oscillator.output.gain.value=1,e.oscillator.start(),e.connect(),s.soundArray.push(Pe(e)),Object.defineProperties(Pe(e),{attack:{get:function(){return this.env.aTime},set:function(t){this.env.setADSR(t,this.env.dTime,this.env.sPercent,this.env.rTime)}},decay:{get:function(){return this.env.dTime},set:function(t){this.env.setADSR(this.env.aTime,t,this.env.sPercent,this.env.rTime)}},sustain:{get:function(){return this.env.sPercent},set:function(t){this.env.setADSR(this.env.aTime,this.env.dTime,t,this.env.rTime)}},release:{get:function(){return this.env.rTime},set:function(t){this.env.setADSR(this.env.aTime,this.env.dTime,this.env.sPercent,t)}}}),e}return yo(t,[{key:"play",value:function(t,n,s,o){this.triggerAttack(t,n,~~s),this.triggerRelease(~~s+(o||mt))}},{key:"triggerAttack",value:function(t,n){var s=arguments.length>2&&arguments[2]!==0[0]?arguments[2]:0,o=X(t),i=n||.1;this.oscillator.freq(o,0,s),this.env.ramp(this.output.gain,s,i)}},{key:"triggerRelease",value:function(){var t=arguments.length>0&&arguments[0]!==0[0]?arguments[0]:0;this.env.ramp(this.output.gain,t,0)}},{key:"setADSR",value:function(t,n,s,o){this.env.setADSR(t,n,s,o)}},{key:"amp",value:function(t,n){var s=n||0;return typeof t!="undefined"&&this.oscillator.amp(t,s),this.oscillator.amp().value}},{key:"connect",value:function(t){var n=t||s.input;this.output.connect(n.input?n.input:n)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){ce(S(t.prototype),"dispose",this).call(this),this.env&&this.env.dispose(),this.oscillator&&this.oscillator.dispose()}}]),t}(Re),at=ut;function Fo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ot(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function zo(e,t,n){return t&&ot(e.prototype,t),n&&ot(e,n),e}st=function(){function e(t,n,s,o){Fo(this,e),this.isDetected=!1,this.freqLow=t,this.freqHigh=n,this.treshold=s,this.energy=0,this.penergy=0,this.sensitivity=500,this.callback=o}return zo(e,[{key:"update",value:function(t,n){if(this.energy=t.getEnergy(this.freqLow,this.freqHigh)/255,this.isDetected===!1&&this.energy-this.penergy>this.treshold){this.isDetected=!0,this.callback?this.callback(this.energy):n&&n(this.energy);var s=this;setTimeout(function(){s.isDetected=!1},this.sensitivity)}this.penergy=this.energy}}]),e}(),nt=st;function Lo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function et(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function Po(e,t,n){return t&&et(e.prototype,t),n&&et(e,n),e}Je=function(){function e(t,n){Lo(this,e),this.audiovoices=[],this.notes={},this._newest=0,this._oldest=0,this.maxVoices=n||8,this.AudioVoice=t===0[0]?p5.MonoSynth:t,this._voicesInUse=new K.a(0),this.output=s.audiocontext.createGain(),this.connect(),this._allocateVoices(),s.soundArray.push(this)}return Po(e,[{key:"_allocateVoices",value:function(){for(var t=0;t<this.maxVoices;t++)this.audiovoices.push(new this.AudioVoice),this.audiovoices[t].disconnect(),this.audiovoices[t].connect(this.output)}},{key:"play",value:function(t,n,s){var o=arguments.length>3&&arguments[3]!==0[0]?arguments[3]:1;this.noteAttack(t,n,s),this.noteRelease(t,s+o)}},{key:"noteADSR",value:function(t,n,o,i,a){var r=arguments.length>5&&arguments[5]!==0[0]?arguments[5]:0,c=s.audiocontext.currentTime,l=c+r;this.audiovoices[this.notes[t].getValueAtTime(l)].setADSR(n,o,i,a)}},{key:"setADSR",value:function(t,n,s,o){this.audiovoices.forEach(function(e){e.setADSR(t,n,s,o)})}},{key:"noteAttack",value:function(t,n){var r,c,d,l=arguments.length>2&&arguments[2]!==0[0]?arguments[2]:0,o=s.audiocontext.currentTime+l,i=X(t),a=n||.1;this.notes[i]&&this.notes[i].getValueAtTime(o)!==null&&this.noteRelease(i,0),this._voicesInUse.getValueAtTime(o)<this.maxVoices?r=Math.max(~~this._voicesInUse.getValueAtTime(o),0):(r=this._oldest,oldestNote=At(this.audiovoices[this._oldest].oscillator.freq().value),this.noteRelease(oldestNote),this._oldest=(this._oldest+1)%(this.maxVoices-1)),this.notes[i]=new K.a,this.notes[i].setValueAtTime(r,o),d=this._voicesInUse._searchBefore(o)===null?0:this._voicesInUse._searchBefore(o).value,this._voicesInUse.setValueAtTime(d+1,o),this._updateAfter(o,1),this._newest=r,typeof a=="number"&&(c=1/this._voicesInUse.getValueAtTime(o)*2,a=a>c?c:a),this.audiovoices[r].triggerAttack(i,a,l)}},{key:"_updateAfter",value:function(t,n){if(this._voicesInUse._searchAfter(t)===null)return;this._voicesInUse._searchAfter(t).value+=n;var s=this._voicesInUse._searchAfter(t).time;this._updateAfter(s,n)}},{key:"noteRelease",value:function(t,n){var i,r,c,l=s.audiocontext.currentTime,a=n||0,o=l+a;if(!t){this.audiovoices.forEach(function(e){e.triggerRelease(a)}),this._voicesInUse.setValueAtTime(0,o);for(c in this.notes)this.notes[c].dispose(),delete this.notes[c];return}i=X(t),!this.notes[i]||this.notes[i].getValueAtTime(o)===null?console.warn("Cannot release a note that is not already playing"):(r=Math.max(~~this._voicesInUse.getValueAtTime(o).value,1),this._voicesInUse.setValueAtTime(r-1,o),r>0&&this._updateAfter(o,-1),this.audiovoices[this.notes[i].getValueAtTime(o)].triggerRelease(a),this.notes[i].dispose(),delete this.notes[i],this._newest=this._newest===0?0:(this._newest-1)%(this.maxVoices-1))}},{key:"connect",value:function(t){var n=t||s.input;this.output.connect(n.input?n.input:n)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){this.audiovoices.forEach(function(e){e.dispose()}),this.output&&(this.output.disconnect(),delete this.output)}}]),e}(),qe=Je;function Bo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Ke=function e(){Bo(this,e),console.warn("p5.Signal is deprecated , Use Tone.js Signal instead ")},Ue=Ke,p5.prototype.getAudioContext=r.b,p5.prototype.userStartAudio=r.c,p5.prototype.sampleRate=vo,p5.prototype.freqToMidi=At,p5.prototype.midiToFreq=J,p5.prototype.noteToFreq=X,p5.prototype.soundFormats=no,p5.prototype.disposeSound=eo,p5.prototype._checkFileFormats=Zs,p5.prototype._mathChain=Ao,p5.prototype.convertToWav=ze,p5.prototype.interleave=Yt,p5.prototype.writeUTFBytes=O,p5.prototype.safeBufferSize=V,p5.prototype.saveSound=Hs,p5.prototype.registerMethod("remove",p5.prototype.disposeSound),p5.Panner=H,p5.SoundFile=Ln,p5.prototype.loadSound=Xn,p5.prototype.registerPreloadMethod("loadSound",p5.prototype),p5.Amplitude=fe,p5.FFT=Ht,p5.Oscillator=C,p5.SinOsc=kt,p5.TriOsc=xt,p5.SawOsc=Me,p5.SqrOsc=Ot,p5.Noise=Xe,p5.Pulse=dt,p5.AudioIn=pt,p5.Effect=c,p5.Filter=M,p5.LowPass=Nt,p5.HighPass=Lt,p5.BandPass=Rt,p5.EQ=ln,p5.listener3D=fn,p5.Panner3D=kn,p5.Delay=In,p5.Reverb=ye,p5.Convolver=_e,p5.prototype.createConvolver=es,p5.prototype.registerPreloadMethod("createConvolver",p5.prototype),p5.Metro=xe,p5.Phrase=F,p5.Part=jn,p5.Score=bn,p5.SoundLoop=dn,p5.Compressor=en,p5.peakDetect=de,p5.SoundRecorder=qt,p5.Distortion=$t,p5.Gain=Tt,p5.AudioVoice=Re,p5.MonoSynth=at,p5.OnsetDetect=nt,p5.PolySynth=qe,p5.PeakDetect=de,p5.Signal=Ue}])