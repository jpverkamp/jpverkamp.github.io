<!doctype html><html><head><title>Parsing PEM Certificates & ASN.1 in Javascript – jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_17422284542669262002.min.834c1e2313951f0c25b90152fe8b62250eab4a2e8cbd2560fa1a1cdc91c71733.js integrity="sha256-g0weIxOVHwwluQFS/otiJQ6rSi6MvSVg+hoc3JHHFzM=" defer></script><script src=/jquery.fancybox_16245765822111608191.min.ef050764ff69f3287c89ff655825479dd8304dcd9bc653d1ddd4772a701ad445.js integrity="sha256-7wUHZP9p8yh8if9lWCVHndgwTc2bxlPR3dR3KnAa1EU=" defer></script><script src=/katex_17296078054267651618.min.deed0e78a77391517d530a00324ce7b760ac204134992ef22d36f583615ae498.js integrity="sha256-3u0OeKdzkVF9UwoAMkznt2CsIEE0mS7yLTb1g2Fa5Jg=" defer></script><script src=/auto-render_14944144240389301023.min.e694d9d5eae2917984179683ead27b998784a81398e8836c369373d2c67fc32a.js integrity="sha256-5pTZ1erikXmEF5aD6tJ7mYeEqBOY6INsNpNz0sZ/wyo=" defer></script><script src=/bigfoot_28293813221957978.min.af671f08986f0a2267c5a0cb2748b005489e47fa25f55479b200e2a563d23022.js integrity="sha256-r2cfCJhvCiJnxaDLJ0iwBUieR/ol9VR5sgDipWPSMCI=" defer></script><script src=/mermaid_9520146763733687737.min.bfe50b47c0387e3c3bf97ec5f338bba94f7ccb02f962a4aec8cf0b4d68c8434d.js integrity="sha256-v+ULR8A4fjw7+X7F8zi7qU98ywL5YqSuyM8LTWjIQ00=" defer></script><script src=/main.min.d60298c89fc4f1e938aceb45c60926efee8b03efc8b50683082e669a100da643.js integrity="sha256-1gKYyJ/E8ek4rOtFxgkm7+6LA+/ItQaDCC5mmhANpkM=" defer></script><link rel=stylesheet href=/katex_13658330645258633971.min.64e42891d651aee0b8cd02ec9227ff271d37bcf06dae985d1acf0eba1623e850.css integrity="sha256-ZOQokdZRruC4zQLskif/Jx03vPBtrphdGs8OuhYj6FA="><link rel=stylesheet href=/bigfoot-default_8781527669040159104.min.0d2b289fa3451447692959fcee5676b846532fe7ab50ddc4660824c42d4adcd7.css integrity="sha256-DSson6NFFEdpKVn87lZ2uEZTL+erUN3EZggkxC1K3Nc="><link rel=stylesheet href=/jquery.fancybox_5330465509389191777.min.67505d77381ebd82623ab9296c1989c44ec828d867c00296e80e52ef860cac37.css integrity="sha256-Z1BddzgevYJiOrkpbBmJxE7IKNhnwAKW6A5S74YMrDc="><link rel=stylesheet href=/css_1846377409604050217.min.fffe842bc000dd1fe8661ac6427a392a08faa95e8edab1ea7fb98c5f8dac6a6f.css integrity="sha256-//6EK8AA3R/oZhrGQno5Kgj6qV6O2rHqf7mMX42sam8="><link rel=stylesheet href=/main.min.b60cba31b8c292392a2d336408f8f344e261df78516eb17bcf029173b24a42b5.css integrity="sha256-tgy6MbjCkjkqLTNkCPjzROJh33hRbrF7zwKRc7JKQrU="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=/search/ method=get class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/home-automation/>Home Automation</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li><a href=https://blog.jverkamp.com/search/>Search</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article data-pagefind-body><header><h1 class=entry-title data-pagefind-meta=title>Parsing PEM Certificates & ASN.1 in Javascript</h1><div class=entry-meta><span class=entry-date>2025-05-29</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a class=taxonomy-value href=/programming/topics/asn.1>ASN.1</a></li><li><a class=taxonomy-value href=/programming/topics/certificates>Certificates</a></li><li><a href=https://blog.jverkamp.com/2025/02/05/webcrypto-sha-256-hmac/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/cryptography>Cryptography</a></li><li><a href=https://blog.jverkamp.com/2025/02/05/webcrypto-sha-256-hmac/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/hmac>HMAC</a></li><li><a href=https://blog.jverkamp.com/2024/12/03/aoc-2024-day-3-mulinator/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/parsing>Parsing</a></li><li><a class=taxonomy-value href=/programming/topics/pem>PEM</a></li><li><a href=https://blog.jverkamp.com/2025/02/05/webcrypto-sha-256-hmac/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/sha-256>SHA-256</a></li><li><a href=https://blog.jverkamp.com/2025/02/05/webcrypto-sha-256-hmac/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/signing>Signing</a></li></ul></li><li><a class=taxonomy-key href=/series/>Series</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2025/02/19/a-quick-mitmproxy-setup/ class=previous-link></a><a class=taxonomy-value href=/series/coding-quick-tips>Coding Quick Tips</a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2025/04/21/solving-woodworm/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2025/07/21/building-a-virtual-cpu-from-nand-gates-up/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2025/05/24/severance-season-2/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2025/05/31/the-marvels/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>I recently had a conversation about parsing HTTPS/TLS/etc certificates client side (so that various values could be compared). There are, of course, <a href=https://asn1js.org/ target=_blank rel=noopener>libraries</a> for that, but where&rsquo;s the fun in that? Let&rsquo;s dig in ourselves!</p><p>I thought of course it would be a well specified format and it wouldn&rsquo;t take more than a few minutes to parse&mldr; right?</p><p>Right?</p><nav id=TableOfContents><ul><li><a href=#parsing>Parsing</a></li><li><a href=#decoding-some-datatypes>Decoding some datatypes</a><ul><li><a href=#object-identifiers--oids>Object Identifiers &ndash; OIDs</a></li><li><a href=#numbers>Numbers</a></li><li><a href=#dates>Dates</a></li></ul></li><li><a href=#printing-results>Printing results</a></li><li><a href=#an-example>An example</a></li><li><a href=#constants>Constants</a></li></ul></nav><hr><h2 id=parsing>Parsing</h2><p>Okay, it&rsquo;s not as bad as all that. The outermost format we&rsquo;re dealing with is [[wiki:PEM|PEM]]. Those <code>-----BEGIN THING----</code> things. Inside of that, we have binary data that has been <a href=https://en.wikipedia.org/wiki/base64>base64</a> encoded.</p><p>So first, let&rsquo;s get the base64 decoding out of the way:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// Parses a PEM-encoded certificate or key and returns an array of objects
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>parsePEM</span>(<span style=color:#a6e22e>pem</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pemRegex</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/-----BEGIN ([A-Z ]+)-----([\s\S]+?)-----END \1-----/g</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>matches</span> <span style=color:#f92672>=</span> [...<span style=color:#a6e22e>pem</span>.<span style=color:#a6e22e>matchAll</span>(<span style=color:#a6e22e>pemRegex</span>)];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>matches</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>match</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>match</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>base64</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>match</span>[<span style=color:#ae81ff>2</span>].<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/\s+/g</span>, <span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>der</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Uint8Array</span>.<span style=color:#a6e22e>from</span>(<span style=color:#a6e22e>atob</span>(<span style=color:#a6e22e>base64</span>), (<span style=color:#a6e22e>c</span>) =&gt; <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>charCodeAt</span>(<span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> { <span style=color:#a6e22e>type</span>, <span style=color:#a6e22e>der</span> };
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This will find each certificate in a file (<a href=https://en.wikipedia.org/wiki/regex>regex</a>!), pull out all whitespace, and then convert it to an array of bytes (<code>Uint8Array</code>).</p><p>Now things get interesting. The binary is in the <a href=https://en.wikipedia.org/wiki/ASN.1>ASN.1</a> format, which is a tree structure packed into the binary. At each level, fields are encoded as <code>[Tag, Length, Value]</code>.</p><p>The <code>Tag</code> is fairly well defined, see the <a href=#constants>the constants</a> later. The first two bits define the &lsquo;class&rsquo; of teh tag: universal, application, context-specific, or private. The next bit defines what kind it is: primitive (basic values like numbers) or constructed (a value that can have children, like sets and sequences). The rest is the actual tag itself.</p><p>The <code>Length</code> field can either be a single byte (if &lt; 127, thus the first bit is 0) or a multibyte encoding wherein the first bit is 0, the rest of the byte is how many bytes the full length takes up. There&rsquo;s also technically an &lsquo;indefinite form&rsquo; (where you don&rsquo;t know the length), but for our cases here, we don&rsquo;t need that.</p><p>And finally, the <code>Value</code>. For primitive types, this is just whatever bytes are stored in the next <code>Length</code> decoded in a variety of ways (see <a href=#decoding-some-datatypes>decoding</a> later).</p><p>For For some kinds of data (<code>constructed</code>), the <code>Value</code> is actually some number of child nodes. To parse those, we basically recursively parse the next object from our stream of bytes&mldr; up until we&rsquo;ve used up <code>Value</code> of them total. We have no idea how many children we&rsquo;ll see or how deep it nests until we&rsquo;ve done it. Interesting that.</p><p>So to turn that all into code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// Reads an ASN.1 structure from a byte array and returns an object representation
</span></span></span><span style=display:flex><span><span style=color:#75715e>// https://www.oss.com/asn1/resources/asn1-made-simple/asn1-quick-reference/basic-encoding-rules.html
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>readASN1</span>(<span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>offset</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>start</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>offset</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tag</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>offset</span><span style=color:#f92672>++</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lengthByte</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>offset</span><span style=color:#f92672>++</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Lengths &gt; 127 are encoded as a multi-byte length
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>lengthByte</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x80</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>numBytes</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>lengthByte</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x7f</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>length</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>numBytes</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>length</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>8</span>) <span style=color:#f92672>|</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>offset</span><span style=color:#f92672>++</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>length</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>lengthByte</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>slice</span>(<span style=color:#a6e22e>offset</span>, <span style=color:#a6e22e>offset</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Tag classes are encoded in the high bits of the tag byte
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tagClass</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tag</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x1f</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// &#39;Constructed&#39; tags have children (SET/SEQUENCE/etc)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isConstructed</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>tag</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x20</span>) <span style=color:#f92672>!==</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>children</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isConstructed</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>childOffset</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>childOffset</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>length</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>child</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readASN1</span>(<span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>childOffset</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>children</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>child</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>childOffset</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>child</span>.<span style=color:#a6e22e>totalLength</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tag</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tagClass</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>isConstructed</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>length</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>totalLength</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>offset</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>start</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>value</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>children</span>,
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>It&rsquo;s kind of amazing how relatively &lsquo;complicated&rsquo; of a file format can be packed like this.</p><p>Now, this doesn&rsquo;t <em>by itself</em> give us enough information to decode a PEM, so&mldr;</p><h2 id=decoding-some-datatypes>Decoding some datatypes</h2><p>The next thing we&rsquo;ll want to do is write decoders for a few specific kinds of primitive <code>Value</code>.</p><h3 id=object-identifiers--oids>Object Identifiers &ndash; OIDs</h3><p>First (and perhaps most important for PEMs), we have object identifiers. These are defined as their own hierarchical list of values, for example:</p><ul><li><code>2 5 29 14</code> - <code>subjectKeyIdentifier</code></li><li><code>2 5 29 15</code> - <code>keyUsage</code></li><li><code>2 5 29 17</code> - <code>subjectAltName</code></li><li><code>2 5 29 19</code> - <code>basicConstraints</code></li><li><code>2 5 29 31</code> - <code>cRLDistributionPoints</code></li><li><code>2 5 29 32</code> - <code>certificatePolicies</code></li><li><code>2 5 29 35</code> - <code>authorityKeyIdentifier</code></li><li><code>2 5 29 37</code> - <code>extKeyUsage</code></li><li><code>2 5 4 10</code> - <code>organizationName</code></li><li><code>2 5 4 11</code> - <code>organizationalUnitName</code></li><li><code>2 5 4 3</code> - <code>commonName</code></li><li><code>2 5 4 6</code> - <code>countryName</code></li><li><code>2 5 4 7</code> - <code>localityName</code></li><li><code>2 5 4 8</code> - <code>stateOrProvinceName</code></li></ul><p>So <code>2 5 29</code> is the general PEM stuff with specific values for specific keys. It&rsquo;s kind of handy that they can encode these as numeric values (rather than say, strings as JSON would do). Somewhat more compact. But because the actual <em>names</em> of these values aren&rsquo;t stored in the ASN.1 data itself&mldr; well, you just have to find a list. <a href=https://www.cs.auckland.ac.nz/~pgut001/dumpasn1.cfg target=_blank rel=noopener>Here is one</a> that I found useful for this project.</p><p>So how do we decode OIDs?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// Decodes an OID from a byte array and returns it as a string
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>decodeOID</span>(<span style=color:#a6e22e>bytes</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>values</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>first</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#66d9ef>byte</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>bytes</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>first</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>values</span>.<span style=color:#a6e22e>push</span>(Math.<span style=color:#a6e22e>floor</span>(<span style=color:#66d9ef>byte</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>40</span>));
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>values</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>byte</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>40</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>first</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>value</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>7</span>) <span style=color:#f92672>|</span> (<span style=color:#66d9ef>byte</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x7f</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ((<span style=color:#66d9ef>byte</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x80</span>) <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>values</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>values</span>.<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=numbers>Numbers</h3><p>Next up, numeric values. The interesting one here is serial number in the certificate&mldr; which I don&rsquo;t seem to have decoded correctly. Because it&rsquo;s bigger then the integer size I&rsquo;m using here, I expect. But I didn&rsquo;t really need this, so &#x1f937;.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// Decodes an integer from a byte array and returns it as a number
</span></span></span><span style=display:flex><span><span style=color:#75715e>// TODO: This doesn&#39;t seem to be handling large values correctly
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>decodeInteger</span>(<span style=color:#a6e22e>bytes</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>bytes</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>result</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>8</span>) <span style=color:#f92672>|</span> <span style=color:#a6e22e>bytes</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=dates>Dates</h3><p>Next, we have dates: <code>UTCTime</code> and <code>GeneralizedTime</code>. The problem here is that the older <code>UTCTime</code> does this screwy thing where the year is only encoded as two bytes. If it&rsquo;s &lt; 50, it&rsquo;s 20**, but more than and it&rsquo;s 19**. So of course <code>GeneralizedTime</code> properly uses 4 digits for the year. &#x1f604;</p><p>It&rsquo;s interesting that they didn&rsquo;t just use <a href=https://en.wikipedia.org/wiki/Unix%20timestamps>Unix timestamps</a> for this, but so it goes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// Decode datetime from a byte array
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>decodeUTCTime</span>(<span style=color:#a6e22e>bytes</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>text</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TextDecoder</span>().<span style=color:#a6e22e>decode</span>(<span style=color:#a6e22e>bytes</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>match</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/^(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})?Z$/</span>.<span style=color:#a6e22e>exec</span>(<span style=color:#a6e22e>text</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>match</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`Invalid UTCTime: &#34;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>text</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> [, <span style=color:#a6e22e>yy</span>, <span style=color:#a6e22e>mm</span>, <span style=color:#a6e22e>dd</span>, <span style=color:#a6e22e>hh</span>, <span style=color:#a6e22e>min</span>, <span style=color:#a6e22e>ss</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;00&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>match</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Handle 2-digit year
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>year</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    parseInt(<span style=color:#a6e22e>yy</span>, <span style=color:#ae81ff>10</span>) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>50</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>2000</span> <span style=color:#f92672>+</span> parseInt(<span style=color:#a6e22e>yy</span>, <span style=color:#ae81ff>10</span>) <span style=color:#f92672>:</span> <span style=color:#ae81ff>1900</span> <span style=color:#f92672>+</span> parseInt(<span style=color:#a6e22e>yy</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>date</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date(
</span></span><span style=display:flex><span>    Date.<span style=color:#a6e22e>UTC</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>year</span>,
</span></span><span style=display:flex><span>      parseInt(<span style=color:#a6e22e>mm</span>, <span style=color:#ae81ff>10</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      parseInt(<span style=color:#a6e22e>dd</span>, <span style=color:#ae81ff>10</span>),
</span></span><span style=display:flex><span>      parseInt(<span style=color:#a6e22e>hh</span>, <span style=color:#ae81ff>10</span>),
</span></span><span style=display:flex><span>      parseInt(<span style=color:#a6e22e>min</span>, <span style=color:#ae81ff>10</span>),
</span></span><span style=display:flex><span>      parseInt(<span style=color:#a6e22e>ss</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>date</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Decode generalized time from a byte array
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>decodeGeneralizedTime</span>(<span style=color:#a6e22e>bytes</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>text</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TextDecoder</span>().<span style=color:#a6e22e>decode</span>(<span style=color:#a6e22e>bytes</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Regex to parse: YYYYMMDDHHMMSS(.sss)?(Z|+hhmm|-hhmm)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>regex</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/^(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\.\d+)?(Z|([+\-])(\d{2})(\d{2}))?$/</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>match</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>regex</span>.<span style=color:#a6e22e>exec</span>(<span style=color:#a6e22e>text</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>match</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`Invalid GeneralizedTime: &#34;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>text</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [
</span></span><span style=display:flex><span>    ,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>year</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>month</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>day</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>hour</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>minute</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>second</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fraction</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tz</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tzSign</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tzHour</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tzMinute</span>,
</span></span><span style=display:flex><span>  ] <span style=color:#f92672>=</span> <span style=color:#a6e22e>match</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Build date string for ISO 8601 parsing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>iso</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>year</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>month</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>day</span><span style=color:#e6db74>}</span><span style=color:#e6db74>T</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>hour</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>minute</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>second</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>fraction</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>iso</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>fraction</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>tz</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>tz</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;Z&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>iso</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#34;Z&#34;</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>iso</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>tzSign</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>tzHour</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;:&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>tzMinute</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>date</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date(<span style=color:#a6e22e>iso</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (isNaN(<span style=color:#a6e22e>date</span>)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`Invalid GeneralizedTime date: &#34;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>text</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>date</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=printing-results>Printing results</h2><p>Okay, we have the data encoded as a giant nested Javascript object and some decoders in place, let&rsquo;s write a function that can actually print these things out for us:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// Recursively prints an ASN.1 structure in a human-readable format
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>printASN1</span>(<span style=color:#a6e22e>node</span>, <span style=color:#a6e22e>depth</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>indent</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;  &#34;</span>.<span style=color:#a6e22e>repeat</span>(<span style=color:#a6e22e>depth</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tagNumber</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>node</span>.<span style=color:#a6e22e>tag</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x1f</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tagName</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ASN1_UNIVERSAL_TAGS</span>[<span style=color:#a6e22e>tagNumber</span>] <span style=color:#f92672>||</span> <span style=color:#e6db74>`Tag(</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>tagNumber</span><span style=color:#e6db74>}</span><span style=color:#e6db74>)`</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>output</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>indent</span><span style=color:#e6db74>}</span><span style=color:#e6db74>- </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>tagName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>node</span>.<span style=color:#a6e22e>isConstructed</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Dump as hex, but truncate if too long
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>hex</span> <span style=color:#f92672>=</span> [...<span style=color:#a6e22e>node</span>.<span style=color:#a6e22e>value</span>]
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>b</span>) =&gt; <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>16</span>).<span style=color:#a6e22e>padStart</span>(<span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#34;0&#34;</span>))
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>shortHex</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>hex</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>32</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>hex</span>.<span style=color:#a6e22e>slice</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>32</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;… (&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>hex</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; bytes)&#34;</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>hex</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>shortHex</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>output</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>` | Hex: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>shortHex</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Attempt to decode as UTF-8 if possible
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>utf8</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>utf8</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TextDecoder</span>().<span style=color:#a6e22e>decode</span>(<span style=color:#a6e22e>node</span>.<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> {}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>utf8</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#e6db74>/^[\x20-\x7E]*$/</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>utf8</span>)) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>output</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>` | UTF-8: &#34;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>utf8</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;`</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>tagNumber</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0x02</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// INTEGER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>output</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>` | Int: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>decodeInteger</span>(<span style=color:#a6e22e>node</span>.<span style=color:#a6e22e>value</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>tagNumber</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0x17</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// UTCTime
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>date</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>decodeUTCTime</span>(<span style=color:#a6e22e>node</span>.<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>output</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>` | Date: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>date</span>.<span style=color:#a6e22e>toISOString</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>tagNumber</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0x18</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// GeneralizedTime
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>date</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>decodeGeneralizedTime</span>(<span style=color:#a6e22e>node</span>.<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>output</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>` | Date: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>date</span>.<span style=color:#a6e22e>toISOString</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>tagNumber</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0x06</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// OBJECT IDENTIFIER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>oid_value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>decodeOID</span>(<span style=color:#a6e22e>node</span>.<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>KNOWN_OID_VALUES</span>[<span style=color:#a6e22e>oid_value</span>]) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>output</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>` | OID: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>oid_value</span><span style=color:#e6db74>}</span><span style=color:#e6db74> (</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>KNOWN_OID_VALUES</span>[<span style=color:#a6e22e>oid_value</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>)`</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>UNKNOWN_OID_VALUES</span>[<span style=color:#a6e22e>oid_value</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>output</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>` | OID: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>oid_value</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>output</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>node</span>.<span style=color:#a6e22e>children</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>child</span>) =&gt; <span style=color:#a6e22e>printASN1</span>(<span style=color:#a6e22e>child</span>, <span style=color:#a6e22e>depth</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The goal here is to keep track of what depth we&rsquo;re at recursively (so we can indent), then print out the tag type (see <a href=#constants>constants</a>) and the data in as useful a form as we can. That takes the form of:</p><ul><li>Always include the hex value, but only up to the first 32 characters of it</li><li>If we can successfully decode it as UTF8, print that (we could just process ones that have tag = <code>PrintableString</code> or something like that, but &#x1f937;)</li><li>If it&rsquo;s one of a few known types, parse those and print them</li><li>For values with children, recur into the children (one level depth&rsquo;er)!</li></ul><p>And&mldr; that&rsquo;s actually it!</p><p>Here&rsquo;s a wrapper to print any given variable <code>pem</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// Read certificate(s) from stdin
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;fs&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pem</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>readFileSync</span>(<span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#34;utf-8&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Unknown OIDs will be collected here so we can add them to the above list later
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>UNKNOWN_OID_VALUES</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// There might be multiple PEM in a file, collect them all
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>blocks</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parsePEM</span>(<span style=color:#a6e22e>pem</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>block</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>blocks</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`\n</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>type</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>root</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readASN1</span>(<span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>der</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Print the ASN.1 structure in a (more or less) human-readable format
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>printASN1</span>(<span style=color:#a6e22e>root</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// If we had any unknown OIDs, print them out
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (Object.<span style=color:#a6e22e>keys</span>(<span style=color:#a6e22e>UNKNOWN_OID_VALUES</span>).<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;\nUnknown OIDs:&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>oid</span> <span style=color:#66d9ef>of</span> Object.<span style=color:#a6e22e>keys</span>(<span style=color:#a6e22e>UNKNOWN_OID_VALUES</span>)) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`- </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>oid</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=an-example>An example</h2><p>So&mldr; let&rsquo;s actually do this thing. You can use <code>openssl</code> to download the certificate for any site and shove that into our decoder:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ openssl s_client -connect www.google.com:443 -showcerts &lt;/dev/null | node decode-pem.js
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CERTIFICATE
</span></span><span style=display:flex><span>- SEQUENCE
</span></span><span style=display:flex><span>  - SEQUENCE
</span></span><span style=display:flex><span>    - Tag<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      - INTEGER | Hex: <span style=color:#ae81ff>02</span> | Int: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    - INTEGER | Hex: 00a3988120eb296bbf0a49e3e78d6a0d… <span style=color:#f92672>(</span><span style=color:#ae81ff>34</span> bytes<span style=color:#f92672>)</span> | Int: -1922429585
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - OBJECT IDENTIFIER | Hex: 2a864886f70d01010b | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>840</span> <span style=color:#ae81ff>113549</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>11</span> <span style=color:#f92672>(</span>sha256WithRSAEncryption<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      - NULL
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550406</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>countryName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: <span style=color:#ae81ff>5553</span> | UTF-8: <span style=color:#e6db74>&#34;US&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 55040a | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>(</span>organizationName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: 476f6f676c6520547275737420536572… <span style=color:#f92672>(</span><span style=color:#ae81ff>42</span> bytes<span style=color:#f92672>)</span> | UTF-8: <span style=color:#e6db74>&#34;Google Trust Services&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550403</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>commonName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: <span style=color:#ae81ff>575232</span> | UTF-8: <span style=color:#e6db74>&#34;WR2&#34;</span>
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - UTCTime | Hex: 3235303432393139333030345a | UTF-8: <span style=color:#e6db74>&#34;250429193004Z&#34;</span> | Date: 2025-04-29T19:30:04.000Z
</span></span><span style=display:flex><span>      - UTCTime | Hex: 3235303732323139333030335a | UTF-8: <span style=color:#e6db74>&#34;250722193003Z&#34;</span> | Date: 2025-07-22T19:30:03.000Z
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550403</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>commonName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: 7777772e676f6f676c652e636f6d | UTF-8: <span style=color:#e6db74>&#34;www.google.com&#34;</span>
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - SEQUENCE
</span></span><span style=display:flex><span>        - OBJECT IDENTIFIER | Hex: 2a8648ce3d0201 | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>840</span> <span style=color:#ae81ff>10045</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>ecPublicKey<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - OBJECT IDENTIFIER | Hex: 2a8648ce3d030107 | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>840</span> <span style=color:#ae81ff>10045</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>(</span>c2tnb191v3<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      - BIT STRING | Hex: 0004a86f2c5232a1076f7be91d3e208a… <span style=color:#f92672>(</span><span style=color:#ae81ff>132</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    - BIT STRING
</span></span><span style=display:flex><span>      - SEQUENCE
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d0f | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>15</span> <span style=color:#f92672>(</span>keyUsage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - BOOLEAN | Hex: ff
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: <span style=color:#ae81ff>03020780</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d25 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>37</span> <span style=color:#f92672>(</span>extKeyUsage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 300a06082b06010505070301
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d13 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>19</span> <span style=color:#f92672>(</span>basicConstraints<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - BOOLEAN | Hex: ff
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: <span style=color:#ae81ff>3000</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d0e | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>14</span> <span style=color:#f92672>(</span>subjectKeyIdentifier<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 04144bc0c4f4b90afe972101a274c6c8… <span style=color:#f92672>(</span><span style=color:#ae81ff>44</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d23 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>35</span> <span style=color:#f92672>(</span>authorityKeyIdentifier<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 30168014de1b1eed7915d43e3724c321… <span style=color:#f92672>(</span><span style=color:#ae81ff>48</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 2b06010505070101 | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>authorityInfoAccess<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 304a302106082b060105050730018615… <span style=color:#f92672>(</span><span style=color:#ae81ff>152</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d11 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>17</span> <span style=color:#f92672>(</span>subjectAltName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 3010820e7777772e676f6f676c652e63… <span style=color:#f92672>(</span><span style=color:#ae81ff>36</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d20 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>32</span> <span style=color:#f92672>(</span>certificatePolicies<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 300a3008060667810c010201
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d1f | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>31</span> <span style=color:#f92672>(</span>cRLDistributionPoints<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 302d302ba029a0278625687474703a2f… <span style=color:#f92672>(</span><span style=color:#ae81ff>94</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 2b06010401d679020402 | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>11129</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>googleSignedCertificateTimestamp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 0481f300f1007700dddcca3495d7e116… <span style=color:#f92672>(</span><span style=color:#ae81ff>492</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  - SEQUENCE
</span></span><span style=display:flex><span>    - OBJECT IDENTIFIER | Hex: 2a864886f70d01010b | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>840</span> <span style=color:#ae81ff>113549</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>11</span> <span style=color:#f92672>(</span>sha256WithRSAEncryption<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    - NULL
</span></span><span style=display:flex><span>  - BIT STRING | Hex: 0062c5c5eda9af6b5b0fb40aa342b635… <span style=color:#f92672>(</span><span style=color:#ae81ff>514</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CERTIFICATE
</span></span><span style=display:flex><span>- SEQUENCE
</span></span><span style=display:flex><span>  - SEQUENCE
</span></span><span style=display:flex><span>    - Tag<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      - INTEGER | Hex: <span style=color:#ae81ff>02</span> | Int: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    - INTEGER | Hex: 7ff005a07c4cded100ad9d66a5107b98 | Int: -1525646440
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - OBJECT IDENTIFIER | Hex: 2a864886f70d01010b | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>840</span> <span style=color:#ae81ff>113549</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>11</span> <span style=color:#f92672>(</span>sha256WithRSAEncryption<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      - NULL
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550406</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>countryName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: <span style=color:#ae81ff>5553</span> | UTF-8: <span style=color:#e6db74>&#34;US&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 55040a | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>(</span>organizationName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: 476f6f676c6520547275737420536572… <span style=color:#f92672>(</span><span style=color:#ae81ff>50</span> bytes<span style=color:#f92672>)</span> | UTF-8: <span style=color:#e6db74>&#34;Google Trust Services LLC&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550403</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>commonName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: 47545320526f6f74205231 | UTF-8: <span style=color:#e6db74>&#34;GTS Root R1&#34;</span>
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - UTCTime | Hex: 3233313231333039303030305a | UTF-8: <span style=color:#e6db74>&#34;231213090000Z&#34;</span> | Date: 2023-12-13T09:00:00.000Z
</span></span><span style=display:flex><span>      - UTCTime | Hex: 3239303232303134303030305a | UTF-8: <span style=color:#e6db74>&#34;290220140000Z&#34;</span> | Date: 2029-02-20T14:00:00.000Z
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550406</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>countryName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: <span style=color:#ae81ff>5553</span> | UTF-8: <span style=color:#e6db74>&#34;US&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 55040a | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>(</span>organizationName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: 476f6f676c6520547275737420536572… <span style=color:#f92672>(</span><span style=color:#ae81ff>42</span> bytes<span style=color:#f92672>)</span> | UTF-8: <span style=color:#e6db74>&#34;Google Trust Services&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550403</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>commonName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: <span style=color:#ae81ff>575232</span> | UTF-8: <span style=color:#e6db74>&#34;WR2&#34;</span>
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - SEQUENCE
</span></span><span style=display:flex><span>        - OBJECT IDENTIFIER | Hex: 2a864886f70d010101 | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>840</span> <span style=color:#ae81ff>113549</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>rsaEncryption<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - NULL
</span></span><span style=display:flex><span>      - BIT STRING | Hex: 003082010a0282010100a9ff9c7f451e… <span style=color:#f92672>(</span><span style=color:#ae81ff>542</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    - BIT STRING
</span></span><span style=display:flex><span>      - SEQUENCE
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d0f | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>15</span> <span style=color:#f92672>(</span>keyUsage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - BOOLEAN | Hex: ff
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: <span style=color:#ae81ff>03020186</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d25 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>37</span> <span style=color:#f92672>(</span>extKeyUsage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 301406082b0601050507030106082b06… <span style=color:#f92672>(</span><span style=color:#ae81ff>44</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d13 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>19</span> <span style=color:#f92672>(</span>basicConstraints<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - BOOLEAN | Hex: ff
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 30060101ff020100
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d0e | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>14</span> <span style=color:#f92672>(</span>subjectKeyIdentifier<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 0414de1b1eed7915d43e3724c321bbec… <span style=color:#f92672>(</span><span style=color:#ae81ff>44</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d23 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>35</span> <span style=color:#f92672>(</span>authorityKeyIdentifier<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 30168014e4af2b26711a2b4827852f52… <span style=color:#f92672>(</span><span style=color:#ae81ff>48</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 2b06010505070101 | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>authorityInfoAccess<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 3026302406082b060105050730028618… <span style=color:#f92672>(</span><span style=color:#ae81ff>80</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d1f | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>31</span> <span style=color:#f92672>(</span>cRLDistributionPoints<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 30223020a01ea01c861a687474703a2f… <span style=color:#f92672>(</span><span style=color:#ae81ff>72</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d20 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>32</span> <span style=color:#f92672>(</span>certificatePolicies<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 300a3008060667810c010201
</span></span><span style=display:flex><span>  - SEQUENCE
</span></span><span style=display:flex><span>    - OBJECT IDENTIFIER | Hex: 2a864886f70d01010b | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>840</span> <span style=color:#ae81ff>113549</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>11</span> <span style=color:#f92672>(</span>sha256WithRSAEncryption<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    - NULL
</span></span><span style=display:flex><span>  - BIT STRING | Hex: 0045758be51f3b4413961aab58f135c9… <span style=color:#f92672>(</span><span style=color:#ae81ff>1026</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CERTIFICATE
</span></span><span style=display:flex><span>- SEQUENCE
</span></span><span style=display:flex><span>  - SEQUENCE
</span></span><span style=display:flex><span>    - Tag<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      - INTEGER | Hex: <span style=color:#ae81ff>02</span> | Int: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    - INTEGER | Hex: 77bd0d6cdb36f91aea210fc4f058d30d | Int: -262614259
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - OBJECT IDENTIFIER | Hex: 2a864886f70d01010b | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>840</span> <span style=color:#ae81ff>113549</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>11</span> <span style=color:#f92672>(</span>sha256WithRSAEncryption<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      - NULL
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550406</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>countryName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: <span style=color:#ae81ff>4245</span> | UTF-8: <span style=color:#e6db74>&#34;BE&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 55040a | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>(</span>organizationName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: 476c6f62616c5369676e206e762d7361 | UTF-8: <span style=color:#e6db74>&#34;GlobalSign nv-sa&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 55040b | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>11</span> <span style=color:#f92672>(</span>organizationalUnitName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: 526f6f74204341 | UTF-8: <span style=color:#e6db74>&#34;Root CA&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550403</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>commonName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: 476c6f62616c5369676e20526f6f7420… <span style=color:#f92672>(</span><span style=color:#ae81ff>36</span> bytes<span style=color:#f92672>)</span> | UTF-8: <span style=color:#e6db74>&#34;GlobalSign Root CA&#34;</span>
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - UTCTime | Hex: 3230303631393030303034325a | UTF-8: <span style=color:#e6db74>&#34;200619000042Z&#34;</span> | Date: 2020-06-19T00:00:42.000Z
</span></span><span style=display:flex><span>      - UTCTime | Hex: 3238303132383030303034325a | UTF-8: <span style=color:#e6db74>&#34;280128000042Z&#34;</span> | Date: 2028-01-28T00:00:42.000Z
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550406</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>countryName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: <span style=color:#ae81ff>5553</span> | UTF-8: <span style=color:#e6db74>&#34;US&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 55040a | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>(</span>organizationName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: 476f6f676c6520547275737420536572… <span style=color:#f92672>(</span><span style=color:#ae81ff>50</span> bytes<span style=color:#f92672>)</span> | UTF-8: <span style=color:#e6db74>&#34;Google Trust Services LLC&#34;</span>
</span></span><span style=display:flex><span>      - SET
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: <span style=color:#ae81ff>550403</span> | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>commonName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - PrintableString | Hex: 47545320526f6f74205231 | UTF-8: <span style=color:#e6db74>&#34;GTS Root R1&#34;</span>
</span></span><span style=display:flex><span>    - SEQUENCE
</span></span><span style=display:flex><span>      - SEQUENCE
</span></span><span style=display:flex><span>        - OBJECT IDENTIFIER | Hex: 2a864886f70d010101 | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>840</span> <span style=color:#ae81ff>113549</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>rsaEncryption<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - NULL
</span></span><span style=display:flex><span>      - BIT STRING | Hex: 003082020a0282020100b611028b1ee3… <span style=color:#f92672>(</span><span style=color:#ae81ff>1054</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    - BIT STRING
</span></span><span style=display:flex><span>      - SEQUENCE
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d0f | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>15</span> <span style=color:#f92672>(</span>keyUsage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - BOOLEAN | Hex: ff
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: <span style=color:#ae81ff>03020186</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d13 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>19</span> <span style=color:#f92672>(</span>basicConstraints<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - BOOLEAN | Hex: ff
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 30030101ff
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d0e | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>14</span> <span style=color:#f92672>(</span>subjectKeyIdentifier<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 0414e4af2b26711a2b4827852f52662c… <span style=color:#f92672>(</span><span style=color:#ae81ff>44</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d23 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>35</span> <span style=color:#f92672>(</span>authorityKeyIdentifier<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 30168014607b661a450d97ca89502f7d… <span style=color:#f92672>(</span><span style=color:#ae81ff>48</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 2b06010505070101 | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>7</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>authorityInfoAccess<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 3052302506082b060105050730018619… <span style=color:#f92672>(</span><span style=color:#ae81ff>168</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d1f | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>31</span> <span style=color:#f92672>(</span>cRLDistributionPoints<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 30293027a025a0238621687474703a2f… <span style=color:#f92672>(</span><span style=color:#ae81ff>86</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        - SEQUENCE
</span></span><span style=display:flex><span>          - OBJECT IDENTIFIER | Hex: 551d20 | OID: <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>29</span> <span style=color:#ae81ff>32</span> <span style=color:#f92672>(</span>certificatePolicies<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          - OCTET STRING | Hex: 30323008060667810c01020130080606… <span style=color:#f92672>(</span><span style=color:#ae81ff>104</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  - SEQUENCE
</span></span><span style=display:flex><span>    - OBJECT IDENTIFIER | Hex: 2a864886f70d01010b | OID: <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>840</span> <span style=color:#ae81ff>113549</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>11</span> <span style=color:#f92672>(</span>sha256WithRSAEncryption<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    - NULL
</span></span><span style=display:flex><span>  - BIT STRING | Hex: 0034a41eb128a3d0b47617a6317a21e9… <span style=color:#f92672>(</span><span style=color:#ae81ff>514</span> bytes<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Now&mldr; you have to actually step back a bit to PEM to determine what those values actually are, which isn&rsquo;t something that I needed for this particular project. But you can already see that the initial <code>CERTIFICATE</code> is always a <code>SEQUENCE</code> containing an ID, the signing type (RSA etc), some basic data as a <code>SEQUENCE</code> of <code>SEQUENCE</code> key/value pairs (countryName, etc), the valid from/valid to dates, etc.</p><h2 id=constants>Constants</h2><p>In case it&rsquo;s useful, here are some tables that I built up as I was working on this. First, ASN.1 tags and classes and then a list of OID values that were useful for this specific work. These could certainly be fleshed out, but they&rsquo;re a good start!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// https://www.oss.com/asn1/resources/asn1-made-simple/asn1-quick-reference/asn1-tags.html
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ASN1_UNIVERSAL_TAGS</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;BOOLEAN&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>2</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;INTEGER&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>3</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;BIT STRING&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;OCTET STRING&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>5</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;NULL&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;OBJECT IDENTIFIER&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>7</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;ObjectDescriptor&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>8</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;EXTERNAL&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>9</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;REAL&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>10</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;ENUMERATED&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>11</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;EMBEDDED PDV&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>12</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;UTF8String&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>13</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;RELATIVE-OID&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>14</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;TIME&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>16</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;SEQUENCE&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>17</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;SET&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>18</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;NumericString&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>19</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;PrintableString&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>20</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;TeletexString&#34;</span>, <span style=color:#75715e>// also known as T61String
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#ae81ff>21</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;VideotexString&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>22</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;IA5String&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>23</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;UTCTime&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>24</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;GeneralizedTime&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>25</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;GraphicString&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>26</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;VisibleString&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>27</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;GeneralString&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>28</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;UniversalString&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>29</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;CHARACTER STRING&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>30</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;BMPString&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>31</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;DATE&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>32</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;TIME-OF-DAY&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>33</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;DATE-TIME&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>34</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;DURATION&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>TAG_CLASSES</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>0</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;UNIVERSAL&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;APPLICATION&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>2</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;CONTEXT-SPECIFIC&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>3</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;PRIVATE&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// https://www.cs.auckland.ac.nz/~pgut001/dumpasn1.cfg
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>KNOWN_OID_VALUES</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;1 2 840 10045 2 1&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;ecPublicKey&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;1 2 840 10045 3 1 7&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;c2tnb191v3&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;1 2 840 113549 1 1 1&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;rsaEncryption&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;1 2 840 113549 1 1 11&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;sha256WithRSAEncryption&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;1 2 840 113549 1 1 5&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;sha1WithRSAEncryption&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;1 3 6 1 4 1 11129 2 4 2&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;googleSignedCertificateTimestamp&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;1 3 6 1 5 5 7 1 1&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;authorityInfoAccess&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 29 14&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;subjectKeyIdentifier&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 29 15&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;keyUsage&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 29 17&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;subjectAltName&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 29 19&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;basicConstraints&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 29 31&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;cRLDistributionPoints&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 29 32&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;certificatePolicies&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 29 35&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;authorityKeyIdentifier&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 29 37&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;extKeyUsage&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 4 10&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;organizationName&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 4 11&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;organizationalUnitName&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 4 3&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;commonName&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 4 6&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;countryName&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 4 7&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;localityName&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2 5 4 8&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;stateOrProvinceName&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span></code></pre></div></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content data-pagefind-ignore=all><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>