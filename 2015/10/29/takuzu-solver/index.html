<!doctype html><html><head><title>Takuzu solver â€“ jverkamp.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/><script src=/jquery_5823201688106629450.min.30448892aa1f91e9c4cb5494e5c5e5abc13b7778de7786e5256cdc7d2424813a.js integrity="sha256-MESIkqofkenEy1SU5cXlq8E7d3jed4blJWzcfSQkgTo=" defer></script>
<script src=/jquery.fancybox_6181813213021922412.min.6ba037466db9f8843b66c38c32fe5a353344e7fd68ecda97efb63a84c881f828.js integrity="sha256-a6A3Rm25+IQ7ZsOMMv5aNTNE5/1o7NqX77Y6hMiB+Cg=" defer></script>
<script src=/katex_12008035502722260518.min.3cc3a080c0368785179e37b0cd0a71c6cf60c4fc5a8dce503f5a542ec0a25043.js integrity="sha256-PMOggMA2h4UXnjewzQpxxs9gxPxajc5QP1pULsCiUEM=" defer></script>
<script src=/bigfoot_8444447145154709333.min.5e80bd85ebaeb95607834d6777bfe7013d1d161f0f02a31b845e4bd765898316.js integrity="sha256-XoC9heuuuVYHg01nd7/nAT0dFh8PAqMbhF5L12WJgxY=" defer></script>
<script src=/mermaid_12365941879912544862.min.e8f19283a632077085b9ad74aecad54abe84429c69789fd29ffa3a254d86abdd.js integrity="sha256-6PGSg6YyB3CFua10rsrVSr6EQpxpeJ/Sn/o6JU2Gq90=" defer></script>
<script src=/main.min.82ab51144325fae71ddbca46269a80c63b28bdab6be6b01aa9ec638c013748e6.js integrity="sha256-gqtRFEMl+ucd28pGJpqAxjsovatr5rAaqexjjAE3SOY=" defer></script>
<link rel=stylesheet href=/katex_14163593549783030822.min.16bacd59fb224ae6c97a749ab0ac1e708cb5e0c9ce5c9a08d7fd73dc8e69429f.css integrity="sha256-FrrNWfsiSubJenSasKwecIy14MnOXJoI1/1z3I5pQp8="><link rel=stylesheet href=/bigfoot-default_16482899066638414220.min.f15d4faa4519addb976f9d69b42bd9eb491b3596b6b2eda83aa3e9e1f48b8f14.css integrity="sha256-8V1PqkUZrduXb51ptCvZ60kbNZa2su2oOqPp4fSLjxQ="><link rel=stylesheet href=/jquery.fancybox_16222217791602823071.min.e28b5d7d9d89efacb5f708ac30cbd76b1b9a0f816dfd9da96631d1d09cbbdd76.css integrity="sha256-4otdfZ2J76y19wisMMvXaxuaD4Ft/Z2pZjHR0Jy73XY="><link rel=stylesheet href=/css_4780214198035419921.min.7cfac95bdd962d85ceec560e50fe7b04c44b58a76e5202006ef36ca8c0a7d836.css integrity="sha256-fPrJW92WLYXO7FYOUP57BMRLWKduUgIAbvNsqMCn2DY="><link rel=stylesheet href=/main.min.21cc0ec02bdbc197a68cb2e246e6db6d9df556ba2994084c55a6f8b6713e604d.css integrity="sha256-IcwOwCvbwZemjLLiRubbbZ31VroplAhMVab4tnE+YE0="></head><body><div id=wrapper><header id=page-header role=banner><h1><a href=/>JP's Blog</a></h1><ul id=page-header-links><li><a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a></li><li><form action=//www.google.com/search method=get onsubmit='(function(e){e.q.value="site:blog.jverkamp.com "+e.qfront.value})(this)' class="navbar-form navbar-right" role=search _lpchecked=1><div class=form-group><input name=q type=hidden>
<input name=qfront type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button></div></form></li></ul><nav id=header-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li></ul></nav></header><div id=page-content-wrapper><div id=page-content><article><header><h1 class=entry-title>Takuzu solver</h1><div class=entry-meta><span class=entry-date>2015-10-29</span></div><div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li><a class=taxonomy-key href=/programming/languages/>Languages</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2015/09/14/mandelbrot/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/python>Python</a><a href=https://blog.jverkamp.com/2015/10/30/finding-ec2-instances-by-tag/ class=next-link></a></li></ul></li><li><a class=taxonomy-key href=/programming/sources/>Sources</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2015/08/24/adjacency-matrix-generator/ class=previous-link></a><a class=taxonomy-value href=/programming/sources/daily-programmer>Daily Programmer</a></li></ul></li><li><a class=taxonomy-key href=/programming/topics/>Topics</a><ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2014/10/28/tile-puzzle/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/backtracking>Backtracking</a><a href=https://blog.jverkamp.com/2016/12/11/aoc-2016-day-11-radiation-avoider/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2015/08/24/adjacency-matrix-generator/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/graphs>Graphs</a><a href=https://blog.jverkamp.com/2017/12/12/aoc-2017-day-12-gridlock/ class=next-link></a></li><li><a href=https://blog.jverkamp.com/2014/09/04/chess-puzzles-knights-tour/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/heuristics>Heuristics</a></li></ul></li><li><a class=taxonomy-key href=/programming>programming</a><ul><li><a href=https://blog.jverkamp.com/2015/09/14/mandelbrot/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2015/10/30/finding-ec2-instances-by-tag/ class=next-link>Next</a></ul></li><li><a class=taxonomy-key href=/>All Posts</a><ul><li><a href=https://blog.jverkamp.com/2015/10/27/oven-sheet-omelette/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2015/10/30/promise-of-blood/ class=next-link>Next</a></ul></li></ul></div></div></header><div class=entry-content><p>Based on a <a href>/r/dailyprogrammer</a> puzzle: <a href=https://www.reddit.com/r/dailyprogrammer/comments/3pwf17/20151023_challenge_237_hard_takuzu_solver/>Takuzu solver</a>.</p><p>Basically, Takuzu is a logic puzzle similar to Sudoku. You are given a grid partially filled with 0s and 1s. You have to fill in the rest of the grid according to three simple rules:</p><ul><li>You cannot have more than three of the same number in a line</li><li>Each column must have an equal number of 0s and 1s<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></li><li>No two rows or no two columns can be identical</li></ul><p>Thus, if you have a puzzle like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>0.01.1
</span></span><span style=display:flex><span>0....1
</span></span><span style=display:flex><span>..00..
</span></span><span style=display:flex><span>..00..
</span></span><span style=display:flex><span>1....0
</span></span><span style=display:flex><span>10.0.0
</span></span></code></pre></div><p>One valid solution (most puzzles should have only a single valid answer, but that doesn&rsquo;t always seem to be the case):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>010101
</span></span><span style=display:flex><span>001101
</span></span><span style=display:flex><span>110010
</span></span><span style=display:flex><span>010011
</span></span><span style=display:flex><span>101100
</span></span><span style=display:flex><span>101010
</span></span></code></pre></div><p>Let&rsquo;s do it!</p><p>First, we need some sort of structure to represent and read in a Takuzu board. I think I&rsquo;m going to over-engineer a little bit here, since I think it will be helpful in the long run.</p><p>My basic idea is to represent it in a way without mutation, that is to say once I&rsquo;ve created a board, that board will never change. That will make it easier to write a backtracking solution, since when we need to back up to a previous state, we just throw away any of the derivative boards.</p><p>Taking that a level further, let&rsquo;s represent the Takuzu board as a base board with an essentially a &lsquo;changelog&rsquo; on top of it, storing any differences from the boards &lsquo;under&rsquo; it. Something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>....    ..1.    ....    ..1.
</span></span><span style=display:flex><span>0.0. {- .... {- .... == 0.0.
</span></span><span style=display:flex><span>..0.    ....    ....    ..0.
</span></span><span style=display:flex><span>...1    ..1.    .0..    .011
</span></span></code></pre></div><p>In that diagram, the board on the far left is the first layer, then the second is the next layer up, and the third is the final layer. The fourth image is the virtual board that any user of the program would actually see.</p><p>So how do we turn that into code?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Takuzu</span>(object):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, filename <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>, parent <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Represent a Takuzu puzzle (a grid of 0, 1, and .)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        If filename is set, load from file.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        If parent is set, extend that Takuzu puzzle.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        If neither or both is set, that is an error.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> (filename <span style=color:#f92672>or</span> parent) <span style=color:#f92672>or</span> (filename <span style=color:#f92672>and</span> parent):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#39;Set exactly one of filename and parent&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>tiles <span style=color:#f92672>=</span> collections<span style=color:#f92672>.</span>defaultdict(<span style=color:#66d9ef>lambda</span> : <span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>parent <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> parent:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>size <span style=color:#f92672>=</span> parent<span style=color:#f92672>.</span>size
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>parent <span style=color:#f92672>=</span> parent
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> filename:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>with</span> open(filename, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> fin:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> row, line <span style=color:#f92672>in</span> enumerate(fin):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> col, char <span style=color:#f92672>in</span> enumerate(line<span style=color:#f92672>.</span>strip()):
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> char <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;01&#39;</span>:
</span></span><span style=display:flex><span>                            self<span style=color:#f92672>.</span>tiles[row, col] <span style=color:#f92672>=</span> char
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        self<span style=color:#f92672>.</span>size <span style=color:#f92672>=</span> col <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get</span>(self, row <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>, col <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Access a tile in the current puzzle, return False for unset values
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        If the current puzzle doesn&#39;t have a value set, recur to parents.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        If either row or col is set to None, return that entire row or column.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        If neither is set, return nested lists containing all current values.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Note: We need the ugly != None to correctly deal with row or col = 0.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Sometimes truthiness is annoying.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> row <span style=color:#f92672>!=</span> <span style=color:#66d9ef>None</span> <span style=color:#f92672>and</span> col <span style=color:#f92672>!=</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>tiles[row, col] <span style=color:#f92672>or</span> (self<span style=color:#f92672>.</span>parent <span style=color:#f92672>and</span> self<span style=color:#f92672>.</span>parent<span style=color:#f92672>.</span>get(row, col))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> row <span style=color:#f92672>!=</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [self<span style=color:#f92672>.</span>get(row, col) <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size)]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> col <span style=color:#f92672>!=</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [self<span style=color:#f92672>.</span>get(row, col) <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size)]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [
</span></span><span style=display:flex><span>                [self<span style=color:#f92672>.</span>get(row, col) <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size)]
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size)
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>set</span>(self, row, col, val):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Create a child Takuzu object with the specific value set.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        If either row or column is set to None, fill any empty elements in that entire row
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        with the given value.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        child <span style=color:#f92672>=</span> Takuzu(parent <span style=color:#f92672>=</span> self)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> row <span style=color:#f92672>!=</span> <span style=color:#66d9ef>None</span> <span style=color:#f92672>and</span> col <span style=color:#f92672>!=</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            child<span style=color:#f92672>.</span>tiles[row, col] <span style=color:#f92672>=</span> val
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> row <span style=color:#f92672>!=</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> child<span style=color:#f92672>.</span>get(row, col):
</span></span><span style=display:flex><span>                    child<span style=color:#f92672>.</span>tiles[row, col] <span style=color:#f92672>=</span> val
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> col <span style=color:#f92672>!=</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> child<span style=color:#f92672>.</span>get(row, col):
</span></span><span style=display:flex><span>                    child<span style=color:#f92672>.</span>tiles[row, col] <span style=color:#f92672>=</span> val
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#39;Must set at least one of row and column&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> child
</span></span></code></pre></div><p>The interesting bits here are the <code>get</code> and <code>set</code> methods. <code>get</code>, as mentioned, assumes the layered structure above. It will start on the topmost layer (the actual object the program has a reference to) and try to look up the given point. If that fails (we&rsquo;re using a <code>collections.defaultdict</code>, so every reference will either by <code>'0'</code>, <code>'1'</code>, or <code>False</code>), fall back to the next layer up (the <code>parent</code>) until we either find one or run out of <code>parent</code> nodes.</p><p>Similarly, <code>set</code> doesn&rsquo;t actually change the current Takuzu object. Instead, it creates a new object with the current one as its parent, setting the new value in the child. This means that any values that were previously set are transparently available in the child, but we can at any point backtrack so long as we keep a reference to the now parent object around.</p><p>In addition, I&rsquo;ve gone ahead and built in a bit of functionality that I know we&rsquo;re going to need into <code>get</code> and <code>set</code>. In either case, if you only specify either the <code>row</code> or <code>col</code> and leave the other empty (<code>None</code>), then we will return that entire row or column (or <code>set</code> any empty values). That&rsquo;s easy enough to code and it has the advantage of making it easy to compare rows to one another (for the third requirement above).</p><p>Okay, up next, we&rsquo;ll probably want a few more helper functions in this class in order to actually tell when we&rsquo;ve solved one of these puzzles so the algorithms we eventually write can actually terminate:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Takuzu</span>(object):
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __eq__(self, other):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;Check if two Takuzu puzzles are equal.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>get(row, col) <span style=color:#f92672>!=</span> other<span style=color:#f92672>.</span>get(row, col):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __str__(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;Return a string representation the same as can be read from a file.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        out <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>                out <span style=color:#f92672>+=</span> str(self<span style=color:#f92672>.</span>get(row, col) <span style=color:#f92672>or</span> <span style=color:#e6db74>&#39;.&#39;</span>)
</span></span><span style=display:flex><span>            out <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> out
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>is_full</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;If all values have been filled in.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>get(row, col):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>is_valid</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;Test if the current is still possibly a valid solution. If it also is_full,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        the board is solved.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Cannot have three identical numbers in a line</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Ignore unset pieces</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>get(row, col):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>get(row <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, col) <span style=color:#f92672>==</span> self<span style=color:#f92672>.</span>get(row, col) <span style=color:#f92672>==</span> self<span style=color:#f92672>.</span>get(row <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, col):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>get(row, col <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>==</span> self<span style=color:#f92672>.</span>get(row, col) <span style=color:#f92672>==</span> self<span style=color:#f92672>.</span>get(row, col <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># All rows and columns must have no more than the maximum (size/2) number of 0s or 1s</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> index <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>get(index, <span style=color:#66d9ef>None</span>)<span style=color:#f92672>.</span>count(<span style=color:#e6db74>&#39;0&#39;</span>) <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>size <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>or</span> self<span style=color:#f92672>.</span>get(index, <span style=color:#66d9ef>None</span>)<span style=color:#f92672>.</span>count(<span style=color:#e6db74>&#39;1&#39;</span>) <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>size <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>or</span> self<span style=color:#f92672>.</span>get(<span style=color:#66d9ef>None</span>, index)<span style=color:#f92672>.</span>count(<span style=color:#e6db74>&#39;0&#39;</span>) <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>size <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>or</span> self<span style=color:#f92672>.</span>get(<span style=color:#66d9ef>None</span>, index)<span style=color:#f92672>.</span>count(<span style=color:#e6db74>&#39;1&#39;</span>) <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>size <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>            ):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># No two rows or columns can be equal (ignore rows/columns that contain unset values)</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># all(...) on a row or column will be true iff all values are set</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> first_index <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> second_index <span style=color:#f92672>in</span> range(first_index):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (
</span></span><span style=display:flex><span>                    all(self<span style=color:#f92672>.</span>get(first_index, <span style=color:#66d9ef>None</span>))
</span></span><span style=display:flex><span>                    <span style=color:#f92672>and</span> all(self<span style=color:#f92672>.</span>get(<span style=color:#66d9ef>None</span>, first_index))
</span></span><span style=display:flex><span>                    <span style=color:#f92672>and</span> (
</span></span><span style=display:flex><span>                        self<span style=color:#f92672>.</span>get(first_index, <span style=color:#66d9ef>None</span>) <span style=color:#f92672>==</span> self<span style=color:#f92672>.</span>get(second_index, <span style=color:#66d9ef>None</span>)
</span></span><span style=display:flex><span>                        <span style=color:#f92672>or</span> self<span style=color:#f92672>.</span>get(<span style=color:#66d9ef>None</span>, first_index) <span style=color:#f92672>==</span> self<span style=color:#f92672>.</span>get(<span style=color:#66d9ef>None</span>, second_index)
</span></span><span style=display:flex><span>                    )
</span></span><span style=display:flex><span>                ):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Whee passed all three conditions!</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>is_solved</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;Return True iff this puzzle is solved.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>is_full() <span style=color:#f92672>and</span> self<span style=color:#f92672>.</span>is_valid()
</span></span></code></pre></div><p><code>__eq__</code> and <code>__str__</code> are &lsquo;magic&rsquo; methods in Python that will define equality and converting this object to a string respectively. This will be nice to make sure we don&rsquo;t investigate the same board more than once later.</p><p>After that, we have <code>is_full</code>, <code>is_valid</code>, and <code>is_solved</code><sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. In the first case, we&rsquo;re checking if a puzzle has everything filled in. That way we know if we can stop recurring one way or the other.</p><p><code>is_valid</code> is actually a relatively new method. Before that, I could only check if a puzzle <code>is_solved</code>, but this way we can eliminate entire branches of the search space much earlier. For example, as soon as a backtracking solution places the third <code>0</code> in a row, it can stop looking down that path since <code>is_valid</code> will return <code>False</code>. Finally, <code>is_solved</code>. It used to have most of the <code>is_valid</code> code, but once that method existed, a puzzle <code>is_solved</code> simply if both it <code>is_full</code> and it <code>is_valid</code>. Easy enough.</p><p>So how do we actually solve a puzzle with this?</p><p>Let&rsquo;s start with the simple (relatively speaking, since we&rsquo;ve done it before) backtracking solution. Given everything that we have in the Takuzu class, the actual solver is actually really simple:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>solve</span>(takuzu):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Solve a puzzle using backtracking (also a fall back for the human solver).&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    queue <span style=color:#f92672>=</span> [takuzu]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> queue:
</span></span><span style=display:flex><span>        takuzu <span style=color:#f92672>=</span> queue<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Solved, we&#39;re done!</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> takuzu<span style=color:#f92672>.</span>is_solved():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># If we don&#39;t have a valid solution, stop looking on this branch</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> takuzu<span style=color:#f92672>.</span>is_valid():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Otherwise, find one empty spot and try both possiblities</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>enqueue</span>():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(takuzu<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(takuzu<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> takuzu<span style=color:#f92672>.</span>get(row, col):
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>for</span> value <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;01&#39;</span>:
</span></span><span style=display:flex><span>                            queue<span style=color:#f92672>.</span>insert(takuzu<span style=color:#f92672>.</span>set(row, col, value), <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>        enqueue()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span></code></pre></div><p>Basically, we keep a stack of solutions, which will allow us to perform a <a href=https://en.wikipedia.org/wiki/depth-first%20search>depth-first search</a><sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</p><p>Basically, create a branch, trying first a <code>0</code> in the first empty spot. Looking down that path, if we find a solution, we&rsquo;re done. If we don&rsquo;t try a <code>1</code> instead. That&rsquo;s really it. And it&rsquo;s actually relatively fast.</p><p>Given the input:</p><pre tabindex=0><code class=language-test data-lang=test>0..1.0
0.11..
......
......
1..1..
.....0
</code></pre><p>We can solve it easily enough:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python3 takuzu.py --method backtracker sample_6x6.takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>010110</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>001101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>110010</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>011001</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>100101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>101010</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Solved in 0.15 seconds
</span></span></code></pre></div><p>Nice. (You can check out the <a href=https://github.com/jpverkamp/takuzu>full source</a> if you&rsquo;d like to see how I&rsquo;m handling the command line parameters along with a few other goodies.<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>)</p><p>Unfortunately, as puzzles get a bit larger, that runtime isn&rsquo;t so great:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python3 takuzu.py --method backtracker sample_8x8.takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>10011010</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>11001100</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01100101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>10110010</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01011001</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01001101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>10100110</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>00110011</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Solved in 47.03 seconds
</span></span></code></pre></div><p>Yeah&mldr;</p><p>We can do better.</p><p>How about instead of trying to solve the puzzle like a computer (brute forcing it), let&rsquo;s apply some heuristics more like a human would solve the puzzle. For example, if we see a pair of 0s next to each other, we know the tile on either side of it is a 1 (likewise for a pair of 0s separated by a single space and said space):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__third_of_a_kind__</span>(takuzu):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;If adding a value would make three in a row, add the other.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(takuzu<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(takuzu<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> takuzu<span style=color:#f92672>.</span>get(row, col):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> ((offset1_row, offset1_col), (offset2_row, offset2_col)) <span style=color:#f92672>in</span> [
</span></span><span style=display:flex><span>                <span style=color:#75715e># Two already in a line</span>
</span></span><span style=display:flex><span>                (( <span style=color:#ae81ff>0</span>,  <span style=color:#ae81ff>1</span>), ( <span style=color:#ae81ff>0</span>,  <span style=color:#ae81ff>2</span>)),
</span></span><span style=display:flex><span>                (( <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>), ( <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>)),
</span></span><span style=display:flex><span>                (( <span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>0</span>), ( <span style=color:#ae81ff>2</span>,  <span style=color:#ae81ff>0</span>)),
</span></span><span style=display:flex><span>                ((<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>0</span>), (<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>,  <span style=color:#ae81ff>0</span>)),
</span></span><span style=display:flex><span>                <span style=color:#75715e># Two with a hole in between</span>
</span></span><span style=display:flex><span>                (( <span style=color:#ae81ff>0</span>,  <span style=color:#ae81ff>1</span>), ( <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)),
</span></span><span style=display:flex><span>                (( <span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>0</span>), (<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>0</span>)),
</span></span><span style=display:flex><span>            ]:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                val1 <span style=color:#f92672>=</span> takuzu<span style=color:#f92672>.</span>get(row <span style=color:#f92672>+</span> offset1_row, col <span style=color:#f92672>+</span> offset1_col)
</span></span><span style=display:flex><span>                val2 <span style=color:#f92672>=</span> takuzu<span style=color:#f92672>.</span>get(row <span style=color:#f92672>+</span> offset2_row, col <span style=color:#f92672>+</span> offset2_col)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> val1 <span style=color:#f92672>and</span> val2 <span style=color:#f92672>and</span> val1 <span style=color:#f92672>==</span> val2:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> takuzu<span style=color:#f92672>.</span>set(row, col, invert(val1))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span></code></pre></div><p>Basically, for each empty tile in the current puzzle, compare each of six pairs. Either those in the four cardinal directions or the pair on either side horizontally or vertically.</p><p>Next rule, let&rsquo;s look for rows where we already have the necessary number of 0s and only need 1s. We can just fill those out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__fill_rows__</span>(takuzu):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;If we can figure out how many 0s and 1s we need for each and any row/col needs
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    only 0s or 1s, add them&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Try to fill any rows that have all of the needed 0s/1s but not the other</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> index <span style=color:#f92672>in</span> range(takuzu<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> row, col <span style=color:#f92672>in</span> [(index, <span style=color:#66d9ef>None</span>), (<span style=color:#66d9ef>None</span>, index)]:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> value <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;01&#39;</span>:
</span></span><span style=display:flex><span>                <span style=color:#75715e># Have enough of &#39;value&#39;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> takuzu<span style=color:#f92672>.</span>get(row, col)<span style=color:#f92672>.</span>count(value) <span style=color:#f92672>==</span> takuzu<span style=color:#f92672>.</span>size <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>                    <span style=color:#75715e># Not enough of the other one</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> takuzu<span style=color:#f92672>.</span>get(row, col)<span style=color:#f92672>.</span>count(invert(value)) <span style=color:#f92672>&lt;</span> takuzu<span style=color:#f92672>.</span>size <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>return</span> takuzu<span style=color:#f92672>.</span>set(row, col, invert(value))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span></code></pre></div><p>It&rsquo;s neat how short that code is.</p><p>Finally (for the moment at least), let&rsquo;s write a slightly more complicated method. This time, let&rsquo;s take a single row or column and generate all the possible ways we can fill it out. Then remove those that would either lead to a duplicate or three in a row. If we have only exactly one row left, then we&rsquo;re golden. That&rsquo;s our row:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__fill_by_duplicates__</span>(takuzu):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Fill a puzzle by checking if any rows/cols are near enough to done that only one
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    possibility is left.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>row_or_col</span>(which, index):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> which <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;row&#39;</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> takuzu<span style=color:#f92672>.</span>get(index, <span style=color:#66d9ef>None</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> takuzu<span style=color:#f92672>.</span>get(<span style=color:#66d9ef>None</span>, index)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> major <span style=color:#f92672>in</span> (<span style=color:#e6db74>&#39;row&#39;</span>, <span style=color:#e6db74>&#39;col&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#75715e># Completed rows/cols have no Nones (so are &#39;all&#39;)</span>
</span></span><span style=display:flex><span>        completed <span style=color:#f92672>=</span> filter(all, [
</span></span><span style=display:flex><span>            row_or_col(major, index)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> index <span style=color:#f92672>in</span> range(takuzu<span style=color:#f92672>.</span>size)
</span></span><span style=display:flex><span>        ])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> index <span style=color:#f92672>in</span> range(takuzu<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>            current <span style=color:#f92672>=</span> row_or_col(major, index)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># Already a complete row/col, skip it</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> all(current):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># Generate all posibilities, removing any that we already see</span>
</span></span><span style=display:flex><span>            possibilities <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>                option
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> option <span style=color:#f92672>in</span> permute_nones(current)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (
</span></span><span style=display:flex><span>                    option <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> completed
</span></span><span style=display:flex><span>                    <span style=color:#f92672>and</span> option<span style=color:#f92672>.</span>count(<span style=color:#e6db74>&#39;0&#39;</span>) <span style=color:#f92672>==</span> takuzu<span style=color:#f92672>.</span>size <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>and</span> option<span style=color:#f92672>.</span>count(<span style=color:#e6db74>&#39;1&#39;</span>) <span style=color:#f92672>==</span> takuzu<span style=color:#f92672>.</span>size <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>and</span> <span style=color:#e6db74>&#39;000&#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(option)
</span></span><span style=display:flex><span>                    <span style=color:#f92672>and</span> <span style=color:#e6db74>&#39;111&#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(option)
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># If we have exactly one, set that one</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> len(possibilities) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> other_index, value <span style=color:#f92672>in</span> enumerate(possibilities[<span style=color:#ae81ff>0</span>]):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> major <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;row&#39;</span>:
</span></span><span style=display:flex><span>                        takuzu <span style=color:#f92672>=</span> takuzu<span style=color:#f92672>.</span>set(index, other_index, value)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                        takuzu <span style=color:#f92672>=</span> takuzu<span style=color:#f92672>.</span>set(other_index, index, value)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Never found one</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span></code></pre></div><p>I&rsquo;m not nearly as happy with this rule as I am with the other two. Mostly because of the difference between rows and columns, the code is a little strange. The core of it is the <code>permute_nones</code> helper, which will take a list containing some number of <code>None</code> entries and fill them each with either a <code>0</code> or <code>1</code>, generating all possibilities:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>permute_nones</span>(ls):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Helper function to generate all permutations from filling in 0s and 1s into a list&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ls <span style=color:#f92672>==</span> []:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>yield</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> ls[<span style=color:#ae81ff>0</span>]:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> recur <span style=color:#f92672>in</span> permute_nones(ls[<span style=color:#ae81ff>1</span>:]):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>yield</span> [ls[<span style=color:#ae81ff>0</span>]] <span style=color:#f92672>+</span> recur
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> value <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;01&#39;</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> recur <span style=color:#f92672>in</span> permute_nones(ls[<span style=color:#ae81ff>1</span>:]):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>yield</span> [value] <span style=color:#f92672>+</span> recur
</span></span></code></pre></div><p>And that&rsquo;s all of my rules from now. The basic algorithm will be to apply each of those three rules in turn (since even after one has stopped working, another may &lsquo;unblock it&rsquo;). If we get to the point where none of those three rules work, fall back to the backtracker we discussed above:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>RULES <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    __third_of_a_kind__,
</span></span><span style=display:flex><span>    __fill_rows__,
</span></span><span style=display:flex><span>    __fill_by_duplicates__,
</span></span><span style=display:flex><span>    solvers<span style=color:#f92672>.</span>backtracker<span style=color:#f92672>.</span>solve,
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>solve</span>(takuzu):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Solve a Takuzu puzzle much as a human would: by applying a series of logical rules.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        updated <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># If we&#39;ve already solved it, return</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> takuzu<span style=color:#f92672>.</span>is_solved():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Try to apply each rule in turn; if any rule works start over</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> rule <span style=color:#f92672>in</span> RULES:
</span></span><span style=display:flex><span>            next_takuzu <span style=color:#f92672>=</span> rule(takuzu)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> next_takuzu:
</span></span><span style=display:flex><span>                takuzu <span style=color:#f92672>=</span> next_takuzu
</span></span><span style=display:flex><span>                updated <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># If we didn&#39;t apply any rule this iteration, done trying</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> updated:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> takuzu
</span></span></code></pre></div><p>Since we don&rsquo;t have to use the much slower (runtime <span class=latex-inline>O(2^n)</span>
) backtracking solution for the entire puzzle, this should run significantly faster:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> python3 takuzu<span style=color:#f92672>.</span>py <span style=color:#f92672>--</span>method human sample_6x6<span style=color:#f92672>.</span>takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>010110</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>001101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>110010</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>011001</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>100101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>101010</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Solved <span style=color:#f92672>in</span> <span style=color:#ae81ff>0.13</span> seconds
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> python3 takuzu<span style=color:#f92672>.</span>py <span style=color:#f92672>--</span>method human sample_8x8<span style=color:#f92672>.</span>takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>10011010</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>11001100</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01100101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>10110010</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01011001</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01001101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>10100110</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>00110011</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Solved <span style=color:#f92672>in</span> <span style=color:#ae81ff>37.23</span> seconds
</span></span></code></pre></div><p>Okay. So 0.13 seconds isn&rsquo;t <em>that</em> much faster than 0.15 seconds, and 37.23 seconds is only a bit faster than 47.03 seconds. For easier puzzles (those where a human wouldn&rsquo;t have to guess), you&rsquo;ll get a better improvement. These were considered &lsquo;hard&rsquo;.</p><p>We can do better though.</p><p>Right now, we fall back to a pure backtracking solution rather than the faster human rules if we ever fail to advance. What if we combined the two models? Use the human solution until you get stuck; then advance exactly one step with the backtracking model; then switch back to the human model. If that branch fails, you reset back to the backtracking step, the human steps can be skipped for this.</p><p>Let&rsquo;s try it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>RULES <span style=color:#f92672>=</span> copy<span style=color:#f92672>.</span>copy(solvers<span style=color:#f92672>.</span>human<span style=color:#f92672>.</span>RULES)
</span></span><span style=display:flex><span>RULES<span style=color:#f92672>.</span>remove(solvers<span style=color:#f92672>.</span>backtracker<span style=color:#f92672>.</span>solve)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>solve</span>(takuzu):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Solve a puzzle using a hybrid model.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Start with the human solver.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Every time you get stuck, guess at a spot.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Switch back to the human solver (backtracking to step 2 on failures).
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    queue <span style=color:#f92672>=</span> [takuzu]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> queue:
</span></span><span style=display:flex><span>        takuzu <span style=color:#f92672>=</span> queue<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Solved, we&#39;re done!</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> takuzu<span style=color:#f92672>.</span>is_solved():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># If we don&#39;t have a valid solution, stop looking on this branch</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> takuzu<span style=color:#f92672>.</span>is_valid():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Try to advance using the human rules until they all fail</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>            updated <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> rule <span style=color:#f92672>in</span> RULES:
</span></span><span style=display:flex><span>                next_takuzu <span style=color:#f92672>=</span> rule(takuzu)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> next_takuzu:
</span></span><span style=display:flex><span>                    takuzu <span style=color:#f92672>=</span> next_takuzu
</span></span><span style=display:flex><span>                    updated <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> updated:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Solved, we&#39;re done!</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> takuzu<span style=color:#f92672>.</span>is_solved():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Once they&#39;ve failed, find one empty spot and try both possibilities</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>enqueue</span>():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(takuzu<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(takuzu<span style=color:#f92672>.</span>size):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> takuzu<span style=color:#f92672>.</span>get(row, col):
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>for</span> value <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;01&#39;</span>:
</span></span><span style=display:flex><span>                            queue<span style=color:#f92672>.</span>append(takuzu<span style=color:#f92672>.</span>set(row, col, value))
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>        enqueue()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span></code></pre></div><p>So how much does that buy us?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> python3 takuzu<span style=color:#f92672>.</span>py <span style=color:#f92672>--</span>method hybrid sample_6x6<span style=color:#f92672>.</span>takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>010110</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>001101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>110010</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>011001</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>100101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>101010</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Solved <span style=color:#f92672>in</span> <span style=color:#ae81ff>0.05</span> seconds
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> python3 takuzu<span style=color:#f92672>.</span>py <span style=color:#f92672>--</span>method hybrid sample_8x8<span style=color:#f92672>.</span>takuzu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>10011010</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>11001100</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01100101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>10110010</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01011001</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01001101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>10100110</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>00110011</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Solved <span style=color:#f92672>in</span> <span style=color:#ae81ff>0.67</span> seconds
</span></span></code></pre></div><p>Hah! That&rsquo;s more like it!</p><p>For now, that&rsquo;s it<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>. If you&rsquo;d like to see how I structured the code (it&rsquo;s big enough to spread into multiple files), how I parsed command line parameters, or how I dynamically load the various solvers, you can see the entire code on GitHub: <a href=https://github.com/jpverkamp/takuzu>jpverkamp/takuzu</a>.</p><p>I like puzzles. Perhaps I&rsquo;ll try <a href=https://en.wikipedia.org/wiki/Suduko>Suduko</a> next. Or maybe <a href=https://en.wikipedia.org/wiki/Hashi%20puzzles>Hashiwokakero</a><sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>. Onwards!<sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>For the longest time, I thought this meant you could have something like four 0s and two 1s, so long as you had that in every row and column; turns out that&rsquo;s not the case and a 6x6 will always have exactly three each of 0s and 1s&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>I miss being able to use mostly arbitrary characters in function names&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>If we wanted a <a href=https://en.wikipedia.org/wiki/breadth-first%20search>breadth-first search</a>, we would use a queue instead. Although in practice it doesn&rsquo;t seem to actually matter much.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>Animation!&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>It turns out there are some large collections of puzzles online. One such site is <a href=http://www.binarypuzzle.com/puzzles.php>binarypuzzle.com</a>. They have puzzles ranging in size from 6x6 up to 14x14 in 4 difficulty levels, 100 of each. That&rsquo;s a total of 2000 puzzles. I have a script to solve all of them with each solver, but it&rsquo;s still running. Another day.&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p>I actually started on a solver for Hashi puzzles first, but my intial model didn&rsquo;t work out nearly as cleanly&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p>Alteratively, perhaps I&rsquo;ll try generating Takuzu puzzles instead. With a fast enough humanish solver, that should be relatively easy to do.&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article></div></div><footer id=page-footer role=contentinfo><nav id=footer-navigation role=navigation class=ribbon><ul class=main-navigation><li><a href=/archive-by-date/>All posts: By Date</a></li><li><a href=/archive-by-tag/>All posts: By Tag</a></li><li><a href=/atom.xml>RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li><li><a href=/programming/atom.xml>RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg></sup></a></li></ul></nav><div id=page-footer-content><div class=legal><p>All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US><img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png></a></p><p>Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a></p></div></div></footer></div></body></html>