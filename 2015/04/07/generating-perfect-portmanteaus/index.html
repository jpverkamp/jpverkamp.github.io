<!doctype html><html>
<head>
<title>Generating perfect portmanteaus â€“ jverkamp.com</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta charset=utf-8><link rel=alternate type=application/atom+xml title="jverkamp.com (Atom 2.0)" href=//blog.jverkamp.com/feed/>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css integrity=sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb crossorigin=anonymous>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css integrity="sha256-s0KLB0LnI5oqhHF8gkgfmxU4usUFEHlWJTxT8q72Tq4=" crossorigin=anonymous>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous>
<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel=stylesheet>
<link rel=stylesheet href=/custom.css defer>
<script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js></script>
</head>
<body>
<div id=wrapper><header id=page-header role=banner>
<h1><a href=/>JP's Blog</a></h1>
<ul id=page-header-links>
<li>
<a href=https://github.com/jpverkamp>GitHub</a> *
<a href=https://www.flickr.com/photos/jpverkamp>Flickr</a> *
<a href=/resume>Resume</a>
</li>
<li>
<form action=//www.google.com/search method=get onsubmit="(function(a){a.q.value='site:blog.jverkamp.com '+a.qfront.value})(this)" class="navbar-form navbar-right" role=search _lpchecked=1>
<div class=form-group>
<input name=q type=hidden>
<input name=qfront type=text class=form-control placeholder=Search>
<button type=submit class="btn btn-default" value=Search>Search</button>
</div>
</form>
</li>
</ul>
<nav id=header-navigation role=navigation class=ribbon>
<ul class=main-navigation><li><a href=https://blog.jverkamp.com/reviews/>Reviews</a></li><li><a href=https://blog.jverkamp.com/photography/>Photography</a></li><li><a href=https://blog.jverkamp.com/programming/>Programming</a></li><li><a href=https://blog.jverkamp.com/maker/>Maker</a></li><li><a href=https://blog.jverkamp.com/writing/>Writing</a></li><li><a href=https://blog.jverkamp.com/research/>Research</a></li><li class=subscription data-subscription=rss><a href=/atom.xml rel=subscribe-rss title="subscribe via RSS">RSS</a></li>
</ul>
</nav>
</header>
<div id=page-content-wrapper>
<div id=page-content><article>
<header>
<h1 class=entry-title>Generating perfect portmanteaus</h1>
<div class=entry-meta><span class=entry-date>2015-04-07</span>
</div>
<div class=entry-taxonomies><div class=entry-tags><ul class=taxonomy-keys><li>
<a class=taxonomy-key href=/programming/languages/>Languages</a>
<ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2015/01/29/ios-backups-in-racket-apps/ class=previous-link></a><a class=taxonomy-value href=/programming/languages/racket>Racket</a><a href=https://blog.jverkamp.com/2015/04/14/a-quick-look-at-rc4/ class=next-link></a></li></ul>
</li><li>
<a class=taxonomy-key href=/programming/topics/>Topics</a>
<ul class=taxonomy-values><li><a href=https://blog.jverkamp.com/2014/08/13/number-words/ class=previous-link></a><a class=taxonomy-value href=/programming/topics/word-games>Word Games</a></li></ul>
</li><li><a class=taxonomy-key href=/programming>programming</a>
<ul>
<li><a href=https://blog.jverkamp.com/2015/04/03/performance-problems-with-flask-and-docker/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2015/04/14/a-quick-look-at-rc4/ class=next-link>Next</a></ul>
</li><li><a class=taxonomy-key href=/>All Posts</a>
<ul>
<li><a href=https://blog.jverkamp.com/2015/04/03/performance-problems-with-flask-and-docker/ class=previous-link>Prev</a>
<a href=https://blog.jverkamp.com/2015/04/14/a-quick-look-at-rc4/ class=next-link>Next</a></ul>
</li></ul>
</div>
</div>
</header>
<div class=entry-content><p>A quick programming post, since it&rsquo;s been a while, inspired by this video:</p>
<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden>
<iframe src=https://www.youtube.com/embed/QVn2PZGZxaI style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe>
</div>
<p>I&rsquo;m not going to go quite as far as that, but I thought it would be interesting to write up some quick code to generate portmanteaus<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p>
<p>Basically<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, a portmanteau is a combination of two words, smooshing them together<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> and dropping some letters from each. In this case, what I&rsquo;m specifically interested in is &lsquo;perfect&rsquo; portmanteaus (I&rsquo;m not sure if there is a better term for it), where the suffix of one word exactly matches the prefix of the other.</p>
<p>As an example, consider the words <code>hamster</code> and <code>termine</code>. The last three letters of the former, perfectly matches the first three of the latter, so let&rsquo;s overlap them. <code>hamstermite</code>. Bam.</p>
<p>So how do we do it?</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket>(<span style=color:#66d9ef>define</span> current-minimum-overlap (make-parameter <span style=color:#ae81ff>3</span>))

(<span style=color:#66d9ef>define</span> (portmanteau left right)
  (<span style=color:#66d9ef>define</span> maximum-overlap (- (min (string-length left) (string-length right)) <span style=color:#ae81ff>1</span>))

  (<span style=color:#66d9ef>for*/first</span> ([overlap (in-range maximum-overlap (- (current-minimum-overlap) <span style=color:#ae81ff>1</span>) <span style=color:#ae81ff>-1</span>)]
               <span style=color:#66d9ef>#:when</span> (equal? (substring left (- (string-length left) overlap))
                              (substring right <span style=color:#ae81ff>0</span> overlap)))
    (list left
          right
          (string-append
           (substring left <span style=color:#ae81ff>0</span> (- (string-length left) overlap))
           right))))
</code></pre></div><p>Should be straight forward enough. Basically, we start with the longest possible overlap (1 less than the length of the shorter word, since we don&rsquo;t want to completely subsume a word), counting down until we reach some minimum overlap. For each possible sequence, we compare the prefix and suffix of the two words, only proceeding into the body of the loop when they match. That&rsquo;s the beauty of <code><a href="http://docs.racket-lang.org/search/index.html?q=for*/first">for*/first</a></code>
, it will loop until it gets a valid value, returning when it does.</p>
<p>And that&rsquo;s really it. Try it out with the example from earlier:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket>&gt; (portmanteau <span style=color:#e6db74>&#34;hamster&#34;</span> <span style=color:#e6db74>&#34;termite&#34;</span>)
<span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;hamster&#34;</span> <span style=color:#e6db74>&#34;termite&#34;</span> <span style=color:#e6db74>&#34;hamstermite&#34;</span>)
</code></pre></div><p>Since that was so quick, let&rsquo;s put some simple wrapper code around it in order to find all portmanteaus from a given word list. First, do the heavy lifting of finding portmanteaus:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket>(<span style=color:#66d9ef>define</span> (portmanteaus)
  (<span style=color:#66d9ef>define</span> words
    (<span style=color:#66d9ef>for*/list</span> ([raw-line (in-lines)]
                [line (in-value (string-trim (string-downcase raw-line)))]
                <span style=color:#66d9ef>#:when</span> (not (equal? <span style=color:#e6db74>&#34;&#34;</span> line)))
      line))

  (<span style=color:#66d9ef>for*/list</span> ([left (in-list words)]
              [right (in-list words)]
              <span style=color:#66d9ef>#:when</span> (not (eq? left right))
              [portmanteau (in-value (portmanteau left right))]
              <span style=color:#66d9ef>#:when</span> portmanteau)
    portmanteau))
</code></pre></div><p><code><a href="http://docs.racket-lang.org/search/index.html?q=in-value">in-value</a></code>
is useful in <code><a href="http://docs.racket-lang.org/search/index.html?q=for*">for*</a></code>
since it lets you bind a single value for future <code>#:when</code> blocks without having to recalculate anything.</p>
<p>After that, a wrapper to process some command line parameters and render output in a few different ways:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket>(<span style=color:#66d9ef>define</span> paths
  (<span style=color:#66d9ef>command-line</span>
   <span style=color:#66d9ef>#:program</span> <span style=color:#e6db74>&#34;portmanteau&#34;</span>
   <span style=color:#66d9ef>#:once-each</span>
   [(<span style=color:#e6db74>&#34;--minimum-overlap&#34;</span>)
    overlap
    <span style=color:#e6db74>&#34;Specify the minimum necessary overlap (default = 3)&#34;</span>
    (<span style=color:#66d9ef>cond</span>
      [(string-&gt;number overlap) <span style=color:#66d9ef>=&gt;</span> current-minimum-overlap]
      [<span style=color:#66d9ef>else</span> (error <span style=color:#f92672>&#39;</span><span style=color:#e6db74>--minimum-overlap</span> <span style=color:#e6db74>&#34;must specify a number&#34;</span>)])]
   <span style=color:#66d9ef>#:once-any</span>
   [(<span style=color:#e6db74>&#34;--verbose&#34;</span>)
    <span style=color:#e6db74>&#34;Print in verbose mode (default = false)&#34;</span>
    (verbose-mode <span style=color:#66d9ef>#t</span>)]
   [(<span style=color:#e6db74>&#34;--graph&#34;</span>)
    <span style=color:#e6db74>&#34;Print out a dotfile&#34;</span>
    (graph-mode <span style=color:#66d9ef>#t</span>)]
   <span style=color:#66d9ef>#:args</span> paths

   paths))

(<span style=color:#66d9ef>when</span> (null? paths)
  (<span style=color:#66d9ef>set!</span> paths <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;-&#34;</span>)))

(<span style=color:#66d9ef>for</span> ([path (in-list paths)])
  (<span style=color:#66d9ef>define</span> results
    (<span style=color:#66d9ef>cond</span>
      [(equal? path <span style=color:#e6db74>&#34;-&#34;</span>)
       (portmanteaus)]
      [<span style=color:#66d9ef>else</span>
       (with-input-from-file path portmanteaus)]))

  (<span style=color:#66d9ef>define</span> g (unweighted-graph/directed <span style=color:#f92672>&#39;</span>()))

  (<span style=color:#66d9ef>for</span> ([result (in-list results)])
    (<span style=color:#66d9ef>match-define</span> (list left right portmanteau) result)
    (<span style=color:#66d9ef>cond</span>
      [(verbose-mode)
       (printf <span style=color:#e6db74>&#34;~a + ~a = ~a</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span> left right portmanteau)]
      [(graph-mode)
       (add-edge! g (~a <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span> left <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span>) (~a <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span> right <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span>))]
      [<span style=color:#66d9ef>else</span>
       (displayln portmanteau)]))

  (<span style=color:#66d9ef>when</span> (graph-mode)
    (displayln (graphviz g))))
</code></pre></div><p>Now you can do some interesting things:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ racket portmanteau.rkt animals.txt

brown recluse spider monkey
gila monstermite
grasshopperegrine falcon
hamstermite
leechidna
ottermite
</code></pre></div><p>Just in case you cannot figure out what animals actually went into that list:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ racket portmanteau.rkt --verbose animals.txt

brown recluse spider + spider monkey <span style=color:#f92672>=</span> brown recluse spider monkey
gila monster + termite <span style=color:#f92672>=</span> gila monstermite
grasshopper + peregrine falcon <span style=color:#f92672>=</span> grasshopperegrine falcon
hamster + termite <span style=color:#f92672>=</span> hamstermite
leech + echidna <span style=color:#f92672>=</span> leechidna
otter + termite <span style=color:#f92672>=</span> ottermite
</code></pre></div><p>Or if you want to be a little more general, matching with only 2 characters rather than the default 3:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ racket portmanteau.rkt --minimum-overlap <span style=color:#ae81ff>2</span> --verbose animals.txt

armadillo + loon <span style=color:#f92672>=</span> armadilloon
armadillo + lorikeet <span style=color:#f92672>=</span> armadillorikeet
armadillo + louse <span style=color:#f92672>=</span> armadillouse
black mamba + badger <span style=color:#f92672>=</span> black mambadger
brown bear + armadillo <span style=color:#f92672>=</span> brown bearmadillo
brown recluse spider + spider monkey <span style=color:#f92672>=</span> brown recluse spider monkey
chinchilaa + aardvark <span style=color:#f92672>=</span> chinchilaardvark
copperhead snake + kestrel <span style=color:#f92672>=</span> copperhead snakestrel
coyote + termite <span style=color:#f92672>=</span> coyotermite
crow + owl <span style=color:#f92672>=</span> crowl
eagle + leech <span style=color:#f92672>=</span> eagleech
eagle + leopard seal <span style=color:#f92672>=</span> eagleopard seal
echidna + narwhal <span style=color:#f92672>=</span> echidnarwhal
gecko + koala <span style=color:#f92672>=</span> geckoala
gila monster + termite <span style=color:#f92672>=</span> gila monstermite
grasshopper + peregrine falcon <span style=color:#f92672>=</span> grasshopperegrine falcon
hamster + termite <span style=color:#f92672>=</span> hamstermite
hyena + narwhal <span style=color:#f92672>=</span> hyenarwhal
jackal + albatross <span style=color:#f92672>=</span> jackalbatross
king cobra + rattlesnake <span style=color:#f92672>=</span> king cobrattlesnake
king cobra + raven <span style=color:#f92672>=</span> king cobraven
kingsnake + kestrel <span style=color:#f92672>=</span> kingsnakestrel
kiwi + wild boar <span style=color:#f92672>=</span> kiwild boar
leech + chinchilaa <span style=color:#f92672>=</span> leechinchilaa
leech + echidna <span style=color:#f92672>=</span> leechidna
leopard seal + albatross <span style=color:#f92672>=</span> leopard sealbatross
narwhal + albatross <span style=color:#f92672>=</span> narwhalbatross
ostrich + chinchilaa <span style=color:#f92672>=</span> ostrichinchilaa
otter + termite <span style=color:#f92672>=</span> ottermite
polar bear + armadillo <span style=color:#f92672>=</span> polar bearmadillo
rattlesnake + kestrel <span style=color:#f92672>=</span> rattlesnakestrel
sloth bear + armadillo <span style=color:#f92672>=</span> sloth bearmadillo
snapping turtle + leech <span style=color:#f92672>=</span> snapping turtleech
snapping turtle + leopard seal <span style=color:#f92672>=</span> snapping turtleopard seal
sparrow + owl <span style=color:#f92672>=</span> sparrowl
sperm whale + leech <span style=color:#f92672>=</span> sperm whaleech
sperm whale + leopard seal <span style=color:#f92672>=</span> sperm whaleopard seal
sponge + gecko <span style=color:#f92672>=</span> spongecko
swan + anaconda <span style=color:#f92672>=</span> swanaconda
wild boar + armadillo <span style=color:#f92672>=</span> wild boarmadillo
</code></pre></div><p>Heh. Narwhalbatross. Wild boarmadillo. ðŸ˜„</p>
<p>And as a final bonus, using the <a href=https://github.com/stchang/graph/tree/master>graph</a> library I&rsquo;ve used (and contributed to) before, we can render the structure of the thing):</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ racket portmanteau.rkt --graph --minimum-overlap <span style=color:#ae81ff>2</span> animals.txt <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    | sed <span style=color:#e6db74>&#34;s/edge \[dir=none\];//g&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    | fdp -Tpng &gt; animals.png <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    <span style=color:#f92672>&amp;&amp;</span> open animals.png
</code></pre></div><figure><img src=/embeds/2015/animals.png>
</figure>
<p>Fun. :)</p>
<p>Think of the arrows as going from the stuck on word to where it&rsquo;s sticking rather than in the order the words would be written. It&rsquo;s easy enough to change though if you&rsquo;d like, just swap the arguments in the <code>add-edge!</code> call above.</p>
<p>And&mldr; that&rsquo;s it. Not much more to do with this one, unless I want to duplicate the above video and portmanteau all the things! We&rsquo;ll see.</p>
<p>As with all my code, you can see the entire thing on GitHub: <a href=https://github.com/jpverkamp/small-projects/blob/master/blog/portmanteau.rkt>portmanteau.rkt</a></p>
<section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>Apparently either portmanteaus or portmanteaux is a valid pluralization&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:2 role=doc-endnote>
<p>If you didn&rsquo;t watch the video&ndash;you really should; at least the introduction&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:3 role=doc-endnote>
<p>Yes, that is the technical term&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section></div>
</article></div>
</div><footer id=page-footer role=contentinfo>
<nav id=footer-navigation role=navigation class=ribbon>
<ul class=main-navigation>
<li><a href=/archive-by-date/>All posts: By Date</a></li>
<li><a href=/archive-by-tag/>All posts: By Tag</a></li>
<li>
<a href=/atom.xml>
RSS: All <sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg>
</sup>
</a>
</li><li>
<a href=/programming/atom.xml>
RSS: programming<sup><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path fill="#fff" d="M6.503 20.752C6.503 22.546 5.047 24 3.252 24c-1.796.0-3.252-1.454-3.252-3.248s1.456-3.248 3.252-3.248c1.795.001 3.251 1.454 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242.0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg>
</sup>
</a>
</li></ul>
</nav>
<div id=page-footer-content>
<div class=legal>
<p>
All posts unless otherwise mentioned are licensed under
<a rel=license href=//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US>
<img alt="Creative Commons License" style=border-width:0 src=//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png>
</a>
</p>
<p>
Any source code unless otherwise mentioned is licensed under the <a href=//directory.fsf.org/wiki/License:BSD_3Clause>3 clause BSD license</a>
</p>
</div>
</div>
</footer>
</div><script defer src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin=anonymous></script>
<script defer src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js integrity="sha256-yDarFEUo87Z0i7SaC6b70xGAKCghhWYAZ/3p+89o4lE=" crossorigin=anonymous></script>
<script defer src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js integrity=sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h crossorigin=anonymous></script>
<script defer src=https://cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js integrity="sha256-2ylggML6rCJMc817KbE8Cx+cuxYIM+6bjG2Gpq2g7iU=" crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script defer>mermaid.initialize({startOnLoad:!0,securityLevel:'loose'})</script>
<script defer src=/custom.js></script>
</body>
</html>