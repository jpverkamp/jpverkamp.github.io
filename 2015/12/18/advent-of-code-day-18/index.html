<!DOCTYPE html>
<html>
<head>
    <title>
    Advent of Code: Day 18 â€“ jverkamp.com
</title>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <link rel="alternate" type="application/atom+xml" title="jverkamp.com (Atom 2.0)" href="//blog.jverkamp.com/feed/">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/css/themes/light/nanogallery_light.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot-default.min.css">

<link href="https://fonts.googleapis.com/css?family=Spectral+SC|Lato|Share+Tech+Mono" rel="stylesheet">

<link rel="stylesheet" href="/custom.css" defer />


    
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
    <div id="wrapper">
        <header id="page-header" role="banner">
    <h1><a href="/">JP's Blog</a></h1>

    <ul id="page-header-links">
        <li>
            <a href="https://twitter.com/jpverkamp">Twitter</a> *
            <a href="https://github.com/jpverkamp">GitHub</a> *
            <a href="https://www.flickr.com/photos/jpverkamp">Flickr</a>
        </li>
        <li>
            <form action="//www.google.com/search" method="get" onsubmit="(function(obj){obj.q.value='site:blog.jverkamp.com '+obj.qfront.value;})(this)" class="navbar-form navbar-right" role="search" _lpchecked="1">
                <div class="form-group">
                    <input name="q" type="hidden">
                    <input name="qfront" type="text" class="form-control" placeholder="Search">
                    <button type="submit" class="btn btn-default" value="Search">Search</button>
                </div>
            </form>
        </li>

    </ul>

    <nav id="header-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
        
            
        
            
            <li><a href="https://blog.jverkamp.com/photography/">Photography</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/programming/">Programming</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/research/">Research</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/reviews/">Reviews</a></li>
            
        
            
            <li><a href="https://blog.jverkamp.com/writing/">Writing</a></li>
            
        
            <li class="subscription" data-subscription="rss"><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    </nav>
</header>


        <div id="page-content-wrapper">
            <div id="page-content">
            
<article>
	<header>
		<h1 class="entry-title">Advent of Code: Day 18</h1>

        <div class="entry-meta">
            
            <span class="entry-date">2015-12-18</span>
            
            
        </div>

        <div class="entry-tags">
    
    

    <ul class="taxonomy-keys">
    
        
        

        
        

        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/languages/">Languages</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2015/12/17/advent-of-code-day-17/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/languages/python">Python</a>
                        <a href="https://blog.jverkamp.com/2015/12/19/advent-of-code-day-19/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/programming/sources/">Sources</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2015/12/17/advent-of-code-day-17/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/programming/sources/advent-of-code">Advent of Code</a>
                        <a href="https://blog.jverkamp.com/2015/12/19/advent-of-code-day-19/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
        <li>
            <a class="taxonomy-key" href="/series/">Series</a>
            <ul class="taxonomy-values">
            
            
                

                
                

                
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    
                    

                    <li>
                        <a href="https://blog.jverkamp.com/2015/12/17/advent-of-code-day-17/" class="previous-link"></a>
                        <a class="taxonomy-value" href="/series/advent-of-code-2015">Advent of Code 2015</a>
                        <a href="https://blog.jverkamp.com/2015/12/19/advent-of-code-day-19/" class="next-link"></a>
                    </li>
                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
                

                
                

                
            
            
            </ul>
        </li>
        
    
        
        

        
        

        
    
        
        

        
        

        
    
        
        

        
        

        
    

    
        
        <li><a class="taxonomy-key" href="/programming">programming</a>
            <ul>
                <li>
                
                <a href="https://blog.jverkamp.com/2015/12/17/advent-of-code-day-17/" class="previous-link">Prev</a>
                

                
                <a href="https://blog.jverkamp.com/2015/12/19/advent-of-code-day-19/" class="next-link">Next</a>
                
            </ul>
        </li>
        

        
        <li><a class="taxonomy-key" href="/">All Posts</a>
            <ul>
                <li>
                
                <a href="https://blog.jverkamp.com/2015/12/17/advent-of-code-day-17/" class="previous-link">Prev</a>
                

                
                <a href="https://blog.jverkamp.com/2015/12/19/vamphyri/" class="next-link">Next</a>
                
            </ul>
        </li>
        
    
    </ul>
</div>

    </header>

	<div class="entry-content">
		<p><a href="http://adventofcode.com/day/18">Source</a></p>

<p><strong>Part 1:</strong> Simulate <a href="https://en.wikipedia.org/wiki/Conway%27s%20Game%20of%20Life">Conway&#39;s Game of Life</a>. Count how many lights are on after 100 iterations.</p>

<p></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Grid</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self, str):
        self<span style="color:#f92672">.</span>data <span style="color:#f92672">=</span> [
            [(char <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;#&#39;</span>) <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> line]
            <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> str<span style="color:#f92672">.</span>split()
        ]
        self<span style="color:#f92672">.</span>width <span style="color:#f92672">=</span> len(self<span style="color:#f92672">.</span>data)
        self<span style="color:#f92672">.</span>height <span style="color:#f92672">=</span> len(self<span style="color:#f92672">.</span>data[<span style="color:#ae81ff">0</span>])

    <span style="color:#66d9ef">def</span> __getitem__(self, pt):
        row, col <span style="color:#f92672">=</span> pt
        <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&lt;=</span> row <span style="color:#f92672">&lt;</span> self<span style="color:#f92672">.</span>height <span style="color:#f92672">and</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&lt;=</span> col <span style="color:#f92672">&lt;</span> self<span style="color:#f92672">.</span>width:
            <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>data[row][col]
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">return</span> False

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">neighbors</span>(self, row, col):
        <span style="color:#66d9ef">return</span> sum(
            (<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> self[row <span style="color:#f92672">+</span> row_delta, col <span style="color:#f92672">+</span> col_delta] <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0</span>)
            <span style="color:#66d9ef">for</span> row_delta <span style="color:#f92672">in</span> range(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>)
            <span style="color:#66d9ef">for</span> col_delta <span style="color:#f92672">in</span> range(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>)
        ) <span style="color:#f92672">-</span> (<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> self[row, col] <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0</span>)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">step</span>(self):
        new_data <span style="color:#f92672">=</span> copy<span style="color:#f92672">.</span>deepcopy(self<span style="color:#f92672">.</span>data)

        <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> range(self<span style="color:#f92672">.</span>height):
            <span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> range(self<span style="color:#f92672">.</span>width):
                <span style="color:#66d9ef">if</span> self[row, col]:
                    new_data[row][col] <span style="color:#f92672">=</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">&lt;=</span> self<span style="color:#f92672">.</span>neighbors(row, col) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">3</span>)
                <span style="color:#66d9ef">else</span>:
                    new_data[row][col] <span style="color:#f92672">=</span> (self<span style="color:#f92672">.</span>neighbors(row, col) <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>)

        self<span style="color:#f92672">.</span>data <span style="color:#f92672">=</span> new_data

    <span style="color:#66d9ef">def</span> __repr__(self):
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>join(
            <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(
                <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;#&#39;</span> <span style="color:#66d9ef">if</span> self[row, col] <span style="color:#66d9ef">else</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;.&#39;</span>
                <span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> range(self<span style="color:#f92672">.</span>width)
            )
            <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> range(self<span style="color:#f92672">.</span>height)
        )

    <span style="color:#66d9ef">def</span> __len__(self):
        <span style="color:#66d9ef">return</span> sum(
            <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> self[row, col] <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0</span>
            <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> range(self<span style="color:#f92672">.</span>height)
            <span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> range(self<span style="color:#f92672">.</span>width)
        )

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    grid <span style="color:#f92672">=</span> Grid(sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>read())

    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(int(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>])):
        grid<span style="color:#f92672">.</span>step()

    <span style="color:#66d9ef">print</span>(grid)
    <span style="color:#66d9ef">print</span>(len(grid))</code></pre></div>
<p>I don&rsquo;t use actually use <a href="https://en.wikipedia.org/wiki/object%20oriented%20programming">object oriented programming</a> that much, but this problem just called for it. It let me abstract away the counting of accessing of elements while dealing with edge cases. Also, it will be even more helpful in part 2<sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup>.</p>

<p>The three interesting bits are the <code>__getitem__</code>, <code>neighbors</code>, and <code>step</code> functions. The first is interesting, since it actually takes a tuple as as argument, but looks like it takes two parameters: <code>grid[row, col]</code> is actually equivalent to <code>grid[(row, col)]</code>, since it&rsquo;s actually the <code>,</code> that makes a tuple, not the parenthesis.</p>

<p>Next, <code>neighbors</code> will count up the positive neighboring elements using <code>__getitem__</code>. We subtract the one at the end if the node is enabled to account for the fact that we counted the node as its own neighbor.</p>

<p>With all of that, <code>step</code> becomes much easier. We just have to loop and using the <code>neighbors</code> function. Shiny.</p>

<p><strong>Part 2:</strong> Repeat, but this time the four lights in the corners will be stuck on.</p>

<p>This is another reason why I wanted to write this in an object oriented style (in highsight):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">part1 <span style="color:#f92672">=</span> imp<span style="color:#f92672">.</span>load_source(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;part1&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;part-1.py&#39;</span>)

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FixedCornerGrid</span>(part1<span style="color:#f92672">.</span>Grid):
    <span style="color:#66d9ef">def</span> __getitem__(self, pt):
        row, col <span style="color:#f92672">=</span> pt
        <span style="color:#66d9ef">if</span> (row <span style="color:#f92672">in</span> (<span style="color:#ae81ff">0</span>, self<span style="color:#f92672">.</span>width <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">and</span> col <span style="color:#f92672">in</span> (<span style="color:#ae81ff">0</span>, self<span style="color:#f92672">.</span>height <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)):
            <span style="color:#66d9ef">return</span> True
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">return</span> part1<span style="color:#f92672">.</span>Grid<span style="color:#f92672">.</span>__getitem__(self, pt)

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    grid <span style="color:#f92672">=</span> FixedCornerGrid(sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>read())

    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(int(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>])):
        grid<span style="color:#f92672">.</span>step()

    <span style="color:#66d9ef">print</span>(grid)
    <span style="color:#66d9ef">print</span>(len(grid))</code></pre></div>
<p>The weirdness comes from the fact that I for some reason decided to use dashes in my filenames. Otherwise, I could just have done <code>import part1</code>. But other than that, we only have to slightly tweak the <code>__getitem__</code> behavior for the four corners. Other than that, we just directly reuse all of the code from the original <code>Grid</code> class.</p>

<p>I actually really like how this turned out. It brings a slightly new twist to a problem I&rsquo;ve solved a half dozen or more times before.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">Spoilers
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
</ol>
</div>
	</div>

    
<div class="entry-comments">
    <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = "jverkamp";
            var disqus_title = "Advent of Code: Day 18";
            var disqus_url = "https:\/\/blog.jverkamp.com\/2015\/12\/18\/advent-of-code-day-18\/";

             
            (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>


</article>

            </div>
        </div>

        <footer id="page-footer" role="contentinfo">
    <nav id="footer-navigation" role="navigation" class="ribbon">
        <ul class="main-navigation">
            <li><a href="/archive-by-date/">All posts: By Date</a></li>
            <li><a href="/archive-by-tag/">All posts: By Tag</a></li>

            <li>
                <a href="/atom.xml">
                    RSS: All <sup>

<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li>

            
            <li>
                <a href="/programming/atom.xml">
                    RSS: programming<sup>

<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24">
    <path fill="white" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z" />
</svg>
</sup>
                </a>
            </li>
            
        </ul>
    </nav>

    <div id="page-footer-content">
        <div class="legal">
            <p>
                All posts unless otherwise mentioned are licensed under
                <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">
                    <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
                </a>
            </p>

            <p>
                Any source code unless otherwise mentioned is licensed under the <a href="//directory.fsf.org/wiki/License:BSD_3Clause">3 clause BSD license</a>
            </p>
        </div>
    </div>
</footer>

    </div>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/nanogallery/4.4.2/jquery.nanogallery.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/bigfoot/2.1.4/bigfoot.min.js"></script>

<script type="text/javascript" src="/custom.js" defer></script>

</body>
</html>
